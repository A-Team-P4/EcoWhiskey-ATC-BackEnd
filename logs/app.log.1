2025-12-02 21:30:48,195 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:30:51,065 | DEBUG | app.services.transcribe | Received transcript chunk: a posición y manteni...
2025-12-02 21:30:51,151 | INFO | app.services.transcribe | Transcription complete. Length: 55
2025-12-02 21:30:51,152 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: a posición y manteniendo pista 10 Alfa Noviembre India
2025-12-02 21:30:51,153 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | text=a posición y manteniendo pista 10 Alfa Noviembre India
2025-12-02 21:30:51,354 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:30:51,357 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:30:51,358 | INFO | sqlalchemy.engine.Engine | [cached since 628.3s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:30:51,386 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:30:54,202 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:30:54,203 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:30:54,204 | INFO | sqlalchemy.engine.Engine | [cached since 631.1s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:30:54,238 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:30:54,240 | INFO | sqlalchemy.engine.Engine | [cached since 629.3s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (22514 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 30, 54, 237093, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:30:54,263 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:30:54,308 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_takeoff_clearance intent=tower_position_report freq=tower
2025-12-02 21:30:54,312 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_position_report freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 70 grados 11 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": ...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_position_report
Transcripción textual del alumno:
a posición y manteniendo pista 10 Alfa Noviembre India

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver ...
2025-12-02 21:31:07,250 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_position_report intento=1: {
  "intent": "tower_position_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, viento 070 grados 11 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.",
  "feedback": "Reporte de posición correcto. Ahora se procede a dar autorización de despegue incluyendo viento, pista, instrucciones de rumbo y reporte de altitud. Se mantiene la fraseología estándar ATC.",
  "confidence": 0.92,
  "score": 85,
  "metadata": {
    ...
2025-12-02 21:31:07,251 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=tower_takeoff_clearance a=tower_initial_climb
2025-12-02 21:31:07,397 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:31:07,397 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:31:07,399 | INFO | sqlalchemy.engine.Engine | [cached since 644.3s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:31:07,423 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:31:07,425 | INFO | sqlalchemy.engine.Engine | [cached since 642.5s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (24117 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 31, 7, 422735, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:31:07,441 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:31:07,475 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:31:07,477 | INFO | sqlalchemy.engine.Engine | [cached since 621.2s ago] (UUID('fb09cbb4-9731-4d8d-a162-e41f57301bfb'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'tower_initial_climb', 85.0, 'Reporte de posición correcto. Ahora se procede a dar autorización de despegue incluyendo viento, pista, instrucciones de rumbo y reporte de altitud. Se mantiene la fraseología estándar ATC.')
2025-12-02 21:31:07,495 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:31:07,528 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_initial_climb score=85.00
2025-12-02 21:31:07,529 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | intent=tower_position_report | phase=tower_initial_climb | allow_response=True | text=Alfa Noviembre India, viento 070 grados 11 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.
2025-12-02 21:33:34,302 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:33:34,303 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:33:34,304 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:33:34,305 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:33:34,307 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:33:34,307 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:33:34,308 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:33:34,308 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:33:34,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:33:34,311 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:33:34,312 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:33:34,312 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:33:34,315 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:33:34,315 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:33:34,317 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:33:34,319 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:33:34,323 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:33:34,323 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:33:34,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:33:34,327 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:33:34,328 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:33:34,329 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:33:34,330 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:33:34,331 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:33:34,332 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:33:34,333 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:33:34,333 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:33:34,333 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:33:34,335 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 21:33:34,338 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:33:34,338 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:33:34,341 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:1460]
2025-12-02 21:33:34,343 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:34,345 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 21:33:34,575 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:34,577 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:34,580 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:34,589 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:33:34,858 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:34,860 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:34,863 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:33:35,123 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:35,126 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:35,127 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:33:35,324 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:35,329 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:35,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:35,336 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:35,338 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:33:35,568 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:35,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:35,574 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:33:35,783 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:35,787 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:35,788 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:35,789 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:33:36,000 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:33:36,004 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:36,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:33:36,241 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:36,242 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:36,245 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:33:36,450 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:36,451 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:36,455 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:33:36,637 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:36,639 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:36,641 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:36,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:33:36,897 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:33:36,899 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:33:36,905 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2832]
2025-12-02 21:33:36,908 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:33:36,910 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:33:37,078 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:33:37,079 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:33:37,081 | INFO | sqlalchemy.engine.Engine | [cached since 838.9s ago] ()
2025-12-02 21:33:37,089 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:33:37,091 | INFO | sqlalchemy.engine.Engine | [cached since 800.9s ago] (6,)
2025-12-02 21:33:38,030 | INFO | app.services.transcribe | Starting stream. Total bytes: 688128. Chunk size: 8192. No throttling.
2025-12-02 21:33:38,032 | DEBUG | app.services.transcribe | Streamed 8192/688128 bytes
2025-12-02 21:33:38,083 | DEBUG | app.services.transcribe | Streamed 417792/688128 bytes
2025-12-02 21:33:38,113 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:33:39,250 | DEBUG | app.services.transcribe | Received transcript chunk: T....
2025-12-02 21:33:41,089 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-02 21:33:41,165 | INFO | app.services.transcribe | Transcription complete. Length: 47
2025-12-02 21:33:41,166 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: T. Alfa Noviembre, India, pasando a 5000 pies.
2025-12-02 21:33:41,166 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | text=T. Alfa Noviembre, India, pasando a 5000 pies.
2025-12-02 21:33:41,328 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:33:41,329 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:33:41,331 | INFO | sqlalchemy.engine.Engine | [cached since 798.2s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:33:41,358 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:33:43,851 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:33:43,853 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:33:43,854 | INFO | sqlalchemy.engine.Engine | [cached since 800.8s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:33:43,880 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:33:43,881 | INFO | sqlalchemy.engine.Engine | [cached since 799s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (24542 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 33, 43, 880046, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:33:43,911 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:33:43,953 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_initial_climb intent=tower_altitude_report freq=tower
2025-12-02 21:33:43,957 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_altitude_report freq_group=tower
SYSTEM> Ya en ascenso; al reportar 5000 pies instruyes cambio a COCO Aproximación. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe ser ...
USER> Fase actual: Reporte pasando 5000 y transferencia a Aproximación
Intent esperado: tower_altitude_report
Transcripción textual del alumno:
T. Alfa Noviembre, India, pasando a 5000 pies.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_initial_climb

Checklist alumno:
- Reportar pasando 5000 pies.
- NO decir: 'Coco Aproximación' todavía (sigues con Torre).

Checklist controlador:
- Agradecer reporte.
- Transferir a COCO Aproximación 120.5.

Cuándo responder:...
2025-12-02 21:34:00,481 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_altitude_report intento=1: {
  "intent": "tower_altitude_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, recibido. Contacte COCO Aproximación 120.5. Buen día.",
  "feedback": "Reporte de altitud correcto. Se incluye el saludo 'T.' y se mantiene la estructura requerida. Ahora se procede a transferir a Aproximación siguiendo el protocolo.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "approach_contact",
    "missingElements": [],
    "additionalNotes": "El alumno cum...
2025-12-02 21:34:00,483 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=tower_initial_climb a=approach_contact
2025-12-02 21:34:00,667 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:34:00,670 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:34:00,671 | INFO | sqlalchemy.engine.Engine | [cached since 817.6s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:34:00,708 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:34:00,710 | INFO | sqlalchemy.engine.Engine | [cached since 815.8s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (26138 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 21, 34, 0, 707969, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:34:00,732 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:34:00,780 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:34:00,782 | INFO | sqlalchemy.engine.Engine | [cached since 794.5s ago] (UUID('5d6eb50b-2278-41c7-aa73-d9008f81b2ea'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'approach_contact', 95.0, "Reporte de altitud correcto. Se incluye el saludo 'T.' y se mantiene la estructura requerida. Ahora se procede a transferir a Aproximación siguiendo el protocolo.")
2025-12-02 21:34:00,799 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:34:00,842 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=approach_contact score=95.00
2025-12-02 21:34:00,844 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | intent=tower_altitude_report | phase=approach_contact | allow_response=True | text=Alfa Noviembre India, recibido. Contacte COCO Aproximación 120.5. Buen día.
2025-12-02 21:35:45,421 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:35:45,422 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:35:45,423 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:35:45,423 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:35:45,424 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:35:45,426 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:35:45,427 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:35:45,427 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:35:45,429 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:35:45,431 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:35:45,432 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:35:45,434 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:35:45,435 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:35:45,437 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:35:45,437 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:35:45,439 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:35:45,440 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:35:45,443 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:35:45,444 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:35:45,446 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:35:45,447 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:35:45,448 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:35:45,448 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:35:45,449 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:35:45,449 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:35:45,451 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:35:45,452 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:35:45,453 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:35:45,456 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:35:45,460 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:35:45,461 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:35:45,462 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 21:35:45,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:35:45,676 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:45,678 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1459]
2025-12-02 21:35:45,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-02 21:35:45,681 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:45,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:35:45,937 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:45,940 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:45,944 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:45,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:35:46,204 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:46,207 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:46,211 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:46,214 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:35:46,430 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:46,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:46,436 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:46,440 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:35:46,630 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:46,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:46,635 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:35:46,820 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:46,820 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:46,822 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:46,826 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:35:47,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:47,096 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:47,099 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:35:47,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:47,305 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:47,309 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:47,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:35:47,561 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:47,562 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:47,565 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:47,566 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:35:47,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:47,777 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:47,779 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:35:48,000 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,004 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:48,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:48,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:35:48,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,196 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,199 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,202 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:35:48,364 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,366 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:48,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:35:48,565 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:48,568 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,574 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,577 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:35:48,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:35:48,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:35:48,786 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3244]
2025-12-02 21:35:48,787 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:35:48,790 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:35:48,949 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:35:48,950 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:35:48,951 | INFO | sqlalchemy.engine.Engine | [cached since 970.8s ago] ()
2025-12-02 21:35:48,961 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:35:48,962 | INFO | sqlalchemy.engine.Engine | [cached since 932.8s ago] (6,)
2025-12-02 21:35:49,940 | INFO | app.services.transcribe | Starting stream. Total bytes: 931840. Chunk size: 8192. No throttling.
2025-12-02 21:35:49,945 | DEBUG | app.services.transcribe | Streamed 8192/931840 bytes
2025-12-02 21:35:50,006 | DEBUG | app.services.transcribe | Streamed 417792/931840 bytes
2025-12-02 21:35:50,052 | DEBUG | app.services.transcribe | Streamed 827392/931840 bytes
2025-12-02 21:35:50,066 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:35:53,226 | DEBUG | app.services.transcribe | Received transcript chunk: coco aproximación Al...
2025-12-02 21:35:54,852 | DEBUG | app.services.transcribe | Received transcript chunk: ascendiendo a 7000 r...
2025-12-02 21:35:54,906 | INFO | app.services.transcribe | Transcription complete. Length: 97
2025-12-02 21:35:54,908 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: coco aproximación Alfa Noviembre India pasando a 5000 pies. ascendiendo a 7000 rumbo a zona Eco.
2025-12-02 21:35:54,910 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=120.500 | text=coco aproximación Alfa Noviembre India pasando a 5000 pies. ascendiendo a 7000 rumbo a zona Eco.
2025-12-02 21:35:55,080 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:35:55,081 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:35:55,082 | INFO | sqlalchemy.engine.Engine | [cached since 932s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:35:55,102 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:35:55,958 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:35:55,960 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:35:55,963 | INFO | sqlalchemy.engine.Engine | [cached since 932.9s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:35:55,993 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:35:55,994 | INFO | sqlalchemy.engine.Engine | [cached since 931.1s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (26625 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 21, 35, 55, 992445, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:35:56,019 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:35:56,055 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=approach_contact intent=approach_altitude_change freq=approach
2025-12-02 21:35:56,059 | INFO | app.services.audio_pipeline | Prompts generados intent=approach_altitude_change freq_group=approach
SYSTEM> Eres COCO Aproximación (120.5). Responde: '[Matrícula], Coco Aproximación, contacto radar. Continúe ascenso nivel siete mil pies. QNH 3012. Reporte ingresando Zona ECO.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence...
USER> Fase actual: Contacto inicial con COCO Aproximación
Intent esperado: approach_altitude_change
Transcripción textual del alumno:
coco aproximación Alfa Noviembre India pasando a 5000 pies. ascendiendo a 7000 rumbo a zona Eco.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: approach
- Fase ID: approach_contact

Checklist alumno:
- Saludo inicial a COCO Aproximación.
- Reportar altitud actual.
- Reportar altitud asignada/ascenso.
- Reportar rumbo o destino.

Checklist controlador:...
2025-12-02 21:36:05,790 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=approach_altitude_change intento=1: {
  "intent": "approach_altitude_change",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Coco Aproximación, contacto radar. Continúe ascenso nivel siete mil pies. QNH 3012. Reporte ingresando Zona ECO.",
  "feedback": "El reporte inicial cumple con los requisitos básicos: incluye altitud actual, ascenso y destino. Sin embargo, falta el saludo formal 'COCO Aproximación' al inicio. La estructura general es correcta pero podría mejorarse en formalidad.",
  "confidence": 0.85...
2025-12-02 21:36:05,791 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=approach_contact a=approach_readback
2025-12-02 21:36:05,976 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:36:05,977 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:36:05,979 | INFO | sqlalchemy.engine.Engine | [cached since 942.9s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:36:06,012 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:36:06,014 | INFO | sqlalchemy.engine.Engine | [cached since 941.1s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (28210 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 21, 36, 6, 12681, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:36:06,045 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:36:06,086 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:36:06,088 | INFO | sqlalchemy.engine.Engine | [cached since 919.8s ago] (UUID('09a69ea0-b94c-4288-9c87-c0855607ced8'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'approach_readback', 82.0, "El reporte inicial cumple con los requisitos básicos: incluye altitud actual, ascenso y destino. Sin embargo, falta el saludo formal 'COCO Aproximación' al inicio. La estructura general es correcta pero podría mejorarse en formalidad.")
2025-12-02 21:36:06,104 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:36:06,147 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=approach_readback score=82.00
2025-12-02 21:36:06,148 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=120.500 | intent=approach_altitude_change | phase=approach_readback | allow_response=True | text=Alfa Noviembre India, Coco Aproximación, contacto radar. Continúe ascenso nivel siete mil pies. QNH 3012. Reporte ingresando Zona ECO.
2025-12-02 21:36:47,076 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:36:47,078 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:36:47,079 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:36:47,080 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:36:47,081 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:36:47,082 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:36:47,083 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:36:47,083 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:36:47,086 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:36:47,087 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:36:47,088 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:36:47,090 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:36:47,092 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:36:47,093 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:36:47,096 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:36:47,097 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:36:47,099 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:36:47,100 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:36:47,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:36:47,101 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:36:47,101 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:36:47,102 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:36:47,103 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:36:47,104 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:36:47,104 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:36:47,107 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:36:47,107 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:36:47,108 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:36:47,109 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:36:47,109 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:36:47,110 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:36:47,111 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 21:36:47,114 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:47,116 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:47,303 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:47,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:47,306 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:47,309 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:36:47,525 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:36:47,527 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:47,530 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:36:47,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:36:47,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:48,033 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:48,036 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:48,039 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:48,041 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:36:48,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:36:48,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:48,533 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:48,535 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:48,537 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:48,768 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:48,770 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:48,773 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:49,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:49,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:49,072 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:49,077 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:36:49,482 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:49,483 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:49,488 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:49,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:36:49,800 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:49,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:49,804 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:49,806 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:50,081 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:36:50,084 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:50,086 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:50,089 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:36:50,315 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:50,317 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:50,320 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:50,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:36:50,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:50,585 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:50,587 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:50,793 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:50,797 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:50,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:50,805 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:36:51,008 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:36:51,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:36:51,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:51,277 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:36:51,280 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:36:51,366 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2643]
2025-12-02 21:36:51,367 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:36:51,369 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:36:51,618 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:36:51,620 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:36:51,622 | INFO | sqlalchemy.engine.Engine | [cached since 1033s ago] ()
2025-12-02 21:36:51,636 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:36:51,637 | INFO | sqlalchemy.engine.Engine | [cached since 995.5s ago] (6,)
2025-12-02 21:36:52,761 | INFO | app.services.transcribe | Starting stream. Total bytes: 1015808. Chunk size: 8192. No throttling.
2025-12-02 21:36:52,766 | DEBUG | app.services.transcribe | Streamed 8192/1015808 bytes
2025-12-02 21:36:52,817 | DEBUG | app.services.transcribe | Streamed 417792/1015808 bytes
2025-12-02 21:36:52,859 | DEBUG | app.services.transcribe | Streamed 827392/1015808 bytes
2025-12-02 21:36:52,886 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:36:54,651 | DEBUG | app.services.transcribe | Received transcript chunk: 30....
2025-12-02 21:36:56,299 | DEBUG | app.services.transcribe | Received transcript chunk: continuamos ascenso ...
2025-12-02 21:36:58,423 | DEBUG | app.services.transcribe | Received transcript chunk: reportaremos ingreso...
2025-12-02 21:36:58,498 | INFO | app.services.transcribe | Transcription complete. Length: 90
2025-12-02 21:36:58,500 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: 30. continuamos ascenso a 7000 pies. reportaremos ingreso a zona Eco Alfa Noviembre India
2025-12-02 21:36:58,500 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=120.500 | text=30. continuamos ascenso a 7000 pies. reportaremos ingreso a zona Eco Alfa Noviembre India
2025-12-02 21:36:58,657 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:36:58,658 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:36:58,660 | INFO | sqlalchemy.engine.Engine | [cached since 995.6s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:36:58,691 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:37:01,090 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:37:01,092 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:37:01,093 | INFO | sqlalchemy.engine.Engine | [cached since 998s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:37:01,125 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:37:01,126 | INFO | sqlalchemy.engine.Engine | [cached since 996.2s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (28678 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 21, 37, 1, 123713, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:37:01,143 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:37:01,181 | INFO | app.controllers.audio | Intent detector frequency mismatch session=2ab6af95-094e-4a42-ae02-443cac08bfa7 detected=radar scenario=approach
2025-12-02 21:37:01,183 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=approach_readback intent=radar_altitude_report freq=approach
2025-12-02 21:37:01,187 | INFO | app.services.audio_pipeline | Prompts generados intent=radar_altitude_report freq_group=approach
SYSTEM> Validas la colación del alumno tras las instrucciones radar. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe ser un número de 0...
USER> Fase actual: Readback de COCO Aproximación
Intent esperado: radar_altitude_report
Transcripción textual del alumno:
30. continuamos ascenso a 7000 pies. reportaremos ingreso a zona Eco Alfa Noviembre India

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: approach
- Fase ID: approach_readback

Checklist alumno:
- Colacionar QNH.
- Colacionar nueva altitud asignada.
- Colacionar reportes solicitados.
- NO colacionar viento ni información general.

Checklist controlador:
- Decir 'c...
2025-12-02 21:37:15,137 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=radar_altitude_report intento=1: {
  "intent": "radar_altitude_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Proceda.",
  "feedback": "La colación incluye QNH, altitud asignada y reporte solicitado. Aunque el orden es ligeramente invertido (QNH primero), la información crítica está presente. Se mantiene la precisión requerida.",
  "confidence": 0.92,
  "score": 90,
  "metadata": {
    "missingItems": [],
    "nextPhase": "approach_zone_entry",
    "notes": "Orden de elementos...
2025-12-02 21:37:15,141 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=approach_readback a=approach_zone_entry
2025-12-02 21:37:15,403 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:37:15,404 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:37:15,406 | INFO | sqlalchemy.engine.Engine | [cached since 1012s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:37:15,435 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:37:15,436 | INFO | sqlalchemy.engine.Engine | [cached since 1011s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (30237 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 21, 37, 15, 433188, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:37:15,456 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:37:15,489 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:37:15,489 | INFO | sqlalchemy.engine.Engine | [cached since 989.2s ago] (UUID('de330554-8a2d-4c24-ac1a-b0fa24eb05f2'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'approach_zone_entry', 90.0, 'La colación incluye QNH, altitud asignada y reporte solicitado. Aunque el orden es ligeramente invertido (QNH primero), la información crítica está presente. Se mantiene la precisión requerida.')
2025-12-02 21:37:15,503 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:37:15,544 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=approach_zone_entry score=90.00
2025-12-02 21:37:15,546 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=120.500 | intent=radar_altitude_report | phase=approach_zone_entry | allow_response=True | text=Alfa Noviembre India, colación correcta. Proceda.
2025-12-02 21:37:50,734 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:37:50,735 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:37:50,736 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:37:50,737 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:37:50,738 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:37:50,739 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:37:50,739 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:37:50,740 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:37:50,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:37:50,743 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:37:50,744 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:37:50,746 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:37:50,746 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:37:50,749 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:37:50,751 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:37:50,753 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:37:50,755 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:37:50,756 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:37:50,757 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:37:50,757 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:37:50,758 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:37:50,759 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:37:50,761 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:37:50,762 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:37:50,764 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:37:50,764 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:37:50,765 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:37:50,768 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:37:50,769 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:37:50,771 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:37:50,771 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:37:50,773 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:1460]
2025-12-02 21:37:50,777 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-02 21:37:51,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:37:51,197 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,199 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:37:51,425 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,429 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,433 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,437 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:37:51,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:37:51,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,646 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,648 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:37:51,969 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,975 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:51,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:37:52,481 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:52,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:52,494 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:52,506 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:52,511 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:37:52,909 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:52,912 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:37:52,915 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:37:52,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:37:53,084 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:37:53,086 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:53,090 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:53,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:37:53,265 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:37:53,268 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:37:53,475 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:37:53,477 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:53,479 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:37:53,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:53,684 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:37:53,686 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:53,688 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:53,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:37:53,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:37:53,919 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:53,923 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:37:54,130 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:54,134 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:37:54,136 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:37:54,260 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:37:54,263 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:37:54,266 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:61]
2025-12-02 21:37:54,266 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:37:54,266 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:37:54,440 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:37:54,440 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:37:54,442 | INFO | sqlalchemy.engine.Engine | [cached since 1096s ago] ()
2025-12-02 21:37:54,458 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:37:54,461 | INFO | sqlalchemy.engine.Engine | [cached since 1058s ago] (6,)
2025-12-02 21:37:55,425 | INFO | app.services.transcribe | Starting stream. Total bytes: 798720. Chunk size: 8192. No throttling.
2025-12-02 21:37:55,429 | DEBUG | app.services.transcribe | Streamed 8192/798720 bytes
2025-12-02 21:37:55,463 | DEBUG | app.services.transcribe | Streamed 417792/798720 bytes
2025-12-02 21:37:55,492 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:37:59,209 | DEBUG | app.services.transcribe | Received transcript chunk: aproximación Alfa No...
2025-12-02 21:37:59,289 | INFO | app.services.transcribe | Transcription complete. Length: 73
2025-12-02 21:37:59,290 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: aproximación Alfa Noviembre India ingresando a zona Eco nivel 7000 pies.
2025-12-02 21:37:59,290 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=120.500 | text=aproximación Alfa Noviembre India ingresando a zona Eco nivel 7000 pies.
2025-12-02 21:37:59,453 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:37:59,454 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:37:59,456 | INFO | sqlalchemy.engine.Engine | [cached since 1056s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:37:59,483 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:38:00,346 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:38:00,348 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:38:00,348 | INFO | sqlalchemy.engine.Engine | [cached since 1057s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:38:00,382 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:38:00,383 | INFO | sqlalchemy.engine.Engine | [cached since 1055s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (30700 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 21, 38, 0, 381204, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:38:00,405 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:38:00,442 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=approach_zone_entry intent=approach_position_report freq=approach
2025-12-02 21:38:00,446 | INFO | app.services.audio_pipeline | Prompts generados intent=approach_position_report freq_group=approach
SYSTEM> El alumno reporta 7000 pies ingresando Zona ECO. Responde: '[Matrícula], recibido. Contacte Coco Radio uno dos seis punto ocho.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | nul...
USER> Fase actual: Reporte ingresando Zona ECO
Intent esperado: approach_position_report
Transcripción textual del alumno:
aproximación Alfa Noviembre India ingresando a zona Eco nivel 7000 pies.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: approach
- Fase ID: approach_zone_entry

Checklist alumno:
- Confirmar altitud y entrada a la zona.

Checklist controlador:
- Acusar recibo.
- Asignar contacto con COCO Radio 126.8.

Cuándo responder:
- Responde siempre con handoff claro.

Guía...
2025-12-02 21:38:11,876 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=approach_position_report intento=1: {
  "intent": "approach_position_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, recibido. Contacte Coco Radio uno dos seis punto ocho.",
  "feedback": "Reporte completo y correcto. Incluye matrícula, altitud y entrada a Zona ECO. La estructura cumple con los estándares ATC. Se procede con el handoff a COCO Radio.",
  "confidence": 0.98,
  "score": 95,
  "metadata": {
    "nextPhase": "radio_check_in",
    "missingElements": [],
    "additionalNotes": "El alumno m...
2025-12-02 21:38:11,880 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=approach_zone_entry a=radio_check_in
2025-12-02 21:38:12,097 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:38:12,099 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:38:12,101 | INFO | sqlalchemy.engine.Engine | [cached since 1069s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:38:12,148 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:38:12,149 | INFO | sqlalchemy.engine.Engine | [cached since 1067s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (32486 characters truncated) ... "122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": true, "default_frequency_group": "radio"}', datetime.datetime(2025, 12, 2, 21, 38, 12, 147461, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:38:12,234 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:38:12,322 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:38:12,325 | INFO | sqlalchemy.engine.Engine | [cached since 1046s ago] (UUID('dbca6f1d-a43e-4b5a-8c1e-bc716f937833'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'radio_check_in', 95.0, 'Reporte completo y correcto. Incluye matrícula, altitud y entrada a Zona ECO. La estructura cumple con los estándares ATC. Se procede con el handoff a COCO Radio.')
2025-12-02 21:38:12,352 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:38:12,408 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=radio_check_in score=95.00
2025-12-02 21:38:12,411 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=120.500 | intent=approach_position_report | phase=radio_check_in | allow_response=True | text=Alfa Noviembre India, recibido. Contacte Coco Radio uno dos seis punto ocho.
2025-12-02 21:38:46,148 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:38:46,150 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:38:46,150 | INFO | sqlalchemy.engine.Engine | [cached since 1148s ago] ()
2025-12-02 21:38:46,160 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:38:46,164 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:38:46,166 | INFO | sqlalchemy.engine.Engine | [cached since 1148s ago] ()
2025-12-02 21:38:46,172 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:46,175 | INFO | sqlalchemy.engine.Engine | [cached since 1110s ago] (6,)
2025-12-02 21:38:46,187 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:46,188 | INFO | sqlalchemy.engine.Engine | [cached since 1110s ago] (6,)
2025-12-02 21:38:46,246 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:38:46,247 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:38:46,248 | INFO | sqlalchemy.engine.Engine | [cached since 1148s ago] ()
2025-12-02 21:38:46,260 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:46,264 | INFO | sqlalchemy.engine.Engine | [cached since 1110s ago] (6,)
2025-12-02 21:38:46,329 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:46,330 | INFO | sqlalchemy.engine.Engine | [cached since 1110s ago] (6,)
2025-12-02 21:38:46,334 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:46,336 | INFO | sqlalchemy.engine.Engine | [cached since 1110s ago] (6,)
2025-12-02 21:38:46,342 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:38:46,344 | INFO | sqlalchemy.engine.Engine | [cached since 858s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:38:46,351 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:38:46,356 | INFO | sqlalchemy.engine.Engine | [cached since 858s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:38:46,380 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:38:46,389 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:38:46,394 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:46,398 | INFO | sqlalchemy.engine.Engine | [cached since 1110s ago] (6,)
2025-12-02 21:38:46,404 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:38:46,407 | INFO | sqlalchemy.engine.Engine | [cached since 858s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:38:46,439 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:38:53,505 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:38:53,508 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:38:53,512 | INFO | sqlalchemy.engine.Engine | [cached since 1155s ago] ()
2025-12-02 21:38:53,526 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:53,529 | INFO | sqlalchemy.engine.Engine | [cached since 1117s ago] (6,)
2025-12-02 21:38:53,681 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.user_id 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID 
 LIMIT $2::INTEGER
2025-12-02 21:38:53,683 | INFO | sqlalchemy.engine.Engine | [generated in 0.00155s] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 1)
2025-12-02 21:38:53,709 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:38:53,711 | INFO | sqlalchemy.engine.Engine | [cached since 1118s ago] (6,)
2025-12-02 21:38:53,722 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID AND ecowhiskey.phase_scores.user_id = $2::INTEGER ORDER BY ecowhiskey.phase_scores.created_at
2025-12-02 21:38:53,725 | INFO | sqlalchemy.engine.Engine | [generated in 0.00307s] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6)
2025-12-02 21:38:59,869 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:39:40,367 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:39:40,369 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:39:40,370 | INFO | sqlalchemy.engine.Engine | [cached since 1202s ago] ()
2025-12-02 21:39:40,380 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:39:40,381 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:39:40,383 | INFO | sqlalchemy.engine.Engine | [cached since 1202s ago] ()
2025-12-02 21:39:40,387 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:39:40,391 | INFO | sqlalchemy.engine.Engine | [cached since 1164s ago] (6,)
2025-12-02 21:39:40,400 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:39:40,401 | INFO | sqlalchemy.engine.Engine | [cached since 1164s ago] (6,)
2025-12-02 21:39:40,551 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:39:40,551 | INFO | sqlalchemy.engine.Engine | [cached since 1164s ago] (6,)
2025-12-02 21:39:40,556 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:39:40,557 | INFO | sqlalchemy.engine.Engine | [cached since 1164s ago] (6,)
2025-12-02 21:39:40,562 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:39:40,565 | INFO | sqlalchemy.engine.Engine | [cached since 912.2s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:39:40,569 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:39:40,573 | INFO | sqlalchemy.engine.Engine | [cached since 912.2s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:39:40,597 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:39:40,603 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:01:01,529 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 22:01:01,530 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 22:01:01,538 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 22:01:01,540 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 22:01:01,548 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 22:01:01,550 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 22:01:01,558 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:01:01,560 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 22:01:01,561 | INFO | sqlalchemy.engine.Engine | [generated in 0.00113s] ()
2025-12-02 22:01:01,568 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:01:01,570 | INFO | sqlalchemy.engine.Engine | [generated in 0.00088s] ()
2025-12-02 22:01:01,578 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,578 | INFO | sqlalchemy.engine.Engine | [generated in 0.00098s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,677 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,678 | INFO | sqlalchemy.engine.Engine | [cached since 0.1006s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,682 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,683 | INFO | sqlalchemy.engine.Engine | [cached since 0.1055s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,687 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,688 | INFO | sqlalchemy.engine.Engine | [cached since 0.111s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,692 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,694 | INFO | sqlalchemy.engine.Engine | [cached since 0.1162s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,697 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,698 | INFO | sqlalchemy.engine.Engine | [cached since 0.1209s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,702 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,703 | INFO | sqlalchemy.engine.Engine | [cached since 0.1261s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,707 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 22:01:01,708 | INFO | sqlalchemy.engine.Engine | [cached since 0.1309s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 22:01:01,714 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 22:01:01,716 | INFO | sqlalchemy.engine.Engine | [generated in 0.00098s] ('group_role', 'pg_catalog')
2025-12-02 22:01:01,723 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 22:01:01,723 | INFO | sqlalchemy.engine.Engine | [cached since 0.009298s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 22:01:01,728 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 22:01:01,729 | INFO | sqlalchemy.engine.Engine | [cached since 0.01479s ago] ('user_status', 'pg_catalog')
2025-12-02 22:01:01,734 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 22:01:01,735 | INFO | sqlalchemy.engine.Engine | [cached since 0.02095s ago] ('account_type', 'pg_catalog')
2025-12-02 22:01:01,740 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 22:01:01,741 | INFO | sqlalchemy.engine.Engine | [generated in 0.00149s] ()
2025-12-02 22:01:01,748 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 22:01:01,750 | INFO | sqlalchemy.engine.Engine | [generated in 0.00091s] ()
2025-12-02 22:01:01,830 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 22:01:01,831 | INFO | sqlalchemy.engine.Engine | [generated in 0.00129s] ()
2025-12-02 22:01:02,200 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 22:01:02,244 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 22:01:42,023 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:01:42,024 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:01:42,025 | INFO | sqlalchemy.engine.Engine | [cached since 40.46s ago] ()
2025-12-02 22:01:42,073 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 22:01:42,075 | INFO | sqlalchemy.engine.Engine | [generated in 0.00100s] ('josuelu2@gmail.com',)
2025-12-02 22:01:42,305 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:01:42,648 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:01:42,648 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:01:42,649 | INFO | sqlalchemy.engine.Engine | [cached since 41.08s ago] ()
2025-12-02 22:01:42,660 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:01:42,661 | INFO | sqlalchemy.engine.Engine | [generated in 0.00112s] (1,)
2025-12-02 22:01:42,777 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:00,625 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:00,627 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:00,627 | INFO | sqlalchemy.engine.Engine | [cached since 59.06s ago] ()
2025-12-02 22:02:00,637 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 22:02:00,638 | INFO | sqlalchemy.engine.Engine | [cached since 18.56s ago] ('josuelu3@gmail.com',)
2025-12-02 22:02:00,828 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:01,078 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:01,078 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:01,079 | INFO | sqlalchemy.engine.Engine | [cached since 59.51s ago] ()
2025-12-02 22:02:01,088 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:01,088 | INFO | sqlalchemy.engine.Engine | [cached since 18.43s ago] (2,)
2025-12-02 22:02:01,180 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:01,398 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:01,401 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:01,402 | INFO | sqlalchemy.engine.Engine | [cached since 59.83s ago] ()
2025-12-02 22:02:01,411 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:01,414 | INFO | sqlalchemy.engine.Engine | [cached since 18.75s ago] (2,)
2025-12-02 22:02:01,426 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:01,428 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:01,429 | INFO | sqlalchemy.engine.Engine | [cached since 59.86s ago] ()
2025-12-02 22:02:01,441 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:01,442 | INFO | sqlalchemy.engine.Engine | [cached since 18.78s ago] (2,)
2025-12-02 22:02:01,526 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.schools.id, ecowhiskey.schools.name, ecowhiskey.schools.value, ecowhiskey.schools.location, ecowhiskey.schools.created_at 
FROM ecowhiskey.schools 
WHERE ecowhiskey.schools.id = $1::INTEGER
2025-12-02 22:02:01,526 | INFO | sqlalchemy.engine.Engine | [generated in 0.00109s] (1,)
2025-12-02 22:02:01,531 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.owner_id = $1::INTEGER ORDER BY ecowhiskey.groups.name
2025-12-02 22:02:01,531 | INFO | sqlalchemy.engine.Engine | [generated in 0.00128s] (2,)
2025-12-02 22:02:01,540 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.school_id = $1::INTEGER AND ecowhiskey.users.account_type = $2::account_type ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:01,541 | INFO | sqlalchemy.engine.Engine | [generated in 0.00100s] (1, 'STUDENT')
2025-12-02 22:02:01,584 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:01,634 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id IN ($2::INTEGER, $3::INTEGER) AND ecowhiskey.group_memberships.user_id = $1::INTEGER
2025-12-02 22:02:01,635 | INFO | sqlalchemy.engine.Engine | [generated in 0.00121s] (2, 1, 3)
2025-12-02 22:02:01,736 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:01,947 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:01,949 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:01,950 | INFO | sqlalchemy.engine.Engine | [cached since 60.38s ago] ()
2025-12-02 22:02:01,960 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:01,961 | INFO | sqlalchemy.engine.Engine | [cached since 19.3s ago] (2,)
2025-12-02 22:02:01,970 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:01,971 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:01,972 | INFO | sqlalchemy.engine.Engine | [cached since 60.4s ago] ()
2025-12-02 22:02:01,981 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:01,982 | INFO | sqlalchemy.engine.Engine | [cached since 19.32s ago] (2,)
2025-12-02 22:02:02,069 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:02,069 | INFO | sqlalchemy.engine.Engine | [generated in 0.00097s] (1,)
2025-12-02 22:02:02,072 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:02,072 | INFO | sqlalchemy.engine.Engine | [cached since 0.00445s ago] (3,)
2025-12-02 22:02:02,093 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:02,094 | INFO | sqlalchemy.engine.Engine | [generated in 0.00117s] (3, 2)
2025-12-02 22:02:02,096 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:02,098 | INFO | sqlalchemy.engine.Engine | [cached since 0.005486s ago] (1, 2)
2025-12-02 22:02:02,271 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at, ecowhiskey.users.id AS id_1, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status AS status_1, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at AS created_at_1, ecowhiskey.users.updated_at AS updated_at_1, schools_1.id AS id_2, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_2 
FROM ecowhiskey.group_memberships JOIN ecowhiskey.users ON ecowhiskey.users.id = ecowhiskey.group_memberships.user_id LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:02,273 | INFO | sqlalchemy.engine.Engine | [generated in 0.00114s] (3,)
2025-12-02 22:02:02,276 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at, ecowhiskey.users.id AS id_1, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status AS status_1, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at AS created_at_1, ecowhiskey.users.updated_at AS updated_at_1, schools_1.id AS id_2, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_2 
FROM ecowhiskey.group_memberships JOIN ecowhiskey.users ON ecowhiskey.users.id = ecowhiskey.group_memberships.user_id LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:02,276 | INFO | sqlalchemy.engine.Engine | [cached since 0.004955s ago] (1,)
2025-12-02 22:02:02,286 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:02,288 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:04,837 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:04,838 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:04,839 | INFO | sqlalchemy.engine.Engine | [cached since 63.27s ago] ()
2025-12-02 22:02:04,849 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:04,850 | INFO | sqlalchemy.engine.Engine | [cached since 22.19s ago] (2,)
2025-12-02 22:02:04,865 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:04,866 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:04,867 | INFO | sqlalchemy.engine.Engine | [cached since 63.3s ago] ()
2025-12-02 22:02:04,878 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:04,881 | INFO | sqlalchemy.engine.Engine | [cached since 22.22s ago] (2,)
2025-12-02 22:02:05,005 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:05,007 | INFO | sqlalchemy.engine.Engine | [cached since 2.938s ago] (1,)
2025-12-02 22:02:05,013 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:05,016 | INFO | sqlalchemy.engine.Engine | [cached since 2.948s ago] (1,)
2025-12-02 22:02:05,048 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:05,051 | INFO | sqlalchemy.engine.Engine | [cached since 2.958s ago] (1, 2)
2025-12-02 22:02:05,057 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:05,059 | INFO | sqlalchemy.engine.Engine | [cached since 2.966s ago] (1, 2)
2025-12-02 22:02:05,118 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:05,122 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at, ecowhiskey.users.id AS id_1, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status AS status_1, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at AS created_at_1, ecowhiskey.users.updated_at AS updated_at_1, schools_1.id AS id_2, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_2 
FROM ecowhiskey.group_memberships JOIN ecowhiskey.users ON ecowhiskey.users.id = ecowhiskey.group_memberships.user_id LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:05,124 | INFO | sqlalchemy.engine.Engine | [cached since 2.853s ago] (1,)
2025-12-02 22:02:05,139 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:08,130 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:08,132 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:08,133 | INFO | sqlalchemy.engine.Engine | [cached since 66.56s ago] ()
2025-12-02 22:02:08,141 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:08,142 | INFO | sqlalchemy.engine.Engine | [cached since 25.48s ago] (2,)
2025-12-02 22:02:08,151 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:08,151 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:08,153 | INFO | sqlalchemy.engine.Engine | [cached since 66.58s ago] ()
2025-12-02 22:02:08,160 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:08,161 | INFO | sqlalchemy.engine.Engine | [cached since 25.5s ago] (2,)
2025-12-02 22:02:08,246 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:08,247 | INFO | sqlalchemy.engine.Engine | [cached since 25.59s ago] (1,)
2025-12-02 22:02:08,249 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:08,250 | INFO | sqlalchemy.engine.Engine | [cached since 25.59s ago] (1,)
2025-12-02 22:02:08,256 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 22:02:08,257 | INFO | sqlalchemy.engine.Engine | [generated in 0.00136s] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 22:02:08,264 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 22:02:08,265 | INFO | sqlalchemy.engine.Engine | [generated in 0.00178s] ('scenario_id', 'session_completed', 1)
2025-12-02 22:02:08,283 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:08,323 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:15,143 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:15,145 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:15,146 | INFO | sqlalchemy.engine.Engine | [cached since 73.58s ago] ()
2025-12-02 22:02:15,158 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:15,160 | INFO | sqlalchemy.engine.Engine | [cached since 32.5s ago] (2,)
2025-12-02 22:02:15,162 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:15,164 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:15,167 | INFO | sqlalchemy.engine.Engine | [cached since 73.6s ago] ()
2025-12-02 22:02:15,178 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:15,180 | INFO | sqlalchemy.engine.Engine | [cached since 32.52s ago] (2,)
2025-12-02 22:02:15,291 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:15,293 | INFO | sqlalchemy.engine.Engine | [cached since 13.23s ago] (3,)
2025-12-02 22:02:15,298 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:15,300 | INFO | sqlalchemy.engine.Engine | [cached since 13.23s ago] (1,)
2025-12-02 22:02:15,323 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:15,324 | INFO | sqlalchemy.engine.Engine | [cached since 13.23s ago] (3, 2)
2025-12-02 22:02:15,328 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:15,329 | INFO | sqlalchemy.engine.Engine | [cached since 13.24s ago] (1, 2)
2025-12-02 22:02:15,368 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at, ecowhiskey.users.id AS id_1, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status AS status_1, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at AS created_at_1, ecowhiskey.users.updated_at AS updated_at_1, schools_1.id AS id_2, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_2 
FROM ecowhiskey.group_memberships JOIN ecowhiskey.users ON ecowhiskey.users.id = ecowhiskey.group_memberships.user_id LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:15,371 | INFO | sqlalchemy.engine.Engine | [cached since 13.1s ago] (1,)
2025-12-02 22:02:15,376 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at, ecowhiskey.users.id AS id_1, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status AS status_1, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at AS created_at_1, ecowhiskey.users.updated_at AS updated_at_1, schools_1.id AS id_2, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_2 
FROM ecowhiskey.group_memberships JOIN ecowhiskey.users ON ecowhiskey.users.id = ecowhiskey.group_memberships.user_id LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:15,378 | INFO | sqlalchemy.engine.Engine | [cached since 13.11s ago] (3,)
2025-12-02 22:02:15,387 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:15,391 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:16,614 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:16,614 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:16,616 | INFO | sqlalchemy.engine.Engine | [cached since 75.05s ago] ()
2025-12-02 22:02:16,625 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:16,625 | INFO | sqlalchemy.engine.Engine | [cached since 33.96s ago] (2,)
2025-12-02 22:02:16,731 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:16,732 | INFO | sqlalchemy.engine.Engine | [cached since 14.66s ago] (1,)
2025-12-02 22:02:16,749 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:16,750 | INFO | sqlalchemy.engine.Engine | [cached since 14.66s ago] (1, 2)
2025-12-02 22:02:16,781 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at, ecowhiskey.users.id AS id_1, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status AS status_1, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at AS created_at_1, ecowhiskey.users.updated_at AS updated_at_1, schools_1.id AS id_2, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_2 
FROM ecowhiskey.group_memberships JOIN ecowhiskey.users ON ecowhiskey.users.id = ecowhiskey.group_memberships.user_id LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:16,782 | INFO | sqlalchemy.engine.Engine | [cached since 14.51s ago] (1,)
2025-12-02 22:02:16,790 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:26,013 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:26,014 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:26,014 | INFO | sqlalchemy.engine.Engine | [cached since 84.45s ago] ()
2025-12-02 22:02:26,022 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:26,023 | INFO | sqlalchemy.engine.Engine | [cached since 43.36s ago] (2,)
2025-12-02 22:02:26,119 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:26,120 | INFO | sqlalchemy.engine.Engine | [cached since 24.05s ago] (3,)
2025-12-02 22:02:26,139 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:26,140 | INFO | sqlalchemy.engine.Engine | [cached since 24.05s ago] (3, 2)
2025-12-02 22:02:26,170 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 22:02:26,342 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 22:02:26,343 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 22:02:26,344 | INFO | sqlalchemy.engine.Engine | [cached since 84.78s ago] ()
2025-12-02 22:02:26,354 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 22:02:26,355 | INFO | sqlalchemy.engine.Engine | [cached since 43.69s ago] (2,)
2025-12-02 22:02:26,451 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.groups.id, ecowhiskey.groups.name, ecowhiskey.groups.description, ecowhiskey.groups.school_id, ecowhiskey.groups.owner_id, ecowhiskey.groups.created_at, ecowhiskey.groups.updated_at 
FROM ecowhiskey.groups 
WHERE ecowhiskey.groups.id = $1::INTEGER
2025-12-02 22:02:26,453 | INFO | sqlalchemy.engine.Engine | [cached since 24.38s ago] (3,)
2025-12-02 22:02:26,477 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at 
FROM ecowhiskey.group_memberships 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER AND ecowhiskey.group_memberships.user_id = $2::INTEGER
2025-12-02 22:02:26,478 | INFO | sqlalchemy.engine.Engine | [cached since 24.39s ago] (3, 2)
2025-12-02 22:02:26,515 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.group_memberships.id, ecowhiskey.group_memberships.group_id, ecowhiskey.group_memberships.user_id, ecowhiskey.group_memberships.role, ecowhiskey.group_memberships.status, ecowhiskey.group_memberships.invited_by_id, ecowhiskey.group_memberships.created_at, ecowhiskey.group_memberships.updated_at, ecowhiskey.users.id AS id_1, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status AS status_1, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at AS created_at_1, ecowhiskey.users.updated_at AS updated_at_1, schools_1.id AS id_2, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_2 
FROM ecowhiskey.group_memberships JOIN ecowhiskey.users ON ecowhiskey.users.id = ecowhiskey.group_memberships.user_id LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.group_memberships.group_id = $1::INTEGER ORDER BY ecowhiskey.users.first_name, ecowhiskey.users.last_name
2025-12-02 22:02:26,516 | INFO | sqlalchemy.engine.Engine | [cached since 24.24s ago] (3,)
2025-12-02 22:02:26,527 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 17:53:54,342 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-03 17:53:54,344 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-03 17:53:54,372 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-03 17:53:54,373 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-03 17:53:54,397 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-03 17:53:54,398 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-03 17:53:54,404 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 17:53:54,405 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-03 17:53:54,407 | INFO | sqlalchemy.engine.Engine | [generated in 0.00154s] ()
2025-12-03 17:53:54,428 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 17:53:54,429 | INFO | sqlalchemy.engine.Engine | [generated in 0.00082s] ()
2025-12-03 17:53:54,438 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,438 | INFO | sqlalchemy.engine.Engine | [generated in 0.00122s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,513 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,513 | INFO | sqlalchemy.engine.Engine | [cached since 0.07602s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,517 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,518 | INFO | sqlalchemy.engine.Engine | [cached since 0.08068s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,523 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,524 | INFO | sqlalchemy.engine.Engine | [cached since 0.08685s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,529 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,529 | INFO | sqlalchemy.engine.Engine | [cached since 0.09228s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,533 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,534 | INFO | sqlalchemy.engine.Engine | [cached since 0.09683s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,538 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,540 | INFO | sqlalchemy.engine.Engine | [cached since 0.1026s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,542 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 17:53:54,543 | INFO | sqlalchemy.engine.Engine | [cached since 0.1065s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 17:53:54,549 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 17:53:54,550 | INFO | sqlalchemy.engine.Engine | [generated in 0.00076s] ('group_role', 'pg_catalog')
2025-12-03 17:53:54,559 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 17:53:54,559 | INFO | sqlalchemy.engine.Engine | [cached since 0.01061s ago] ('group_membership_status', 'pg_catalog')
2025-12-03 17:53:54,563 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 17:53:54,564 | INFO | sqlalchemy.engine.Engine | [cached since 0.01559s ago] ('user_status', 'pg_catalog')
2025-12-03 17:53:54,568 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 17:53:54,569 | INFO | sqlalchemy.engine.Engine | [cached since 0.02045s ago] ('account_type', 'pg_catalog')
2025-12-03 17:53:54,574 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-03 17:53:54,575 | INFO | sqlalchemy.engine.Engine | [generated in 0.00108s] ()
2025-12-03 17:53:54,635 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-03 17:53:54,635 | INFO | sqlalchemy.engine.Engine | [generated in 0.00075s] ()
2025-12-03 17:53:54,732 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-03 17:53:54,733 | INFO | sqlalchemy.engine.Engine | [generated in 0.00119s] ()
2025-12-03 17:53:55,150 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 17:53:55,202 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-03 18:58:42,116 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:42,118 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:42,119 | INFO | sqlalchemy.engine.Engine | [cached since 3888s ago] ()
2025-12-03 18:58:42,173 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-03 18:58:42,174 | INFO | sqlalchemy.engine.Engine | [generated in 0.00096s] ('josuelu2@gmail.com',)
2025-12-03 18:58:42,796 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 18:58:44,846 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:44,847 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:44,848 | INFO | sqlalchemy.engine.Engine | [cached since 3890s ago] ()
2025-12-03 18:58:44,857 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:44,857 | INFO | sqlalchemy.engine.Engine | [generated in 0.00073s] (1,)
2025-12-03 18:58:44,939 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 18:58:47,054 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:47,056 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:47,058 | INFO | sqlalchemy.engine.Engine | [cached since 3893s ago] ()
2025-12-03 18:58:47,061 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:47,062 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:47,064 | INFO | sqlalchemy.engine.Engine | [cached since 3893s ago] ()
2025-12-03 18:58:47,075 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:47,077 | INFO | sqlalchemy.engine.Engine | [cached since 2.219s ago] (1,)
2025-12-03 18:58:47,081 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:47,082 | INFO | sqlalchemy.engine.Engine | [cached since 2.226s ago] (1,)
2025-12-03 18:58:47,234 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:47,236 | INFO | sqlalchemy.engine.Engine | [cached since 2.38s ago] (1,)
2025-12-03 18:58:47,241 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:47,244 | INFO | sqlalchemy.engine.Engine | [cached since 2.387s ago] (1,)
2025-12-03 18:58:47,253 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 18:58:47,257 | INFO | sqlalchemy.engine.Engine | [generated in 0.00464s] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 18:58:47,268 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 18:58:47,272 | INFO | sqlalchemy.engine.Engine | [generated in 0.00397s] ('scenario_id', 'session_completed', 1)
2025-12-03 18:58:47,427 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 18:58:47,465 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 18:58:54,128 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:54,128 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:54,130 | INFO | sqlalchemy.engine.Engine | [cached since 3900s ago] ()
2025-12-03 18:58:54,136 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:54,137 | INFO | sqlalchemy.engine.Engine | [cached since 9.281s ago] (1,)
2025-12-03 18:58:54,214 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 18:58:54,215 | INFO | sqlalchemy.engine.Engine | [generated in 0.00077s] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-03 18:58:54,248 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-03 18:58:54,248 | INFO | sqlalchemy.engine.Engine | [generated in 0.00072s] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-03 18:58:54,266 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 18:58:54,267 | INFO | sqlalchemy.engine.Engine | [generated in 0.00074s] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-03 18:58:54,285 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 18:58:54,592 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:54,593 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:54,594 | INFO | sqlalchemy.engine.Engine | [cached since 3900s ago] ()
2025-12-03 18:58:54,603 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:54,604 | INFO | sqlalchemy.engine.Engine | [cached since 9.748s ago] (1,)
2025-12-03 18:58:54,634 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:54,635 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:54,636 | INFO | sqlalchemy.engine.Engine | [cached since 3900s ago] ()
2025-12-03 18:58:54,645 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:54,646 | INFO | sqlalchemy.engine.Engine | [cached since 9.789s ago] (1,)
2025-12-03 18:58:54,705 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:54,706 | INFO | sqlalchemy.engine.Engine | [cached since 9.849s ago] (1,)
2025-12-03 18:58:54,710 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 18:58:54,711 | INFO | sqlalchemy.engine.Engine | [cached since 7.444s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 18:58:54,714 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:54,714 | INFO | sqlalchemy.engine.Engine | [cached since 9.857s ago] (1,)
2025-12-03 18:58:54,719 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 18:58:54,720 | INFO | sqlalchemy.engine.Engine | [cached since 7.467s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 18:58:54,728 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 18:58:54,737 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 18:58:57,550 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:57,550 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:57,552 | INFO | sqlalchemy.engine.Engine | [cached since 3903s ago] ()
2025-12-03 18:58:57,561 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:57,562 | INFO | sqlalchemy.engine.Engine | [cached since 12.71s ago] (1,)
2025-12-03 18:58:57,657 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 18:58:57,658 | INFO | sqlalchemy.engine.Engine | [cached since 3.443s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-03 18:58:57,671 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-03 18:58:57,672 | INFO | sqlalchemy.engine.Engine | [cached since 3.424s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-03 18:58:57,692 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 18:58:57,693 | INFO | sqlalchemy.engine.Engine | [cached since 3.427s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-03 18:58:57,700 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 18:58:58,150 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:58,151 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:58,152 | INFO | sqlalchemy.engine.Engine | [cached since 3904s ago] ()
2025-12-03 18:58:58,161 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:58,161 | INFO | sqlalchemy.engine.Engine | [cached since 13.31s ago] (1,)
2025-12-03 18:58:58,180 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 18:58:58,180 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 18:58:58,181 | INFO | sqlalchemy.engine.Engine | [cached since 3904s ago] ()
2025-12-03 18:58:58,190 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:58,192 | INFO | sqlalchemy.engine.Engine | [cached since 13.33s ago] (1,)
2025-12-03 18:58:58,268 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:58,268 | INFO | sqlalchemy.engine.Engine | [cached since 13.41s ago] (1,)
2025-12-03 18:58:58,271 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 18:58:58,272 | INFO | sqlalchemy.engine.Engine | [cached since 13.41s ago] (1,)
2025-12-03 18:58:58,275 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 18:58:58,276 | INFO | sqlalchemy.engine.Engine | [cached since 11.02s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 18:58:58,278 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 18:58:58,280 | INFO | sqlalchemy.engine.Engine | [cached since 11.01s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 18:58:58,296 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 18:58:58,297 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:00:24,892 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-03 19:00:25,130 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D488F990>
2025-12-03 19:00:25,130 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x00000254D48DAA80> server_hostname='aviationweather.gov' timeout=10.0
2025-12-03 19:00:25,244 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D4402E90>
2025-12-03 19:00:25,245 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-03 19:00:25,246 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-03 19:00:25,247 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-03 19:00:25,247 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-03 19:00:25,248 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-03 19:00:25,405 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 04 Dec 2025 01:00:25 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'471'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1d7-bqgyMnm85OuYCOIZOquANnMmyP4"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251204T010025Z-1654ff75797x4s2vhC1MIA6ytw0000000wz000000000664a'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-03 19:00:25,406 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-03 19:00:25,407 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-03 19:00:25,407 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-03 19:00:25,409 | DEBUG | httpcore.http11 | response_closed.started
2025-12-03 19:00:25,410 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-03 19:00:25,410 | DEBUG | httpcore.connection | close.started
2025-12-03 19:00:25,412 | DEBUG | httpcore.connection | close.complete
2025-12-03 19:00:33,281 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:00:33,282 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:00:33,283 | INFO | sqlalchemy.engine.Engine | [cached since 3999s ago] ()
2025-12-03 19:00:33,291 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:00:33,292 | INFO | sqlalchemy.engine.Engine | [cached since 108.4s ago] (1,)
2025-12-03 19:00:33,410 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-03 19:00:33,410 | INFO | sqlalchemy.engine.Engine | [generated in 0.01552s] (UUID('10e7320b-4cb1-423d-a754-1520d58fa503'), UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "080", "windSpeed": "9", "temp": "22", "dewp": "16", "cloudCover": "FEW", "cloudBase": "4000", "wind": "080/9"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 3, 19, 0, 33, 409254, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 3, 19, 0, 33, 409254, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-03 19:00:33,440 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:00:33,653 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:00:33,656 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-03 19:00:33,657 | INFO | sqlalchemy.engine.Engine | [generated in 0.00113s] (UUID('10e7320b-4cb1-423d-a754-1520d58fa503'),)
2025-12-03 19:00:33,680 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:01:18,582 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:01:18,583 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:01:18,584 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:01:18,584 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:01:18,586 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:01:18,586 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:01:18,587 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:01:18,588 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:01:18,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:01:18,590 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:01:18,591 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:01:18,592 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:01:18,592 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:01:18,595 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:01:18,596 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:01:18,597 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:01:18,598 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:01:18,600 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:01:18,601 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:01:18,601 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:01:18,602 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:01:18,602 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:01:18,603 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:01:18,604 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:01:18,606 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:01:18,607 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:01:18,608 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:01:18,608 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:01:18,610 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:01:18,612 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:01:18,613 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:01:18,614 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:01:18,615 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:18,617 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:01:18,744 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:18,746 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:18,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:18,868 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:18,871 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:18,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:18,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:19,106 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:19,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:19,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:01:19,227 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:19,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:19,347 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:19,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:19,351 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:19,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:19,465 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:19,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:19,574 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:19,575 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:19,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:19,691 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:19,819 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:19,820 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:19,824 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:19,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:19,967 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:19,970 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:20,081 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:20,083 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:20,084 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:891]
2025-12-03 19:01:20,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 19:01:20,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:20,197 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:20,312 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:20,314 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:20,422 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:20,424 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:20,425 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:20,536 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:20,537 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:20,540 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:20,652 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:20,653 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:20,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:20,779 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:20,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:20,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:20,894 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:20,895 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:21,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:21,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:21,015 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:21,139 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:21,143 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:21,145 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:21,257 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:21,258 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:21,261 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:21,375 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:21,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:21,378 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:01:21,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:21,491 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:01:21,492 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:21,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:01:21,602 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:01:21,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:21,714 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:01:21,794 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:01:21,795 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1572]
2025-12-03 19:01:21,795 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:01:21,796 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:01:21,925 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:01:21,926 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:01:21,927 | INFO | sqlalchemy.engine.Engine | [cached since 4047s ago] ()
2025-12-03 19:01:21,934 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:01:21,935 | INFO | sqlalchemy.engine.Engine | [cached since 157.1s ago] (1,)
2025-12-03 19:01:24,026 | INFO | app.services.transcribe | Starting stream. Total bytes: 1613824. Chunk size: 8192. No throttling.
2025-12-03 19:01:24,028 | DEBUG | app.services.transcribe | Streamed 8192/1613824 bytes
2025-12-03 19:01:24,055 | DEBUG | app.services.transcribe | Streamed 417792/1613824 bytes
2025-12-03 19:01:24,065 | DEBUG | app.services.transcribe | Streamed 827392/1613824 bytes
2025-12-03 19:01:24,076 | DEBUG | app.services.transcribe | Streamed 1236992/1613824 bytes
2025-12-03 19:01:24,090 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:01:32,924 | DEBUG | app.services.transcribe | Received transcript chunk: superficie alfa novi...
2025-12-03 19:01:33,106 | INFO | app.services.transcribe | Transcription complete. Length: 182
2025-12-03 19:01:33,107 | INFO | app.controllers.audio | Transcripción recibida session=0c48dfb9-799f-4fff-9dab-ef0081979493: superficie alfa noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Paso Ochgo 9000 pies, dos almas a bordo, autonomía, cinco horas.
2025-12-03 19:01:33,108 | INFO | app.logs.transcript | student | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | text=superficie alfa noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Paso Ochgo 9000 pies, dos almas a bordo, autonomía, cinco horas.
2025-12-03 19:01:33,211 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:01:33,211 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:01:33,212 | INFO | sqlalchemy.engine.Engine | [cached since 159s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:01:33,228 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:01:34,268 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:01:34,268 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:01:34,270 | INFO | sqlalchemy.engine.Engine | [cached since 160.1s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:01:34,285 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:01:34,286 | INFO | sqlalchemy.engine.Engine | [generated in 0.00092s] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (14591 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-04T01:01:34Z"}]}', datetime.datetime(2025, 12, 3, 19, 1, 34, 285197, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:01:34,316 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:01:34,341 | INFO | app.controllers.audio | Fase activa session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-03 19:01:34,344 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0557. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": stri...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie alfa noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Paso Ochgo 9000 pies, dos almas a bordo, autonomía, cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubic...
2025-12-03 19:01:47,341 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0557. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, altitud, almas y autonomía. Proceda con autorización de rodaje.",
  "confidence": 0.95,
...
2025-12-03 19:01:47,343 | INFO | app.controllers.audio | Transición automática de fase session=0c48dfb9-799f-4fff-9dab-ef0081979493 de=ground_departure_request a=ground_readback
2025-12-03 19:01:47,466 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:01:47,467 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:01:47,467 | INFO | sqlalchemy.engine.Engine | [cached since 173.3s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:01:47,484 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:01:47,484 | INFO | sqlalchemy.engine.Engine | [cached since 13.2s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (16087 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0557", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 1, 47, 483370, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:01:47,502 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:01:47,518 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:01:47,518 | INFO | sqlalchemy.engine.Engine | [generated in 0.00133s] (UUID('a0b8230e-7aeb-4eca-8f22-887ed87b066b'), UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'), 1, 'ground_readback', 95.0, 'Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, altitud, almas y autonomía. Proceda con autorización de rodaje.')
2025-12-03 19:01:47,530 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:01:47,555 | INFO | app.controllers.audio | Puntuación guardada session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=ground_readback score=95.00
2025-12-03 19:01:47,556 | INFO | app.logs.transcript | controller | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0557. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.
2025-12-03 19:02:56,735 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:02:56,736 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:02:56,737 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:02:56,739 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:02:56,741 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:02:56,742 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:02:56,744 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:02:56,746 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:02:56,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:02:56,749 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:02:56,751 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:02:56,753 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:02:56,754 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:02:56,756 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:02:56,759 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:02:56,760 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:02:56,764 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:02:56,766 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:02:56,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:02:56,769 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:02:56,770 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:02:56,772 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:02:56,773 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:02:56,775 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:02:56,777 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:02:56,777 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:02:56,780 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:02:56,781 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:02:56,785 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:02:56,786 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:02:56,788 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:02:56,790 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:02:56,796 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:56,800 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:02:56,948 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:56,951 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:56,957 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:57,141 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:57,147 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:57,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:57,344 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:57,347 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:57,352 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:57,357 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:02:57,551 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:57,553 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:57,662 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:57,663 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:57,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:57,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:57,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:57,886 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:57,887 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:57,890 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:57,997 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:58,000 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:58,001 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:02:58,114 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:58,115 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:58,116 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:58,227 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:58,229 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:58,232 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:58,367 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:58,369 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:58,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:58,491 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:58,493 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:02:58,602 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:58,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:58,606 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:58,710 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:58,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:58,819 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:58,822 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:58,824 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:58,927 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:58,928 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:59,036 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:59,038 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:59,039 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:59,148 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:59,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:59,260 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:59,261 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:59,262 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:59,370 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:02:59,371 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:59,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:59,483 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:59,486 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:59,626 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:59,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:59,629 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:02:59,739 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:02:59,741 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:02:59,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3537]
2025-12-03 19:02:59,743 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:02:59,743 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:02:59,865 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:02:59,866 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:02:59,867 | INFO | sqlalchemy.engine.Engine | [cached since 4145s ago] ()
2025-12-03 19:02:59,874 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:02:59,874 | INFO | sqlalchemy.engine.Engine | [cached since 255s ago] (1,)
2025-12-03 19:03:00,889 | INFO | app.services.transcribe | Starting stream. Total bytes: 1390592. Chunk size: 8192. No throttling.
2025-12-03 19:03:00,891 | DEBUG | app.services.transcribe | Streamed 8192/1390592 bytes
2025-12-03 19:03:00,921 | DEBUG | app.services.transcribe | Streamed 417792/1390592 bytes
2025-12-03 19:03:00,945 | DEBUG | app.services.transcribe | Streamed 827392/1390592 bytes
2025-12-03 19:03:00,968 | DEBUG | app.services.transcribe | Streamed 1236992/1390592 bytes
2025-12-03 19:03:00,977 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:03:04,430 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017 transponder...
2025-12-03 19:03:07,691 | DEBUG | app.services.transcribe | Received transcript chunk: rodaré vía Alfa dos ...
2025-12-03 19:03:08,518 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre India...
2025-12-03 19:03:08,568 | INFO | app.services.transcribe | Transcription complete. Length: 95
2025-12-03 19:03:08,570 | INFO | app.controllers.audio | Transcripción recibida session=0c48dfb9-799f-4fff-9dab-ef0081979493: QNH 1017 transponder 0557. rodaré vía Alfa dos Bravo Al.de espera pista. Alfa Noviembre India.
2025-12-03 19:03:08,571 | INFO | app.logs.transcript | student | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | text=QNH 1017 transponder 0557. rodaré vía Alfa dos Bravo Al.de espera pista. Alfa Noviembre India.
2025-12-03 19:03:08,683 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:03:08,684 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:03:08,686 | INFO | sqlalchemy.engine.Engine | [cached since 254.5s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:03:08,703 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:03:11,227 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:03:11,228 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:03:11,228 | INFO | sqlalchemy.engine.Engine | [cached since 257s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:03:11,247 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:03:11,248 | INFO | sqlalchemy.engine.Engine | [cached since 96.96s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (16604 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0557", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 3, 11, 247304, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:03:11,264 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:03:11,294 | INFO | app.controllers.audio | Fase activa session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 19:03:11,296 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH 1017 transponder 0557. rodaré vía Alfa dos Bravo Al.de espera pista. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, esp...
2025-12-03 19:03:22,170 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Falta mencionar 'punto de espera pista uno cero' y la instrucción 'Llame listo'. La ruta de rodaje debe ser 'Alfa, Bravo' sin 'dos'. Corrija estos elementos en su colación.",
  "confidence": 0.85,
  "score": 60,
  "metadata": {
    "missingItems": [
      "Punto de espera pista uno cero",
      "Instrucción 'Llame listo'",
      "Ruta de rodaje exacta (Alfa, Bravo sin 'dos')"
    ]
  }
}
2025-12-03 19:03:22,337 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:03:22,338 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:03:22,340 | INFO | sqlalchemy.engine.Engine | [cached since 268.1s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:03:22,364 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:03:22,366 | INFO | sqlalchemy.engine.Engine | [cached since 108.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (17910 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0557", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 3, 22, 364679, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:03:22,385 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:03:22,404 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:03:22,405 | INFO | sqlalchemy.engine.Engine | [cached since 94.89s ago] (UUID('fae5bcaa-7974-43ee-9c61-e2338617208d'), UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'), 1, 'ground_readback', 60.0, "Falta mencionar 'punto de espera pista uno cero' y la instrucción 'Llame listo'. La ruta de rodaje debe ser 'Alfa, Bravo' sin 'dos'. Corrija estos elementos en su colación.")
2025-12-03 19:03:22,425 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:03:22,462 | INFO | app.controllers.audio | Puntuación guardada session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=ground_readback score=60.00
2025-12-03 19:03:22,463 | INFO | app.logs.transcript | controller | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-03 19:03:57,761 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:03:57,762 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:03:57,763 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:03:57,763 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:03:57,764 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:03:57,765 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:03:57,765 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:03:57,766 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:03:57,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:03:57,767 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:03:57,768 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:03:57,769 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:03:57,769 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:03:57,770 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:03:57,770 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:03:57,772 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:03:57,773 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:03:57,774 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:03:57,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:03:57,776 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:03:57,776 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:03:57,778 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:03:57,779 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:03:57,779 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:03:57,780 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:03:57,780 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:03:57,780 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:03:57,782 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:03:57,783 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:03:57,783 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:03:57,784 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:03:57,784 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 19:03:57,786 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:03:57,885 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:57,886 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:57,888 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:58,003 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:58,004 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:58,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:03:58,010 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:03:58,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:58,166 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:58,168 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:58,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:58,338 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:58,342 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:58,510 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:58,512 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:58,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:58,654 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:58,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:58,660 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:58,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:03:58,784 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:58,786 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:03:58,905 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:58,907 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:58,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:59,022 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:03:59,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:03:59,136 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:59,138 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,140 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:59,258 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:59,260 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,262 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:59,388 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,391 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,393 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:03:59,396 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:03:59,516 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,517 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:03:59,518 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:03:59,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:03:59,633 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:59,744 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:59,746 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1459]
2025-12-03 19:03:59,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 19:03:59,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:59,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,868 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:59,871 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:03:59,985 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:59,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:03:59,987 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:03:59,990 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:04:00,106 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:04:00,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:04:00,111 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:04:00,201 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:04:00,203 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:04:00,205 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1410]
2025-12-03 19:04:00,205 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:04:00,207 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:04:00,344 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:04:00,344 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:04:00,345 | INFO | sqlalchemy.engine.Engine | [cached since 4206s ago] ()
2025-12-03 19:04:00,353 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:04:00,354 | INFO | sqlalchemy.engine.Engine | [cached since 315.5s ago] (1,)
2025-12-03 19:04:01,301 | INFO | app.services.transcribe | Starting stream. Total bytes: 1159168. Chunk size: 8192. No throttling.
2025-12-03 19:04:01,304 | DEBUG | app.services.transcribe | Streamed 8192/1159168 bytes
2025-12-03 19:04:01,337 | DEBUG | app.services.transcribe | Streamed 417792/1159168 bytes
2025-12-03 19:04:01,362 | DEBUG | app.services.transcribe | Streamed 827392/1159168 bytes
2025-12-03 19:04:01,376 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:04:07,935 | DEBUG | app.services.transcribe | Received transcript chunk: H 1017 transponder 0...
2025-12-03 19:04:08,091 | INFO | app.services.transcribe | Transcription complete. Length: 81
2025-12-03 19:04:08,092 | INFO | app.controllers.audio | Transcripción recibida session=0c48dfb9-799f-4fff-9dab-ef0081979493: H 1017 transponder 0557 Rodaré vía Alfa Bravo Al.de espera Pista Alfa Noviembre.
2025-12-03 19:04:08,092 | INFO | app.logs.transcript | student | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | text=H 1017 transponder 0557 Rodaré vía Alfa Bravo Al.de espera Pista Alfa Noviembre.
2025-12-03 19:04:08,220 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:04:08,221 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:04:08,223 | INFO | sqlalchemy.engine.Engine | [cached since 314s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:04:08,240 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:04:08,991 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:04:08,992 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:04:08,994 | INFO | sqlalchemy.engine.Engine | [cached since 314.8s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:04:09,009 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:04:09,009 | INFO | sqlalchemy.engine.Engine | [cached since 154.7s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (18413 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0557", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 4, 9, 8450, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:04:09,026 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:04:09,054 | INFO | app.controllers.audio | Fase activa session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 19:04:09,056 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
H 1017 transponder 0557 Rodaré vía Alfa Bravo Al.de espera Pista Alfa Noviembre.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO col...
2025-12-03 19:04:18,483 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persisten errores en la colación: 1) 'Al.de espera' debe ser 'punto de espera'. 2) 'Pista Alfa Noviembre' es incorrecto - debe ser 'pista uno cero'. 3) Falta la instrucción 'Llame listo'. Corrija estos elementos antes de proceder.",
  "confidence": 0.85,
  "score": 40,
  "metadata": {
    "missingItems": [
      "Punto de espera pista uno cero",
      "Instrucción 'Llame listo'"
    ],...
2025-12-03 19:04:18,596 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:04:18,597 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:04:18,597 | INFO | sqlalchemy.engine.Engine | [cached since 324.4s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:04:18,615 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:04:18,615 | INFO | sqlalchemy.engine.Engine | [cached since 164.3s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (19891 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0557", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 4, 18, 615171, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:04:18,629 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:04:18,648 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:04:18,648 | INFO | sqlalchemy.engine.Engine | [cached since 151.1s ago] (UUID('c7dc0bc5-40d1-45b2-bcb0-97b3060b7d2b'), UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'), 1, 'ground_readback', 40.0, "Persisten errores en la colación: 1) 'Al.de espera' debe ser 'punto de espera'. 2) 'Pista Alfa Noviembre' es incorrecto - debe ser 'pista uno cero'. 3) Falta la instrucción 'Llame listo'. Corrija estos elementos antes de proceder.")
2025-12-03 19:04:18,661 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:04:18,687 | INFO | app.controllers.audio | Puntuación guardada session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=ground_readback score=40.00
2025-12-03 19:04:18,688 | INFO | app.logs.transcript | controller | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-03 19:09:11,067 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:09:11,067 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:09:11,068 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:09:11,068 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:09:11,070 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:09:11,071 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:09:11,071 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:09:11,072 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:09:11,072 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:09:11,073 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:09:11,074 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:09:11,074 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:09:11,075 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:09:11,075 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:09:11,076 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:09:11,076 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:09:11,076 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:09:11,077 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:09:11,078 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:09:11,078 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:09:11,078 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:09:11,080 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:09:11,080 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:09:11,080 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:09:11,081 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:09:11,081 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:09:11,082 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:09:11,082 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:09:11,082 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:09:11,084 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:09:11,084 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:09:11,085 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:1460]
2025-12-03 19:09:11,087 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:09:11,186 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:11,187 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,188 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:11,313 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:11,314 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,316 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:11,317 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:09:11,431 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:11,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,434 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,435 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:09:11,550 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:11,551 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,553 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:11,555 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:09:11,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:11,689 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:09:11,803 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:11,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:09:11,921 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:11,922 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:11,926 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:12,042 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:12,044 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:12,157 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:12,159 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:12,265 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:12,267 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:12,374 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:12,376 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:12,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:09:12,482 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:12,484 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:12,594 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:12,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:12,598 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:12,702 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:12,703 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:12,705 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:12,817 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:12,818 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:09:12,820 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:09:12,932 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:12,934 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:12,935 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:13,042 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:13,044 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-03 19:09:13,177 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:13,179 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:13,181 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:13,288 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:13,290 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:13,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:13,294 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:09:13,401 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:13,404 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:13,409 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3811]
2025-12-03 19:09:13,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 19:09:13,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:13,515 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:13,516 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:09:13,627 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:09:13,629 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:13,631 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:09:13,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:891]
2025-12-03 19:09:13,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 19:09:13,644 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:808]
2025-12-03 19:09:13,644 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:09:13,645 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:09:13,768 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:09:13,770 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:09:13,770 | INFO | sqlalchemy.engine.Engine | [cached since 4519s ago] ()
2025-12-03 19:09:13,780 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:09:13,781 | INFO | sqlalchemy.engine.Engine | [cached since 628.9s ago] (1,)
2025-12-03 19:09:15,294 | INFO | app.services.transcribe | Starting stream. Total bytes: 1339392. Chunk size: 8192. No throttling.
2025-12-03 19:09:15,297 | DEBUG | app.services.transcribe | Streamed 8192/1339392 bytes
2025-12-03 19:09:15,313 | DEBUG | app.services.transcribe | Streamed 417792/1339392 bytes
2025-12-03 19:09:15,327 | DEBUG | app.services.transcribe | Streamed 827392/1339392 bytes
2025-12-03 19:09:15,342 | DEBUG | app.services.transcribe | Streamed 1236992/1339392 bytes
2025-12-03 19:09:15,346 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:09:21,540 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017 Transponder...
2025-12-03 19:09:22,110 | DEBUG | app.services.transcribe | Received transcript chunk: listo....
2025-12-03 19:09:22,163 | INFO | app.services.transcribe | Transcription complete. Length: 75
2025-12-03 19:09:22,164 | INFO | app.controllers.audio | Transcripción recibida session=0c48dfb9-799f-4fff-9dab-ef0081979493: QNH 1017 Transponder 0557 Rodaré vía Alfa Bravo al.de espera pista. listo.
2025-12-03 19:09:22,164 | INFO | app.logs.transcript | student | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | text=QNH 1017 Transponder 0557 Rodaré vía Alfa Bravo al.de espera pista. listo.
2025-12-03 19:09:22,289 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:09:22,290 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:09:22,293 | INFO | sqlalchemy.engine.Engine | [cached since 628.1s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:09:22,313 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:09:25,951 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:09:25,952 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:09:25,953 | INFO | sqlalchemy.engine.Engine | [cached since 631.7s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:09:25,975 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:09:25,976 | INFO | sqlalchemy.engine.Engine | [cached since 471.7s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (20388 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0557", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 9, 25, 975112, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:09:25,997 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:09:26,036 | INFO | app.controllers.audio | Fase activa session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 19:09:26,040 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH 1017 Transponder 0557 Rodaré vía Alfa Bravo al.de espera pista. listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colaciona...
2025-12-03 19:09:43,111 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "Colación completa y correcta. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista asignada y restricción de espera. Puede proceder a contactar Torre.",
  "confidence": 0.98,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_hold_short",
    "missingItems": [],
    "extraI...
2025-12-03 19:09:43,114 | INFO | app.controllers.audio | Transición automática de fase session=0c48dfb9-799f-4fff-9dab-ef0081979493 de=ground_readback a=tower_hold_short
2025-12-03 19:09:43,235 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:09:43,236 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:09:43,237 | INFO | sqlalchemy.engine.Engine | [cached since 649s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:09:43,254 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:09:43,255 | INFO | sqlalchemy.engine.Engine | [cached since 489s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (22301 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0557", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 9, 43, 254035, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('10e7320b-4cb1-423d-a754-1520d58fa503'))
2025-12-03 19:09:43,268 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:09:43,292 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:09:43,293 | INFO | sqlalchemy.engine.Engine | [cached since 475.8s ago] (UUID('6a57bef4-04ad-4fd9-b7eb-7895437422c9'), UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'), 1, 'tower_hold_short', 95.0, 'Colación completa y correcta. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista asignada y restricción de espera. Puede proceder a contactar Torre.')
2025-12-03 19:09:43,304 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:09:43,331 | INFO | app.controllers.audio | Puntuación guardada session=0c48dfb9-799f-4fff-9dab-ef0081979493 phase_id=tower_hold_short score=95.00
2025-12-03 19:09:43,332 | INFO | app.logs.transcript | controller | session=0c48dfb9-799f-4fff-9dab-ef0081979493 | frequency=121.700 | intent=ground_taxi_instructions | phase=tower_hold_short | allow_response=True | text=Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-03 19:10:38,406 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-03 19:10:38,544 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D4903E90>
2025-12-03 19:10:38,545 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x00000254D48DADE0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-03 19:10:38,653 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D4901310>
2025-12-03 19:10:38,655 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-03 19:10:38,656 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-03 19:10:38,657 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-03 19:10:38,657 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-03 19:10:38,659 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-03 19:10:38,801 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 04 Dec 2025 01:10:38 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'471'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1d7-bqgyMnm85OuYCOIZOquANnMmyP4"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251204T011038Z-1654ff75797kk9hrhC1MIAp11800000032b000000000rzun'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-03 19:10:38,802 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-03 19:10:38,803 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-03 19:10:38,804 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-03 19:10:38,805 | DEBUG | httpcore.http11 | response_closed.started
2025-12-03 19:10:38,807 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-03 19:10:38,809 | DEBUG | httpcore.connection | close.started
2025-12-03 19:10:38,810 | DEBUG | httpcore.connection | close.complete
2025-12-03 19:10:41,454 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:10:41,455 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:10:41,456 | INFO | sqlalchemy.engine.Engine | [cached since 4607s ago] ()
2025-12-03 19:10:41,464 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:10:41,465 | INFO | sqlalchemy.engine.Engine | [cached since 716.6s ago] (1,)
2025-12-03 19:10:41,548 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-03 19:10:41,549 | INFO | sqlalchemy.engine.Engine | [cached since 608.2s ago] (UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "080", "windSpeed": "9", "temp": "22", "dewp": "16", "cloudCover": "FEW", "cloudBase": "4000", "wind": "080/9"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 3, 19, 10, 41, 548467, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 3, 19, 10, 41, 548467, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-03 19:10:41,560 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:10:41,722 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:10:41,724 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-03 19:10:41,725 | INFO | sqlalchemy.engine.Engine | [cached since 608.1s ago] (UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'),)
2025-12-03 19:10:41,742 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:12:28,866 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:12:28,866 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:12:28,867 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:12:28,867 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:12:28,868 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:12:28,869 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:12:28,870 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:12:28,870 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:12:28,872 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:12:28,873 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:12:28,874 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:12:28,875 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:12:28,876 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:12:28,877 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:12:28,878 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:12:28,878 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:12:28,879 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:12:28,880 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:12:28,881 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:12:28,882 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:12:28,882 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:12:28,883 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:12:28,884 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:12:28,885 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:12:28,886 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:12:28,886 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:12:28,887 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:12:28,889 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:12:28,889 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:12:28,890 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:12:28,891 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:12:28,892 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 19:12:28,895 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:12:29,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,027 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:29,030 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:29,151 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:29,153 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,155 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,158 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:29,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:29,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:29,414 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:29,415 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,417 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,420 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:29,534 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,536 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:29,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:29,658 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,660 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:29,662 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:29,797 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:29,800 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:29,802 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:29,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:29,920 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:30,034 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:30,036 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:30,038 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:30,161 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:30,162 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:30,307 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:30,309 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:30,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:30,438 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:30,440 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:30,442 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:30,561 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:30,563 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:30,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:30,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:30,684 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:30,810 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:30,812 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:12:30,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:30,942 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:30,944 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:30,946 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:31,064 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:31,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:12:31,067 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:31,197 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:31,200 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:31,203 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:12:31,413 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:31,415 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:31,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:31,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:31,541 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:31,543 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:31,544 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:12:31,665 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:31,667 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:31,670 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:31,671 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:31,795 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:31,796 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:31,798 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:31,912 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:31,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:32,046 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,047 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,050 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:32,161 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,161 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:32,165 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:32,273 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,274 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,275 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:32,388 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,389 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,391 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:32,510 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,511 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:32,629 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,630 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,631 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:32,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,743 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,744 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:32,854 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:12:32,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,858 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:12:32,966 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:12:32,968 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,970 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:32,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:12:33,000 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:12:33,001 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:540]
2025-12-03 19:12:33,003 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:12:33,004 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:12:33,117 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:12:33,117 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:12:33,118 | INFO | sqlalchemy.engine.Engine | [cached since 4719s ago] ()
2025-12-03 19:12:33,126 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:12:33,127 | INFO | sqlalchemy.engine.Engine | [cached since 828.3s ago] (1,)
2025-12-03 19:12:34,154 | INFO | app.services.transcribe | Starting stream. Total bytes: 1941504. Chunk size: 8192. No throttling.
2025-12-03 19:12:34,156 | DEBUG | app.services.transcribe | Streamed 8192/1941504 bytes
2025-12-03 19:12:34,176 | DEBUG | app.services.transcribe | Streamed 417792/1941504 bytes
2025-12-03 19:12:34,199 | DEBUG | app.services.transcribe | Streamed 827392/1941504 bytes
2025-12-03 19:12:34,236 | DEBUG | app.services.transcribe | Streamed 1236992/1941504 bytes
2025-12-03 19:12:34,253 | DEBUG | app.services.transcribe | Streamed 1646592/1941504 bytes
2025-12-03 19:12:34,268 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:12:44,778 | DEBUG | app.services.transcribe | Received transcript chunk: superficie Alfa Novi...
2025-12-03 19:12:45,020 | INFO | app.services.transcribe | Transcription complete. Length: 186
2025-12-03 19:12:45,022 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía paso ochogo nivel 7000 pies dos almas a bordo, autonomía cinco horas.
2025-12-03 19:12:45,022 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | text=superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía paso ochogo nivel 7000 pies dos almas a bordo, autonomía cinco horas.
2025-12-03 19:12:45,139 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:12:45,139 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:12:45,142 | INFO | sqlalchemy.engine.Engine | [cached since 830.9s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:12:45,157 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:12:45,940 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:12:45,941 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:12:45,943 | INFO | sqlalchemy.engine.Engine | [cached since 831.7s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:12:45,956 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:12:45,956 | INFO | sqlalchemy.engine.Engine | [cached since 671.7s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (14595 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-04T01:12:45Z"}]}', datetime.datetime(2025, 12, 3, 19, 12, 45, 955801, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:12:45,970 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:12:46,000 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-03 19:12:46,002 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0531. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": stri...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía paso ochogo nivel 7000 pies dos almas a bordo, autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ...
2025-12-03 19:12:54,237 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0531. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.",
  "confidence": 0.95,
  "score": 100,
  "metadata": {
    "nextPhase": "ground_readback"
 ...
2025-12-03 19:12:54,238 | INFO | app.controllers.audio | Transición automática de fase session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 de=ground_departure_request a=ground_readback
2025-12-03 19:12:54,381 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:12:54,382 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:12:54,383 | INFO | sqlalchemy.engine.Engine | [cached since 840.2s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:12:54,401 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:12:54,402 | INFO | sqlalchemy.engine.Engine | [cached since 680.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (15865 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 12, 54, 401047, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:12:54,418 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:12:54,450 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:12:54,452 | INFO | sqlalchemy.engine.Engine | [cached since 666.9s ago] (UUID('4bc51057-22a6-4f34-8c14-8605e792c19b'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'ground_readback', 100.0, 'Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.')
2025-12-03 19:12:54,464 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:12:54,492 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=ground_readback score=100.00
2025-12-03 19:12:54,493 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0531. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.
2025-12-03 19:14:25,750 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:14:25,750 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:14:25,751 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:14:25,752 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:14:25,754 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:14:25,755 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:14:25,755 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:14:25,756 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:14:25,758 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:14:25,758 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:14:25,759 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:14:25,761 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:14:25,762 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:14:25,763 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:14:25,763 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:14:25,765 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:14:25,765 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:14:25,766 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:14:25,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:14:25,767 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:14:25,768 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:14:25,770 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:14:25,771 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:14:25,772 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:14:25,773 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:14:25,776 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:14:25,776 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:14:25,778 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:14:25,779 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:14:25,780 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:14:25,781 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:14:25,783 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:14:25,785 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:25,787 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:14:25,895 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:25,896 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:25,898 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:26,017 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,018 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:26,020 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:26,135 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:26,137 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,140 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:26,272 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,274 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:26,277 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:26,280 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:14:26,415 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:14:26,548 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:14:26,550 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:26,670 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:14:26,672 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:26,676 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:14:26,800 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,803 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,806 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,810 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:26,946 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:26,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:26,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:27,068 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:27,071 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:27,073 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:27,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:27,198 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:27,200 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:27,384 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:27,387 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:27,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:27,570 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:27,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:27,576 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:27,580 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:14:27,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:14:27,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:27,942 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:27,944 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:27,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:14:27,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:14:28,089 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:28,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,096 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:28,235 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,237 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:28,239 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:28,366 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,367 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:28,369 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,372 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:14:28,508 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:28,510 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:28,634 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,635 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:28,638 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:14:28,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:14:28,752 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:14:28,866 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:28,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:28,870 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:28,871 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:14:28,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:14:28,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:14:29,096 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:14:29,098 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:14:29,100 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2919]
2025-12-03 19:14:29,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 19:14:29,102 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:14:29,123 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1380]
2025-12-03 19:14:29,123 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:14:29,125 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:14:29,296 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:14:29,297 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:14:29,299 | INFO | sqlalchemy.engine.Engine | [cached since 4835s ago] ()
2025-12-03 19:14:29,310 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:14:29,312 | INFO | sqlalchemy.engine.Engine | [cached since 944.5s ago] (1,)
2025-12-03 19:14:30,438 | INFO | app.services.transcribe | Starting stream. Total bytes: 1462272. Chunk size: 8192. No throttling.
2025-12-03 19:14:30,441 | DEBUG | app.services.transcribe | Streamed 8192/1462272 bytes
2025-12-03 19:14:30,495 | DEBUG | app.services.transcribe | Streamed 417792/1462272 bytes
2025-12-03 19:14:30,543 | DEBUG | app.services.transcribe | Streamed 827392/1462272 bytes
2025-12-03 19:14:30,583 | DEBUG | app.services.transcribe | Streamed 1236992/1462272 bytes
2025-12-03 19:14:30,600 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:14:33,139 | DEBUG | app.services.transcribe | Received transcript chunk: H 10 transponder....
2025-12-03 19:14:37,226 | DEBUG | app.services.transcribe | Received transcript chunk: 0530 y uno rodaré ví...
2025-12-03 19:14:37,757 | DEBUG | app.services.transcribe | Received transcript chunk: listo....
2025-12-03 19:14:37,839 | INFO | app.services.transcribe | Transcription complete. Length: 78
2025-12-03 19:14:37,841 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: H 10 transponder. 0530 y uno rodaré vía Alfa Bravo al.de espera pista. listo.
2025-12-03 19:14:37,842 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | text=H 10 transponder. 0530 y uno rodaré vía Alfa Bravo al.de espera pista. listo.
2025-12-03 19:14:38,028 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:14:38,030 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:14:38,031 | INFO | sqlalchemy.engine.Engine | [cached since 943.8s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:14:38,049 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:14:40,632 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:14:40,632 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:14:40,633 | INFO | sqlalchemy.engine.Engine | [cached since 946.4s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:14:40,650 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:14:40,651 | INFO | sqlalchemy.engine.Engine | [cached since 786.4s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (16365 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 14, 40, 650109, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:14:40,670 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:14:40,697 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 19:14:40,700 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
H 10 transponder. 0530 y uno rodaré vía Alfa Bravo al.de espera pista. listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colaci...
2025-12-03 19:14:57,860 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Errores detectados en la colación: 1) Código transponder incorrecto (0530 vs 0531 asignado). 2) Falta colación de QNH 1017. 3) No menciona 'punto de espera' antes de pista. Corrija estos elementos antes de proceder.",
  "confidence": 0.92,
  "score": 40,
  "metadata": {
    "missingItems": [
      "QNH 1017",
      "Código transponder correcto (0531)",
      "Frase 'punto de espera' an...
2025-12-03 19:14:57,997 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:14:57,998 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:14:57,999 | INFO | sqlalchemy.engine.Engine | [cached since 963.8s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:14:58,014 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:14:58,015 | INFO | sqlalchemy.engine.Engine | [cached since 803.7s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (17761 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 14, 58, 14000, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:14:58,030 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:14:58,058 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:14:58,060 | INFO | sqlalchemy.engine.Engine | [cached since 790.5s ago] (UUID('8661006b-77e9-4bfc-ba8b-4dac4f51bc77'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'ground_readback', 40.0, "Errores detectados en la colación: 1) Código transponder incorrecto (0530 vs 0531 asignado). 2) Falta colación de QNH 1017. 3) No menciona 'punto de espera' antes de pista. Corrija estos elementos antes de proceder.")
2025-12-03 19:14:58,071 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:14:58,097 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=ground_readback score=40.00
2025-12-03 19:14:58,098 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-03 19:15:36,462 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:15:36,463 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:15:36,464 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:15:36,464 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:15:36,466 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:15:36,467 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:15:36,467 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:15:36,468 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:15:36,468 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:15:36,470 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:15:36,470 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:15:36,471 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:15:36,472 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:15:36,473 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:15:36,474 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:15:36,475 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:15:36,476 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:15:36,477 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:15:36,478 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:15:36,479 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:15:36,480 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:15:36,480 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:15:36,481 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:15:36,481 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:15:36,482 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:15:36,483 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:15:36,483 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:15:36,484 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:15:36,485 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:15:36,487 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:15:36,488 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:15:36,489 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 19:15:36,491 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:15:36,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:36,594 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:36,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:36,722 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:36,724 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:36,727 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:15:36,853 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:36,855 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:36,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:36,970 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:36,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:36,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:37,089 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:15:37,090 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:37,092 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:15:37,210 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:37,211 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:37,213 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:37,382 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:37,384 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:37,387 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:37,390 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:15:37,584 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:37,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:37,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:37,792 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:37,794 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-03 19:15:38,021 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,023 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:38,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:38,171 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,172 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:38,174 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:38,291 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:38,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:38,409 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,410 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:38,412 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:38,530 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:15:38,531 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:38,533 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:15:38,647 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,647 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:38,649 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:38,768 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,770 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:38,771 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,773 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:15:38,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:15:38,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:38,921 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:15:39,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:39,046 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:39,048 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:39,176 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:39,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:39,180 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:39,306 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:39,308 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:39,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:39,447 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:39,448 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:39,450 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:15:39,557 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:15:39,558 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:15:39,560 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2640]
2025-12-03 19:15:39,560 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:15:39,560 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:15:39,684 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:15:39,686 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:15:39,687 | INFO | sqlalchemy.engine.Engine | [cached since 4905s ago] ()
2025-12-03 19:15:39,694 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:15:39,695 | INFO | sqlalchemy.engine.Engine | [cached since 1015s ago] (1,)
2025-12-03 19:15:40,687 | INFO | app.services.transcribe | Starting stream. Total bytes: 1325056. Chunk size: 8192. No throttling.
2025-12-03 19:15:40,691 | DEBUG | app.services.transcribe | Streamed 8192/1325056 bytes
2025-12-03 19:15:40,713 | DEBUG | app.services.transcribe | Streamed 417792/1325056 bytes
2025-12-03 19:15:40,743 | DEBUG | app.services.transcribe | Streamed 827392/1325056 bytes
2025-12-03 19:15:40,765 | DEBUG | app.services.transcribe | Streamed 1236992/1325056 bytes
2025-12-03 19:15:40,769 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:15:44,312 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017 Transponder...
2025-12-03 19:15:47,478 | DEBUG | app.services.transcribe | Received transcript chunk: rodaré vía Alfa Brav...
2025-12-03 19:15:47,550 | INFO | app.services.transcribe | Transcription complete. Length: 78
2025-12-03 19:15:47,551 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: QNH 1017 Transponder 053. rodaré vía Alfa Bravo al.de espera pista 10. Listo.
2025-12-03 19:15:47,552 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | text=QNH 1017 Transponder 053. rodaré vía Alfa Bravo al.de espera pista 10. Listo.
2025-12-03 19:15:47,863 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:15:47,864 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:15:47,865 | INFO | sqlalchemy.engine.Engine | [cached since 1014s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:15:47,887 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:15:50,693 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:15:50,695 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:15:50,695 | INFO | sqlalchemy.engine.Engine | [cached since 1016s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:15:50,711 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:15:50,712 | INFO | sqlalchemy.engine.Engine | [cached since 856.4s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (18261 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 15, 50, 711074, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:15:50,731 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:15:50,763 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 19:15:50,766 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH 1017 Transponder 053. rodaré vía Alfa Bravo al.de espera pista 10. Listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colaci...
2025-12-03 19:16:01,412 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persisten errores en la colación: 1) Código transponder incompleto (053 vs 0531 asignado). 2) Falta 'punto de espera' antes de pista 10. Corrija el código transponder y complete la fraseología de la pista antes de proceder.",
  "confidence": 0.85,
  "score": 45,
  "metadata": {
    "missingItems": [
      "Código transponder completo",
      "Fraseología correcta de pista (punto de esp...
2025-12-03 19:16:01,529 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:16:01,531 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:16:01,532 | INFO | sqlalchemy.engine.Engine | [cached since 1027s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:16:01,546 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:16:01,547 | INFO | sqlalchemy.engine.Engine | [cached since 867.3s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (19671 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 16, 1, 546253, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:16:01,562 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:16:01,580 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:16:01,581 | INFO | sqlalchemy.engine.Engine | [cached since 854.1s ago] (UUID('1f24fb83-c0f3-4095-8ff5-98787f6aba37'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'ground_readback', 45.0, "Persisten errores en la colación: 1) Código transponder incompleto (053 vs 0531 asignado). 2) Falta 'punto de espera' antes de pista 10. Corrija el código transponder y complete la fraseología de la pista antes de proceder.")
2025-12-03 19:16:01,593 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:16:01,621 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=ground_readback score=45.00
2025-12-03 19:16:01,622 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-03 19:16:41,033 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:16:41,033 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:16:41,034 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:16:41,035 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:16:41,036 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:16:41,036 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:16:41,037 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:16:41,037 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:16:41,039 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:16:41,040 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:16:41,041 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:16:41,042 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:16:41,042 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:16:41,043 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:16:41,044 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:16:41,044 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:16:41,045 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:16:41,046 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:16:41,046 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:16:41,047 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:16:41,048 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:16:41,048 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:16:41,048 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:16:41,050 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:16:41,051 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:16:41,052 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:16:41,052 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:16:41,052 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:16:41,053 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:16:41,054 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:16:41,055 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:16:41,056 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-03 19:16:41,059 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:41,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:41,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:41,166 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:41,280 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:41,282 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:41,284 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:41,286 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:41,424 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:41,426 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:16:41,428 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:16:41,546 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:16:41,548 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:41,550 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:16:41,669 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:41,670 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:16:41,671 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:16:41,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:41,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:41,784 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:41,891 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:41,894 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:41,895 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:42,008 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,010 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:16:42,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:16:42,126 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:16:42,127 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:42,128 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:16:42,241 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:42,243 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,244 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:42,352 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,354 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:42,356 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:42,468 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:42,470 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:42,596 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:42,597 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:42,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:42,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:42,823 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,824 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:16:42,826 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:16:42,931 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:42,931 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:42,933 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:43,047 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:43,048 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:43,050 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:43,051 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:16:43,184 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:16:43,185 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:43,188 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:16:43,190 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:16:43,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:16:43,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:16:43,361 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:16:43,362 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:171]
2025-12-03 19:16:43,363 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:16:43,364 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:16:43,477 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:16:43,478 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:16:43,478 | INFO | sqlalchemy.engine.Engine | [cached since 4969s ago] ()
2025-12-03 19:16:43,487 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:16:43,487 | INFO | sqlalchemy.engine.Engine | [cached since 1079s ago] (1,)
2025-12-03 19:16:44,448 | INFO | app.services.transcribe | Starting stream. Total bytes: 1210368. Chunk size: 8192. No throttling.
2025-12-03 19:16:44,450 | DEBUG | app.services.transcribe | Streamed 8192/1210368 bytes
2025-12-03 19:16:44,490 | DEBUG | app.services.transcribe | Streamed 417792/1210368 bytes
2025-12-03 19:16:44,520 | DEBUG | app.services.transcribe | Streamed 827392/1210368 bytes
2025-12-03 19:16:44,545 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:16:50,847 | DEBUG | app.services.transcribe | Received transcript chunk: QMH1017 transponder ...
2025-12-03 19:16:50,970 | INFO | app.services.transcribe | Transcription complete. Length: 76
2025-12-03 19:16:50,971 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: QMH1017 transponder 0531 Rodaré vía Alfa Bravo Al.de espera Pista 10 Listo.
2025-12-03 19:16:50,972 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | text=QMH1017 transponder 0531 Rodaré vía Alfa Bravo Al.de espera Pista 10 Listo.
2025-12-03 19:16:51,081 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:16:51,082 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:16:51,082 | INFO | sqlalchemy.engine.Engine | [cached since 1077s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:16:51,100 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:16:51,893 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:16:51,894 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:16:51,895 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:16:51,917 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:16:51,918 | INFO | sqlalchemy.engine.Engine | [cached since 917.6s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (20169 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 16, 51, 916464, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:16:51,939 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:16:51,976 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 19:16:51,978 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QMH1017 transponder 0531 Rodaré vía Alfa Bravo Al.de espera Pista 10 Listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colacion...
2025-12-03 19:17:00,579 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": true,
  "controllerText": "QMH1017, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "Colación completa y precisa. Se corrigieron los errores previos de transponder y fraseología de pista. Puede proceder a Torre.",
  "confidence": 0.98,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_hold_short",
    "missingItems": [],
    "extraItems": []
  }
}
2025-12-03 19:17:00,580 | INFO | app.controllers.audio | Transición automática de fase session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 de=ground_readback a=tower_hold_short
2025-12-03 19:17:00,714 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:17:00,715 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:17:00,715 | INFO | sqlalchemy.engine.Engine | [cached since 1087s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:17:00,736 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:17:00,737 | INFO | sqlalchemy.engine.Engine | [cached since 926.5s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (21368 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 17, 0, 736644, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:17:00,753 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:17:00,769 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:17:00,770 | INFO | sqlalchemy.engine.Engine | [cached since 913.3s ago] (UUID('cd75e4fd-d66c-4be3-8fc5-63025c18695d'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_hold_short', 95.0, 'Colación completa y precisa. Se corrigieron los errores previos de transponder y fraseología de pista. Puede proceder a Torre.')
2025-12-03 19:17:00,782 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:17:00,814 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_hold_short score=95.00
2025-12-03 19:17:00,816 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | intent=ground_taxi_instructions | phase=tower_hold_short | allow_response=True | text=QMH1017, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-03 19:17:50,087 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:17:50,088 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:17:50,089 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:17:50,090 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:17:50,091 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:17:50,092 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:17:50,092 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:17:50,094 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:17:50,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:17:50,096 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:17:50,097 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:17:50,098 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:17:50,098 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:17:50,100 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:17:50,100 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:17:50,102 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:17:50,102 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:17:50,103 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:17:50,104 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:17:50,106 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:17:50,107 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:17:50,108 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:17:50,108 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:17:50,108 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:17:50,111 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:17:50,112 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:17:50,113 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:17:50,115 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:17:50,116 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:17:50,117 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:17:50,118 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:17:50,121 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:1460]
2025-12-03 19:17:50,123 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,125 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:50,233 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,234 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,236 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:50,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,351 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,353 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:50,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,472 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,475 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,477 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:17:50,594 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,596 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:50,709 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,710 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:50,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,831 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:50,942 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:50,943 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:50,945 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:51,061 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,064 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:51,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:51,212 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,214 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:51,215 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,218 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:17:51,344 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,345 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:51,347 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:17:51,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:17:51,460 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:51,461 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:17:51,574 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,576 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:51,578 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:51,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:17:51,695 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:17:51,745 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:17:51,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:621]
2025-12-03 19:17:51,748 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:17:51,748 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:17:51,865 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:17:51,866 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:17:51,867 | INFO | sqlalchemy.engine.Engine | [cached since 5037s ago] ()
2025-12-03 19:17:51,873 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:17:51,875 | INFO | sqlalchemy.engine.Engine | [cached since 1147s ago] (1,)
2025-12-03 19:17:52,780 | INFO | app.services.transcribe | Starting stream. Total bytes: 841728. Chunk size: 8192. No throttling.
2025-12-03 19:17:52,783 | DEBUG | app.services.transcribe | Streamed 8192/841728 bytes
2025-12-03 19:17:52,805 | DEBUG | app.services.transcribe | Streamed 417792/841728 bytes
2025-12-03 19:17:52,834 | DEBUG | app.services.transcribe | Streamed 827392/841728 bytes
2025-12-03 19:17:52,836 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:17:56,570 | DEBUG | app.services.transcribe | Received transcript chunk: Torre Alfa Noviembre...
2025-12-03 19:17:56,673 | INFO | app.services.transcribe | Transcription complete. Length: 68
2025-12-03 19:17:56,674 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: Torre Alfa Noviembre India en.de espera pista 10 listo para salida.
2025-12-03 19:17:56,675 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | text=Torre Alfa Noviembre India en.de espera pista 10 listo para salida.
2025-12-03 19:17:56,800 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:17:56,801 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:17:56,803 | INFO | sqlalchemy.engine.Engine | [cached since 1143s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:17:56,822 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:17:57,938 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:17:57,940 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:17:57,942 | INFO | sqlalchemy.engine.Engine | [cached since 1144s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:17:57,970 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:17:57,972 | INFO | sqlalchemy.engine.Engine | [cached since 983.7s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (21846 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 17, 57, 968543, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:17:58,014 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:17:58,064 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_hold_short intent=tower_ready_for_departure freq=tower
2025-12-03 19:17:58,065 | INFO | app.controllers.audio | Frecuencia fuera de rango intent=tower_ready_for_departure freq=121.700 esperado=118.300
2025-12-03 19:17:58,256 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:17:58,257 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:17:58,258 | INFO | sqlalchemy.engine.Engine | [cached since 1144s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:17:58,282 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:17:58,283 | INFO | sqlalchemy.engine.Engine | [cached since 984s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (22410 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 17, 58, 282094, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:17:58,301 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:17:58,323 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:17:58,326 | INFO | sqlalchemy.engine.Engine | [cached since 970.8s ago] (UUID('7ebbb215-fda3-45aa-b804-6668895d5447'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'frequency_usage_error', 0.0, 'La frecuencia esperada para esta solicitud es 118.300.')
2025-12-03 19:17:58,340 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:17:58,377 | INFO | app.controllers.audio | Error de frecuencia registrado session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_hold_short
2025-12-03 19:17:58,379 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=121.700 | intent=tower_ready_for_departure | phase=tower_hold_short | allow_response=False | text=La frecuencia esperada para esta solicitud es 118.300.
2025-12-03 19:18:27,553 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:18:27,556 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:18:27,558 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:18:27,559 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:18:27,561 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:18:27,563 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:18:27,564 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:18:27,566 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:18:27,567 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:18:27,567 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:18:27,570 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:18:27,572 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:18:27,574 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:18:27,578 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:18:27,580 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:18:27,583 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:18:27,585 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:18:27,588 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:18:27,590 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:18:27,593 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:18:27,596 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:18:27,597 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:18:27,599 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:18:27,602 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:18:27,606 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:18:27,608 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:18:27,608 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:18:27,612 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:18:27,616 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:18:27,621 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:18:27,632 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:18:27,641 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-03 19:18:27,650 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:27,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:18:27,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:27,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:27,952 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:27,955 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:28,125 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,126 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:18:28,241 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:18:28,242 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,245 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:18:28,358 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:28,359 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,361 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:28,500 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:28,505 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:28,631 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:28,633 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,634 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,636 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:18:28,745 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:28,746 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,748 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:18:28,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:28,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:28,858 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:28,983 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:18:28,985 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:29,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:29,103 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,106 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:29,215 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:29,217 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,218 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:29,327 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:18:29,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:18:29,444 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:29,445 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,446 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:29,558 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,558 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:29,560 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:29,562 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:18:29,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,689 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:18:29,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:18:29,727 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:18:29,730 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:415]
2025-12-03 19:18:29,731 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:18:29,732 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:18:29,860 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:18:29,861 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:18:29,861 | INFO | sqlalchemy.engine.Engine | [cached since 5075s ago] ()
2025-12-03 19:18:29,867 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:18:29,868 | INFO | sqlalchemy.engine.Engine | [cached since 1185s ago] (1,)
2025-12-03 19:18:30,785 | INFO | app.services.transcribe | Starting stream. Total bytes: 1009664. Chunk size: 8192. No throttling.
2025-12-03 19:18:30,788 | DEBUG | app.services.transcribe | Streamed 8192/1009664 bytes
2025-12-03 19:18:30,823 | DEBUG | app.services.transcribe | Streamed 417792/1009664 bytes
2025-12-03 19:18:30,858 | DEBUG | app.services.transcribe | Streamed 827392/1009664 bytes
2025-12-03 19:18:30,873 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:18:34,819 | DEBUG | app.services.transcribe | Received transcript chunk: Torre Alfa Noviembre...
2025-12-03 19:18:35,653 | DEBUG | app.services.transcribe | Received transcript chunk: listo para salida....
2025-12-03 19:18:35,768 | INFO | app.services.transcribe | Transcription complete. Length: 66
2025-12-03 19:18:35,769 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: Torre Alfa Noviembre India en.de espera pista. listo para salida.
2025-12-03 19:18:35,770 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=Torre Alfa Noviembre India en.de espera pista. listo para salida.
2025-12-03 19:18:35,874 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:18:35,875 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:18:35,876 | INFO | sqlalchemy.engine.Engine | [cached since 1182s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:18:35,900 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:18:36,786 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:18:36,787 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:18:36,788 | INFO | sqlalchemy.engine.Engine | [cached since 1183s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:18:36,809 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:18:36,811 | INFO | sqlalchemy.engine.Engine | [cached since 1023s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (22886 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 18, 36, 809046, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:18:36,851 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:18:36,887 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_hold_short intent=tower_ready_for_departure freq=tower
2025-12-03 19:18:36,890 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_ready_for_departure freq_group=tower
SYSTEM> Eres Pavas Torre (118.3). Cuando la aeronave se reporta lista, responde: '[Matrícula], mantenga fuera de pista, tránsito en final corto.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": num...
USER> Fase actual: Contacto inicial con Torre (mantener fuera)
Intent esperado: tower_ready_for_departure
Transcripción textual del alumno:
Torre Alfa Noviembre India en.de espera pista. listo para salida.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_hold_short

Checklist alumno:
- Reportar punto de espera pista uno cero.
- Colacionar: 'Mantengo fuera de pista' o 'A posición y mantengo'.
- Colacionar instrucciones condicionales (ej. 'detrás del tránsito').
-...
2025-12-03 19:18:44,476 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_ready_for_departure intento=1: {
  "intent": "tower_ready_for_departure",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.",
  "feedback": "Reporte inicial correcto en frecuencia de Torre. Se mantiene la instrucción de espera por tráfico en aproximación final.",
  "confidence": 0.92,
  "score": 85,
  "metadata": {
    "missingElements": [
      "No especificó 'pista 10' en el último reporte"
    ],
    "nextPhase": "tower_line_up"
  }
}
2025-12-03 19:18:44,478 | INFO | app.controllers.audio | Transición automática de fase session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 de=tower_hold_short a=tower_line_up
2025-12-03 19:18:44,609 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:18:44,610 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:18:44,610 | INFO | sqlalchemy.engine.Engine | [cached since 1190s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:18:44,630 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:18:44,631 | INFO | sqlalchemy.engine.Engine | [cached since 1030s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (24169 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 18, 44, 630105, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:18:44,645 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:18:44,661 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:18:44,662 | INFO | sqlalchemy.engine.Engine | [cached since 1017s ago] (UUID('59a76af7-64df-416b-97f8-78f4180467ce'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_line_up', 85.0, 'Reporte inicial correcto en frecuencia de Torre. Se mantiene la instrucción de espera por tráfico en aproximación final.')
2025-12-03 19:18:44,675 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:18:44,703 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_line_up score=85.00
2025-12-03 19:18:44,705 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_ready_for_departure | phase=tower_line_up | allow_response=True | text=Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.
2025-12-03 19:19:26,496 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:19:26,497 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:19:26,498 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:19:26,498 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:19:26,500 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:19:26,500 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:19:26,501 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:19:26,502 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:19:26,503 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:19:26,504 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:19:26,504 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:19:26,506 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:19:26,507 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:19:26,508 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:19:26,508 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:19:26,509 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:19:26,510 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:19:26,512 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:19:26,512 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:19:26,513 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:19:26,513 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:19:26,513 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:19:26,515 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:19:26,516 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:19:26,517 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:19:26,518 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:19:26,519 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:19:26,520 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:19:26,521 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:19:26,521 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:19:26,523 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:19:26,525 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:7300]
2025-12-03 19:19:26,528 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:19:26,658 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:26,660 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:19:26,661 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:19:26,790 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:26,792 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:19:26,794 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:19:26,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:19:26,911 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:26,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:19:27,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:27,046 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:19:27,047 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:19:27,170 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:27,170 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:19:27,176 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:27,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:19:27,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:27,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:19:27,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:19:27,406 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:19:27,407 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:19:27,410 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:19:27,412 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1256]
2025-12-03 19:19:27,413 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:19:27,413 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:19:27,691 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:19:27,695 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:19:27,698 | INFO | sqlalchemy.engine.Engine | [cached since 5133s ago] ()
2025-12-03 19:19:27,722 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:19:27,725 | INFO | sqlalchemy.engine.Engine | [cached since 1243s ago] (1,)
2025-12-03 19:19:28,765 | INFO | app.services.transcribe | Starting stream. Total bytes: 446464. Chunk size: 8192. No throttling.
2025-12-03 19:19:28,767 | DEBUG | app.services.transcribe | Streamed 8192/446464 bytes
2025-12-03 19:19:28,792 | DEBUG | app.services.transcribe | Streamed 417792/446464 bytes
2025-12-03 19:19:28,797 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:19:30,675 | DEBUG | app.services.transcribe | Received transcript chunk: mantengo fuera Alfa ...
2025-12-03 19:19:30,732 | INFO | app.services.transcribe | Transcription complete. Length: 37
2025-12-03 19:19:30,733 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: mantengo fuera Alfa Noviembre India.
2025-12-03 19:19:30,734 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=mantengo fuera Alfa Noviembre India.
2025-12-03 19:19:30,853 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:19:30,854 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:19:30,855 | INFO | sqlalchemy.engine.Engine | [cached since 1237s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:19:30,871 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:19:33,611 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:19:33,611 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:19:33,612 | INFO | sqlalchemy.engine.Engine | [cached since 1239s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:19:33,631 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:19:33,632 | INFO | sqlalchemy.engine.Engine | [cached since 1079s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (24619 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 19, 33, 630935, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:19:33,650 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:19:33,682 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_line_up intent=tower_hold_short_instruction freq=tower
2025-12-03 19:19:33,685 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_hold_short_instruction freq_group=tower
SYSTEM> Sigues en Pavas Torre. Una vez libre el tránsito, instruye: '[Matrícula], ruede a posición y mantenga pista uno cero.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "meta...
USER> Fase actual: Autorización a posición y mantener
Intent esperado: tower_hold_short_instruction
Transcripción textual del alumno:
mantengo fuera Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_line_up

Checklist alumno:
- Reconocer la instrucción anterior y estar listo.

Checklist controlador:
- Autorizar 'ruede a posición y mantenga pista uno cero'.
- Mantener fraseología local.

Cuándo responder:
- allowResponse=true con la instrucci...
2025-12-03 19:19:45,963 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_hold_short_instruction intento=1: {
  "intent": "tower_hold_short_instruction",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, ruede a posición y mantenga pista uno cero.",
  "feedback": "Se reconoce la confirmación de espera. Ahora se autoriza rodar a posición de espera en pista. Recuerde no autorizar despegue todavía.",
  "confidence": 0.92,
  "score": 85,
  "metadata": {
    "nextPhase": "tower_takeoff_clearance",
    "missingElements": [
      "Falta la frase 'ruede a posición' antes de 'mantenga pist...
2025-12-03 19:19:45,964 | INFO | app.controllers.audio | Transición automática de fase session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 de=tower_line_up a=tower_takeoff_clearance
2025-12-03 19:19:46,069 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:19:46,071 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:19:46,071 | INFO | sqlalchemy.engine.Engine | [cached since 1252s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:19:46,086 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:19:46,087 | INFO | sqlalchemy.engine.Engine | [cached since 1092s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (25990 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 19, 46, 86949, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:19:46,103 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:19:46,129 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:19:46,130 | INFO | sqlalchemy.engine.Engine | [cached since 1079s ago] (UUID('63d0471b-b163-42d7-91d6-f6b2af52d78f'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_takeoff_clearance', 85.0, 'Se reconoce la confirmación de espera. Ahora se autoriza rodar a posición de espera en pista. Recuerde no autorizar despegue todavía.')
2025-12-03 19:19:46,142 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:19:46,167 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance score=85.00
2025-12-03 19:19:46,168 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_hold_short_instruction | phase=tower_takeoff_clearance | allow_response=True | text=Alfa Noviembre India, ruede a posición y mantenga pista uno cero.
2025-12-03 19:20:14,197 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:20:14,198 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:20:14,198 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:20:14,200 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:14,201 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:20:14,202 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:20:14,202 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:14,203 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:20:14,204 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:20:14,205 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:20:14,205 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:20:14,206 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:20:14,207 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:20:14,208 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:14,208 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:20:14,210 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:20:14,211 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:14,212 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:20:14,212 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:20:14,213 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:20:14,213 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:20:14,214 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:20:14,215 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:20:14,215 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:14,216 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:20:14,217 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:20:14,217 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:14,220 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:20:14,221 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:20:14,221 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:14,222 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:20:14,223 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:20:14,225 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:20:14,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:20:14,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:14,336 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:20:14,457 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:14,459 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:14,461 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:14,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:20:14,600 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:14,601 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:14,604 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:14,606 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:20:14,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:20:14,784 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:14,786 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:20:14,925 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:14,926 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:14,928 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:20:15,046 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,047 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:15,049 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:20:15,176 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,177 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:20:15,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:20:15,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:15,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:20:15,411 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:15,412 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,414 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:20:15,533 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,533 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:15,535 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:20:15,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:15,684 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,686 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,688 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:20:15,777 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:15,779 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:15,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:769]
2025-12-03 19:20:15,782 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:20:15,782 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:20:15,946 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:20:15,947 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:20:15,948 | INFO | sqlalchemy.engine.Engine | [cached since 5182s ago] ()
2025-12-03 19:20:15,957 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:20:15,959 | INFO | sqlalchemy.engine.Engine | [cached since 1291s ago] (1,)
2025-12-03 19:20:16,431 | INFO | app.services.transcribe | Starting stream. Total bytes: 733184. Chunk size: 8192. No throttling.
2025-12-03 19:20:16,434 | DEBUG | app.services.transcribe | Streamed 8192/733184 bytes
2025-12-03 19:20:16,455 | DEBUG | app.services.transcribe | Streamed 417792/733184 bytes
2025-12-03 19:20:16,472 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:20:19,747 | DEBUG | app.services.transcribe | Received transcript chunk: a posición y manteni...
2025-12-03 19:20:19,844 | INFO | app.services.transcribe | Transcription complete. Length: 57
2025-12-03 19:20:19,846 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: a posición y manteniendo pista 10 Alfa Noviembre, India.
2025-12-03 19:20:19,847 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=a posición y manteniendo pista 10 Alfa Noviembre, India.
2025-12-03 19:20:19,960 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:20:19,961 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:20:19,962 | INFO | sqlalchemy.engine.Engine | [cached since 1286s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:20:19,978 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:20:22,607 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:20:22,608 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:20:22,609 | INFO | sqlalchemy.engine.Engine | [cached since 1288s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:20:22,623 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:20:22,624 | INFO | sqlalchemy.engine.Engine | [cached since 1128s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (26459 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 20, 22, 623342, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:20:22,640 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:20:22,666 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance intent=tower_position_report freq=tower
2025-12-03 19:20:22,668 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_position_report freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_position_report
Transcripción textual del alumno:
a posición y manteniendo pista 10 Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ve...
2025-12-03 19:20:35,417 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_position_report intento=1: {
  "intent": "tower_position_report",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Falta la autorización de despegue. Debes esperar a recibir 'AUTORIZADO DESPEGAR' antes de iniciar carrera. Corrige: 'Alfa Noviembre India, listo para despegar pista 10'.",
  "confidence": 0.85,
  "score": 40,
  "metadata": {
    "missingItems": [
      "AUTORIZADO DESPEGAR",
      "Restricciones de ascenso",
      "Reporte de altitud"
    ],
    "nextPhase": null
  }
}
2025-12-03 19:20:35,528 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:20:35,528 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:20:35,529 | INFO | sqlalchemy.engine.Engine | [cached since 1301s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:20:35,545 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:20:35,546 | INFO | sqlalchemy.engine.Engine | [cached since 1141s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (27690 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 20, 35, 545887, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:20:35,562 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:20:35,591 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:20:35,593 | INFO | sqlalchemy.engine.Engine | [cached since 1128s ago] (UUID('b7270eb9-b48c-46ba-906a-1a9e094d9299'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_takeoff_clearance', 40.0, "Falta la autorización de despegue. Debes esperar a recibir 'AUTORIZADO DESPEGAR' antes de iniciar carrera. Corrige: 'Alfa Noviembre India, listo para despegar pista 10'.")
2025-12-03 19:20:35,605 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:20:35,638 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance score=40.00
2025-12-03 19:20:35,640 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_position_report | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:20:59,726 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:20:59,726 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:20:59,727 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:20:59,728 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:59,729 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:20:59,730 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:20:59,730 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:59,731 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:20:59,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:20:59,733 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:20:59,734 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:20:59,734 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:20:59,734 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:20:59,735 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:59,736 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:20:59,736 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:20:59,737 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:59,739 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:20:59,740 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:20:59,740 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:20:59,741 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:20:59,741 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:20:59,742 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:20:59,743 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:59,744 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:20:59,744 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:20:59,745 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:59,746 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:20:59,746 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:20:59,748 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:20:59,749 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:20:59,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:4380]
2025-12-03 19:20:59,753 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:59,755 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:20:59,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:59,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:59,859 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:20:59,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:20:59,990 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:20:59,993 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:21:00,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,168 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:21:00,320 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:21:00,323 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:21:00,442 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:21:00,443 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,445 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:21:00,556 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:21:00,559 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,561 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:21:00,674 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,676 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:21:00,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:21:00,728 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3096]
2025-12-03 19:21:00,730 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:21:00,731 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:21:00,873 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:21:00,874 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:21:00,875 | INFO | sqlalchemy.engine.Engine | [cached since 5226s ago] ()
2025-12-03 19:21:00,883 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:21:00,884 | INFO | sqlalchemy.engine.Engine | [cached since 1336s ago] (1,)
2025-12-03 19:21:01,697 | INFO | app.services.transcribe | Starting stream. Total bytes: 477184. Chunk size: 8192. No throttling.
2025-12-03 19:21:01,700 | DEBUG | app.services.transcribe | Streamed 8192/477184 bytes
2025-12-03 19:21:01,729 | DEBUG | app.services.transcribe | Streamed 417792/477184 bytes
2025-12-03 19:21:01,735 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:21:03,670 | DEBUG | app.services.transcribe | Received transcript chunk: a posición y manteni...
2025-12-03 19:21:03,721 | INFO | app.services.transcribe | Transcription complete. Length: 35
2025-12-03 19:21:03,722 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: a posición y manteniendo pista 10.
2025-12-03 19:21:03,723 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=a posición y manteniendo pista 10.
2025-12-03 19:21:03,850 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:21:03,852 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:21:03,853 | INFO | sqlalchemy.engine.Engine | [cached since 1330s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:21:03,872 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:21:04,617 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:21:04,618 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:21:04,619 | INFO | sqlalchemy.engine.Engine | [cached since 1330s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:21:04,639 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:21:04,641 | INFO | sqlalchemy.engine.Engine | [cached since 1170s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (28137 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 21, 4, 639981, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:21:04,656 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:21:04,688 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance intent=tower_position_report freq=tower
2025-12-03 19:21:04,691 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_position_report freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_position_report
Transcripción textual del alumno:
a posición y manteniendo pista 10.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver data).
- Dar pista (...
2025-12-03 19:21:14,167 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_position_report intento=1: {
  "intent": "tower_position_report",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persiste el error de no solicitar autorización de despegue. Recuerda: debes esperar la instrucción 'AUTORIZADO DESPEGAR' antes de iniciar carrera. Vuelve a intentar con: 'Alfa Noviembre India, listo para despegar pista 10'.",
  "confidence": 0.92,
  "score": 30,
  "metadata": {
    "missingItems": [
      "AUTORIZADO DESPEGAR"
    ],
    "nextStep": "Esperar autorización explícita de desp...
2025-12-03 19:21:14,285 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:21:14,288 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:21:14,290 | INFO | sqlalchemy.engine.Engine | [cached since 1340s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:21:14,310 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:21:14,311 | INFO | sqlalchemy.engine.Engine | [cached since 1180s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (29470 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 21, 14, 310028, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:21:14,325 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:21:14,354 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:21:14,356 | INFO | sqlalchemy.engine.Engine | [cached since 1167s ago] (UUID('acbec184-135d-4f72-b61f-dc45de645b1b'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_takeoff_clearance', 30.0, "Persiste el error de no solicitar autorización de despegue. Recuerda: debes esperar la instrucción 'AUTORIZADO DESPEGAR' antes de iniciar carrera. Vuelve a intentar con: 'Alfa Noviembre India, listo para despegar pista 10'.")
2025-12-03 19:21:14,366 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:21:14,396 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance score=30.00
2025-12-03 19:21:14,397 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_position_report | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:22:39,373 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:22:39,375 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:22:39,376 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:22:39,378 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:22:39,379 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:22:39,381 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:22:39,382 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:22:39,383 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:22:39,384 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:22:39,384 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:22:39,386 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:22:39,387 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:22:39,387 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:22:39,388 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:22:39,390 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:22:39,390 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:22:39,392 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:22:39,392 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:22:39,393 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:22:39,394 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:22:39,395 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:22:39,396 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:22:39,397 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:22:39,398 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:22:39,400 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:22:39,401 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:22:39,402 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:22:39,403 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:22:39,404 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:22:39,405 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:22:39,406 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:22:39,408 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:22:39,410 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:39,412 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:22:39,546 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:22:39,548 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:39,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:39,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:39,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:39,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:39,815 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:39,816 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:39,955 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:39,956 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:39,959 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,078 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:40,080 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,082 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,206 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:40,208 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,211 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,331 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:40,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,452 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,453 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:40,455 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,565 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:40,566 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,568 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:40,686 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,688 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,817 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,818 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:40,822 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:40,957 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:22:40,960 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:40,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:22:41,072 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:22:41,074 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:22:41,193 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:41,195 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:41,196 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:22:41,196 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:22:41,308 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:41,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:22:41,312 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:22:41,313 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:22:41,380 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:22:41,382 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:123]
2025-12-03 19:22:41,382 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:22:41,383 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:22:41,507 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:22:41,508 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:22:41,510 | INFO | sqlalchemy.engine.Engine | [cached since 5327s ago] ()
2025-12-03 19:22:41,515 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:22:41,515 | INFO | sqlalchemy.engine.Engine | [cached since 1437s ago] (1,)
2025-12-03 19:22:42,439 | INFO | app.services.transcribe | Starting stream. Total bytes: 968704. Chunk size: 8192. No throttling.
2025-12-03 19:22:42,441 | DEBUG | app.services.transcribe | Streamed 8192/968704 bytes
2025-12-03 19:22:42,460 | DEBUG | app.services.transcribe | Streamed 417792/968704 bytes
2025-12-03 19:22:42,481 | DEBUG | app.services.transcribe | Streamed 827392/968704 bytes
2025-12-03 19:22:42,488 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:22:44,041 | DEBUG | app.services.transcribe | Received transcript chunk: autorizado a despega...
2025-12-03 19:22:47,642 | DEBUG | app.services.transcribe | Received transcript chunk: 10. Mantengo el rumb...
2025-12-03 19:22:47,756 | INFO | app.services.transcribe | Transcription complete. Length: 105
2025-12-03 19:22:47,757 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: autorizado a despegar. 10. Mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.
2025-12-03 19:22:47,759 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=autorizado a despegar. 10. Mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.
2025-12-03 19:22:48,149 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:22:48,153 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:22:48,159 | INFO | sqlalchemy.engine.Engine | [cached since 1434s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:22:48,201 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:22:48,941 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:22:48,941 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:22:48,942 | INFO | sqlalchemy.engine.Engine | [cached since 1435s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:22:48,959 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:22:48,959 | INFO | sqlalchemy.engine.Engine | [cached since 1275s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (29989 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 22, 48, 958960, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:22:48,974 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:22:49,003 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance intent=tower_takeoff_clearance freq=tower
2025-12-03 19:22:49,005 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_takeoff_clearance freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_takeoff_clearance
Transcripción textual del alumno:
autorizado a despegar. 10. Mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de ...
2025-12-03 19:22:58,190 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_takeoff_clearance intento=1: {
  "intent": "tower_takeoff_clearance",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Has invertido los roles: estás dando la autorización de despegue en lugar de recibirla. Recuerda que en esta fase debes esperar la instrucción 'AUTORIZADO DESPEGAR' del controlador. Corrige diciendo: 'Alfa Noviembre India, listo para despegar pista 10'.",
  "confidence": 0.82,
  "score": 45,
  "metadata": {
    "missingItems": [
      "Solicitud de autorización de despegue"
    ],
    "...
2025-12-03 19:22:58,350 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:22:58,351 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:22:58,352 | INFO | sqlalchemy.engine.Engine | [cached since 1444s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:22:58,369 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:22:58,370 | INFO | sqlalchemy.engine.Engine | [cached since 1284s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (31296 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 22, 58, 369309, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:22:58,383 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:22:58,418 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:22:58,420 | INFO | sqlalchemy.engine.Engine | [cached since 1271s ago] (UUID('455eaf2e-3392-4324-a5d5-9bcb64e6bbea'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_takeoff_clearance', 45.0, "Has invertido los roles: estás dando la autorización de despegue en lugar de recibirla. Recuerda que en esta fase debes esperar la instrucción 'AUTORIZADO DESPEGAR' del controlador. Corrige diciendo: 'Alfa Noviembre India, listo para despegar pista 10'.")
2025-12-03 19:22:58,437 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:22:58,475 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance score=45.00
2025-12-03 19:22:58,478 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_takeoff_clearance | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:23:33,517 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:23:33,517 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:23:33,518 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:23:33,518 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:23:33,521 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:23:33,521 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:23:33,522 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:23:33,523 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:23:33,524 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:23:33,526 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:23:33,527 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:23:33,527 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:23:33,528 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:23:33,528 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:23:33,530 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:23:33,530 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:23:33,532 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:23:33,533 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:23:33,534 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:23:33,535 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:23:33,536 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:23:33,537 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:23:33,538 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:23:33,540 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:23:33,542 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:23:33,543 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:23:33,544 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:23:33,545 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:23:33,546 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:23:33,547 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:23:33,548 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:23:33,550 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:1460]
2025-12-03 19:23:33,552 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:33,556 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:33,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:33,695 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:33,696 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:33,821 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:33,823 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:33,825 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:33,826 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:23:33,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:33,949 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2919]
2025-12-03 19:23:33,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 19:23:33,951 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:23:34,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:23:34,067 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:23:34,190 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:34,192 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,193 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:34,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:23:34,317 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,321 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,323 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:34,440 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:34,441 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,444 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:34,567 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,569 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,570 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:34,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:34,696 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,697 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:23:34,835 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:34,837 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,840 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:34,964 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:34,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:34,966 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:35,094 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:23:35,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:23:35,097 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:23:35,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:895]
2025-12-03 19:23:35,114 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:23:35,114 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:23:35,241 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:23:35,243 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:23:35,244 | INFO | sqlalchemy.engine.Engine | [cached since 5381s ago] ()
2025-12-03 19:23:35,254 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:23:35,255 | INFO | sqlalchemy.engine.Engine | [cached since 1490s ago] (1,)
2025-12-03 19:23:36,180 | INFO | app.services.transcribe | Starting stream. Total bytes: 761856. Chunk size: 8192. No throttling.
2025-12-03 19:23:36,183 | DEBUG | app.services.transcribe | Streamed 8192/761856 bytes
2025-12-03 19:23:36,203 | DEBUG | app.services.transcribe | Streamed 417792/761856 bytes
2025-12-03 19:23:36,225 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:23:38,290 | DEBUG | app.services.transcribe | Received transcript chunk: a posición y manteni...
2025-12-03 19:23:39,372 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-03 19:23:39,471 | INFO | app.services.transcribe | Transcription complete. Length: 55
2025-12-03 19:23:39,472 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: a posición y manteniendo pista. Alfa Noviembre, India.
2025-12-03 19:23:39,474 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=a posición y manteniendo pista. Alfa Noviembre, India.
2025-12-03 19:23:39,602 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:23:39,603 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:23:39,603 | INFO | sqlalchemy.engine.Engine | [cached since 1485s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:23:39,621 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:23:42,997 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:23:42,998 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:23:43,000 | INFO | sqlalchemy.engine.Engine | [cached since 1489s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:23:43,020 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:23:43,022 | INFO | sqlalchemy.engine.Engine | [cached since 1329s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (31763 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 23, 43, 20341, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:23:43,043 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:23:43,074 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance intent=tower_position_report freq=tower
2025-12-03 19:23:43,077 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_position_report freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_position_report
Transcripción textual del alumno:
a posición y manteniendo pista. Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver ...
2025-12-03 19:23:57,015 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_position_report intento=1: {
  "intent": "tower_position_report",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Nuevamente estás reportando posición en lugar de solicitar autorización. Debes esperar la instrucción 'AUTORIZADO DESPEGAR' del controlador. Corrige diciendo: 'Alfa Noviembre India, listo para despegar pista 10'.",
  "confidence": 0.92,
  "score": 35,
  "metadata": {
    "missingItems": [
      "AUTORIZADO DESPEGAR"
    ],
    "nextStep": "Esperar autorización de despegue"
  }
}
2025-12-03 19:23:57,129 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:23:57,130 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:23:57,130 | INFO | sqlalchemy.engine.Engine | [cached since 1503s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:23:57,149 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:23:57,150 | INFO | sqlalchemy.engine.Engine | [cached since 1343s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (33066 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 23, 57, 148140, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:23:57,167 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:23:57,183 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:23:57,184 | INFO | sqlalchemy.engine.Engine | [cached since 1330s ago] (UUID('39cb2bd8-40e1-4cc2-a257-740be343333e'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_takeoff_clearance', 35.0, "Nuevamente estás reportando posición en lugar de solicitar autorización. Debes esperar la instrucción 'AUTORIZADO DESPEGAR' del controlador. Corrige diciendo: 'Alfa Noviembre India, listo para despegar pista 10'.")
2025-12-03 19:23:57,197 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:23:57,226 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance score=35.00
2025-12-03 19:23:57,227 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_position_report | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:26:26,813 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:26:26,814 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:26:26,815 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:26:26,816 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:26:26,817 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:26:26,818 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:26:26,819 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:26:26,820 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:26:26,821 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:26:26,822 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:26:26,823 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:26:26,824 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:26:26,825 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:26:26,827 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:26:26,828 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:26:26,829 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:26:26,830 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:26:26,832 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:26:26,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:26:26,836 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:26:26,836 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:26:26,839 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:26:26,840 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:26:26,841 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:26:26,844 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:26:26,845 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:26:26,847 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:26:26,848 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:26:26,849 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:26:26,849 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:26:26,851 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:26:26,854 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:2920]
2025-12-03 19:26:26,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:26:26,977 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:26,979 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:26:27,099 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:26:27,100 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:27,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:26:27,222 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:27,223 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:26:27,226 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:27,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:26:27,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:26:27,349 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:26:27,467 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:26:27,469 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:27,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:26:27,601 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:26:27,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:26:27,726 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:27,728 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:27,730 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:26:27,880 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:27,884 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:26:27,887 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:26:28,089 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:26:28,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:26:28,097 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:26:28,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:26:28,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:26:28,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:26:28,352 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:26:28,355 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:742]
2025-12-03 19:26:28,356 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:26:28,357 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:26:28,598 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:26:28,600 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:26:28,602 | INFO | sqlalchemy.engine.Engine | [cached since 5554s ago] ()
2025-12-03 19:26:28,613 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:26:28,615 | INFO | sqlalchemy.engine.Engine | [cached since 1664s ago] (1,)
2025-12-03 19:26:29,580 | INFO | app.services.transcribe | Starting stream. Total bytes: 651264. Chunk size: 8192. No throttling.
2025-12-03 19:26:29,581 | DEBUG | app.services.transcribe | Streamed 8192/651264 bytes
2025-12-03 19:26:29,604 | DEBUG | app.services.transcribe | Streamed 417792/651264 bytes
2025-12-03 19:26:29,618 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:26:31,522 | DEBUG | app.services.transcribe | Received transcript chunk: en posición y listo ...
2025-12-03 19:26:32,390 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre India...
2025-12-03 19:26:32,436 | INFO | app.services.transcribe | Transcription complete. Length: 57
2025-12-03 19:26:32,437 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: en posición y listo para despegar. Alfa Noviembre India.
2025-12-03 19:26:32,438 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=en posición y listo para despegar. Alfa Noviembre India.
2025-12-03 19:26:32,551 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:26:32,551 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:26:32,552 | INFO | sqlalchemy.engine.Engine | [cached since 1658s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:26:32,570 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:26:33,343 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:26:33,344 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:26:33,346 | INFO | sqlalchemy.engine.Engine | [cached since 1659s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:26:33,364 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:26:33,365 | INFO | sqlalchemy.engine.Engine | [cached since 1499s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (33537 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 26, 33, 364414, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:26:33,383 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:26:33,422 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_takeoff_clearance intent=tower_ready_for_takeoff freq=tower
2025-12-03 19:26:33,425 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_ready_for_takeoff freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_ready_for_takeoff
Transcripción textual del alumno:
en posición y listo para despegar. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (...
2025-12-03 19:26:44,943 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_ready_for_takeoff intento=1: {
  "intent": "tower_ready_for_takeoff",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, viento 080 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.",
  "feedback": "Has corregido la fraseología y estás listo para recibir autorización. Ahora puedes proceder con el despegue tras recibir la instrucción 'AUTORIZADO DESPEGAR'.",
  "confidence": 0.92,
  "score": 85,
  "metadata": {
    "nextPhase": "tower_initial_cl...
2025-12-03 19:26:44,945 | INFO | app.controllers.audio | Transición automática de fase session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 de=tower_takeoff_clearance a=tower_initial_climb
2025-12-03 19:26:45,056 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:26:45,057 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:26:45,058 | INFO | sqlalchemy.engine.Engine | [cached since 1671s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:26:45,077 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:26:45,078 | INFO | sqlalchemy.engine.Engine | [cached since 1511s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (35110 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 26, 45, 76220, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:26:45,095 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:26:45,125 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:26:45,126 | INFO | sqlalchemy.engine.Engine | [cached since 1498s ago] (UUID('fbd1f62c-5684-4a5b-9bab-6cd4bef3f709'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'tower_initial_climb', 85.0, "Has corregido la fraseología y estás listo para recibir autorización. Ahora puedes proceder con el despegue tras recibir la instrucción 'AUTORIZADO DESPEGAR'.")
2025-12-03 19:26:45,137 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:26:45,168 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_initial_climb score=85.00
2025-12-03 19:26:45,170 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_ready_for_takeoff | phase=tower_initial_climb | allow_response=True | text=Alfa Noviembre India, viento 080 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.
2025-12-03 19:28:08,500 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:28:08,501 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:28:08,502 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:28:08,503 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:28:08,505 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:28:08,506 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:28:08,508 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:28:08,508 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:28:08,511 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:28:08,511 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:28:08,512 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:28:08,513 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:28:08,514 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:28:08,515 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:28:08,517 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:28:08,518 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:28:08,520 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:28:08,521 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:28:08,523 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:28:08,524 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:28:08,525 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:28:08,527 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:28:08,530 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:28:08,532 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:28:08,534 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:28:08,538 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:28:08,541 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:28:08,543 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:28:08,544 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:28:08,547 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:28:08,548 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:28:08,551 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 19:28:08,555 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:28:08,727 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:28:08,728 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:08,730 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:28:08,850 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:08,851 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:08,853 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:08,978 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:08,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:08,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:09,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,108 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:28:09,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:28:09,231 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,232 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:09,233 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:09,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:09,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,352 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:09,482 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,484 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:09,485 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:09,611 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,612 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:09,613 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:09,730 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:09,731 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:09,847 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,848 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:28:09,850 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:28:09,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:09,967 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:09,969 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:09,970 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:28:10,086 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:10,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:10,090 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:10,092 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:28:10,214 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:10,215 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:10,217 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:28:10,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:28:10,337 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:10,339 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:28:10,433 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:28:10,435 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:10,436 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:28:10,438 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:941]
2025-12-03 19:28:10,439 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:28:10,440 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:28:10,603 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:28:10,604 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:28:10,605 | INFO | sqlalchemy.engine.Engine | [cached since 5656s ago] ()
2025-12-03 19:28:10,614 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:28:10,615 | INFO | sqlalchemy.engine.Engine | [cached since 1766s ago] (1,)
2025-12-03 19:28:11,568 | INFO | app.services.transcribe | Starting stream. Total bytes: 925696. Chunk size: 8192. No throttling.
2025-12-03 19:28:11,571 | DEBUG | app.services.transcribe | Streamed 8192/925696 bytes
2025-12-03 19:28:11,596 | DEBUG | app.services.transcribe | Streamed 417792/925696 bytes
2025-12-03 19:28:11,618 | DEBUG | app.services.transcribe | Streamed 827392/925696 bytes
2025-12-03 19:28:11,626 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:28:15,247 | DEBUG | app.services.transcribe | Received transcript chunk: autorizado a despega...
2025-12-03 19:28:15,350 | INFO | app.services.transcribe | Transcription complete. Length: 113
2025-12-03 19:28:15,352 | INFO | app.controllers.audio | Transcripción recibida session=26676720-41ff-40e2-9375-5b3fb9e1d3d0: autorizado a despegar en pista 10. Mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.
2025-12-03 19:28:15,353 | INFO | app.logs.transcript | student | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | text=autorizado a despegar en pista 10. Mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.
2025-12-03 19:28:15,482 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:28:15,484 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:28:15,484 | INFO | sqlalchemy.engine.Engine | [cached since 1761s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:28:15,502 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:28:16,245 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:28:16,246 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:28:16,247 | INFO | sqlalchemy.engine.Engine | [cached since 1762s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:28:16,266 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:28:16,267 | INFO | sqlalchemy.engine.Engine | [cached since 1602s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (35637 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 28, 16, 266272, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:28:16,284 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:28:16,313 | INFO | app.controllers.audio | Fase activa session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=tower_initial_climb intent=tower_takeoff_clearance freq=tower
2025-12-03 19:28:16,316 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_takeoff_clearance freq_group=tower
SYSTEM> Ya en ascenso; al reportar 5000 pies instruyes cambio a COCO Aproximación. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe ser ...
USER> Fase actual: Reporte pasando 5000 y transferencia a Aproximación
Intent esperado: tower_takeoff_clearance
Transcripción textual del alumno:
autorizado a despegar en pista 10. Mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_initial_climb

Checklist alumno:
- Reportar pasando 5000 pies.
- NO decir: 'Coco Aproximación' todavía (sigues con Torre).

Checklist controlador:
- Agradecer...
2025-12-03 19:28:31,342 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_takeoff_clearance intento=1: {
  "intent": "tower_departure_handoff",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, recibido. Contacte COCO Aproximación 120.5. Buen día.",
  "feedback": "Has reportado correctamente el ascenso a 5000 pies. Sin embargo, no debes repetir la autorización de despegue ('autorizado a despegar') ya que estás en fase de reporte. La transferencia a Aproximación se realiza correctamente.",
  "confidence": 0.85,
  "score": 82,
  "metadata": {
    "nextPhase": "approach_contact"...
2025-12-03 19:28:31,344 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (tower_departure_handoff) difiere del esperado (tower_takeoff_clearance)
2025-12-03 19:28:31,345 | INFO | app.controllers.audio | Transición automática de fase session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 de=tower_initial_climb a=approach_contact
2025-12-03 19:28:31,491 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:28:31,491 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:28:31,492 | INFO | sqlalchemy.engine.Engine | [cached since 1777s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:28:31,508 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:28:31,509 | INFO | sqlalchemy.engine.Engine | [cached since 1617s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (37469 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0531", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 3, 19, 28, 31, 507319, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('62b6f029-c2ad-4329-8b64-d63ae9b05eff'))
2025-12-03 19:28:31,522 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:28:31,547 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:28:31,549 | INFO | sqlalchemy.engine.Engine | [cached since 1604s ago] (UUID('3930be6a-2f25-4339-a616-65dcbd2cd723'), UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'), 1, 'approach_contact', 82.0, "Has reportado correctamente el ascenso a 5000 pies. Sin embargo, no debes repetir la autorización de despegue ('autorizado a despegar') ya que estás en fase de reporte. La transferencia a Aproximación se realiza correctamente.")
2025-12-03 19:28:31,561 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:28:31,588 | INFO | app.controllers.audio | Puntuación guardada session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 phase_id=approach_contact score=82.00
2025-12-03 19:28:31,589 | INFO | app.logs.transcript | controller | session=26676720-41ff-40e2-9375-5b3fb9e1d3d0 | frequency=118.300 | intent=tower_departure_handoff | phase=approach_contact | allow_response=True | text=Alfa Noviembre India, recibido. Contacte COCO Aproximación 120.5. Buen día.
2025-12-03 19:30:20,897 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:20,898 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:20,900 | INFO | sqlalchemy.engine.Engine | [cached since 5786s ago] ()
2025-12-03 19:30:20,901 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:20,902 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:20,903 | INFO | sqlalchemy.engine.Engine | [cached since 5786s ago] ()
2025-12-03 19:30:20,912 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:20,913 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:20,916 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:20,917 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:20,925 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:20,926 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:20,928 | INFO | sqlalchemy.engine.Engine | [cached since 5786s ago] ()
2025-12-03 19:30:20,939 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:20,940 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:20,974 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:20,975 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:20,976 | INFO | sqlalchemy.engine.Engine | [cached since 5787s ago] ()
2025-12-03 19:30:20,986 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:20,988 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:21,044 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:21,046 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:21,050 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:21,051 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:21,055 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:21,058 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:21,062 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 19:30:21,064 | INFO | sqlalchemy.engine.Engine | [cached since 1894s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 19:30:21,068 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 19:30:21,070 | INFO | sqlalchemy.engine.Engine | [cached since 1894s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 19:30:21,074 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 19:30:21,075 | INFO | sqlalchemy.engine.Engine | [cached since 1894s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 19:30:21,097 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:30:21,101 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:30:21,103 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:30:21,107 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:21,108 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] (1,)
2025-12-03 19:30:21,115 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 19:30:21,117 | INFO | sqlalchemy.engine.Engine | [cached since 1894s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 19:30:21,146 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:30:26,847 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:26,848 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:26,850 | INFO | sqlalchemy.engine.Engine | [cached since 5792s ago] ()
2025-12-03 19:30:26,858 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:26,859 | INFO | sqlalchemy.engine.Engine | [cached since 1902s ago] (1,)
2025-12-03 19:30:26,962 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:30:26,963 | INFO | sqlalchemy.engine.Engine | [cached since 1893s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:30:26,977 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-03 19:30:26,978 | INFO | sqlalchemy.engine.Engine | [cached since 1893s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:30:26,994 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:30:26,995 | INFO | sqlalchemy.engine.Engine | [cached since 1893s ago] (UUID('26676720-41ff-40e2-9375-5b3fb9e1d3d0'),)
2025-12-03 19:30:27,000 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:30:27,238 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:27,239 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:27,240 | INFO | sqlalchemy.engine.Engine | [cached since 5793s ago] ()
2025-12-03 19:30:27,250 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:27,251 | INFO | sqlalchemy.engine.Engine | [cached since 1902s ago] (1,)
2025-12-03 19:30:27,263 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:27,263 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:27,264 | INFO | sqlalchemy.engine.Engine | [cached since 5793s ago] ()
2025-12-03 19:30:27,274 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:27,275 | INFO | sqlalchemy.engine.Engine | [cached since 1902s ago] (1,)
2025-12-03 19:30:27,345 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:27,346 | INFO | sqlalchemy.engine.Engine | [cached since 1902s ago] (1,)
2025-12-03 19:30:27,348 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:27,350 | INFO | sqlalchemy.engine.Engine | [cached since 1902s ago] (1,)
2025-12-03 19:30:27,353 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 19:30:27,353 | INFO | sqlalchemy.engine.Engine | [cached since 1900s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 19:30:27,356 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 19:30:27,358 | INFO | sqlalchemy.engine.Engine | [cached since 1900s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 19:30:27,372 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:30:27,378 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:30:40,568 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:30:40,569 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:30:40,570 | INFO | sqlalchemy.engine.Engine | [cached since 5806s ago] ()
2025-12-03 19:30:40,578 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:40,579 | INFO | sqlalchemy.engine.Engine | [cached since 1916s ago] (1,)
2025-12-03 19:30:40,664 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:30:40,665 | INFO | sqlalchemy.engine.Engine | [cached since 1906s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 19:30:40,680 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:30:40,680 | INFO | sqlalchemy.engine.Engine | [cached since 1916s ago] (1,)
2025-12-03 19:30:40,685 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:30:58,510 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-03 19:30:58,620 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D4A831D0>
2025-12-03 19:30:58,621 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x00000254D4A51AC0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-03 19:30:58,748 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D4A7F990>
2025-12-03 19:30:58,748 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-03 19:30:58,750 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-03 19:30:58,750 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-03 19:30:58,752 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-03 19:30:58,753 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-03 19:30:58,878 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 04 Dec 2025 01:30:59 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'471'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1d7-bqgyMnm85OuYCOIZOquANnMmyP4"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251204T013059Z-1654ff75797qvtlbhC1MIA56nn00000031t000000000echn'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-03 19:30:58,880 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-03 19:30:58,881 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-03 19:30:58,882 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-03 19:30:58,882 | DEBUG | httpcore.http11 | response_closed.started
2025-12-03 19:30:58,883 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-03 19:30:58,884 | DEBUG | httpcore.connection | close.started
2025-12-03 19:30:58,885 | DEBUG | httpcore.connection | close.complete
2025-12-03 19:31:05,707 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:31:05,708 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:31:05,710 | INFO | sqlalchemy.engine.Engine | [cached since 5831s ago] ()
2025-12-03 19:31:05,717 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:31:05,718 | INFO | sqlalchemy.engine.Engine | [cached since 1941s ago] (1,)
2025-12-03 19:31:05,807 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-03 19:31:05,808 | INFO | sqlalchemy.engine.Engine | [cached since 1832s ago] (UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "080", "windSpeed": "9", "temp": "22", "dewp": "16", "cloudCover": "FEW", "cloudBase": "4000", "wind": "080/9"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 3, 19, 31, 5, 807511, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 3, 19, 31, 5, 807511, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-03 19:31:05,818 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:31:06,050 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:31:06,051 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-03 19:31:06,052 | INFO | sqlalchemy.engine.Engine | [cached since 1832s ago] (UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'),)
2025-12-03 19:31:06,075 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:32:37,799 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:32:37,800 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:32:37,801 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:32:37,802 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:32:37,802 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:32:37,803 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:32:37,803 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:32:37,803 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:32:37,805 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:32:37,807 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:32:37,807 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:32:37,808 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:32:37,809 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:32:37,810 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:32:37,811 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:32:37,812 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:32:37,813 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:32:37,814 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:32:37,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:32:37,816 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:32:37,816 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:32:37,817 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:32:37,818 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:32:37,819 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:32:37,819 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:32:37,821 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:32:37,822 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:32:37,823 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:32:37,824 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:32:37,825 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:32:37,826 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:32:37,828 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 19:32:37,831 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:37,834 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:37,963 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:37,964 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:37,966 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:38,140 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:38,143 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:38,147 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:38,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:38,327 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:38,331 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:32:38,334 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:38,530 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:38,533 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:38,740 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:38,743 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:38,745 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:32:38,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:38,920 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:38,922 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:38,923 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:39,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,067 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:39,070 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:39,073 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:32:39,233 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,234 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:39,236 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,238 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:39,363 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,364 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,366 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:32:39,497 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:39,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:39,501 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:32:39,624 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,626 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:39,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:39,764 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:39,766 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:39,881 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,882 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:39,884 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:39,887 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:40,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,009 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:40,012 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:40,014 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:40,125 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:40,127 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:40,245 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,247 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,248 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,252 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:40,378 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,381 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:40,382 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:40,384 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:40,543 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,546 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:40,550 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:40,701 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:40,703 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,706 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:40,841 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,843 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,846 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,848 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:40,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:40,975 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:40,976 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:41,100 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:41,103 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,105 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:41,290 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:41,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:32:41,533 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,535 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:41,536 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:41,540 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:41,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,689 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,691 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:32:41,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:41,822 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:41,824 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,827 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:41,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:41,976 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:41,979 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:41,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:32:42,158 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:42,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:42,163 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:42,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:42,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:42,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:42,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:32:42,413 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:42,414 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:42,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:42,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:32:42,535 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:32:42,536 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:32:42,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:32:42,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2863]
2025-12-03 19:32:42,583 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:32:42,583 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:32:42,715 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:32:42,716 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:32:42,717 | INFO | sqlalchemy.engine.Engine | [cached since 5928s ago] ()
2025-12-03 19:32:42,727 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:32:42,728 | INFO | sqlalchemy.engine.Engine | [cached since 2038s ago] (1,)
2025-12-03 19:32:43,860 | INFO | app.services.transcribe | Starting stream. Total bytes: 1888256. Chunk size: 8192. No throttling.
2025-12-03 19:32:43,864 | DEBUG | app.services.transcribe | Streamed 8192/1888256 bytes
2025-12-03 19:32:43,904 | DEBUG | app.services.transcribe | Streamed 417792/1888256 bytes
2025-12-03 19:32:43,947 | DEBUG | app.services.transcribe | Streamed 827392/1888256 bytes
2025-12-03 19:32:43,983 | DEBUG | app.services.transcribe | Streamed 1236992/1888256 bytes
2025-12-03 19:32:44,013 | DEBUG | app.services.transcribe | Streamed 1646592/1888256 bytes
2025-12-03 19:32:44,020 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:32:54,256 | DEBUG | app.services.transcribe | Received transcript chunk: Pas superficie Alfa ...
2025-12-03 19:32:54,499 | INFO | app.services.transcribe | Transcription complete. Length: 178
2025-12-03 19:32:54,500 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: Pas superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo niveles, dos almas a bordo autonomía, cinco horas.
2025-12-03 19:32:54,500 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=121.700 | text=Pas superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo niveles, dos almas a bordo autonomía, cinco horas.
2025-12-03 19:32:54,611 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:32:54,613 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:32:54,614 | INFO | sqlalchemy.engine.Engine | [cached since 2040s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:32:54,628 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:32:55,376 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:32:55,377 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:32:55,378 | INFO | sqlalchemy.engine.Engine | [cached since 2041s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:32:55,393 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:32:55,394 | INFO | sqlalchemy.engine.Engine | [cached since 1881s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (14599 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-04T01:32:55Z"}]}', datetime.datetime(2025, 12, 3, 19, 32, 55, 393206, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:32:55,408 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:32:55,443 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-03 19:32:55,447 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0526. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": str...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
Pas superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo niveles, dos almas a bordo autonomía, cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicació...
2025-12-03 19:33:05,680 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0526. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, nivel inicial, almas y autonomía. Proceda con autorización de rodaje.",
  "confidence":...
2025-12-03 19:33:05,682 | INFO | app.controllers.audio | Transición automática de fase session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 de=ground_departure_request a=ground_readback
2025-12-03 19:33:05,801 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:33:05,802 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:33:05,803 | INFO | sqlalchemy.engine.Engine | [cached since 2052s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:33:05,823 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:33:05,824 | INFO | sqlalchemy.engine.Engine | [cached since 1892s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (16109 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 33, 5, 823896, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:33:05,835 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:33:05,863 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:33:05,864 | INFO | sqlalchemy.engine.Engine | [cached since 1878s ago] (UUID('deb9f08b-39fd-406d-b657-2092b5dc2942'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'ground_readback', 95.0, 'Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, nivel inicial, almas y autonomía. Proceda con autorización de rodaje.')
2025-12-03 19:33:05,875 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:33:05,904 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=ground_readback score=95.00
2025-12-03 19:33:05,905 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0526. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.
2025-12-03 19:33:51,997 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:33:51,998 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:33:51,998 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:33:51,999 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:33:52,000 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:33:52,001 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:33:52,001 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:33:52,001 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:33:52,003 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:33:52,003 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:33:52,004 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:33:52,005 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:33:52,006 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:33:52,006 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:33:52,007 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:33:52,007 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:33:52,008 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:33:52,008 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:33:52,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:33:52,011 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:33:52,012 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:33:52,013 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:33:52,014 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:33:52,014 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:33:52,015 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:33:52,015 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:33:52,016 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:33:52,017 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:33:52,017 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:33:52,019 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:33:52,020 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:33:52,021 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:33:52,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:52,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:33:52,138 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:33:52,140 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:52,257 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:52,258 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,260 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:52,374 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,375 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,379 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:52,500 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:52,503 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,504 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:52,663 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,665 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:52,667 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:52,798 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:52,803 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:52,927 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:52,928 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:52,930 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:53,051 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,052 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,054 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:53,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,180 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,182 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:53,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:53,417 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,420 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,422 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:33:53,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,540 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,543 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,544 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:33:53,668 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,669 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,672 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,674 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:33:53,828 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:33:53,832 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:33:53,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:53,963 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:53,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:54,082 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,083 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,085 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:54,201 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,202 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,204 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,207 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:33:54,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,326 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:54,462 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:33:54,581 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,583 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,585 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:33:54,707 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,709 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 19:33:54,711 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:33:54,826 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,828 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,832 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:33:54,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:54,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:54,991 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:55,144 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:55,146 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:55,147 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:55,151 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:55,265 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:33:55,267 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:55,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:33:55,395 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:33:55,396 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:33:55,408 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1149]
2025-12-03 19:33:55,410 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:33:55,410 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:33:55,545 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:33:55,546 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:33:55,547 | INFO | sqlalchemy.engine.Engine | [cached since 6001s ago] ()
2025-12-03 19:33:55,553 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:33:55,554 | INFO | sqlalchemy.engine.Engine | [cached since 2111s ago] (1,)
2025-12-03 19:33:56,528 | INFO | app.services.transcribe | Starting stream. Total bytes: 1579008. Chunk size: 8192. No throttling.
2025-12-03 19:33:56,531 | DEBUG | app.services.transcribe | Streamed 8192/1579008 bytes
2025-12-03 19:33:56,557 | DEBUG | app.services.transcribe | Streamed 417792/1579008 bytes
2025-12-03 19:33:56,582 | DEBUG | app.services.transcribe | Streamed 827392/1579008 bytes
2025-12-03 19:33:56,603 | DEBUG | app.services.transcribe | Streamed 1236992/1579008 bytes
2025-12-03 19:33:56,615 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:34:04,601 | DEBUG | app.services.transcribe | Received transcript chunk: 1017 transponder 052...
2025-12-03 19:34:04,749 | INFO | app.services.transcribe | Transcription complete. Length: 77
2025-12-03 19:34:04,752 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: 1017 transponder 0526 Rodaré Vía Alfa tres Alfa al.de espera pista 10 Listo.
2025-12-03 19:34:04,752 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=121.700 | text=1017 transponder 0526 Rodaré Vía Alfa tres Alfa al.de espera pista 10 Listo.
2025-12-03 19:34:04,863 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:34:04,864 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:34:04,864 | INFO | sqlalchemy.engine.Engine | [cached since 2111s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:34:04,883 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:34:07,706 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:34:07,707 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:34:07,708 | INFO | sqlalchemy.engine.Engine | [cached since 2113s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:34:07,730 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:34:07,731 | INFO | sqlalchemy.engine.Engine | [cached since 1953s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (16608 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 34, 7, 730170, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:34:07,750 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:34:07,782 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 19:34:07,784 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
1017 transponder 0526 Rodaré Vía Alfa tres Alfa al.de espera pista 10 Listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colacio...
2025-12-03 19:34:15,243 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje y punto de espera. Puede proceder a contactar Torre.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "missingItems": [],
    "nextPhase": "tower_hold_short"
  }
}
2025-12-03 19:34:15,245 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-03 19:34:15,246 | INFO | app.controllers.audio | Transición automática de fase session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 de=ground_readback a=tower_hold_short
2025-12-03 19:34:15,401 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:34:15,402 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:34:15,403 | INFO | sqlalchemy.engine.Engine | [cached since 2121s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:34:15,425 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:34:15,426 | INFO | sqlalchemy.engine.Engine | [cached since 1961s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (17835 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 34, 15, 425360, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:34:15,444 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:34:15,475 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:34:15,476 | INFO | sqlalchemy.engine.Engine | [cached since 1948s ago] (UUID('9792d18e-2035-453b-b2ed-b2d387527678'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_hold_short', 95.0, 'Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje y punto de espera. Puede proceder a contactar Torre.')
2025-12-03 19:34:15,490 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:34:15,525 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_hold_short score=95.00
2025-12-03 19:34:15,526 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=121.700 | intent=ground_taxi_readback | phase=tower_hold_short | allow_response=True | text=Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-03 19:35:32,382 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:35:32,382 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:35:32,383 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:35:32,384 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:35:32,385 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:35:32,386 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:35:32,386 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:35:32,387 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:35:32,388 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:35:32,388 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:35:32,388 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:35:32,390 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:35:32,390 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:35:32,391 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:35:32,392 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:35:32,392 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:35:32,394 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:35:32,394 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:35:32,395 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:35:32,396 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:35:32,396 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:35:32,396 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:35:32,399 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:35:32,399 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:35:32,400 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:35:32,401 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:35:32,401 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:35:32,402 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:35:32,403 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:35:32,404 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:35:32,405 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:35:32,406 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:35:32,408 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:32,411 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:35:32,527 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:32,529 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:32,531 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:32,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:32,644 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:32,645 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:32,764 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:32,765 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:32,766 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:32,884 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:32,887 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:32,889 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:32,890 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:33,028 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,029 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,031 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:33,177 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,179 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,182 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:33,315 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,317 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,321 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:35:33,434 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,435 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:35:33,437 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:35:33,553 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,554 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,556 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,557 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:35:33,672 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,674 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,676 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,678 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:35:33,788 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,789 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,792 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:33,906 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:33,907 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:33,908 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:34,021 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:35:34,023 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:34,025 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:35:34,167 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:34,168 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:34,171 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:34,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:34,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:34,301 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:35:34,417 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:34,419 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:35:34,420 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:35:34,422 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:747]
2025-12-03 19:35:34,423 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:35:34,423 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:35:34,543 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:35:34,544 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:35:34,545 | INFO | sqlalchemy.engine.Engine | [cached since 6100s ago] ()
2025-12-03 19:35:34,551 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:35:34,551 | INFO | sqlalchemy.engine.Engine | [cached since 2210s ago] (1,)
2025-12-03 19:35:35,492 | INFO | app.services.transcribe | Starting stream. Total bytes: 995328. Chunk size: 8192. No throttling.
2025-12-03 19:35:35,495 | DEBUG | app.services.transcribe | Streamed 8192/995328 bytes
2025-12-03 19:35:35,514 | DEBUG | app.services.transcribe | Streamed 417792/995328 bytes
2025-12-03 19:35:35,546 | DEBUG | app.services.transcribe | Streamed 827392/995328 bytes
2025-12-03 19:35:35,567 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:35:40,026 | DEBUG | app.services.transcribe | Received transcript chunk: Torre Alfa Noviembre...
2025-12-03 19:35:40,174 | INFO | app.services.transcribe | Transcription complete. Length: 65
2025-12-03 19:35:40,175 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: Torre Alfa Noviembre India en.depera pista 10 listo para salida.
2025-12-03 19:35:40,175 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=Torre Alfa Noviembre India en.depera pista 10 listo para salida.
2025-12-03 19:35:40,286 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:35:40,287 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:35:40,289 | INFO | sqlalchemy.engine.Engine | [cached since 2206s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:35:40,304 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:35:41,037 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:35:41,038 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:35:41,040 | INFO | sqlalchemy.engine.Engine | [cached since 2207s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:35:41,054 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:35:41,056 | INFO | sqlalchemy.engine.Engine | [cached since 2047s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (18308 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 35, 41, 54679, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:35:41,068 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:35:41,094 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_hold_short intent=tower_takeoff_readiness freq=tower
2025-12-03 19:35:41,097 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_takeoff_readiness freq_group=tower
SYSTEM> Eres Pavas Torre (118.3). Cuando la aeronave se reporta lista, responde: '[Matrícula], mantenga fuera de pista, tránsito en final corto.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": num...
USER> Fase actual: Contacto inicial con Torre (mantener fuera)
Intent esperado: tower_takeoff_readiness
Transcripción textual del alumno:
Torre Alfa Noviembre India en.depera pista 10 listo para salida.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_hold_short

Checklist alumno:
- Reportar punto de espera pista uno cero.
- Colacionar: 'Mantengo fuera de pista' o 'A posición y mantengo'.
- Colacionar instrucciones condicionales (ej. 'detrás del tránsito').
- NO...
2025-12-03 19:35:51,581 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_takeoff_readiness intento=1: {
  "intent": "tower_takeoff_readiness",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.",
  "feedback": "Reporte correcto de posición y estado. Se usó 'listo para salida' correctamente. La fraseología cumple con los estándares ATC. Proceda con instrucción de espera.",
  "confidence": 0.95,
  "score": 90,
  "metadata": {
    "nextPhase": "tower_line_up",
    "missingElements": [],
    "additionalNotes": "El alumno reportó c...
2025-12-03 19:35:51,582 | INFO | app.controllers.audio | Transición automática de fase session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 de=tower_hold_short a=tower_line_up
2025-12-03 19:35:51,712 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:35:51,713 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:35:51,714 | INFO | sqlalchemy.engine.Engine | [cached since 2217s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:35:51,733 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:35:51,734 | INFO | sqlalchemy.engine.Engine | [cached since 2057s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (20073 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 35, 51, 733870, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:35:51,749 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:35:51,775 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:35:51,776 | INFO | sqlalchemy.engine.Engine | [cached since 2044s ago] (UUID('69b0d0dd-78ec-45bb-b832-1f156eab19f2'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_line_up', 90.0, "Reporte correcto de posición y estado. Se usó 'listo para salida' correctamente. La fraseología cumple con los estándares ATC. Proceda con instrucción de espera.")
2025-12-03 19:35:51,786 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:35:51,813 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_line_up score=90.00
2025-12-03 19:35:51,813 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=tower_takeoff_readiness | phase=tower_line_up | allow_response=True | text=Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.
2025-12-03 19:36:50,487 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:36:50,488 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:36:50,490 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:36:50,490 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:36:50,491 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:36:50,492 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:36:50,494 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:36:50,494 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:36:50,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:36:50,495 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:36:50,496 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:36:50,498 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:36:50,498 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:36:50,500 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:36:50,500 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:36:50,501 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:36:50,501 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:36:50,502 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:36:50,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:36:50,504 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:36:50,505 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:36:50,506 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:36:50,506 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:36:50,507 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:36:50,508 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:36:50,509 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:36:50,510 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:36:50,511 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:36:50,512 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:36:50,513 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:36:50,514 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:36:50,515 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:4380]
2025-12-03 19:36:50,518 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:50,520 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:36:50,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:50,643 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:50,644 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:36:50,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:50,779 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:50,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:50,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:36:50,938 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:50,940 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:50,943 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:36:51,100 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:36:51,102 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:51,105 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:36:51,242 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:51,244 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:51,246 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:51,248 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:36:51,384 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:51,385 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:51,387 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:36:51,526 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:51,528 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:51,530 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:36:51,651 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:51,653 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:51,655 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:36:51,658 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:36:51,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:36:51,714 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1299]
2025-12-03 19:36:51,714 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:36:51,715 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:36:51,862 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:36:51,863 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:36:51,864 | INFO | sqlalchemy.engine.Engine | [cached since 6177s ago] ()
2025-12-03 19:36:51,872 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:36:51,874 | INFO | sqlalchemy.engine.Engine | [cached since 2287s ago] (1,)
2025-12-03 19:36:52,709 | INFO | app.services.transcribe | Starting stream. Total bytes: 534528. Chunk size: 8192. No throttling.
2025-12-03 19:36:52,712 | DEBUG | app.services.transcribe | Streamed 8192/534528 bytes
2025-12-03 19:36:52,733 | DEBUG | app.services.transcribe | Streamed 417792/534528 bytes
2025-12-03 19:36:52,743 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:36:55,249 | DEBUG | app.services.transcribe | Received transcript chunk: me mantengo fuera de...
2025-12-03 19:36:55,310 | INFO | app.services.transcribe | Transcription complete. Length: 50
2025-12-03 19:36:55,312 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: me mantengo fuera de pista. Alfa Noviembre India.
2025-12-03 19:36:55,312 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=me mantengo fuera de pista. Alfa Noviembre India.
2025-12-03 19:36:55,444 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:36:55,445 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:36:55,446 | INFO | sqlalchemy.engine.Engine | [cached since 2281s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:36:55,464 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:37:00,732 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:37:00,732 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:37:00,733 | INFO | sqlalchemy.engine.Engine | [cached since 2287s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:37:00,750 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:37:00,752 | INFO | sqlalchemy.engine.Engine | [cached since 2126s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (20526 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 37, 0, 749969, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:37:00,770 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:37:00,797 | INFO | app.controllers.audio | Intent detector frequency mismatch session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 detected=ground scenario=tower
2025-12-03 19:37:00,798 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_line_up intent=ground_hold_short freq=tower
2025-12-03 19:37:00,801 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_hold_short freq_group=tower
SYSTEM> Sigues en Pavas Torre. Una vez libre el tránsito, instruye: '[Matrícula], ruede a posición y mantenga pista uno cero.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "meta...
USER> Fase actual: Autorización a posición y mantener
Intent esperado: ground_hold_short
Transcripción textual del alumno:
me mantengo fuera de pista. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_line_up

Checklist alumno:
- Reconocer la instrucción anterior y estar listo.

Checklist controlador:
- Autorizar 'ruede a posición y mantenga pista uno cero'.
- Mantener fraseología local.

Cuándo responder:
- allowResponse=true con la instruc...
2025-12-03 19:37:10,475 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_hold_short intento=1: {
  "intent": "ground_hold_short",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, ruede a posición y mantenga pista uno cero.",
  "feedback": "Se reconoce la confirmación de espera. Ahora debe proceder con la instrucción de alineamiento. La fraseología de espera fue correcta, pero faltaba la autorización para rodar a pista. Proceda con la siguiente fase.",
  "confidence": 0.85,
  "score": 70,
  "metadata": {
    "nextPhase": "tower_takeoff_clearance",
    "missingElements...
2025-12-03 19:37:10,477 | INFO | app.controllers.audio | Transición automática de fase session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 de=tower_line_up a=tower_takeoff_clearance
2025-12-03 19:37:10,605 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:37:10,606 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:37:10,607 | INFO | sqlalchemy.engine.Engine | [cached since 2296s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:37:10,627 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:37:10,628 | INFO | sqlalchemy.engine.Engine | [cached since 2136s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (21985 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 37, 10, 627083, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:37:10,645 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:37:10,681 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:37:10,682 | INFO | sqlalchemy.engine.Engine | [cached since 2123s ago] (UUID('044f09a2-6d78-46eb-ad7a-8955333d219f'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_takeoff_clearance', 70.0, 'Se reconoce la confirmación de espera. Ahora debe proceder con la instrucción de alineamiento. La fraseología de espera fue correcta, pero faltaba la autorización para rodar a pista. Proceda con la siguiente fase.')
2025-12-03 19:37:10,695 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:37:10,736 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance score=70.00
2025-12-03 19:37:10,738 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=ground_hold_short | phase=tower_takeoff_clearance | allow_response=True | text=Alfa Noviembre India, ruede a posición y mantenga pista uno cero.
2025-12-03 19:39:43,316 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:39:43,317 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:39:43,318 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:39:43,319 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:39:43,321 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:39:43,322 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:39:43,322 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:39:43,323 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:39:43,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:39:43,325 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:39:43,326 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:39:43,327 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:39:43,328 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:39:43,330 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:39:43,330 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:39:43,331 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:39:43,331 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:39:43,332 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:39:43,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:39:43,333 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:39:43,334 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:39:43,335 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:39:43,335 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:39:43,336 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:39:43,337 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:39:43,338 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:39:43,339 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:39:43,340 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:39:43,340 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:39:43,342 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:39:43,344 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:39:43,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:39:43,351 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:43,352 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:39:43,460 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:39:43,461 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:39:43,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:43,580 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:43,583 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:39:43,698 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:43,699 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:43,701 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:43,703 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:43,705 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:39:43,819 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:43,821 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:43,822 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:39:43,937 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:39:43,939 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:43,941 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:43,943 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:39:44,058 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,060 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,062 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,063 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:39:44,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,195 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,196 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:39:44,308 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,313 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:39:44,430 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:39:44,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,433 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:39:44,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,596 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,598 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:39:44,716 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,717 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,718 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:39:44,838 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,839 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,841 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:39:44,970 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:39:44,974 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:39:44,976 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:39:45,006 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1871]
2025-12-03 19:39:45,006 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:39:45,007 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:39:45,171 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:39:45,172 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:39:45,174 | INFO | sqlalchemy.engine.Engine | [cached since 6351s ago] ()
2025-12-03 19:39:45,186 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:39:45,188 | INFO | sqlalchemy.engine.Engine | [cached since 2460s ago] (1,)
2025-12-03 19:39:46,565 | INFO | app.services.transcribe | Starting stream. Total bytes: 829440. Chunk size: 8192. No throttling.
2025-12-03 19:39:46,568 | DEBUG | app.services.transcribe | Streamed 8192/829440 bytes
2025-12-03 19:39:46,591 | DEBUG | app.services.transcribe | Streamed 417792/829440 bytes
2025-12-03 19:39:46,617 | DEBUG | app.services.transcribe | Streamed 827392/829440 bytes
2025-12-03 19:39:46,619 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:39:50,497 | DEBUG | app.services.transcribe | Received transcript chunk: rodando a posición y...
2025-12-03 19:39:50,646 | INFO | app.services.transcribe | Transcription complete. Length: 70
2025-12-03 19:39:50,646 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: rodando a posición y manteniendo pista 10 Alfa Noviembre India Listo.
2025-12-03 19:39:50,647 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=rodando a posición y manteniendo pista 10 Alfa Noviembre India Listo.
2025-12-03 19:39:50,776 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:39:50,777 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:39:50,778 | INFO | sqlalchemy.engine.Engine | [cached since 2457s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:39:50,793 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:39:51,575 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:39:51,576 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:39:51,578 | INFO | sqlalchemy.engine.Engine | [cached since 2457s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:39:51,603 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:39:51,603 | INFO | sqlalchemy.engine.Engine | [cached since 2297s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (22471 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 39, 51, 602788, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:39:51,624 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:39:51,657 | INFO | app.controllers.audio | Intent detector frequency mismatch session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 detected=ground scenario=tower
2025-12-03 19:39:51,658 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance intent=ground_taxi_instructions freq=tower
2025-12-03 19:39:51,662 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
rodando a posición y manteniendo pista 10 Alfa Noviembre India Listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
...
2025-12-03 19:40:10,420 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El alumno ha confirmado la instrucción de rodaje a posición pero no ha recibido autorización de despegue. Se esperaba la colación de la autorización de despegue (AUTORIZADO DESPEGAR) en lugar de repetir la instrucción de rodaje. Debe esperar la autorización explícita antes de proceder.",
  "confidence": 0.89,
  "score": 65,
  "metadata": {
    "missing_elements": [
      "AUTORIZADO DE...
2025-12-03 19:40:10,532 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:40:10,534 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:40:10,535 | INFO | sqlalchemy.engine.Engine | [cached since 2476s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:40:10,550 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:40:10,551 | INFO | sqlalchemy.engine.Engine | [cached since 2316s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (24138 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 40, 10, 550089, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:40:10,567 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:40:10,596 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:40:10,597 | INFO | sqlalchemy.engine.Engine | [cached since 2303s ago] (UUID('2e5c7e0c-e606-4893-9c2e-70565f34955d'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_takeoff_clearance', 65.0, 'El alumno ha confirmado la instrucción de rodaje a posición pero no ha recibido autorización de despegue. Se esperaba la colación de la autorización de despegue (AUTORIZADO DESPEGAR) en lugar de repetir la instrucción de rodaje. Debe esperar la autorización explícita antes de proceder.')
2025-12-03 19:40:10,607 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:40:10,635 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance score=65.00
2025-12-03 19:40:10,635 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=ground_taxi_instructions | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:41:27,302 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:41:27,302 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:41:27,303 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:41:27,304 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:41:27,305 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:41:27,306 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:41:27,308 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:41:27,308 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:41:27,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:41:27,311 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:41:27,312 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:41:27,313 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:41:27,314 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:41:27,314 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:41:27,316 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:41:27,316 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:41:27,316 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:41:27,318 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:41:27,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:41:27,320 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:41:27,320 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:41:27,322 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:41:27,322 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:41:27,324 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:41:27,325 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:41:27,326 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:41:27,327 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:41:27,327 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:41:27,328 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:41:27,330 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:41:27,331 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:41:27,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:5840]
2025-12-03 19:41:27,336 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:27,338 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:41:27,451 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:27,453 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:27,455 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:27,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:41:27,598 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:27,601 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:27,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:41:27,741 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:27,743 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:27,745 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:41:27,866 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:41:27,868 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:27,870 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:41:28,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,008 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:41:28,136 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,137 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,138 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,141 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:41:28,257 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,258 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,260 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,263 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:41:28,390 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,393 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,395 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:41:28,548 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,550 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,555 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:41:28,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,753 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,756 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:41:28,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:41:28,870 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:41:28,873 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:345]
2025-12-03 19:41:28,875 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:41:28,877 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:41:29,193 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:41:29,195 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:41:29,196 | INFO | sqlalchemy.engine.Engine | [cached since 6455s ago] ()
2025-12-03 19:41:29,207 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:41:29,209 | INFO | sqlalchemy.engine.Engine | [cached since 2564s ago] (1,)
2025-12-03 19:41:30,147 | INFO | app.services.transcribe | Starting stream. Total bytes: 669696. Chunk size: 8192. No throttling.
2025-12-03 19:41:30,149 | DEBUG | app.services.transcribe | Streamed 8192/669696 bytes
2025-12-03 19:41:30,179 | DEBUG | app.services.transcribe | Streamed 417792/669696 bytes
2025-12-03 19:41:30,196 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:41:33,441 | DEBUG | app.services.transcribe | Received transcript chunk: rodando a posición y...
2025-12-03 19:41:33,524 | INFO | app.services.transcribe | Transcription complete. Length: 63
2025-12-03 19:41:33,525 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: rodando a posición y manteniendo pista 10 listo para despegar.
2025-12-03 19:41:33,525 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=rodando a posición y manteniendo pista 10 listo para despegar.
2025-12-03 19:41:33,672 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:41:33,673 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:41:33,676 | INFO | sqlalchemy.engine.Engine | [cached since 2559s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:41:33,695 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:41:34,524 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:41:34,525 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:41:34,527 | INFO | sqlalchemy.engine.Engine | [cached since 2560s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:41:34,542 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:41:34,543 | INFO | sqlalchemy.engine.Engine | [cached since 2400s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (24615 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 41, 34, 542985, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:41:34,562 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:41:34,589 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance intent=tower_ready_for_takeoff freq=tower
2025-12-03 19:41:34,591 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_ready_for_takeoff freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_ready_for_takeoff
Transcripción textual del alumno:
rodando a posición y manteniendo pista 10 listo para despegar.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar vi...
2025-12-03 19:41:48,048 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_ready_for_takeoff intento=1: {
  "intent": "tower_ready_for_takeoff",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El alumno ha repetido la instrucción de rodaje y ha añadido 'listo para despegar', lo cual no es la fraseología correcta. Se esperaba la confirmación de estar listo para recibir autorización de despegue ('listo para salida') y esperar la autorización explícita 'AUTORIZADO DESPEGAR'. No se debe usar 'listo para despegar' ya que no ha recibido autorización. Corrija la fraseología y espere...
2025-12-03 19:41:48,180 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:41:48,181 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:41:48,182 | INFO | sqlalchemy.engine.Engine | [cached since 2574s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:41:48,201 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:41:48,202 | INFO | sqlalchemy.engine.Engine | [cached since 2414s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (26332 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 41, 48, 200692, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:41:48,221 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:41:48,249 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:41:48,250 | INFO | sqlalchemy.engine.Engine | [cached since 2401s ago] (UUID('a1d15078-a041-47da-b882-def308544e9c'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_takeoff_clearance', 45.0, "El alumno ha repetido la instrucción de rodaje y ha añadido 'listo para despegar', lo cual no es la fraseología correcta. Se esperaba la confirmación ... (115 characters truncated) ... TORIZADO DESPEGAR'. No se debe usar 'listo para despegar' ya que no ha recibido autorización. Corrija la fraseología y espere la autorización formal.")
2025-12-03 19:41:48,262 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:41:48,288 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance score=45.00
2025-12-03 19:41:48,290 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=tower_ready_for_takeoff | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:42:40,083 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:42:40,083 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:42:40,085 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:42:40,086 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:42:40,087 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:42:40,087 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:42:40,088 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:42:40,088 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:42:40,091 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:42:40,091 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:42:40,092 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:42:40,092 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:42:40,093 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:42:40,094 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:42:40,094 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:42:40,095 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:42:40,095 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:42:40,095 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:42:40,097 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:42:40,098 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:42:40,098 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:42:40,100 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:42:40,100 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:42:40,102 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:42:40,102 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:42:40,103 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:42:40,104 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:42:40,106 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:42:40,107 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:42:40,108 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:42:40,108 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:42:40,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:2920]
2025-12-03 19:42:40,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:40,113 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:42:40,225 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:40,226 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:40,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:42:40,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:42:40,347 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:40,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:42:40,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:40,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:40,468 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:42:40,583 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:40,584 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:40,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:42:40,738 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:40,740 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:40,741 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:40,743 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:42:40,871 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:40,872 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:42:40,874 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:42:41,002 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:41,003 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:41,005 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:41,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:42:41,131 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:41,132 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:41,133 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:42:41,254 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:41,255 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:41,257 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:41,259 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:42:41,381 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:41,383 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:41,385 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:42:41,473 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:42:41,475 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:42:41,476 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1719]
2025-12-03 19:42:41,477 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:42:41,477 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:42:41,598 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:42:41,598 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:42:41,599 | INFO | sqlalchemy.engine.Engine | [cached since 6527s ago] ()
2025-12-03 19:42:41,606 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:42:41,607 | INFO | sqlalchemy.engine.Engine | [cached since 2637s ago] (1,)
2025-12-03 19:42:42,400 | INFO | app.services.transcribe | Starting stream. Total bytes: 679936. Chunk size: 8192. No throttling.
2025-12-03 19:42:42,402 | DEBUG | app.services.transcribe | Streamed 8192/679936 bytes
2025-12-03 19:42:42,418 | DEBUG | app.services.transcribe | Streamed 417792/679936 bytes
2025-12-03 19:42:42,436 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:42:45,954 | DEBUG | app.services.transcribe | Received transcript chunk: rodando a posición y...
2025-12-03 19:42:46,056 | INFO | app.services.transcribe | Transcription complete. Length: 61
2025-12-03 19:42:46,057 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: rodando a posición y manteniendo pista 10 listo para salida.
2025-12-03 19:42:46,058 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=rodando a posición y manteniendo pista 10 listo para salida.
2025-12-03 19:42:46,166 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:42:46,166 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:42:46,168 | INFO | sqlalchemy.engine.Engine | [cached since 2632s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:42:46,184 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:42:46,976 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:42:46,977 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:42:46,978 | INFO | sqlalchemy.engine.Engine | [cached since 2633s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:42:46,993 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:42:46,994 | INFO | sqlalchemy.engine.Engine | [cached since 2473s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (26806 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 42, 46, 993326, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:42:47,010 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:42:47,039 | INFO | app.controllers.audio | Intent detector frequency mismatch session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 detected=ground scenario=tower
2025-12-03 19:42:47,039 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance intent=ground_taxi_clearance freq=tower
2025-12-03 19:42:47,042 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
rodando a posición y manteniendo pista 10 listo para salida.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento...
2025-12-03 19:43:01,861 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance intento=1: {
  "intent": "ground_taxi_clearance",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El alumno ha repetido la instrucción de rodaje y ha corregido a 'listo para salida', pero aún no ha recibido la autorización de despegue. Se esperaba que esperara la autorización formal 'AUTORIZADO DESPEGAR'. No debe repetir la instrucción de rodaje ni declararse listo para salida sin autorización. Debe esperar la autorización explícita de Torre antes de proceder.",
  "confidence": 0.85,
...
2025-12-03 19:43:02,013 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:43:02,014 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:43:02,016 | INFO | sqlalchemy.engine.Engine | [cached since 2648s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:43:02,037 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:43:02,038 | INFO | sqlalchemy.engine.Engine | [cached since 2488s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (28486 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 43, 2, 36490, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:43:02,060 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:43:02,093 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:43:02,094 | INFO | sqlalchemy.engine.Engine | [cached since 2475s ago] (UUID('83a087a9-2653-4650-adee-dace5fa26c46'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_takeoff_clearance', 40.0, "El alumno ha repetido la instrucción de rodaje y ha corregido a 'listo para salida', pero aún no ha recibido la autorización de despegue. Se esperaba ... (68 characters truncated) ... repetir la instrucción de rodaje ni declararse listo para salida sin autorización. Debe esperar la autorización explícita de Torre antes de proceder.")
2025-12-03 19:43:02,107 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:43:02,140 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance score=40.00
2025-12-03 19:43:02,141 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=ground_taxi_clearance | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:43:48,674 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:43:48,675 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:43:48,677 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:43:48,680 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:43:48,681 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:43:48,683 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:43:48,684 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:43:48,685 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:43:48,688 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:43:48,690 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:43:48,692 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:43:48,693 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:43:48,695 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:43:48,696 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:43:48,698 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:43:48,699 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:43:48,702 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:43:48,704 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:43:48,708 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:43:48,711 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:43:48,712 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:43:48,714 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:43:48,715 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:43:48,717 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:43:48,718 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:43:48,720 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:43:48,723 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:43:48,725 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:43:48,727 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:43:48,728 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:43:48,735 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:43:48,736 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:4380]
2025-12-03 19:43:48,740 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:43:48,940 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:48,943 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:48,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:48,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:43:49,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:49,166 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:49,170 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:43:49,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:49,370 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:49,374 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:43:49,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:49,500 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:49,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:43:49,645 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:43:49,647 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:49,650 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:43:49,777 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:49,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:49,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:49,783 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:43:49,907 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:49,909 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:43:49,911 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:43:50,022 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:50,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:43:50,025 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:43:50,056 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:43:50,057 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:195]
2025-12-03 19:43:50,058 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:43:50,059 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:43:50,207 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:43:50,208 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:43:50,210 | INFO | sqlalchemy.engine.Engine | [cached since 6596s ago] ()
2025-12-03 19:43:50,218 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:43:50,220 | INFO | sqlalchemy.engine.Engine | [cached since 2705s ago] (1,)
2025-12-03 19:43:51,074 | INFO | app.services.transcribe | Starting stream. Total bytes: 526336. Chunk size: 8192. No throttling.
2025-12-03 19:43:51,076 | DEBUG | app.services.transcribe | Streamed 8192/526336 bytes
2025-12-03 19:43:51,096 | DEBUG | app.services.transcribe | Streamed 417792/526336 bytes
2025-12-03 19:43:51,104 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:43:53,667 | DEBUG | app.services.transcribe | Received transcript chunk: rodando a posición y...
2025-12-03 19:43:53,754 | INFO | app.services.transcribe | Transcription complete. Length: 43
2025-12-03 19:43:53,755 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: rodando a posición y manteniendo pista 10.
2025-12-03 19:43:53,756 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=rodando a posición y manteniendo pista 10.
2025-12-03 19:43:53,885 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:43:53,886 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:43:53,887 | INFO | sqlalchemy.engine.Engine | [cached since 2700s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:43:53,903 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:43:54,664 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:43:54,665 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:43:54,666 | INFO | sqlalchemy.engine.Engine | [cached since 2700s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:43:54,684 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:43:54,685 | INFO | sqlalchemy.engine.Engine | [cached since 2540s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (28945 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 43, 54, 684108, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:43:54,703 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:43:54,733 | INFO | app.controllers.audio | Intent detector frequency mismatch session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 detected=ground scenario=tower
2025-12-03 19:43:54,734 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance intent=ground_taxi_instructions freq=tower
2025-12-03 19:43:54,737 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
rodando a posición y manteniendo pista 10.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver data).
- ...
2025-12-03 19:44:07,731 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El alumno ha repetido la instrucción de rodaje por tercera vez sin esperar la autorización de despegue. Esto indica que no está siguiendo el protocolo correcto de comunicaciones. Debe esperar la autorización explícita 'AUTORIZADO DESPEGAR' antes de proceder. No se debe repetir la instrucción de rodaje ni declararse listo sin autorización formal.",
  "confidence": 0.92,
  "score": 20,
 ...
2025-12-03 19:44:07,841 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:44:07,841 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:44:07,843 | INFO | sqlalchemy.engine.Engine | [cached since 2714s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:44:07,858 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:44:07,860 | INFO | sqlalchemy.engine.Engine | [cached since 2554s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (30620 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 44, 7, 858867, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:44:07,876 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:44:07,902 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:44:07,904 | INFO | sqlalchemy.engine.Engine | [cached since 2540s ago] (UUID('0dadb358-bb1d-408b-bda6-c2c2c1840658'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_takeoff_clearance', 20.0, "El alumno ha repetido la instrucción de rodaje por tercera vez sin esperar la autorización de despegue. Esto indica que no está siguiendo el protocol ... (49 characters truncated) ... orización explícita 'AUTORIZADO DESPEGAR' antes de proceder. No se debe repetir la instrucción de rodaje ni declararse listo sin autorización formal.")
2025-12-03 19:44:07,915 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:44:07,943 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance score=20.00
2025-12-03 19:44:07,944 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=ground_taxi_instructions | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:45:18,324 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:45:18,325 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:45:18,326 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:45:18,327 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:45:18,328 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:45:18,329 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:45:18,330 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:45:18,331 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:45:18,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:45:18,333 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:45:18,334 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:45:18,335 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:45:18,336 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:45:18,337 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:45:18,338 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:45:18,338 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:45:18,339 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:45:18,340 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:45:18,341 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:45:18,341 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:45:18,343 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:45:18,343 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:45:18,344 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:45:18,345 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:45:18,346 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:45:18,347 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:45:18,348 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:45:18,348 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:45:18,351 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:45:18,352 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:45:18,354 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:45:18,354 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:4380]
2025-12-03 19:45:18,357 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:18,358 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:45:18,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:18,492 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:18,494 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:18,496 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:45:18,615 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:18,616 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:18,618 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:45:18,785 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:18,788 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:18,792 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:45:18,979 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:18,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:18,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:45:19,166 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:19,168 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,172 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:19,175 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:45:19,388 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,391 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,394 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,403 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,407 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:45:19,592 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:19,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:45:19,725 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:19,727 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,729 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:45:19,829 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:45:19,831 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:45:19,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2533]
2025-12-03 19:45:19,834 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:45:19,834 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:45:19,964 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:45:19,965 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:45:19,965 | INFO | sqlalchemy.engine.Engine | [cached since 6686s ago] ()
2025-12-03 19:45:19,973 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:45:19,974 | INFO | sqlalchemy.engine.Engine | [cached since 2795s ago] (1,)
2025-12-03 19:45:20,908 | INFO | app.services.transcribe | Starting stream. Total bytes: 565248. Chunk size: 8192. No throttling.
2025-12-03 19:45:20,912 | DEBUG | app.services.transcribe | Streamed 8192/565248 bytes
2025-12-03 19:45:20,935 | DEBUG | app.services.transcribe | Streamed 417792/565248 bytes
2025-12-03 19:45:20,947 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:45:22,156 | DEBUG | app.services.transcribe | Received transcript chunk: en posición....
2025-12-03 19:45:23,382 | DEBUG | app.services.transcribe | Received transcript chunk: y esperando autoriza...
2025-12-03 19:45:23,444 | INFO | app.services.transcribe | Transcription complete. Length: 39
2025-12-03 19:45:23,444 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: en posición. y esperando autorización.
2025-12-03 19:45:23,445 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=en posición. y esperando autorización.
2025-12-03 19:45:23,566 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:45:23,567 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:45:23,568 | INFO | sqlalchemy.engine.Engine | [cached since 2789s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:45:23,587 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:45:33,971 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:45:33,972 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:45:33,973 | INFO | sqlalchemy.engine.Engine | [cached since 2800s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:45:33,990 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:45:33,992 | INFO | sqlalchemy.engine.Engine | [cached since 2640s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (31074 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 45, 33, 990840, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:45:34,009 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:45:34,039 | INFO | app.controllers.audio | Intent detector frequency mismatch session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 detected=ground scenario=tower
2025-12-03 19:45:34,040 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance intent=ground_hold_short freq=tower
2025-12-03 19:45:34,043 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_hold_short freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: ground_hold_short
Transcripción textual del alumno:
en posición. y esperando autorización.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver data).
- Dar pista (...
2025-12-03 19:45:44,939 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_hold_short intento=1: {
  "intent": "ground_hold_short",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El alumno ha mostrado consistencia en repetir instrucciones de rodaje y declararse listo sin recibir autorización formal. Después de múltiples intentos, sigue sin esperar la autorización explícita 'AUTORIZADO DESPEGAR'. Esto indica un problema crítico en el protocolo de comunicaciones que requiere corrección antes de proceder.",
  "confidence": 0.89,
  "score": 30,
  "metadata": {
    "critic...
2025-12-03 19:45:45,058 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:45:45,060 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:45:45,061 | INFO | sqlalchemy.engine.Engine | [cached since 2811s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:45:45,076 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:45:45,077 | INFO | sqlalchemy.engine.Engine | [cached since 2651s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (32816 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 45, 45, 75761, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:45:45,090 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:45:45,119 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:45:45,120 | INFO | sqlalchemy.engine.Engine | [cached since 2638s ago] (UUID('64de2480-8a75-4fd8-b5a2-ac9c0928e9a2'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_takeoff_clearance', 30.0, "El alumno ha mostrado consistencia en repetir instrucciones de rodaje y declararse listo sin recibir autorización formal. Después de múltiples intent ... (30 characters truncated) ... ización explícita 'AUTORIZADO DESPEGAR'. Esto indica un problema crítico en el protocolo de comunicaciones que requiere corrección antes de proceder.")
2025-12-03 19:45:45,131 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:45:45,165 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance score=30.00
2025-12-03 19:45:45,166 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=ground_hold_short | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:49:37,601 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:49:37,603 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:49:37,604 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:49:37,604 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:49:37,605 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:49:37,606 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:49:37,607 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:49:37,607 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:49:37,609 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:49:37,611 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:49:37,611 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:49:37,612 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:49:37,612 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:49:37,614 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:49:37,615 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:49:37,616 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:49:37,617 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:49:37,617 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:49:37,618 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:49:37,618 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:49:37,620 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:49:37,621 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:49:37,622 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:49:37,622 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:49:37,624 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:49:37,625 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:49:37,626 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:49:37,627 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:49:37,628 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 19:49:37,629 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:49:37,630 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:49:37,630 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:5840]
2025-12-03 19:49:37,633 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:49:37,756 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:49:37,758 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:49:37,760 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:49:37,762 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:49:37,875 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:49:37,877 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:49:37,878 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:49:37,881 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:49:38,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:49:38,016 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:49:38,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:49:38,161 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:49:38,163 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:49:38,281 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:49:38,282 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:49:38,283 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:49:38,402 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:49:38,404 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:49:38,407 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:49:38,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:49:38,459 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:288]
2025-12-03 19:49:38,461 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:49:38,462 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:49:38,589 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:49:38,590 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:49:38,590 | INFO | sqlalchemy.engine.Engine | [cached since 6944s ago] ()
2025-12-03 19:49:38,598 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:49:38,599 | INFO | sqlalchemy.engine.Engine | [cached since 3054s ago] (1,)
2025-12-03 19:49:39,567 | INFO | app.services.transcribe | Starting stream. Total bytes: 417792. Chunk size: 8192. No throttling.
2025-12-03 19:49:39,570 | DEBUG | app.services.transcribe | Streamed 8192/417792 bytes
2025-12-03 19:49:39,646 | DEBUG | app.services.transcribe | Streamed 417792/417792 bytes
2025-12-03 19:49:39,648 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:49:41,237 | DEBUG | app.services.transcribe | Received transcript chunk: mantengo fuera de pi...
2025-12-03 19:49:41,275 | INFO | app.services.transcribe | Transcription complete. Length: 25
2025-12-03 19:49:41,276 | INFO | app.controllers.audio | Transcripción recibida session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42: mantengo fuera de pista.
2025-12-03 19:49:41,277 | INFO | app.logs.transcript | student | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | text=mantengo fuera de pista.
2025-12-03 19:49:41,397 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:49:41,398 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:49:41,400 | INFO | sqlalchemy.engine.Engine | [cached since 3047s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:49:41,421 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:49:42,159 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:49:42,160 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:49:42,160 | INFO | sqlalchemy.engine.Engine | [cached since 3048s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:49:42,178 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:49:42,179 | INFO | sqlalchemy.engine.Engine | [cached since 2888s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (33244 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 49, 42, 178014, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:49:42,237 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:49:42,267 | INFO | app.controllers.audio | Intent detector frequency mismatch session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 detected=ground scenario=tower
2025-12-03 19:49:42,268 | INFO | app.controllers.audio | Fase activa session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance intent=ground_hold_short freq=tower
2025-12-03 19:49:42,270 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_hold_short freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 80 grados 9 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": n...
USER> Fase actual: Autorización de despegue
Intent esperado: ground_hold_short
Transcripción textual del alumno:
mantengo fuera de pista.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver data).
- Dar pista (ver data).
- D...
2025-12-03 19:49:56,346 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_hold_short intento=1: {
  "intent": "ground_hold_short",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El alumno ha repetido la instrucción de mantener fuera de pista por cuarta vez, lo que indica que no está siguiendo el flujo correcto de comunicaciones. Después de múltiples intentos fallidos de recibir la autorización de despegue, se requiere una corrección fundamental en el protocolo de comunicaciones. El alumno debe esperar la autorización explícita 'AUTORIZADO DESPEGAR' y no repetir instr...
2025-12-03 19:49:56,460 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:49:56,461 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:49:56,461 | INFO | sqlalchemy.engine.Engine | [cached since 3062s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:49:56,481 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:49:56,482 | INFO | sqlalchemy.engine.Engine | [cached since 2902s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (35084 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0526", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 19, 49, 56, 481483, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('4ee1563b-d394-4da8-b49a-bfd4bb61f212'))
2025-12-03 19:49:56,498 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:49:56,535 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:49:56,536 | INFO | sqlalchemy.engine.Engine | [cached since 2889s ago] (UUID('879cf274-9b4f-4f7f-a275-000e03fa79c6'), UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'), 1, 'tower_takeoff_clearance', 20.0, "El alumno ha repetido la instrucción de mantener fuera de pista por cuarta vez, lo que indica que no está siguiendo el flujo correcto de comunicacion ... (114 characters truncated) ... amental en el protocolo de comunicaciones. El alumno debe esperar la autorización explícita 'AUTORIZADO DESPEGAR' y no repetir instrucciones previas.")
2025-12-03 19:49:56,548 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:49:56,580 | INFO | app.controllers.audio | Puntuación guardada session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 phase_id=tower_takeoff_clearance score=20.00
2025-12-03 19:49:56,582 | INFO | app.logs.transcript | controller | session=37e1102a-9f5d-4f95-b06f-9a3b68ee0a42 | frequency=118.300 | intent=ground_hold_short | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 19:55:36,600 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:36,601 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:36,602 | INFO | sqlalchemy.engine.Engine | [cached since 7302s ago] ()
2025-12-03 19:55:36,603 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:36,605 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:36,607 | INFO | sqlalchemy.engine.Engine | [cached since 7302s ago] ()
2025-12-03 19:55:36,612 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,614 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,620 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,620 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,633 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:36,635 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:36,636 | INFO | sqlalchemy.engine.Engine | [cached since 7302s ago] ()
2025-12-03 19:55:36,646 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,647 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,675 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:36,676 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:36,677 | INFO | sqlalchemy.engine.Engine | [cached since 7302s ago] ()
2025-12-03 19:55:36,687 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,688 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,735 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,736 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,739 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,740 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,743 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,744 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,749 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 19:55:36,749 | INFO | sqlalchemy.engine.Engine | [cached since 3409s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 19:55:36,753 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 19:55:36,753 | INFO | sqlalchemy.engine.Engine | [cached since 3409s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 19:55:36,757 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 19:55:36,757 | INFO | sqlalchemy.engine.Engine | [cached since 3410s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 19:55:36,772 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:36,773 | INFO | sqlalchemy.engine.Engine | [cached since 3412s ago] (1,)
2025-12-03 19:55:36,778 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:55:36,780 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:55:36,782 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:55:36,784 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 19:55:36,785 | INFO | sqlalchemy.engine.Engine | [cached since 3410s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 19:55:36,801 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:55:41,230 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:41,231 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:41,232 | INFO | sqlalchemy.engine.Engine | [cached since 7307s ago] ()
2025-12-03 19:55:41,243 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:41,245 | INFO | sqlalchemy.engine.Engine | [cached since 3416s ago] (1,)
2025-12-03 19:55:41,369 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:55:41,370 | INFO | sqlalchemy.engine.Engine | [cached since 3407s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:55:41,388 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-03 19:55:41,389 | INFO | sqlalchemy.engine.Engine | [cached since 3407s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:55:41,410 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:55:41,411 | INFO | sqlalchemy.engine.Engine | [cached since 3407s ago] (UUID('37e1102a-9f5d-4f95-b06f-9a3b68ee0a42'),)
2025-12-03 19:55:41,417 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:55:41,631 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:41,631 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:41,633 | INFO | sqlalchemy.engine.Engine | [cached since 7307s ago] ()
2025-12-03 19:55:41,641 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:41,642 | INFO | sqlalchemy.engine.Engine | [cached since 3417s ago] (1,)
2025-12-03 19:55:41,662 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:41,663 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:41,665 | INFO | sqlalchemy.engine.Engine | [cached since 7307s ago] ()
2025-12-03 19:55:41,674 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:41,675 | INFO | sqlalchemy.engine.Engine | [cached since 3417s ago] (1,)
2025-12-03 19:55:41,748 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:41,749 | INFO | sqlalchemy.engine.Engine | [cached since 3417s ago] (1,)
2025-12-03 19:55:41,751 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:41,752 | INFO | sqlalchemy.engine.Engine | [cached since 3417s ago] (1,)
2025-12-03 19:55:41,756 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 19:55:41,757 | INFO | sqlalchemy.engine.Engine | [cached since 3415s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 19:55:41,761 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 19:55:41,762 | INFO | sqlalchemy.engine.Engine | [cached since 3414s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 19:55:41,781 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:55:41,784 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:55:55,611 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-03 19:55:55,895 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D4AF8150>
2025-12-03 19:55:55,896 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x00000254D4A53410> server_hostname='aviationweather.gov' timeout=10.0
2025-12-03 19:55:56,025 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000254D4A09310>
2025-12-03 19:55:56,026 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-03 19:55:56,028 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-03 19:55:56,028 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-03 19:55:56,029 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-03 19:55:56,030 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-03 19:55:56,142 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 04 Dec 2025 01:55:56 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'471'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1d7-bqgyMnm85OuYCOIZOquANnMmyP4"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251204T015556Z-1654ff757974tq5jhC1MIAc7e80000001h2g00000000rqq6'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-03 19:55:56,142 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-03 19:55:56,144 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-03 19:55:56,145 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-03 19:55:56,146 | DEBUG | httpcore.http11 | response_closed.started
2025-12-03 19:55:56,147 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-03 19:55:56,148 | DEBUG | httpcore.connection | close.started
2025-12-03 19:55:56,149 | DEBUG | httpcore.connection | close.complete
2025-12-03 19:55:59,742 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:55:59,744 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:55:59,746 | INFO | sqlalchemy.engine.Engine | [cached since 7325s ago] ()
2025-12-03 19:55:59,758 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:55:59,761 | INFO | sqlalchemy.engine.Engine | [cached since 3435s ago] (1,)
2025-12-03 19:55:59,902 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-03 19:55:59,902 | INFO | sqlalchemy.engine.Engine | [cached since 3327s ago] (UUID('6f296eb4-4540-47a3-8f74-3275716c7868'), UUID('a21dc360-9581-4136-adca-e0ef2721687d'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "080", "windSpeed": "9", "temp": "22", "dewp": "16", "cloudCover": "FEW", "cloudBase": "4000", "wind": "080/9"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 3, 19, 55, 59, 902965, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 3, 19, 55, 59, 902965, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-03 19:55:59,915 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:56:00,078 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:56:00,079 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-03 19:56:00,080 | INFO | sqlalchemy.engine.Engine | [cached since 3326s ago] (UUID('6f296eb4-4540-47a3-8f74-3275716c7868'),)
2025-12-03 19:56:00,097 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:56:38,217 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:56:38,218 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:56:38,218 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:56:38,220 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:56:38,221 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:56:38,222 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:56:38,222 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:56:38,223 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:56:38,225 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:56:38,226 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:56:38,226 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:56:38,227 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:56:38,228 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:56:38,228 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:56:38,230 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:56:38,231 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:56:38,231 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:56:38,232 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:56:38,233 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:56:38,233 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:56:38,235 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:56:38,235 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:56:38,236 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:56:38,237 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:56:38,238 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:56:38,238 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:56:38,238 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:56:38,241 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:56:38,242 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:56:38,243 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:56:38,243 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:56:38,244 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-03 19:56:38,247 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:38,250 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:38,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:38,379 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:38,380 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:38,498 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:38,500 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:38,618 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:38,620 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:38,621 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:38,623 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:38,748 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:38,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:38,752 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:38,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:38,876 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:38,877 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:38,879 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:38,881 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:38,995 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:38,997 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:38,998 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:39,119 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:39,120 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:39,122 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:39,123 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:39,241 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:39,243 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:39,244 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:56:39,436 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:39,438 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:39,442 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:39,640 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:39,644 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:39,648 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:56:39,846 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:39,848 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:39,851 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:39,854 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:40,080 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,082 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,084 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,087 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:40,211 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,213 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,215 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:40,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:40,448 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:40,451 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,452 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,453 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:40,567 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,569 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:40,699 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,701 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,704 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:40,821 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:40,823 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:40,937 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:40,939 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:40,940 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:41,060 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,062 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,063 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:56:41,190 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:41,193 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:41,320 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,321 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:41,446 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:41,447 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,449 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:56:41,567 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,569 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:56:41,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:41,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:41,840 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,842 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,844 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,847 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:41,991 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:41,993 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,995 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:41,996 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:42,119 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:42,120 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:42,122 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:42,236 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:42,238 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:42,239 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:42,362 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:42,363 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:42,365 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:42,367 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:56:42,489 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:42,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:42,493 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:56:42,613 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:42,614 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:42,617 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:56:42,619 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:56:42,731 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:56:42,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:56:42,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:86]
2025-12-03 19:56:42,735 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:56:42,736 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:56:42,856 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:56:42,857 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:56:42,858 | INFO | sqlalchemy.engine.Engine | [cached since 7368s ago] ()
2025-12-03 19:56:42,865 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 19:56:42,865 | INFO | sqlalchemy.engine.Engine | [cached since 3478s ago] (1,)
2025-12-03 19:56:44,465 | INFO | app.services.transcribe | Starting stream. Total bytes: 1980416. Chunk size: 8192. No throttling.
2025-12-03 19:56:44,467 | DEBUG | app.services.transcribe | Streamed 8192/1980416 bytes
2025-12-03 19:56:44,499 | DEBUG | app.services.transcribe | Streamed 417792/1980416 bytes
2025-12-03 19:56:44,513 | DEBUG | app.services.transcribe | Streamed 827392/1980416 bytes
2025-12-03 19:56:44,527 | DEBUG | app.services.transcribe | Streamed 1236992/1980416 bytes
2025-12-03 19:56:44,540 | DEBUG | app.services.transcribe | Streamed 1646592/1980416 bytes
2025-12-03 19:56:44,558 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 19:56:55,797 | DEBUG | app.services.transcribe | Received transcript chunk: superficie alfa novi...
2025-12-03 19:56:56,043 | INFO | app.services.transcribe | Transcription complete. Length: 181
2025-12-03 19:56:56,044 | INFO | app.controllers.audio | Transcripción recibida session=a21dc360-9581-4136-adca-e0ef2721687d: superficie alfa noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo nivel 7000 pies, dos almas a bordo autonomía cinco horas.
2025-12-03 19:56:56,046 | INFO | app.logs.transcript | student | session=a21dc360-9581-4136-adca-e0ef2721687d | frequency=121.700 | text=superficie alfa noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo nivel 7000 pies, dos almas a bordo autonomía cinco horas.
2025-12-03 19:56:56,163 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:56:56,164 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:56:56,164 | INFO | sqlalchemy.engine.Engine | [cached since 3482s ago] (UUID('a21dc360-9581-4136-adca-e0ef2721687d'),)
2025-12-03 19:56:56,182 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:56:57,029 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:56:57,030 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:56:57,031 | INFO | sqlalchemy.engine.Engine | [cached since 3483s ago] (UUID('a21dc360-9581-4136-adca-e0ef2721687d'),)
2025-12-03 19:56:57,052 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:56:57,053 | INFO | sqlalchemy.engine.Engine | [cached since 3323s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (14602 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-04T01:56:56Z"}]}', datetime.datetime(2025, 12, 3, 19, 56, 57, 52424, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('6f296eb4-4540-47a3-8f74-3275716c7868'))
2025-12-03 19:56:57,074 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:56:57,109 | INFO | app.controllers.audio | Fase activa session=a21dc360-9581-4136-adca-e0ef2721687d phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-03 19:56:57,111 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0537. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": str...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie alfa noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo nivel 7000 pies, dos almas a bordo autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubica...
2025-12-03 19:57:17,664 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0537. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "ground_readback",
...
2025-12-03 19:57:17,665 | INFO | app.controllers.audio | Transición automática de fase session=a21dc360-9581-4136-adca-e0ef2721687d de=ground_departure_request a=ground_readback
2025-12-03 19:57:17,798 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:57:17,799 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 19:57:17,800 | INFO | sqlalchemy.engine.Engine | [cached since 3504s ago] (UUID('a21dc360-9581-4136-adca-e0ef2721687d'),)
2025-12-03 19:57:17,822 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 19:57:17,823 | INFO | sqlalchemy.engine.Engine | [cached since 3344s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "080/9", "cloudBase": "4000", "condition": "VMC", "windSpeed": "9", "cl ... (16402 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0537", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 19, 57, 17, 822651, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('6f296eb4-4540-47a3-8f74-3275716c7868'))
2025-12-03 19:57:17,842 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:57:17,877 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 19:57:17,878 | INFO | sqlalchemy.engine.Engine | [cached since 3330s ago] (UUID('c5fe7463-11c8-4aef-9e2d-e7dff073d8b4'), UUID('a21dc360-9581-4136-adca-e0ef2721687d'), 1, 'ground_readback', 95.0, 'Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.')
2025-12-03 19:57:17,893 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 19:57:17,932 | INFO | app.controllers.audio | Puntuación guardada session=a21dc360-9581-4136-adca-e0ef2721687d phase_id=ground_readback score=95.00
2025-12-03 19:57:17,933 | INFO | app.logs.transcript | controller | session=a21dc360-9581-4136-adca-e0ef2721687d | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 80 grados 9 nudos. QNH 1017. Transponder 0537. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.
2025-12-03 19:58:40,764 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:58:40,766 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 19:58:40,767 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 19:58:40,767 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:58:40,769 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 19:58:40,769 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 19:58:40,770 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:58:40,771 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:58:40,772 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 19:58:40,772 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:58:40,773 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:58:40,776 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 19:58:40,776 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 19:58:40,777 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:58:40,778 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 19:58:40,778 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 19:58:40,780 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:58:40,780 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:58:40,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 19:58:40,782 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:58:40,783 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 19:58:40,783 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 19:58:40,784 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 19:58:40,785 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:58:40,785 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 19:58:40,786 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 19:58:40,787 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:58:40,788 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 19:58:40,788 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 19:58:40,791 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 19:58:40,792 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 19:58:40,793 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 19:58:40,797 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:40,798 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:58:40,919 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:40,920 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:40,923 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:40,925 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:58:41,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:41,097 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,100 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:41,102 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:58:41,243 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:41,244 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,245 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:41,367 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,369 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,370 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,373 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:41,580 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:41,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,590 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,590 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:58:41,755 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:41,757 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,761 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,763 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:58:41,944 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:41,946 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:41,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:42,080 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:42,082 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,084 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:42,086 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:58:42,248 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:42,250 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,254 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:42,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,393 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:42,395 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:42,539 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,540 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,543 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,546 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,549 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:58:42,728 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,730 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-03 19:58:42,951 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:42,953 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:42,955 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:42,959 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:58:43,102 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:43,103 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:43,106 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:43,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:58:43,280 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:58:43,283 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:43,472 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:43,476 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 19:58:43,633 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 19:58:43,635 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:43,760 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:43,762 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:43,763 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:43,765 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:58:43,896 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:43,897 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:43,899 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:44,028 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,030 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:44,031 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:44,148 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,148 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:44,151 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:44,275 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,276 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,278 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 19:58:44,398 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,398 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:44,401 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:44,517 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,518 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:44,521 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3811]
2025-12-03 19:58:44,662 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 19:58:44,663 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:44,665 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,666 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 19:58:44,792 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,794 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 19:58:44,795 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 19:58:44,796 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 19:58:44,829 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2251]
2025-12-03 19:58:44,830 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 19:58:44,830 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 19:58:44,957 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:58:44,959 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:58:44,960 | INFO | sqlalchemy.engine.Engine | [cached since 7491s ago] ()
2025-12-03 19:58:44,966 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:59:13,841 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:59:13,842 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:59:13,843 | INFO | sqlalchemy.engine.Engine | [cached since 7519s ago] ()
2025-12-03 19:59:13,852 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:59:26,234 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:59:26,235 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:59:26,236 | INFO | sqlalchemy.engine.Engine | [cached since 7532s ago] ()
2025-12-03 19:59:26,245 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:59:26,254 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:59:26,255 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:59:26,257 | INFO | sqlalchemy.engine.Engine | [cached since 7532s ago] ()
2025-12-03 19:59:26,267 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 19:59:49,313 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 19:59:49,314 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 19:59:49,315 | INFO | sqlalchemy.engine.Engine | [cached since 7555s ago] ()
2025-12-03 19:59:49,321 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:03:10,249 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:03:10,250 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:03:10,252 | INFO | sqlalchemy.engine.Engine | [cached since 7756s ago] ()
2025-12-03 20:03:10,262 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:04:47,611 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-03 20:04:47,612 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-03 20:04:47,618 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-03 20:04:47,619 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-03 20:04:47,624 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-03 20:04:47,625 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-03 20:04:47,631 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:04:47,632 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-03 20:04:47,634 | INFO | sqlalchemy.engine.Engine | [generated in 0.00126s] ()
2025-12-03 20:04:47,640 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:04:47,642 | INFO | sqlalchemy.engine.Engine | [generated in 0.00106s] ()
2025-12-03 20:04:47,649 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,650 | INFO | sqlalchemy.engine.Engine | [generated in 0.00123s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,670 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,672 | INFO | sqlalchemy.engine.Engine | [cached since 0.02194s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,674 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,675 | INFO | sqlalchemy.engine.Engine | [cached since 0.02698s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,681 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,681 | INFO | sqlalchemy.engine.Engine | [cached since 0.03187s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,686 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,686 | INFO | sqlalchemy.engine.Engine | [cached since 0.03736s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,691 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,692 | INFO | sqlalchemy.engine.Engine | [cached since 0.04279s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,696 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,696 | INFO | sqlalchemy.engine.Engine | [cached since 0.0476s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,700 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-03 20:04:47,702 | INFO | sqlalchemy.engine.Engine | [cached since 0.05297s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-03 20:04:47,708 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 20:04:47,708 | INFO | sqlalchemy.engine.Engine | [generated in 0.00097s] ('group_role', 'pg_catalog')
2025-12-03 20:04:47,716 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 20:04:47,716 | INFO | sqlalchemy.engine.Engine | [cached since 0.008523s ago] ('group_membership_status', 'pg_catalog')
2025-12-03 20:04:47,721 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 20:04:47,721 | INFO | sqlalchemy.engine.Engine | [cached since 0.01411s ago] ('user_status', 'pg_catalog')
2025-12-03 20:04:47,726 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-03 20:04:47,727 | INFO | sqlalchemy.engine.Engine | [cached since 0.01923s ago] ('account_type', 'pg_catalog')
2025-12-03 20:04:47,732 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-03 20:04:47,732 | INFO | sqlalchemy.engine.Engine | [generated in 0.00092s] ()
2025-12-03 20:04:47,739 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-03 20:04:47,740 | INFO | sqlalchemy.engine.Engine | [generated in 0.00070s] ()
2025-12-03 20:04:47,758 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-03 20:04:47,760 | INFO | sqlalchemy.engine.Engine | [generated in 0.00174s] ()
2025-12-03 20:04:47,871 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:04:47,902 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-03 20:06:15,275 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:06:15,276 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:06:15,276 | INFO | sqlalchemy.engine.Engine | [cached since 87.64s ago] ()
2025-12-03 20:06:15,304 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-03 20:06:15,305 | INFO | sqlalchemy.engine.Engine | [generated in 0.00098s] ('josuelu2@gmail.com',)
2025-12-03 20:06:15,444 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:06:17,397 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:06:17,398 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:06:17,399 | INFO | sqlalchemy.engine.Engine | [cached since 89.76s ago] ()
2025-12-03 20:06:17,408 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:17,408 | INFO | sqlalchemy.engine.Engine | [generated in 0.00103s] (1,)
2025-12-03 20:06:17,438 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:06:17,440 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:06:17,445 | INFO | sqlalchemy.engine.Engine | [cached since 89.8s ago] ()
2025-12-03 20:06:17,453 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:17,454 | INFO | sqlalchemy.engine.Engine | [cached since 0.04614s ago] (1,)
2025-12-03 20:06:17,491 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:06:17,528 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:17,529 | INFO | sqlalchemy.engine.Engine | [cached since 0.1212s ago] (1,)
2025-12-03 20:06:17,535 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 20:06:17,536 | INFO | sqlalchemy.engine.Engine | [generated in 0.00111s] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 20:06:17,556 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:06:18,303 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:06:18,304 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:06:18,305 | INFO | sqlalchemy.engine.Engine | [cached since 90.67s ago] ()
2025-12-03 20:06:18,314 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:18,315 | INFO | sqlalchemy.engine.Engine | [cached since 0.9075s ago] (1,)
2025-12-03 20:06:18,337 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:06:18,338 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:06:18,340 | INFO | sqlalchemy.engine.Engine | [cached since 90.7s ago] ()
2025-12-03 20:06:18,350 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:18,352 | INFO | sqlalchemy.engine.Engine | [cached since 0.9433s ago] (1,)
2025-12-03 20:06:18,419 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:18,421 | INFO | sqlalchemy.engine.Engine | [cached since 1.012s ago] (1,)
2025-12-03 20:06:18,430 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 20:06:18,432 | INFO | sqlalchemy.engine.Engine | [generated in 0.00184s] ('scenario_id', 'session_completed', 1)
2025-12-03 20:06:18,447 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:06:18,450 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:18,451 | INFO | sqlalchemy.engine.Engine | [cached since 1.043s ago] (1,)
2025-12-03 20:06:18,455 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 20:06:18,457 | INFO | sqlalchemy.engine.Engine | [cached since 0.9223s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 20:06:18,475 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:06:26,508 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-03 20:06:26,643 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001437F7F9C90>
2025-12-03 20:06:26,644 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x000001437F86E8D0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-03 20:06:26,751 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001437CC935D0>
2025-12-03 20:06:26,752 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-03 20:06:26,754 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-03 20:06:26,755 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-03 20:06:26,756 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-03 20:06:26,756 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-03 20:06:26,882 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 04 Dec 2025 02:06:27 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'473'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1d9-JdzWQeB4ha/lNnFWrcdRg4ft6eQ"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251204T020627Z-1654ff75797c6sb2hC1MIAnwqw0000000zrg00000000f069'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-03 20:06:26,884 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-03 20:06:26,885 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-03 20:06:26,885 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-03 20:06:26,887 | DEBUG | httpcore.http11 | response_closed.started
2025-12-03 20:06:26,888 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-03 20:06:26,889 | DEBUG | httpcore.connection | close.started
2025-12-03 20:06:26,890 | DEBUG | httpcore.connection | close.complete
2025-12-03 20:06:30,396 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:06:30,398 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:06:30,399 | INFO | sqlalchemy.engine.Engine | [cached since 102.8s ago] ()
2025-12-03 20:06:30,411 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:06:30,413 | INFO | sqlalchemy.engine.Engine | [cached since 13s ago] (1,)
2025-12-03 20:06:30,555 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-03 20:06:30,556 | INFO | sqlalchemy.engine.Engine | [generated in 0.01427s] (UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1018", "windDirection": "110", "windSpeed": "13", "temp": "22", "dewp": "16", "cloudCover": "FEW", "cloudBase": "4000", "wind": "110/13"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 3, 20, 6, 30, 554956, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 3, 20, 6, 30, 554956, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-03 20:06:30,571 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:06:30,774 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:06:30,777 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-03 20:06:30,778 | INFO | sqlalchemy.engine.Engine | [generated in 0.00104s] (UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'),)
2025-12-03 20:06:30,794 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:07:17,749 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:07:17,750 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 20:07:17,752 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 20:07:17,753 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:07:17,754 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 20:07:17,754 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 20:07:17,755 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:07:17,756 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:07:17,757 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 20:07:17,757 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:07:17,759 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:07:17,759 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 20:07:17,760 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 20:07:17,760 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:07:17,761 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 20:07:17,762 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 20:07:17,764 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:07:17,764 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:07:17,766 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 20:07:17,767 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:07:17,767 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:07:17,768 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 20:07:17,768 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 20:07:17,769 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:07:17,770 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 20:07:17,770 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 20:07:17,772 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:07:17,773 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 20:07:17,773 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 20:07:17,774 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:07:17,774 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:07:17,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-03 20:07:17,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:17,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:17,890 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:17,892 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:17,894 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:17,896 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:18,016 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,018 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,020 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,022 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:18,138 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,140 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,142 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,144 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:18,306 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:07:18,309 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,312 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:18,451 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,453 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,454 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,455 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:18,575 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,576 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,578 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:18,708 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,710 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:18,838 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,839 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,842 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:18,958 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:18,960 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:18,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:19,080 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:07:19,081 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:19,208 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,209 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:19,212 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,214 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:19,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:19,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,353 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:19,356 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:19,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:07:19,514 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,517 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:19,647 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:19,648 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,650 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,652 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:19,842 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,844 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,847 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:19,850 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:20,071 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:20,072 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,075 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:20,077 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:20,276 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,278 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,282 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,284 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:20,473 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:07:20,475 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,477 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,478 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:20,614 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:07:20,616 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,618 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,620 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:20,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:20,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,783 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:20,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:20,914 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:20,916 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:21,046 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,049 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:21,050 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:21,052 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:21,201 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:21,203 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,204 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:21,342 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,344 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,345 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,347 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:21,484 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:21,485 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,488 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:21,624 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:07:21,626 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,630 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:21,762 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:21,764 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:21,945 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:21,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:21,953 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:22,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:22,108 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:22,111 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:22,113 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:22,265 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:07:22,267 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:22,269 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:22,426 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:22,427 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:22,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:07:22,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:22,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:22,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:22,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:07:22,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:22,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:07:22,717 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:07:22,719 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:07:22,731 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:586]
2025-12-03 20:07:22,731 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:07:22,732 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 20:07:22,863 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:07:22,864 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:07:22,864 | INFO | sqlalchemy.engine.Engine | [cached since 155.2s ago] ()
2025-12-03 20:07:22,872 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:07:22,876 | INFO | sqlalchemy.engine.Engine | [cached since 65.47s ago] (1,)
2025-12-03 20:07:25,629 | INFO | app.services.transcribe | Starting stream. Total bytes: 1990656. Chunk size: 8192. No throttling.
2025-12-03 20:07:25,633 | DEBUG | app.services.transcribe | Streamed 8192/1990656 bytes
2025-12-03 20:07:25,650 | DEBUG | app.services.transcribe | Streamed 417792/1990656 bytes
2025-12-03 20:07:25,665 | DEBUG | app.services.transcribe | Streamed 827392/1990656 bytes
2025-12-03 20:07:25,682 | DEBUG | app.services.transcribe | Streamed 1236992/1990656 bytes
2025-12-03 20:07:25,702 | DEBUG | app.services.transcribe | Streamed 1646592/1990656 bytes
2025-12-03 20:07:25,714 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 20:07:37,263 | DEBUG | app.services.transcribe | Received transcript chunk: superficie Alfa Novi...
2025-12-03 20:07:37,520 | INFO | app.services.transcribe | Transcription complete. Length: 173
2025-12-03 20:07:37,521 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo niveles, dos almas a bordo, autonomía cinco horas
2025-12-03 20:07:37,522 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | text=superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo niveles, dos almas a bordo, autonomía cinco horas
2025-12-03 20:07:37,632 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:07:37,633 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:07:37,634 | INFO | sqlalchemy.engine.Engine | [generated in 0.00100s] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:07:37,648 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:07:41,484 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:07:41,485 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:07:41,486 | INFO | sqlalchemy.engine.Engine | [cached since 3.853s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:07:41,500 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:07:41,501 | INFO | sqlalchemy.engine.Engine | [generated in 0.00113s] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (14620 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-04T02:07:41Z"}]}', datetime.datetime(2025, 12, 3, 20, 7, 41, 500594, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:07:41,516 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:07:41,545 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-03 20:07:41,547 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 110 grados 13 nudos. QNH 1018. Transponder 0598. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": s...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie Alfa Noviembre India en plataforma remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía Pasogo niveles, dos almas a bordo, autonomía cinco horas

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicación act...
2025-12-03 20:08:00,630 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 110 grados 13 nudos. QNH 1018. Transponder 0598. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, nivel inicial, almas y autonomía. Proceda con autorización de rodaje.",
  "confidence...
2025-12-03 20:08:00,632 | INFO | app.controllers.audio | Transición automática de fase session=addc8698-ae92-4006-8ad3-08b90eedaab9 de=ground_departure_request a=ground_readback
2025-12-03 20:08:00,764 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:08:00,766 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:08:00,767 | INFO | sqlalchemy.engine.Engine | [cached since 23.13s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:08:00,783 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:08:00,784 | INFO | sqlalchemy.engine.Engine | [cached since 19.28s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (16134 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 20, 8, 0, 783053, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:08:00,802 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:08:00,834 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 20:08:00,836 | INFO | sqlalchemy.engine.Engine | [generated in 0.00171s] (UUID('bfc600da-f689-48e9-b529-1f11f5bb7da8'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'ground_readback', 95.0, 'Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, nivel inicial, almas y autonomía. Proceda con autorización de rodaje.')
2025-12-03 20:08:00,853 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:08:00,886 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=ground_readback score=95.00
2025-12-03 20:08:00,887 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 110 grados 13 nudos. QNH 1018. Transponder 0598. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.
2025-12-03 20:10:08,062 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:10:08,063 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 20:10:08,064 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 20:10:08,064 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:10:08,065 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 20:10:08,066 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 20:10:08,067 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:10:08,067 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:10:08,068 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 20:10:08,069 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:10:08,070 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:10:08,071 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 20:10:08,072 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 20:10:08,072 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:10:08,073 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 20:10:08,073 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 20:10:08,074 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:10:08,075 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:10:08,076 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 20:10:08,077 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:10:08,078 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:10:08,078 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 20:10:08,080 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 20:10:08,080 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:10:08,081 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 20:10:08,082 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 20:10:08,082 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:10:08,083 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 20:10:08,084 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 20:10:08,085 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:10:08,085 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:10:08,087 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 20:10:08,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:08,091 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:08,206 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:08,207 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:08,209 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:08,211 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:08,357 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:08,360 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:08,361 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:08,364 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:08,541 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:08,542 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:08,544 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:10:08,674 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:08,675 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:08,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:10:08,808 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:10:08,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:08,813 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:10:08,934 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:08,935 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:08,937 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:10:09,067 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,068 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,070 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,071 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:10:09,191 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:09,192 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:10:09,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:09,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,327 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:09,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:09,516 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:09,517 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,518 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:10:09,675 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-03 20:10:09,678 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:09,813 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:10:09,816 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:09,817 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:10:10,065 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,068 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,070 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,073 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:10:10,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,314 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,316 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,321 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:10:10,523 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,528 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,532 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,536 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:10,688 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,691 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:10,821 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,823 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,825 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,828 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:10:10,978 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:10,981 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:10,983 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:11,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,102 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:11,104 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,106 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:11,222 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:11,224 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,225 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,227 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:11,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:10:11,353 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,355 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:11,477 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:11,478 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,481 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:10:11,602 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,604 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:10:11,605 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:10:11,607 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:10:11,627 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:831]
2025-12-03 20:10:11,628 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:10:11,629 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 20:10:11,737 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:10:11,738 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:10:11,738 | INFO | sqlalchemy.engine.Engine | [cached since 324.1s ago] ()
2025-12-03 20:10:11,747 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:10:11,748 | INFO | sqlalchemy.engine.Engine | [cached since 234.3s ago] (1,)
2025-12-03 20:10:16,963 | INFO | app.services.transcribe | Starting stream. Total bytes: 1398784. Chunk size: 8192. No throttling.
2025-12-03 20:10:16,974 | DEBUG | app.services.transcribe | Streamed 8192/1398784 bytes
2025-12-03 20:10:17,057 | DEBUG | app.services.transcribe | Streamed 417792/1398784 bytes
2025-12-03 20:10:17,118 | DEBUG | app.services.transcribe | Streamed 827392/1398784 bytes
2025-12-03 20:10:17,161 | DEBUG | app.services.transcribe | Streamed 1236992/1398784 bytes
2025-12-03 20:10:17,165 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 20:10:24,110 | DEBUG | app.services.transcribe | Received transcript chunk: NH1018 Transponder 0...
2025-12-03 20:10:24,260 | INFO | app.services.transcribe | Transcription complete. Length: 76
2025-12-03 20:10:24,261 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: NH1018 Transponder 0598 Rodaré vía Alpha Alpha Al.de espera pista 10 Listo.
2025-12-03 20:10:24,262 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | text=NH1018 Transponder 0598 Rodaré vía Alpha Alpha Al.de espera pista 10 Listo.
2025-12-03 20:10:24,390 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:10:24,390 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:10:24,392 | INFO | sqlalchemy.engine.Engine | [cached since 166.8s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:10:24,406 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:10:26,687 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:10:26,688 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:10:26,689 | INFO | sqlalchemy.engine.Engine | [cached since 169.1s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:10:26,701 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:10:26,701 | INFO | sqlalchemy.engine.Engine | [cached since 165.2s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (16634 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 20, 10, 26, 700893, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:10:26,717 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:10:26,748 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 20:10:26,752 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
NH1018 Transponder 0598 Rodaré vía Alpha Alpha Al.de espera pista 10 Listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colacion...
2025-12-03 20:10:34,876 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Error en la ruta de rodaje: dijo 'Alpha Alpha' en lugar de 'Alfa 3, Alfa'. Corrija la ruta exacta antes de proceder.",
  "confidence": 0.85,
  "score": 60,
  "metadata": {
    "missingItems": [
      "Ruta de rodaje exacta (Alfa 3, Alfa)"
    ],
    "incorrectItems": [
      "Ruta de rodaje (Alpha Alpha en lugar de Alfa 3, Alfa)"
    ]
  }
}
2025-12-03 20:10:34,878 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-03 20:10:34,998 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:10:34,998 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:10:35,000 | INFO | sqlalchemy.engine.Engine | [cached since 177.4s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:10:35,012 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:10:35,012 | INFO | sqlalchemy.engine.Engine | [cached since 173.5s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (17784 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 20, 10, 35, 12186, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:10:35,023 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:10:35,050 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 20:10:35,051 | INFO | sqlalchemy.engine.Engine | [cached since 154.2s ago] (UUID('0123d197-08d5-46a0-bf36-04d29a8c9da2'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'ground_readback', 60.0, "Error en la ruta de rodaje: dijo 'Alpha Alpha' en lugar de 'Alfa 3, Alfa'. Corrija la ruta exacta antes de proceder.")
2025-12-03 20:10:35,063 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:10:35,084 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=ground_readback score=60.00
2025-12-03 20:10:35,084 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | intent=ground_taxi_readback | phase=ground_readback | allow_response=False | text=
2025-12-03 20:11:18,145 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:11:18,145 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 20:11:18,146 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 20:11:18,147 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:11:18,148 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 20:11:18,148 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 20:11:18,150 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:11:18,151 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:11:18,152 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 20:11:18,152 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:11:18,153 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:11:18,154 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 20:11:18,155 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 20:11:18,155 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:11:18,156 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 20:11:18,157 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 20:11:18,159 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:11:18,159 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:11:18,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 20:11:18,161 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:11:18,162 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:11:18,162 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 20:11:18,163 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 20:11:18,164 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:11:18,165 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 20:11:18,165 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 20:11:18,166 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:11:18,166 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 20:11:18,167 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 20:11:18,168 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:11:18,168 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:11:18,170 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 20:11:18,171 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:11:18,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:18,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:18,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:18,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:18,438 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:18,440 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:18,442 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:18,598 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:18,600 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:18,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:18,604 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:18,818 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:18,820 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:18,821 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:18,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:18,974 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:18,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:18,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:18,984 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:19,175 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:19,177 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:19,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:19,180 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:11:19,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:19,323 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:19,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:19,326 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:19,456 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:19,457 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:19,459 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:19,607 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:19,609 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:19,611 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:19,733 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:19,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:19,735 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:19,865 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:11:19,865 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:19,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:20,103 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:20,105 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:20,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:20,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:20,421 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:20,423 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:20,425 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:20,436 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:20,439 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:20,686 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:20,689 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:20,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:20,866 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:20,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:20,870 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:21,002 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,004 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:21,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:21,132 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,133 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:21,136 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,138 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:21,260 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,262 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:21,262 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:21,384 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,386 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 20:11:21,512 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,514 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:11:21,516 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:11:21,666 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,668 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:21,670 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:21,800 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:11:21,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:11:21,802 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:11:21,837 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2230]
2025-12-03 20:11:21,837 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:11:21,839 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 20:11:21,950 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:11:21,950 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:11:21,951 | INFO | sqlalchemy.engine.Engine | [cached since 394.3s ago] ()
2025-12-03 20:11:21,960 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:11:21,960 | INFO | sqlalchemy.engine.Engine | [cached since 304.6s ago] (1,)
2025-12-03 20:11:22,913 | INFO | app.services.transcribe | Starting stream. Total bytes: 1349632. Chunk size: 8192. No throttling.
2025-12-03 20:11:22,915 | DEBUG | app.services.transcribe | Streamed 8192/1349632 bytes
2025-12-03 20:11:22,936 | DEBUG | app.services.transcribe | Streamed 417792/1349632 bytes
2025-12-03 20:11:22,962 | DEBUG | app.services.transcribe | Streamed 827392/1349632 bytes
2025-12-03 20:11:22,981 | DEBUG | app.services.transcribe | Streamed 1236992/1349632 bytes
2025-12-03 20:11:22,984 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 20:11:30,040 | DEBUG | app.services.transcribe | Received transcript chunk: QNH1018 Transponder ...
2025-12-03 20:11:30,152 | INFO | app.services.transcribe | Transcription complete. Length: 77
2025-12-03 20:11:30,154 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: QNH1018 Transponder 0598 Rodaré vía Alpha Alpha Al.de espera pista 10 Listo.
2025-12-03 20:11:30,155 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | text=QNH1018 Transponder 0598 Rodaré vía Alpha Alpha Al.de espera pista 10 Listo.
2025-12-03 20:11:30,524 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:11:30,525 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:11:30,526 | INFO | sqlalchemy.engine.Engine | [cached since 232.9s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:11:30,544 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:11:32,969 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:11:32,970 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:11:32,970 | INFO | sqlalchemy.engine.Engine | [cached since 235.3s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:11:32,983 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:11:32,983 | INFO | sqlalchemy.engine.Engine | [cached since 231.5s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (18285 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 20, 11, 32, 982178, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:11:32,997 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:11:33,029 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 20:11:33,031 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH1018 Transponder 0598 Rodaré vía Alpha Alpha Al.de espera pista 10 Listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colacio...
2025-12-03 20:11:41,078 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persiste el error en la ruta de rodaje. La autorización original fue 'Alfa 3, Alfa', pero se repite 'Alpha Alpha'. Corrija la ruta exacta para continuar.",
  "confidence": 0.92,
  "score": 60,
  "metadata": {
    "missingItems": ["Ruta de rodaje exacta"],
    "nextStep": "Repita la autorización con la ruta correcta: Alfa 3, Alfa"
  }
}
2025-12-03 20:11:41,196 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:11:41,197 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:11:41,199 | INFO | sqlalchemy.engine.Engine | [cached since 243.6s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:11:41,212 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:11:41,212 | INFO | sqlalchemy.engine.Engine | [cached since 239.7s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (19471 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 20, 11, 41, 212605, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:11:41,227 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:11:41,252 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 20:11:41,253 | INFO | sqlalchemy.engine.Engine | [cached since 220.4s ago] (UUID('678b97e7-ab72-4d02-b4c3-065fe91ec801'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'ground_readback', 60.0, "Persiste el error en la ruta de rodaje. La autorización original fue 'Alfa 3, Alfa', pero se repite 'Alpha Alpha'. Corrija la ruta exacta para continuar.")
2025-12-03 20:11:41,265 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:11:41,299 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=ground_readback score=60.00
2025-12-03 20:11:41,301 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-03 20:12:18,682 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:12:18,683 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 20:12:18,683 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 20:12:18,684 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:12:18,684 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 20:12:18,685 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 20:12:18,686 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:12:18,687 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:12:18,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 20:12:18,688 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:12:18,689 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:12:18,690 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 20:12:18,691 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 20:12:18,691 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:12:18,692 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 20:12:18,692 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 20:12:18,692 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:12:18,694 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:12:18,695 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 20:12:18,696 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:12:18,696 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:12:18,697 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 20:12:18,697 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 20:12:18,697 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:12:18,699 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 20:12:18,700 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 20:12:18,700 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:12:18,700 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 20:12:18,701 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 20:12:18,702 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:12:18,703 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:12:18,704 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-03 20:12:18,706 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:12:18,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:18,858 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:18,860 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:19,021 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,023 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,025 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,027 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:19,182 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:12:19,183 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,185 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:12:19,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:19,324 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,326 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:19,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,465 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:19,467 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:19,470 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:12:19,624 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,626 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:19,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,630 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:12:19,793 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:19,796 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,798 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:19,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:19,974 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:19,976 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:20,280 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:20,282 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:20,285 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:20,288 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:12:20,584 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:20,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:20,589 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:20,591 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:12:20,847 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:12:20,847 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:20,850 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:20,852 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:12:21,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,027 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,030 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:21,182 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,183 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:21,184 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:21,323 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:21,324 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:21,331 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:12:21,485 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:21,487 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,494 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:21,654 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:21,667 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:21,812 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:21,813 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:21,817 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:12:21,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:12:21,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:21,966 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:12:22,177 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:22,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:22,180 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:22,181 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:12:22,385 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:22,387 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:22,388 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:12:22,615 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:22,616 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:12:22,618 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:22,621 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:12:22,731 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:12:22,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:435]
2025-12-03 20:12:22,733 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:12:22,734 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 20:12:22,854 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:12:22,855 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:12:22,856 | INFO | sqlalchemy.engine.Engine | [cached since 455.2s ago] ()
2025-12-03 20:12:22,864 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:12:22,864 | INFO | sqlalchemy.engine.Engine | [cached since 365.5s ago] (1,)
2025-12-03 20:12:23,774 | INFO | app.services.transcribe | Starting stream. Total bytes: 1298432. Chunk size: 8192. No throttling.
2025-12-03 20:12:23,777 | DEBUG | app.services.transcribe | Streamed 8192/1298432 bytes
2025-12-03 20:12:23,806 | DEBUG | app.services.transcribe | Streamed 417792/1298432 bytes
2025-12-03 20:12:23,836 | DEBUG | app.services.transcribe | Streamed 827392/1298432 bytes
2025-12-03 20:12:23,859 | DEBUG | app.services.transcribe | Streamed 1236992/1298432 bytes
2025-12-03 20:12:23,863 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 20:12:26,038 | DEBUG | app.services.transcribe | Received transcript chunk: QNH1018...
2025-12-03 20:12:30,786 | DEBUG | app.services.transcribe | Received transcript chunk: transponder 0598 Rod...
2025-12-03 20:12:30,891 | INFO | app.services.transcribe | Transcription complete. Length: 76
2025-12-03 20:12:30,892 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: QNH1018 transponder 0598 Rodaré vía Alfa tres al.de espera pista 10. Listo.
2025-12-03 20:12:30,893 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | text=QNH1018 transponder 0598 Rodaré vía Alfa tres al.de espera pista 10. Listo.
2025-12-03 20:12:31,005 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:12:31,006 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:12:31,007 | INFO | sqlalchemy.engine.Engine | [cached since 293.4s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:12:31,021 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:12:34,280 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:12:34,281 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:12:34,282 | INFO | sqlalchemy.engine.Engine | [cached since 296.6s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:12:34,297 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:12:34,298 | INFO | sqlalchemy.engine.Engine | [cached since 292.8s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (19971 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 3, 20, 12, 34, 296625, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:12:34,314 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:12:34,344 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-03 20:12:34,348 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH1018 transponder 0598 Rodaré vía Alfa tres al.de espera pista 10. Listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar restricciones (mantenga, espere).
- NO colacion...
2025-12-03 20:12:43,073 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "Colación completa y correcta. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje y punto de espera. Puede proceder a contactar Torre.",
  "confidence": 0.98,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_hold_short",
    "missingItems": [],
    "extraItems": []
  }
}
2025-12-03 20:12:43,075 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-03 20:12:43,076 | INFO | app.controllers.audio | Transición automática de fase session=addc8698-ae92-4006-8ad3-08b90eedaab9 de=ground_readback a=tower_hold_short
2025-12-03 20:12:43,226 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:12:43,227 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:12:43,228 | INFO | sqlalchemy.engine.Engine | [cached since 305.6s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:12:43,274 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:12:43,276 | INFO | sqlalchemy.engine.Engine | [cached since 301.8s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (21246 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 20, 12, 43, 274052, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:12:43,304 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:12:43,336 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 20:12:43,338 | INFO | sqlalchemy.engine.Engine | [cached since 282.5s ago] (UUID('4a7e9137-e9d9-4830-9251-544015ee8901'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'tower_hold_short', 95.0, 'Colación completa y correcta. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje y punto de espera. Puede proceder a contactar Torre.')
2025-12-03 20:12:43,351 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:12:43,376 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_hold_short score=95.00
2025-12-03 20:12:43,378 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=121.700 | intent=ground_taxi_readback | phase=tower_hold_short | allow_response=True | text=Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-03 20:15:49,323 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:15:49,323 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 20:15:49,324 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 20:15:49,325 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:15:49,326 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 20:15:49,326 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 20:15:49,327 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:15:49,327 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:15:49,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 20:15:49,331 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:15:49,331 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:15:49,332 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 20:15:49,333 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 20:15:49,333 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:15:49,333 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 20:15:49,334 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 20:15:49,335 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:15:49,336 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:15:49,337 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 20:15:49,337 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:15:49,339 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:15:49,340 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 20:15:49,340 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 20:15:49,341 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:15:49,342 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 20:15:49,342 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 20:15:49,343 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:15:49,343 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 20:15:49,344 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-03 20:15:49,345 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:15:49,345 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:15:49,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-03 20:15:49,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:49,459 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:49,462 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:49,587 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:49,590 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:49,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:49,714 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:49,717 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:15:49,834 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,836 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:49,838 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:49,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,963 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:49,967 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:50,114 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:50,116 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,120 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:50,351 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,354 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,356 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,359 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:50,361 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:15:50,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,601 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,604 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,607 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:50,611 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:15:50,898 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,902 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,906 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:50,908 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:50,912 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:15:51,078 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:51,080 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:51,082 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:51,210 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:51,212 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:51,213 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:51,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1459]
2025-12-03 20:15:51,370 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-03 20:15:51,371 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:51,373 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:15:51,519 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:15:51,521 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:51,529 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:15:51,531 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:15:51,622 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:15:51,625 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1955]
2025-12-03 20:15:51,626 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:15:51,626 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 20:15:51,734 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:15:51,734 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:15:51,735 | INFO | sqlalchemy.engine.Engine | [cached since 664.1s ago] ()
2025-12-03 20:15:51,742 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:15:51,743 | INFO | sqlalchemy.engine.Engine | [cached since 574.3s ago] (1,)
2025-12-03 20:15:52,678 | INFO | app.services.transcribe | Starting stream. Total bytes: 862208. Chunk size: 8192. No throttling.
2025-12-03 20:15:52,682 | DEBUG | app.services.transcribe | Streamed 8192/862208 bytes
2025-12-03 20:15:52,700 | DEBUG | app.services.transcribe | Streamed 417792/862208 bytes
2025-12-03 20:15:52,723 | DEBUG | app.services.transcribe | Streamed 827392/862208 bytes
2025-12-03 20:15:52,728 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 20:15:56,172 | DEBUG | app.services.transcribe | Received transcript chunk: Torre Alfa Noviembre...
2025-12-03 20:15:57,087 | DEBUG | app.services.transcribe | Received transcript chunk: listo para salida....
2025-12-03 20:15:57,147 | INFO | app.services.transcribe | Transcription complete. Length: 66
2025-12-03 20:15:57,148 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: Torre Alfa Noviembre India en.de espera pista. listo para salida.
2025-12-03 20:15:57,148 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | text=Torre Alfa Noviembre India en.de espera pista. listo para salida.
2025-12-03 20:15:57,290 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:15:57,291 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:15:57,292 | INFO | sqlalchemy.engine.Engine | [cached since 499.7s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:15:57,308 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:15:58,108 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:15:58,109 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:15:58,110 | INFO | sqlalchemy.engine.Engine | [cached since 500.5s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:15:58,122 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:15:58,123 | INFO | sqlalchemy.engine.Engine | [cached since 496.6s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (21724 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 20, 15, 58, 122938, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:15:58,137 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:15:58,161 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_hold_short intent=tower_ready_for_departure freq=tower
2025-12-03 20:15:58,163 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_ready_for_departure freq_group=tower
SYSTEM> Eres Pavas Torre (118.3). Cuando la aeronave se reporta lista, responde: '[Matrícula], mantenga fuera de pista, tránsito en final corto.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": num...
USER> Fase actual: Contacto inicial con Torre (mantener fuera)
Intent esperado: tower_ready_for_departure
Transcripción textual del alumno:
Torre Alfa Noviembre India en.de espera pista. listo para salida.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_hold_short

Checklist alumno:
- Reportar punto de espera pista uno cero.
- Colacionar: 'Mantengo fuera de pista' o 'A posición y mantengo'.
- Colacionar instrucciones condicionales (ej. 'detrás del tránsito').
-...
2025-12-03 20:16:07,482 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_ready_for_departure intento=1: {
  "intent": "tower_ready_for_departure",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.",
  "feedback": "Reporte inicial correcto a Torre. Se usó 'listo para salida' apropiadamente. Seguimos protocolo de espera por tráfico.",
  "confidence": 0.92,
  "score": 90,
  "metadata": {
    "nextPhase": "tower_line_up",
    "missingElements": [],
    "additionalNotes": "El alumno reportó correctamente su posición y estado. La ins...
2025-12-03 20:16:07,482 | INFO | app.controllers.audio | Transición automática de fase session=addc8698-ae92-4006-8ad3-08b90eedaab9 de=tower_hold_short a=tower_line_up
2025-12-03 20:16:07,595 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:16:07,596 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:16:07,597 | INFO | sqlalchemy.engine.Engine | [cached since 510s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:16:07,611 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:16:07,612 | INFO | sqlalchemy.engine.Engine | [cached since 506.1s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (23265 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 20, 16, 7, 611075, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:16:07,624 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:16:07,647 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 20:16:07,648 | INFO | sqlalchemy.engine.Engine | [cached since 486.8s ago] (UUID('79ca8a4a-4930-4783-9795-d37649231f08'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'tower_line_up', 90.0, "Reporte inicial correcto a Torre. Se usó 'listo para salida' apropiadamente. Seguimos protocolo de espera por tráfico.")
2025-12-03 20:16:07,658 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:16:07,682 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_line_up score=90.00
2025-12-03 20:16:07,683 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | intent=tower_ready_for_departure | phase=tower_line_up | allow_response=True | text=Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.
2025-12-03 20:17:43,483 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:17:43,484 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 20:17:43,485 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 20:17:43,486 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:17:43,487 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 20:17:43,487 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 20:17:43,488 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:17:43,489 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:17:43,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 20:17:43,490 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:17:43,492 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:17:43,492 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 20:17:43,493 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 20:17:43,494 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:17:43,494 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 20:17:43,495 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 20:17:43,496 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:17:43,497 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:17:43,497 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 20:17:43,499 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:17:43,499 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:17:43,500 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 20:17:43,500 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 20:17:43,501 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:17:43,502 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 20:17:43,503 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 20:17:43,504 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:17:43,504 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 20:17:43,505 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 20:17:43,506 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:17:43,507 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:17:43,508 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:2920]
2025-12-03 20:17:43,510 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:43,512 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:17:43,613 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:17:43,615 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:17:43,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:43,733 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:17:43,735 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:17:43,846 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:43,848 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:17:43,851 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:17:43,968 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:43,969 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:17:43,970 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 20:17:44,087 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:44,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:17:44,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:44,097 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:17:44,224 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:17:44,225 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:44,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:17:44,230 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:17:44,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:17:44,347 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:17:44,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:17:44,351 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:17:44,383 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2252]
2025-12-03 20:17:44,384 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:17:44,385 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 20:17:44,510 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:17:44,511 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:17:44,512 | INFO | sqlalchemy.engine.Engine | [cached since 776.9s ago] ()
2025-12-03 20:17:44,521 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:17:44,522 | INFO | sqlalchemy.engine.Engine | [cached since 687.1s ago] (1,)
2025-12-03 20:17:45,379 | INFO | app.services.transcribe | Starting stream. Total bytes: 471040. Chunk size: 8192. No throttling.
2025-12-03 20:17:45,382 | DEBUG | app.services.transcribe | Streamed 8192/471040 bytes
2025-12-03 20:17:45,420 | DEBUG | app.services.transcribe | Streamed 417792/471040 bytes
2025-12-03 20:17:45,428 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 20:17:47,747 | DEBUG | app.services.transcribe | Received transcript chunk: me mantengo fuera de...
2025-12-03 20:17:47,810 | INFO | app.services.transcribe | Transcription complete. Length: 49
2025-12-03 20:17:47,810 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: me mantengo fuera de pista. Alfa Noviembre India
2025-12-03 20:17:47,811 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | text=me mantengo fuera de pista. Alfa Noviembre India
2025-12-03 20:17:47,918 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:17:47,919 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:17:47,919 | INFO | sqlalchemy.engine.Engine | [cached since 610.3s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:17:47,933 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:17:50,811 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:17:50,814 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:17:50,815 | INFO | sqlalchemy.engine.Engine | [cached since 613.2s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:17:50,833 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:17:50,834 | INFO | sqlalchemy.engine.Engine | [cached since 609.3s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (23731 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 20, 17, 50, 832652, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:17:50,862 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:17:50,900 | INFO | app.controllers.audio | Intent detector frequency mismatch session=addc8698-ae92-4006-8ad3-08b90eedaab9 detected=ground scenario=tower
2025-12-03 20:17:50,901 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_line_up intent=ground_hold_short_instruction freq=tower
2025-12-03 20:17:50,905 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_hold_short_instruction freq_group=tower
SYSTEM> Sigues en Pavas Torre. Una vez libre el tránsito, instruye: '[Matrícula], ruede a posición y mantenga pista uno cero.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "meta...
USER> Fase actual: Autorización a posición y mantener
Intent esperado: ground_hold_short_instruction
Transcripción textual del alumno:
me mantengo fuera de pista. Alfa Noviembre India

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_line_up

Checklist alumno:
- Reconocer la instrucción anterior y estar listo.

Checklist controlador:
- Autorizar 'ruede a posición y mantenga pista uno cero'.
- Mantener fraseología local.

Cuándo responder:
- allowResponse=true con...
2025-12-03 20:17:59,607 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_hold_short_instruction intento=1: {
  "intent": "ground_hold_short_instruction",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El piloto ha confirmado mantenerse fuera de pista pero no ha solicitado autorización para alinearse. Debe esperar la instrucción 'ruede a posición y mantenga' antes de moverse. Corrija su procedimiento de espera activa.",
  "confidence": 0.89,
  "score": 45,
  "metadata": {
    "missingElements": [
      "Esperar instrucción explícita para alinearse"
    ],
    "nextPhase": null
 ...
2025-12-03 20:17:59,715 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:17:59,717 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:17:59,718 | INFO | sqlalchemy.engine.Engine | [cached since 622.1s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:17:59,731 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:17:59,731 | INFO | sqlalchemy.engine.Engine | [cached since 618.2s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (25048 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 20, 17, 59, 730812, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:17:59,747 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:17:59,765 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 20:17:59,766 | INFO | sqlalchemy.engine.Engine | [cached since 598.9s ago] (UUID('f7a8e70f-f3b4-49b7-b29b-61323402c764'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'tower_line_up', 45.0, "El piloto ha confirmado mantenerse fuera de pista pero no ha solicitado autorización para alinearse. Debe esperar la instrucción 'ruede a posición y mantenga' antes de moverse. Corrija su procedimiento de espera activa.")
2025-12-03 20:17:59,779 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:17:59,806 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_line_up score=45.00
2025-12-03 20:17:59,807 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | intent=ground_hold_short_instruction | phase=tower_line_up | allow_response=False | text=
2025-12-03 20:20:01,153 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:20:01,154 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 20:20:01,154 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 20:20:01,155 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:20:01,156 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 20:20:01,157 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 20:20:01,158 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:20:01,158 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:20:01,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 20:20:01,160 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:20:01,161 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:20:01,162 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 20:20:01,163 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 20:20:01,164 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:20:01,165 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 20:20:01,165 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 20:20:01,166 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:20:01,166 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:20:01,167 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 20:20:01,168 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:20:01,168 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 20:20:01,170 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 20:20:01,170 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 20:20:01,172 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:20:01,172 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 20:20:01,173 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 20:20:01,174 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:20:01,174 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 20:20:01,175 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 20:20:01,176 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 20:20:01,177 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 20:20:01,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:5840]
2025-12-03 20:20:01,180 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 20:20:01,294 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 20:20:01,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 20:20:01,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 20:20:01,396 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:20:01,397 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 20:20:01,400 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3642]
2025-12-03 20:20:01,401 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 20:20:01,402 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 20:20:01,514 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:20:01,515 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 20:20:01,515 | INFO | sqlalchemy.engine.Engine | [cached since 913.9s ago] ()
2025-12-03 20:20:01,521 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 20:20:01,523 | INFO | sqlalchemy.engine.Engine | [cached since 824.1s ago] (1,)
2025-12-03 20:20:02,241 | INFO | app.services.transcribe | Starting stream. Total bytes: 141312. Chunk size: 8192. No throttling.
2025-12-03 20:20:02,244 | DEBUG | app.services.transcribe | Streamed 8192/141312 bytes
2025-12-03 20:20:02,272 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 20:20:02,610 | INFO | app.services.transcribe | Transcription complete. Length: 0
2025-12-03 20:20:02,611 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: 
2025-12-03 20:20:02,612 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | text=
2025-12-03 20:20:02,739 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:20:02,740 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:20:02,741 | INFO | sqlalchemy.engine.Engine | [cached since 745.1s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:20:02,755 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 20:20:02,890 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:20:02,891 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:20:02,892 | INFO | sqlalchemy.engine.Engine | [cached since 745.3s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:20:02,910 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:20:02,912 | INFO | sqlalchemy.engine.Engine | [cached since 741.4s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (25367 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 20, 20, 2, 910937, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:20:02,932 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:20:02,966 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_line_up intent=tower_line_up_wait freq=tower
2025-12-03 20:20:02,969 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_line_up_wait freq_group=tower
SYSTEM> Sigues en Pavas Torre. Una vez libre el tránsito, instruye: '[Matrícula], ruede a posición y mantenga pista uno cero.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "meta...
USER> Fase actual: Autorización a posición y mantener
Intent esperado: tower_line_up_wait
Transcripción textual del alumno:


Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_line_up

Checklist alumno:
- Reconocer la instrucción anterior y estar listo.

Checklist controlador:
- Autorizar 'ruede a posición y mantenga pista uno cero'.
- Mantener fraseología local.

Cuándo responder:
- allowResponse=true con la instrucción de posición.

Guía de feedback:
- Confirma ...
2025-12-03 20:20:17,969 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_line_up_wait intento=1: {
  "intent": "tower_line_up_wait",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, ruede a posición y mantenga pista uno cero.",
  "feedback": "El tránsito ha sido liberado. Ahora debe autorizar al piloto a alinearse en pista manteniendo la fraseología estándar. No autorice el despegue todavía.",
  "confidence": 0.95,
  "score": 90,
  "metadata": {
    "nextPhase": "tower_takeoff_clearance",
    "missingElements": [],
    "additionalNotes": "La instrucción sigue el protoc...
2025-12-03 20:20:17,971 | INFO | app.controllers.audio | Transición automática de fase session=addc8698-ae92-4006-8ad3-08b90eedaab9 de=tower_line_up a=tower_takeoff_clearance
2025-12-03 20:20:18,093 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 20:20:18,093 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 20:20:18,094 | INFO | sqlalchemy.engine.Engine | [cached since 760.5s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 20:20:18,108 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 20:20:18,110 | INFO | sqlalchemy.engine.Engine | [cached since 756.6s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (26882 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 20, 20, 18, 108930, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 20:20:18,123 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:20:18,147 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 20:20:18,148 | INFO | sqlalchemy.engine.Engine | [cached since 737.3s ago] (UUID('6a86ef9c-029b-43e1-af26-46b140b45334'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'tower_takeoff_clearance', 90.0, 'El tránsito ha sido liberado. Ahora debe autorizar al piloto a alinearse en pista manteniendo la fraseología estándar. No autorice el despegue todavía.')
2025-12-03 20:20:18,161 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 20:20:18,180 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_takeoff_clearance score=90.00
2025-12-03 20:20:18,182 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | intent=tower_line_up_wait | phase=tower_takeoff_clearance | allow_response=True | text=Alfa Noviembre India, ruede a posición y mantenga pista uno cero.
2025-12-03 21:43:20,721 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 21:43:20,723 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 21:43:20,723 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 21:43:20,724 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:43:20,725 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 21:43:20,726 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 21:43:20,726 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:43:20,727 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 21:43:20,728 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 21:43:20,728 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 21:43:20,730 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 21:43:20,731 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 21:43:20,731 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 21:43:20,732 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:43:20,733 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 21:43:20,733 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 21:43:20,734 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:43:20,735 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 21:43:20,735 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 21:43:20,736 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 21:43:20,737 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 21:43:20,738 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 21:43:20,738 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 21:43:20,739 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:43:20,740 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 21:43:20,741 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 21:43:20,742 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:43:20,743 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 21:43:20,744 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 21:43:20,745 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:43:20,746 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 21:43:20,748 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:8192]
2025-12-03 21:43:20,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:43:20,869 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:20,875 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:43:20,878 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 21:43:21,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 21:43:21,016 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 21:43:21,188 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,191 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:43:21,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,196 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:43:21,387 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,390 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:43:21,393 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 21:43:21,542 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,544 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:43:21,546 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 21:43:21,730 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:43:21,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,736 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:43:21,915 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:43:21,919 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:43:21,921 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:43:21,934 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:296]
2025-12-03 21:43:21,935 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 21:43:21,935 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 21:43:22,121 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:43:22,122 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:43:22,125 | INFO | sqlalchemy.engine.Engine | [cached since 5914s ago] ()
2025-12-03 21:43:22,139 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:43:48,625 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:43:48,625 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:43:48,627 | INFO | sqlalchemy.engine.Engine | [cached since 5941s ago] ()
2025-12-03 21:43:48,640 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-03 21:43:48,641 | INFO | sqlalchemy.engine.Engine | [cached since 5853s ago] ('josuelu2@gmail.com',)
2025-12-03 21:43:48,825 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:43:52,495 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:43:52,497 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:43:52,498 | INFO | sqlalchemy.engine.Engine | [cached since 5945s ago] ()
2025-12-03 21:43:52,510 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:52,511 | INFO | sqlalchemy.engine.Engine | [cached since 5855s ago] (1,)
2025-12-03 21:43:52,526 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:43:52,527 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:43:52,529 | INFO | sqlalchemy.engine.Engine | [cached since 5945s ago] ()
2025-12-03 21:43:52,536 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:52,537 | INFO | sqlalchemy.engine.Engine | [cached since 5855s ago] (1,)
2025-12-03 21:43:52,602 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:43:52,619 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:52,620 | INFO | sqlalchemy.engine.Engine | [cached since 5855s ago] (1,)
2025-12-03 21:43:52,626 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 21:43:52,629 | INFO | sqlalchemy.engine.Engine | [cached since 5855s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 21:43:52,650 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:43:54,983 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:43:54,985 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:43:54,986 | INFO | sqlalchemy.engine.Engine | [cached since 5947s ago] ()
2025-12-03 21:43:54,994 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:43:54,996 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:43:54,997 | INFO | sqlalchemy.engine.Engine | [cached since 5947s ago] ()
2025-12-03 21:43:55,001 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:55,002 | INFO | sqlalchemy.engine.Engine | [cached since 5858s ago] (1,)
2025-12-03 21:43:55,015 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:55,017 | INFO | sqlalchemy.engine.Engine | [cached since 5858s ago] (1,)
2025-12-03 21:43:55,200 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:55,202 | INFO | sqlalchemy.engine.Engine | [cached since 5858s ago] (1,)
2025-12-03 21:43:55,206 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:55,207 | INFO | sqlalchemy.engine.Engine | [cached since 5858s ago] (1,)
2025-12-03 21:43:55,212 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 21:43:55,214 | INFO | sqlalchemy.engine.Engine | [cached since 5858s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 21:43:55,218 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 21:43:55,220 | INFO | sqlalchemy.engine.Engine | [cached since 5857s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 21:43:55,273 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:43:55,286 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:43:59,775 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:43:59,776 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:43:59,777 | INFO | sqlalchemy.engine.Engine | [cached since 5952s ago] ()
2025-12-03 21:43:59,785 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:59,786 | INFO | sqlalchemy.engine.Engine | [cached since 5862s ago] (1,)
2025-12-03 21:43:59,863 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:43:59,863 | INFO | sqlalchemy.engine.Engine | [cached since 5782s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 21:43:59,878 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:43:59,878 | INFO | sqlalchemy.engine.Engine | [cached since 5862s ago] (1,)
2025-12-03 21:43:59,884 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:46:18,283 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 21:46:18,285 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-03 21:46:18,286 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-03 21:46:18,287 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:46:18,288 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-03 21:46:18,288 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-03 21:46:18,289 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:46:18,290 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 21:46:18,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-03 21:46:18,292 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 21:46:18,293 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 21:46:18,294 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-03 21:46:18,295 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-03 21:46:18,296 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:46:18,296 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-03 21:46:18,298 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-03 21:46:18,298 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:46:18,299 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 21:46:18,301 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-03 21:46:18,302 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 21:46:18,303 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-03 21:46:18,304 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-03 21:46:18,306 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-03 21:46:18,306 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:46:18,308 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-03 21:46:18,308 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-03 21:46:18,310 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:46:18,310 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-03 21:46:18,311 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-03 21:46:18,313 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-03 21:46:18,314 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-03 21:46:18,315 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:1460]
2025-12-03 21:46:18,318 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:18,321 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-03 21:46:18,519 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:18,520 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:18,522 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:18,524 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-03 21:46:18,672 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:18,673 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:18,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:18,678 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:46:18,826 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:18,829 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:18,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 21:46:18,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:18,972 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:18,978 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 21:46:19,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:19,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,114 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:46:19,252 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 21:46:19,261 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,263 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:46:19,399 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:19,401 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,402 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,403 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:46:19,565 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:19,568 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 21:46:19,746 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,748 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:19,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-03 21:46:19,905 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-03 21:46:19,912 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:19,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:46:20,057 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:20,058 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-03 21:46:20,060 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-03 21:46:20,062 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-03 21:46:20,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:437]
2025-12-03 21:46:20,070 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-03 21:46:20,070 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-03 21:46:20,225 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:46:20,226 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:46:20,227 | INFO | sqlalchemy.engine.Engine | [cached since 6093s ago] ()
2025-12-03 21:46:20,236 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:46:20,237 | INFO | sqlalchemy.engine.Engine | [cached since 6003s ago] (1,)
2025-12-03 21:46:21,713 | INFO | app.services.transcribe | Starting stream. Total bytes: 698368. Chunk size: 8192. No throttling.
2025-12-03 21:46:21,717 | DEBUG | app.services.transcribe | Streamed 8192/698368 bytes
2025-12-03 21:46:21,737 | DEBUG | app.services.transcribe | Streamed 417792/698368 bytes
2025-12-03 21:46:21,745 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-03 21:46:23,564 | DEBUG | app.services.transcribe | Received transcript chunk: a posición y manteng...
2025-12-03 21:46:25,147 | DEBUG | app.services.transcribe | Received transcript chunk: listo para el despeg...
2025-12-03 21:46:25,220 | INFO | app.services.transcribe | Transcription complete. Length: 69
2025-12-03 21:46:25,222 | INFO | app.controllers.audio | Transcripción recibida session=addc8698-ae92-4006-8ad3-08b90eedaab9: a posición y mantengo. listo para el despegue. Alfa Noviembre India.
2025-12-03 21:46:25,223 | INFO | app.logs.transcript | student | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | text=a posición y mantengo. listo para el despegue. Alfa Noviembre India.
2025-12-03 21:46:25,414 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:46:25,415 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:46:25,417 | INFO | sqlalchemy.engine.Engine | [cached since 5928s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 21:46:25,435 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:46:46,045 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:46:46,045 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:46:46,047 | INFO | sqlalchemy.engine.Engine | [cached since 5948s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 21:46:46,072 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 21:46:46,073 | INFO | sqlalchemy.engine.Engine | [cached since 5945s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (27367 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 21, 46, 46, 71074, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 21:46:46,098 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 21:46:46,131 | INFO | app.controllers.audio | Fase activa session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_takeoff_clearance intent=tower_ready_for_takeoff freq=tower
2025-12-03 21:46:46,134 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_ready_for_takeoff freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 110 grados 13 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence":...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_ready_for_takeoff
Transcripción textual del alumno:
a posición y mantengo. listo para el despegue. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- ...
2025-12-03 21:47:15,442 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_ready_for_takeoff intento=1: {
  "intent": "tower_ready_for_takeoff",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "El piloto ha usado 'listo para el despegue' en lugar de 'listo para salida'. Aunque está en posición, la fraseología no es la correcta según protocolos ATC. Corrija la terminología antes de autorizar el despegue.",
  "confidence": 0.85,
  "score": 60,
  "metadata": {
    "missingItems": [
      "Fraseología correcta: 'listo para salida'"
    ],
    "nextStep": "Corregir la fraseología d...
2025-12-03 21:47:15,648 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:47:15,651 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:47:15,652 | INFO | sqlalchemy.engine.Engine | [cached since 5978s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 21:47:15,672 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-03 21:47:15,673 | INFO | sqlalchemy.engine.Engine | [cached since 5974s ago] ('{"meteo": {"qnh": "1018", "vis": ">10km", "dewp": "16", "temp": "22", "wind": "110/13", "cloudBase": "4000", "condition": "VMC", "windSpeed": "13", " ... (28840 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0598", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 3, 21, 47, 15, 671766, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('7a42bac8-c894-47bc-9232-b6ecb5c06cd3'))
2025-12-03 21:47:15,700 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 21:47:15,737 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-03 21:47:15,739 | INFO | sqlalchemy.engine.Engine | [cached since 5955s ago] (UUID('1e2ee2c1-d1fc-4b76-9e81-5d0ef6af9c6e'), UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'), 1, 'tower_takeoff_clearance', 60.0, "El piloto ha usado 'listo para el despegue' en lugar de 'listo para salida'. Aunque está en posición, la fraseología no es la correcta según protocolos ATC. Corrija la terminología antes de autorizar el despegue.")
2025-12-03 21:47:15,766 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 21:47:15,798 | INFO | app.controllers.audio | Puntuación guardada session=addc8698-ae92-4006-8ad3-08b90eedaab9 phase_id=tower_takeoff_clearance score=60.00
2025-12-03 21:47:15,800 | INFO | app.logs.transcript | controller | session=addc8698-ae92-4006-8ad3-08b90eedaab9 | frequency=118.300 | intent=tower_ready_for_takeoff | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-03 21:53:14,025 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:14,027 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:14,029 | INFO | sqlalchemy.engine.Engine | [cached since 6506s ago] ()
2025-12-03 21:53:14,040 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,041 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,094 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:14,096 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:14,096 | INFO | sqlalchemy.engine.Engine | [cached since 6506s ago] ()
2025-12-03 21:53:14,103 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:14,104 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:14,105 | INFO | sqlalchemy.engine.Engine | [cached since 6506s ago] ()
2025-12-03 21:53:14,108 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,110 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,115 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,116 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,180 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:14,181 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:14,182 | INFO | sqlalchemy.engine.Engine | [cached since 6507s ago] ()
2025-12-03 21:53:14,192 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,193 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,196 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,197 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,204 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 21:53:14,205 | INFO | sqlalchemy.engine.Engine | [cached since 6416s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 21:53:14,208 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,210 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,214 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,215 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,218 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 21:53:14,220 | INFO | sqlalchemy.engine.Engine | [cached since 6416s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 21:53:14,223 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 21:53:14,224 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 21:53:14,237 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:14,240 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:14,254 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:14,309 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:14,311 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1,)
2025-12-03 21:53:14,315 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 21:53:14,317 | INFO | sqlalchemy.engine.Engine | [cached since 6417s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 21:53:14,339 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:20,010 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:20,012 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:20,013 | INFO | sqlalchemy.engine.Engine | [cached since 6512s ago] ()
2025-12-03 21:53:20,023 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:20,024 | INFO | sqlalchemy.engine.Engine | [cached since 6423s ago] (1,)
2025-12-03 21:53:20,131 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:53:20,132 | INFO | sqlalchemy.engine.Engine | [cached since 6342s ago] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 21:53:20,157 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-03 21:53:20,158 | INFO | sqlalchemy.engine.Engine | [generated in 0.00136s] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 21:53:20,182 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:53:20,183 | INFO | sqlalchemy.engine.Engine | [generated in 0.00110s] (UUID('addc8698-ae92-4006-8ad3-08b90eedaab9'),)
2025-12-03 21:53:20,187 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 21:53:20,648 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:20,650 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:20,652 | INFO | sqlalchemy.engine.Engine | [cached since 6513s ago] ()
2025-12-03 21:53:20,661 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:20,664 | INFO | sqlalchemy.engine.Engine | [cached since 6423s ago] (1,)
2025-12-03 21:53:20,725 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:20,726 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:20,728 | INFO | sqlalchemy.engine.Engine | [cached since 6513s ago] ()
2025-12-03 21:53:20,738 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:20,739 | INFO | sqlalchemy.engine.Engine | [cached since 6423s ago] (1,)
2025-12-03 21:53:20,773 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:20,775 | INFO | sqlalchemy.engine.Engine | [cached since 6423s ago] (1,)
2025-12-03 21:53:20,780 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 21:53:20,781 | INFO | sqlalchemy.engine.Engine | [cached since 6422s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 21:53:20,796 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:20,831 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:20,833 | INFO | sqlalchemy.engine.Engine | [cached since 6423s ago] (1,)
2025-12-03 21:53:20,838 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 21:53:20,840 | INFO | sqlalchemy.engine.Engine | [cached since 6423s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 21:53:20,880 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:23,056 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:23,057 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:23,060 | INFO | sqlalchemy.engine.Engine | [cached since 6515s ago] ()
2025-12-03 21:53:23,073 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:23,074 | INFO | sqlalchemy.engine.Engine | [cached since 6426s ago] (1,)
2025-12-03 21:53:23,191 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:53:23,192 | INFO | sqlalchemy.engine.Engine | [cached since 6346s ago] (UUID('a21dc360-9581-4136-adca-e0ef2721687d'),)
2025-12-03 21:53:23,214 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-03 21:53:23,215 | INFO | sqlalchemy.engine.Engine | [cached since 3.059s ago] (UUID('a21dc360-9581-4136-adca-e0ef2721687d'),)
2025-12-03 21:53:23,238 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:53:23,239 | INFO | sqlalchemy.engine.Engine | [cached since 3.057s ago] (UUID('a21dc360-9581-4136-adca-e0ef2721687d'),)
2025-12-03 21:53:23,248 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 21:53:23,570 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:23,571 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:23,572 | INFO | sqlalchemy.engine.Engine | [cached since 6516s ago] ()
2025-12-03 21:53:23,581 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:23,582 | INFO | sqlalchemy.engine.Engine | [cached since 6426s ago] (1,)
2025-12-03 21:53:23,602 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:23,604 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:23,606 | INFO | sqlalchemy.engine.Engine | [cached since 6516s ago] ()
2025-12-03 21:53:23,616 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:23,617 | INFO | sqlalchemy.engine.Engine | [cached since 6426s ago] (1,)
2025-12-03 21:53:23,673 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:23,674 | INFO | sqlalchemy.engine.Engine | [cached since 6426s ago] (1,)
2025-12-03 21:53:23,678 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 21:53:23,680 | INFO | sqlalchemy.engine.Engine | [cached since 6426s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 21:53:23,698 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:23,699 | INFO | sqlalchemy.engine.Engine | [cached since 6426s ago] (1,)
2025-12-03 21:53:23,703 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:23,705 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 21:53:23,706 | INFO | sqlalchemy.engine.Engine | [cached since 6425s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 21:53:23,720 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:27,258 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:27,258 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:27,261 | INFO | sqlalchemy.engine.Engine | [cached since 6520s ago] ()
2025-12-03 21:53:27,272 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:27,273 | INFO | sqlalchemy.engine.Engine | [cached since 6430s ago] (1,)
2025-12-03 21:53:27,356 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:53:27,357 | INFO | sqlalchemy.engine.Engine | [cached since 6350s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 21:53:27,373 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-03 21:53:27,374 | INFO | sqlalchemy.engine.Engine | [cached since 7.218s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 21:53:27,401 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-03 21:53:27,401 | INFO | sqlalchemy.engine.Engine | [cached since 7.22s ago] (UUID('0c48dfb9-799f-4fff-9dab-ef0081979493'),)
2025-12-03 21:53:27,409 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 21:53:27,756 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:27,758 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:27,760 | INFO | sqlalchemy.engine.Engine | [cached since 6520s ago] ()
2025-12-03 21:53:27,774 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:27,775 | INFO | sqlalchemy.engine.Engine | [cached since 6430s ago] (1,)
2025-12-03 21:53:27,804 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:27,805 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:27,806 | INFO | sqlalchemy.engine.Engine | [cached since 6520s ago] ()
2025-12-03 21:53:27,814 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:27,817 | INFO | sqlalchemy.engine.Engine | [cached since 6430s ago] (1,)
2025-12-03 21:53:27,867 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:27,867 | INFO | sqlalchemy.engine.Engine | [cached since 6430s ago] (1,)
2025-12-03 21:53:27,871 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-03 21:53:27,873 | INFO | sqlalchemy.engine.Engine | [cached since 6429s ago] ('scenario_id', 'session_completed', 1)
2025-12-03 21:53:27,888 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:27,899 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:27,901 | INFO | sqlalchemy.engine.Engine | [cached since 6430s ago] (1,)
2025-12-03 21:53:27,907 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-03 21:53:27,908 | INFO | sqlalchemy.engine.Engine | [cached since 6430s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-03 21:53:27,938 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-03 21:53:45,039 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-03 21:53:45,268 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001437FA032D0>
2025-12-03 21:53:45,270 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x000001437F9E1AC0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-03 21:53:45,378 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001437F9AC4D0>
2025-12-03 21:53:45,384 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-03 21:53:45,389 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-03 21:53:45,394 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-03 21:53:45,398 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-03 21:53:45,399 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-03 21:53:45,601 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 04 Dec 2025 03:53:45 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'404'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"194-nXac8SGHXFUkAmKWrz9A9MGYot4"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251204T035345Z-1654ff75797kk9hrhC1MIAp11800000032z00000000044w4'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-03 21:53:45,607 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-03 21:53:45,609 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-03 21:53:45,610 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-03 21:53:45,611 | DEBUG | httpcore.http11 | response_closed.started
2025-12-03 21:53:45,612 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-03 21:53:45,615 | DEBUG | httpcore.connection | close.started
2025-12-03 21:53:45,617 | DEBUG | httpcore.connection | close.complete
2025-12-03 21:53:48,482 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-03 21:53:48,484 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-03 21:53:48,486 | INFO | sqlalchemy.engine.Engine | [cached since 6541s ago] ()
2025-12-03 21:53:48,497 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-03 21:53:48,500 | INFO | sqlalchemy.engine.Engine | [cached since 6451s ago] (1,)
2025-12-03 21:53:48,615 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-03 21:53:48,617 | INFO | sqlalchemy.engine.Engine | [cached since 6438s ago] (UUID('4e2d4b49-5d1c-4964-82f5-8a898f9f4dd5'), UUID('d554c474-648d-4155-b1b3-390474c59697'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1018", "windDirection": "070", "windSpeed": "9", "temp": "22", "dewp": "16", "cloudCover": "SKC", "cloudBase": "", "wind": "070/9"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 3, 21, 53, 48, 615898, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 3, 21, 53, 48, 615898, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-03 21:53:48,633 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-03 21:53:48,841 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
