2025-11-27 20:48:41,683 | INFO | sqlalchemy.engine.Engine | [cached since 99.6s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (17955 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 27, 20, 48, 41, 681542, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-11-27 20:48:41,715 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-27 20:48:41,763 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-11-27 20:48:41,766 | INFO | sqlalchemy.engine.Engine | [cached since 88.19s ago] (UUID('8c1ce7ec-8804-4f21-a1c3-ffe5dd2b4000'), UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'), 1, 'ground_readback', 0.0, 'La transmisión no corresponde a una colación de autorización de rodaje. Se esperaba la confirmación de QNH, código transponder, ruta de rodaje y pista asignada. Por favor, realice el readback correcto de la autorización recibida.')
2025-11-27 20:48:41,780 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-27 20:48:41,817 | INFO | app.controllers.audio | Puntuación guardada session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=ground_readback score=0.00
2025-11-27 20:48:41,818 | INFO | app.logs.transcript | controller | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=121.700 | intent=non_atc_communication | phase=ground_readback | allow_response=False | text=
2025-11-27 20:49:25,497 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-27 20:49:25,497 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-11-27 20:49:25,498 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-11-27 20:49:25,500 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-27 20:49:25,501 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-11-27 20:49:25,502 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-11-27 20:49:25,503 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-27 20:49:25,505 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-27 20:49:25,505 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-11-27 20:49:25,507 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-27 20:49:25,510 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-27 20:49:25,511 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-11-27 20:49:25,515 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-11-27 20:49:25,518 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-27 20:49:25,519 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-11-27 20:49:25,521 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-11-27 20:49:25,522 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-27 20:49:25,523 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-27 20:49:25,525 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-11-27 20:49:25,526 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-27 20:49:25,528 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-27 20:49:25,530 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-11-27 20:49:25,531 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-11-27 20:49:25,532 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-27 20:49:25,533 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-11-27 20:49:25,534 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-11-27 20:49:25,536 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-27 20:49:25,536 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-11-27 20:49:25,537 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-11-27 20:49:25,537 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-27 20:49:25,538 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-27 20:49:25,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-11-27 20:49:25,541 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-11-27 20:49:25,669 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:25,671 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:25,674 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:25,822 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:25,825 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:25,998 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:26,000 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:26,003 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-11-27 20:49:26,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:26,151 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:26,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:26,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:26,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-11-27 20:49:26,447 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:26,449 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:26,452 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:26,605 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:26,607 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:26,613 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:26,773 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:26,776 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:26,940 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:26,944 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:26,948 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:27,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:27,109 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:27,268 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:27,271 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:27,273 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:27,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:27,435 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:27,437 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:27,621 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:27,622 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:27,626 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:27,802 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:27,805 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-11-27 20:49:27,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:27,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-11-27 20:49:28,170 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:28,173 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:28,179 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:28,361 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:28,367 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:28,370 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-11-27 20:49:28,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:28,541 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:28,545 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:28,695 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:28,697 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:28,867 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:28,868 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:29,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:29,028 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:29,031 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:29,183 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-11-27 20:49:29,187 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:29,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-11-27 20:49:29,337 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-11-27 20:49:29,339 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-11-27 20:49:29,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1120]
2025-11-27 20:49:29,370 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-27 20:49:29,373 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-27 20:49:29,582 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-27 20:49:29,583 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-27 20:49:29,583 | INFO | sqlalchemy.engine.Engine | [cached since 435.9s ago] ()
2025-11-27 20:49:29,590 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-27 20:49:29,591 | INFO | sqlalchemy.engine.Engine | [cached since 358.7s ago] (1,)
2025-11-27 20:49:30,667 | INFO | app.services.transcribe | Starting stream. Total bytes: 1400832. Chunk size: 8192. No throttling.
2025-11-27 20:49:30,668 | DEBUG | app.services.transcribe | Streamed 8192/1400832 bytes
2025-11-27 20:49:30,732 | DEBUG | app.services.transcribe | Streamed 417792/1400832 bytes
2025-11-27 20:49:30,791 | DEBUG | app.services.transcribe | Streamed 827392/1400832 bytes
2025-11-27 20:49:30,827 | DEBUG | app.services.transcribe | Streamed 1236992/1400832 bytes
2025-11-27 20:49:30,837 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-11-27 20:49:33,833 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1015 Transponder...
2025-11-27 20:49:35,333 | DEBUG | app.services.transcribe | Received transcript chunk: rodaré vía Alfa Brav...
2025-11-27 20:49:36,696 | DEBUG | app.services.transcribe | Received transcript chunk: al.de espera pista 1...
2025-11-27 20:49:37,328 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-11-27 20:49:37,365 | INFO | app.services.transcribe | Transcription complete. Length: 95
2025-11-27 20:49:37,368 | INFO | app.controllers.audio | Transcripción recibida session=ab8c878c-a76e-421b-bf02-b589d0088a92: QNH 1015 Transponder 0532. rodaré vía Alfa Bravo al.de espera pista 10. Alfa Noviembre, India.
2025-11-27 20:49:37,368 | INFO | app.logs.transcript | student | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=121.700 | text=QNH 1015 Transponder 0532. rodaré vía Alfa Bravo al.de espera pista 10. Alfa Noviembre, India.
2025-11-27 20:49:37,533 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-27 20:49:37,533 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-27 20:49:37,535 | INFO | sqlalchemy.engine.Engine | [cached since 156.6s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-11-27 20:49:37,564 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-27 20:49:40,426 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-27 20:49:40,428 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-27 20:49:40,429 | INFO | sqlalchemy.engine.Engine | [cached since 159.5s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-11-27 20:49:40,457 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-27 20:49:40,460 | INFO | sqlalchemy.engine.Engine | [cached since 158.4s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (18474 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 27, 20, 49, 40, 457650, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-11-27 20:49:40,487 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-27 20:49:40,525 | INFO | app.controllers.audio | Fase activa session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-11-27 20:49:40,529 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH 1015 Transponder 0532. rodaré vía Alfa Bravo al.de espera pista 10. Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar...
2025-11-27 20:49:48,637 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "La colación incluye todos los elementos requeridos: QNH, transponder, ruta de rodaje y pista asignada. La fraseología es correcta aunque se omitió 'punto de espera', pero se entiende la intención. Puede proceder a Torre.",
  "confidence": 0.92,
  "score": 90,
  "metadata": {
    "missingItems": [],
    "nextPhase"...
2025-11-27 20:49:48,641 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-11-27 20:49:48,643 | INFO | app.controllers.audio | Transición automática de fase session=ab8c878c-a76e-421b-bf02-b589d0088a92 de=ground_readback a=tower_hold_short
2025-11-27 20:49:48,801 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-27 20:49:48,802 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-27 20:49:48,803 | INFO | sqlalchemy.engine.Engine | [cached since 167.9s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-11-27 20:49:48,820 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-27 20:49:48,824 | INFO | sqlalchemy.engine.Engine | [cached since 166.7s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (19861 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 11, 27, 20, 49, 48, 820924, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-11-27 20:49:48,846 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-27 20:49:48,886 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-11-27 20:49:48,887 | INFO | sqlalchemy.engine.Engine | [cached since 155.3s ago] (UUID('c3837d13-ba29-4c36-bc8c-3c4785966b13'), UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'), 1, 'tower_hold_short', 90.0, "La colación incluye todos los elementos requeridos: QNH, transponder, ruta de rodaje y pista asignada. La fraseología es correcta aunque se omitió 'punto de espera', pero se entiende la intención. Puede proceder a Torre.")
2025-11-27 20:49:48,898 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-27 20:49:48,935 | INFO | app.controllers.audio | Puntuación guardada session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=tower_hold_short score=90.00
2025-11-27 20:49:48,936 | INFO | app.logs.transcript | controller | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=121.700 | intent=ground_taxi_readback | phase=tower_hold_short | allow_response=True | text=Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-02 19:44:01,668 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 19:44:01,669 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 19:44:01,689 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 19:44:01,689 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 19:44:01,708 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 19:44:01,709 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 19:44:01,715 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:44:01,716 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 19:44:01,718 | INFO | sqlalchemy.engine.Engine | [generated in 0.00110s] ()
2025-12-02 19:44:01,735 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:44:01,736 | INFO | sqlalchemy.engine.Engine | [generated in 0.00066s] ()
2025-12-02 19:44:01,745 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,746 | INFO | sqlalchemy.engine.Engine | [generated in 0.00144s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,830 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,831 | INFO | sqlalchemy.engine.Engine | [cached since 0.08653s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,834 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,835 | INFO | sqlalchemy.engine.Engine | [cached since 0.09075s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,839 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,840 | INFO | sqlalchemy.engine.Engine | [cached since 0.09576s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,845 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,847 | INFO | sqlalchemy.engine.Engine | [cached since 0.1017s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,850 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,851 | INFO | sqlalchemy.engine.Engine | [cached since 0.1065s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,854 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,856 | INFO | sqlalchemy.engine.Engine | [cached since 0.1115s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,859 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 19:44:01,859 | INFO | sqlalchemy.engine.Engine | [cached since 0.1155s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 19:44:01,865 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 19:44:01,866 | INFO | sqlalchemy.engine.Engine | [generated in 0.00094s] ('group_role', 'pg_catalog')
2025-12-02 19:44:01,875 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 19:44:01,876 | INFO | sqlalchemy.engine.Engine | [cached since 0.01053s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 19:44:01,881 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 19:44:01,882 | INFO | sqlalchemy.engine.Engine | [cached since 0.01678s ago] ('user_status', 'pg_catalog')
2025-12-02 19:44:01,887 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 19:44:01,888 | INFO | sqlalchemy.engine.Engine | [cached since 0.02222s ago] ('account_type', 'pg_catalog')
2025-12-02 19:44:01,893 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 19:44:01,893 | INFO | sqlalchemy.engine.Engine | [generated in 0.00101s] ()
2025-12-02 19:44:01,963 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 19:44:01,965 | INFO | sqlalchemy.engine.Engine | [generated in 0.00075s] ()
2025-12-02 19:44:02,070 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 19:44:02,071 | INFO | sqlalchemy.engine.Engine | [generated in 0.00121s] ()
2025-12-02 19:44:02,516 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:44:02,569 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 19:46:08,030 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:46:08,031 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:46:08,033 | INFO | sqlalchemy.engine.Engine | [cached since 126.3s ago] ()
2025-12-02 19:46:08,071 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 19:46:08,071 | INFO | sqlalchemy.engine.Engine | [generated in 0.00102s] ('josuelu2@gmail.com',)
2025-12-02 19:46:08,435 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:46:10,681 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:46:10,681 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:46:10,681 | INFO | sqlalchemy.engine.Engine | [cached since 128.9s ago] ()
2025-12-02 19:46:10,694 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:46:10,696 | INFO | sqlalchemy.engine.Engine | [generated in 0.00207s] (1,)
2025-12-02 19:46:10,795 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:46:13,706 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:46:13,707 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:46:13,708 | INFO | sqlalchemy.engine.Engine | [cached since 132s ago] ()
2025-12-02 19:46:13,719 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:46:13,720 | INFO | sqlalchemy.engine.Engine | [cached since 3.025s ago] (1,)
2025-12-02 19:46:13,734 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:46:13,735 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:46:13,737 | INFO | sqlalchemy.engine.Engine | [cached since 132s ago] ()
2025-12-02 19:46:13,749 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:46:13,749 | INFO | sqlalchemy.engine.Engine | [cached since 3.056s ago] (1,)
2025-12-02 19:46:13,840 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:46:13,841 | INFO | sqlalchemy.engine.Engine | [cached since 3.147s ago] (1,)
2025-12-02 19:46:13,844 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:46:13,844 | INFO | sqlalchemy.engine.Engine | [cached since 3.151s ago] (1,)
2025-12-02 19:46:13,853 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 19:46:13,856 | INFO | sqlalchemy.engine.Engine | [generated in 0.00245s] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 19:46:13,864 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 19:46:13,866 | INFO | sqlalchemy.engine.Engine | [generated in 0.00183s] ('scenario_id', 'session_completed', 1)
2025-12-02 19:46:13,963 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:46:13,997 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:46:25,954 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:46:25,956 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:46:25,957 | INFO | sqlalchemy.engine.Engine | [cached since 144.2s ago] ()
2025-12-02 19:46:25,967 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:46:25,968 | INFO | sqlalchemy.engine.Engine | [cached since 15.27s ago] (1,)
2025-12-02 19:46:26,088 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:46:26,089 | INFO | sqlalchemy.engine.Engine | [generated in 0.00121s] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:46:26,118 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:46:26,119 | INFO | sqlalchemy.engine.Engine | [cached since 15.42s ago] (1,)
2025-12-02 19:46:26,124 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:48:13,430 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:48:13,431 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:48:13,432 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:48:13,433 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:48:13,435 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:48:13,436 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:48:13,437 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:48:13,438 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:48:13,440 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:48:13,441 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:48:13,442 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:48:13,443 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:48:13,444 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:48:13,444 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:48:13,445 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:48:13,447 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:48:13,448 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:48:13,449 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:48:13,450 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:48:13,451 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:48:13,452 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:48:13,453 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:48:13,454 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:48:13,455 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:48:13,458 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:48:13,459 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:48:13,460 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:48:13,462 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:48:13,462 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 19:48:13,463 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:48:13,463 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:48:13,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 19:48:13,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:48:13,576 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:48:13,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:13,581 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:48:13,699 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:13,700 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:13,702 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:48:13,826 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:13,829 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:13,832 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:13,834 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:48:13,974 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:13,976 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:13,979 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:48:14,131 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:48:14,134 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:14,135 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:48:14,282 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:48:14,286 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:48:14,429 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:48:14,431 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:48:14,578 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:14,580 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:14,583 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:48:14,748 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:14,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:14,752 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:48:14,883 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:14,885 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:14,888 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:48:15,137 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:48:15,139 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:48:15,155 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:48:15,157 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:48:15,159 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3655]
2025-12-02 19:48:15,161 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:48:15,162 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:48:15,313 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:48:15,314 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:48:15,315 | INFO | sqlalchemy.engine.Engine | [cached since 253.6s ago] ()
2025-12-02 19:48:15,325 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:48:15,326 | INFO | sqlalchemy.engine.Engine | [cached since 124.6s ago] (1,)
2025-12-02 19:48:19,749 | INFO | app.services.transcribe | Starting stream. Total bytes: 753664. Chunk size: 8192. No throttling.
2025-12-02 19:48:19,751 | DEBUG | app.services.transcribe | Streamed 8192/753664 bytes
2025-12-02 19:48:19,782 | DEBUG | app.services.transcribe | Streamed 417792/753664 bytes
2025-12-02 19:48:19,803 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:48:22,141 | DEBUG | app.services.transcribe | Received transcript chunk: Pastore Alfa Noviemb...
2025-12-02 19:48:22,958 | DEBUG | app.services.transcribe | Received transcript chunk: esta....
2025-12-02 19:48:23,608 | DEBUG | app.services.transcribe | Received transcript chunk: listo para salida....
2025-12-02 19:48:23,665 | INFO | app.services.transcribe | Transcription complete. Length: 68
2025-12-02 19:48:23,666 | INFO | app.controllers.audio | Transcripción recibida session=ab8c878c-a76e-421b-bf02-b589d0088a92: Pastore Alfa Noviembre India en.de espera. esta. listo para salida.
2025-12-02 19:48:23,666 | INFO | app.logs.transcript | student | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=118.300 | text=Pastore Alfa Noviembre India en.de espera. esta. listo para salida.
2025-12-02 19:48:23,803 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:48:23,805 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:48:23,807 | INFO | sqlalchemy.engine.Engine | [cached since 117.7s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:48:23,822 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:48:26,019 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:48:26,020 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:48:26,021 | INFO | sqlalchemy.engine.Engine | [cached since 119.9s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:48:26,068 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:48:26,069 | INFO | sqlalchemy.engine.Engine | [generated in 0.02597s] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (20343 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 48, 26, 68252, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-12-02 19:48:26,120 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:48:26,149 | INFO | app.controllers.audio | Intent detector frequency mismatch session=ab8c878c-a76e-421b-bf02-b589d0088a92 detected=ground scenario=tower
2025-12-02 19:48:26,150 | INFO | app.controllers.audio | Fase activa session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=tower_hold_short intent=ground_ready_for_departure freq=tower
2025-12-02 19:48:26,153 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_ready_for_departure freq_group=tower
SYSTEM> Eres Pavas Torre (118.3). Cuando la aeronave se reporta lista, responde: '[Matrícula], mantenga fuera de pista, tránsito en final corto.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": num...
USER> Fase actual: Contacto inicial con Torre (mantener fuera)
Intent esperado: ground_ready_for_departure
Transcripción textual del alumno:
Pastore Alfa Noviembre India en.de espera. esta. listo para salida.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_hold_short

Checklist alumno:
- Reportar punto de espera pista uno cero.
- Colacionar: 'Mantengo fuera de pista' o 'A posición y mantengo'.
- Colacionar instrucciones condicionales (ej. 'detrás del tránsito')...
2025-12-02 19:48:39,520 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_ready_for_departure intento=1: {
  "intent": "ground_ready_for_departure",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.",
  "feedback": "La transmisión cumple con el objetivo de reportar listo para salida. Aunque la fraseología tiene pausas innecesarias ('en.de espera. esta.'), la intención es clara. Se corrige automáticamente a 'mantenga fuera de pista' según protocolos de seguridad.",
  "confidence": 0.85,
  "score": 78,
  "metadata": {
    "nextPha...
2025-12-02 19:48:39,522 | INFO | app.controllers.audio | Transición automática de fase session=ab8c878c-a76e-421b-bf02-b589d0088a92 de=tower_hold_short a=tower_line_up
2025-12-02 19:48:39,687 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:48:39,689 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:48:39,690 | INFO | sqlalchemy.engine.Engine | [cached since 133.6s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:48:39,721 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:48:39,723 | INFO | sqlalchemy.engine.Engine | [cached since 13.68s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (22124 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 48, 39, 721374, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-12-02 19:48:39,747 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:48:39,779 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:48:39,780 | INFO | sqlalchemy.engine.Engine | [generated in 0.00179s] (UUID('d3ecc576-0374-42ff-8a9a-e1e0e9567411'), UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'), 1, 'tower_line_up', 78.0, "La transmisión cumple con el objetivo de reportar listo para salida. Aunque la fraseología tiene pausas innecesarias ('en.de espera. esta.'), la intención es clara. Se corrige automáticamente a 'mantenga fuera de pista' según protocolos de seguridad.")
2025-12-02 19:48:39,817 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:48:39,863 | INFO | app.controllers.audio | Puntuación guardada session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=tower_line_up score=78.00
2025-12-02 19:48:39,865 | INFO | app.logs.transcript | controller | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=118.300 | intent=ground_ready_for_departure | phase=tower_line_up | allow_response=True | text=Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.
2025-12-02 19:49:04,092 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:49:04,093 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:49:04,094 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:49:04,095 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:04,097 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:49:04,097 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:49:04,098 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:04,100 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:49:04,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:49:04,102 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:49:04,103 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:49:04,103 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:49:04,105 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:49:04,109 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:04,110 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:49:04,111 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:49:04,113 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:04,116 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:49:04,117 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:49:04,118 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:49:04,119 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:49:04,119 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:49:04,122 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:49:04,124 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:04,125 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:49:04,126 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:49:04,127 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:04,128 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:49:04,130 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 19:49:04,131 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:04,131 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:49:04,132 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:8192]
2025-12-02 19:49:04,259 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2919]
2025-12-02 19:49:04,261 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-02 19:49:04,261 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:04,264 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:04,402 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:04,403 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:04,407 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:49:04,525 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:49:04,526 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:04,675 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:49:04,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:04,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:04,802 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:49:04,804 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:04,908 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:49:04,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2549]
2025-12-02 19:49:04,911 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:49:04,911 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:49:05,053 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:49:05,055 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:49:05,057 | INFO | sqlalchemy.engine.Engine | [cached since 303.3s ago] ()
2025-12-02 19:49:05,067 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:49:05,067 | INFO | sqlalchemy.engine.Engine | [cached since 174.4s ago] (1,)
2025-12-02 19:49:05,550 | INFO | app.services.transcribe | Starting stream. Total bytes: 385024. Chunk size: 8192. No throttling.
2025-12-02 19:49:05,552 | DEBUG | app.services.transcribe | Streamed 8192/385024 bytes
2025-12-02 19:49:05,583 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:49:06,901 | DEBUG | app.services.transcribe | Received transcript chunk: mantengo fuera Alfa ...
2025-12-02 19:49:06,949 | INFO | app.services.transcribe | Transcription complete. Length: 38
2025-12-02 19:49:06,952 | INFO | app.controllers.audio | Transcripción recibida session=ab8c878c-a76e-421b-bf02-b589d0088a92: mantengo fuera Alfa Noviembre, India.
2025-12-02 19:49:06,954 | INFO | app.logs.transcript | student | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=118.300 | text=mantengo fuera Alfa Noviembre, India.
2025-12-02 19:49:07,274 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:49:07,276 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:49:07,280 | INFO | sqlalchemy.engine.Engine | [cached since 161.2s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:49:07,331 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:49:12,155 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:49:12,158 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:49:12,160 | INFO | sqlalchemy.engine.Engine | [cached since 166.1s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:49:12,179 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:49:12,181 | INFO | sqlalchemy.engine.Engine | [cached since 46.14s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (22577 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 49, 12, 179763, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-12-02 19:49:12,202 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:49:12,239 | INFO | app.controllers.audio | Fase activa session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=tower_line_up intent=tower_hold_short_instruction freq=tower
2025-12-02 19:49:12,243 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_hold_short_instruction freq_group=tower
SYSTEM> Sigues en Pavas Torre. Una vez libre el tránsito, instruye: '[Matrícula], ruede a posición y mantenga pista uno cero.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "meta...
USER> Fase actual: Autorización a posición y mantener
Intent esperado: tower_hold_short_instruction
Transcripción textual del alumno:
mantengo fuera Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_line_up

Checklist alumno:
- Reconocer la instrucción anterior y estar listo.

Checklist controlador:
- Autorizar 'ruede a posición y mantenga pista uno cero'.
- Mantener fraseología local.

Cuándo responder:
- allowResponse=true con la instrucc...
2025-12-02 19:49:27,219 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_hold_short_instruction intento=1: {
  "intent": "tower_hold_short_instruction",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, ruede a posición y mantenga pista uno cero.",
  "feedback": "La confirmación 'mantengo fuera' es correcta, aunque se omitió 'de pista'. Ahora que el tránsito ha sido liberado, se autoriza el rodaje a posición. Se mantiene la puntuación estándar y se incluye la pista asignada.",
  "confidence": 0.92,
  "score": 85,
  "metadata": {
    "nextPhase": "tower_takeoff_clearance",
    "mi...
2025-12-02 19:49:27,223 | INFO | app.controllers.audio | Transición automática de fase session=ab8c878c-a76e-421b-bf02-b589d0088a92 de=tower_line_up a=tower_takeoff_clearance
2025-12-02 19:49:27,591 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:49:27,594 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:49:27,596 | INFO | sqlalchemy.engine.Engine | [cached since 181.5s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:49:27,650 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:49:27,651 | INFO | sqlalchemy.engine.Engine | [cached since 61.61s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (24468 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 49, 27, 650094, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-12-02 19:49:27,691 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:49:27,728 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:49:27,733 | INFO | sqlalchemy.engine.Engine | [cached since 47.95s ago] (UUID('921dacf0-4c08-4c9e-a2c3-640368dd9163'), UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'), 1, 'tower_takeoff_clearance', 85.0, "La confirmación 'mantengo fuera' es correcta, aunque se omitió 'de pista'. Ahora que el tránsito ha sido liberado, se autoriza el rodaje a posición. Se mantiene la puntuación estándar y se incluye la pista asignada.")
2025-12-02 19:49:27,748 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:49:27,799 | INFO | app.controllers.audio | Puntuación guardada session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=tower_takeoff_clearance score=85.00
2025-12-02 19:49:27,801 | INFO | app.logs.transcript | controller | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=118.300 | intent=tower_hold_short_instruction | phase=tower_takeoff_clearance | allow_response=True | text=Alfa Noviembre India, ruede a posición y mantenga pista uno cero.
2025-12-02 19:49:44,368 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:49:44,369 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:49:44,371 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:49:44,372 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:44,373 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:49:44,374 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:49:44,375 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:44,376 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:49:44,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:49:44,378 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:49:44,379 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:49:44,380 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:49:44,381 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:49:44,382 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:44,383 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:49:44,384 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:49:44,385 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:44,387 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:49:44,389 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:49:44,390 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:49:44,391 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:49:44,393 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:49:44,394 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:49:44,395 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:44,395 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:49:44,396 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:49:44,398 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:44,399 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:49:44,399 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 19:49:44,400 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:49:44,401 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:49:44,402 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:5840]
2025-12-02 19:49:44,405 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:49:44,522 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:49:44,524 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:44,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:49:44,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:44,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:44,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:49:44,815 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:44,943 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:49:44,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:44,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:45,108 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:49:45,109 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:49:45,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:49:45,243 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:45,245 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:49:45,248 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:45,367 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:49:45,369 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:49:45,372 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:49:45,482 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:49:45,486 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1497]
2025-12-02 19:49:45,487 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:49:45,488 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:49:45,687 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:49:45,688 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:49:45,690 | INFO | sqlalchemy.engine.Engine | [cached since 344s ago] ()
2025-12-02 19:49:45,700 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:49:45,703 | INFO | sqlalchemy.engine.Engine | [cached since 215s ago] (1,)
2025-12-02 19:49:46,162 | INFO | app.services.transcribe | Starting stream. Total bytes: 497664. Chunk size: 8192. No throttling.
2025-12-02 19:49:46,164 | DEBUG | app.services.transcribe | Streamed 8192/497664 bytes
2025-12-02 19:49:46,197 | DEBUG | app.services.transcribe | Streamed 417792/497664 bytes
2025-12-02 19:49:46,204 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:49:48,146 | DEBUG | app.services.transcribe | Received transcript chunk: posición y mantenien...
2025-12-02 19:49:48,194 | INFO | app.services.transcribe | Transcription complete. Length: 54
2025-12-02 19:49:48,195 | INFO | app.controllers.audio | Transcripción recibida session=ab8c878c-a76e-421b-bf02-b589d0088a92: posición y manteniendo pista 10 Alfa Noviembre India.
2025-12-02 19:49:48,195 | INFO | app.logs.transcript | student | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=118.300 | text=posición y manteniendo pista 10 Alfa Noviembre India.
2025-12-02 19:49:48,328 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:49:48,328 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:49:48,329 | INFO | sqlalchemy.engine.Engine | [cached since 202.2s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:49:48,347 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:49:50,994 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:49:50,995 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:49:50,996 | INFO | sqlalchemy.engine.Engine | [cached since 204.9s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:49:51,013 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:49:51,014 | INFO | sqlalchemy.engine.Engine | [cached since 84.97s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (24936 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 49, 51, 13072, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-12-02 19:49:51,034 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:49:51,063 | INFO | app.controllers.audio | Fase activa session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=tower_takeoff_clearance intent=tower_position_report freq=tower
2025-12-02 19:49:51,066 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_position_report freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 100 grados 18 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence":...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_position_report
Transcripción textual del alumno:
posición y manteniendo pista 10 Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver d...
2025-12-02 19:50:05,677 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_position_report intento=1: {
  "intent": "tower_position_report",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "La transmisión confirma la posición en pista pero no colacionó la autorización de despegue. Debes repetir 'AUTORIZADO DESPEGAR' y las restricciones (rumbo y reporte de altitud) antes de iniciar rodaje. Corrige: 'Autorizado despegar pista 10, mantengo rumbo y reportaré pasando 5000 pies'.",
  "confidence": 0.85,
  "score": 40,
  "metadata": {
    "missing_elements": [
      "AUTORIZADO DES...
2025-12-02 19:50:05,827 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:50:05,828 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:50:05,830 | INFO | sqlalchemy.engine.Engine | [cached since 219.7s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:50:05,853 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:50:05,855 | INFO | sqlalchemy.engine.Engine | [cached since 99.81s ago] ('{"meteo": {"qnh": "1015", "vis": ">10km", "dewp": "17", "temp": "22", "wind": "100/18", "cloudBase": "1000", "condition": "VMC", "windSpeed": "18", " ... (26573 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0532", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 50, 5, 853154, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('0fae9ff5-daff-41a8-82c8-3a1bb11662a1'))
2025-12-02 19:50:05,877 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:50:05,911 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:50:05,912 | INFO | sqlalchemy.engine.Engine | [cached since 86.13s ago] (UUID('6257a961-e22c-460c-8151-be523eb843dd'), UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'), 1, 'tower_takeoff_clearance', 40.0, "La transmisión confirma la posición en pista pero no colacionó la autorización de despegue. Debes repetir 'AUTORIZADO DESPEGAR' y las restricciones (rumbo y reporte de altitud) antes de iniciar rodaje. Corrige: 'Autorizado despegar pista 10, mantengo rumbo y reportaré pasando 5000 pies'.")
2025-12-02 19:50:05,921 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:50:05,957 | INFO | app.controllers.audio | Puntuación guardada session=ab8c878c-a76e-421b-bf02-b589d0088a92 phase_id=tower_takeoff_clearance score=40.00
2025-12-02 19:50:05,959 | INFO | app.logs.transcript | controller | session=ab8c878c-a76e-421b-bf02-b589d0088a92 | frequency=118.300 | intent=tower_position_report | phase=tower_takeoff_clearance | allow_response=False | text=
2025-12-02 19:51:17,967 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:17,970 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:17,971 | INFO | sqlalchemy.engine.Engine | [cached since 436.2s ago] ()
2025-12-02 19:51:17,974 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:17,975 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:17,977 | INFO | sqlalchemy.engine.Engine | [cached since 436.2s ago] ()
2025-12-02 19:51:17,984 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:17,987 | INFO | sqlalchemy.engine.Engine | [cached since 307.3s ago] (1,)
2025-12-02 19:51:17,990 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:17,992 | INFO | sqlalchemy.engine.Engine | [cached since 307.3s ago] (1,)
2025-12-02 19:51:18,011 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:18,012 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:18,014 | INFO | sqlalchemy.engine.Engine | [cached since 436.3s ago] ()
2025-12-02 19:51:18,026 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:18,028 | INFO | sqlalchemy.engine.Engine | [cached since 307.3s ago] (1,)
2025-12-02 19:51:18,061 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:18,063 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:18,065 | INFO | sqlalchemy.engine.Engine | [cached since 436.3s ago] ()
2025-12-02 19:51:18,074 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:18,074 | INFO | sqlalchemy.engine.Engine | [cached since 307.4s ago] (1,)
2025-12-02 19:51:18,123 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:18,124 | INFO | sqlalchemy.engine.Engine | [cached since 307.4s ago] (1,)
2025-12-02 19:51:18,127 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:18,129 | INFO | sqlalchemy.engine.Engine | [cached since 307.4s ago] (1,)
2025-12-02 19:51:18,132 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:18,134 | INFO | sqlalchemy.engine.Engine | [cached since 307.4s ago] (1,)
2025-12-02 19:51:18,138 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 19:51:18,139 | INFO | sqlalchemy.engine.Engine | [cached since 304.3s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 19:51:18,143 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 19:51:18,144 | INFO | sqlalchemy.engine.Engine | [cached since 304.3s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 19:51:18,147 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 19:51:18,148 | INFO | sqlalchemy.engine.Engine | [cached since 304.3s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 19:51:18,166 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:51:18,168 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:51:18,172 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:51:18,177 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:18,179 | INFO | sqlalchemy.engine.Engine | [cached since 307.5s ago] (1,)
2025-12-02 19:51:18,187 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 19:51:18,188 | INFO | sqlalchemy.engine.Engine | [cached since 304.3s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 19:51:18,215 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:51:21,961 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:21,962 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:21,964 | INFO | sqlalchemy.engine.Engine | [cached since 440.2s ago] ()
2025-12-02 19:51:21,977 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:21,978 | INFO | sqlalchemy.engine.Engine | [cached since 311.3s ago] (1,)
2025-12-02 19:51:22,111 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:51:22,114 | INFO | sqlalchemy.engine.Engine | [cached since 296s ago] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:51:22,143 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-02 19:51:22,144 | INFO | sqlalchemy.engine.Engine | [generated in 0.00107s] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:51:22,167 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:51:22,169 | INFO | sqlalchemy.engine.Engine | [generated in 0.00098s] (UUID('ab8c878c-a76e-421b-bf02-b589d0088a92'),)
2025-12-02 19:51:22,177 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:51:22,608 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:22,611 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:22,614 | INFO | sqlalchemy.engine.Engine | [cached since 440.9s ago] ()
2025-12-02 19:51:22,628 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:22,631 | INFO | sqlalchemy.engine.Engine | [cached since 311.9s ago] (1,)
2025-12-02 19:51:22,640 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:22,643 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:22,646 | INFO | sqlalchemy.engine.Engine | [cached since 440.9s ago] ()
2025-12-02 19:51:22,660 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:22,662 | INFO | sqlalchemy.engine.Engine | [cached since 312s ago] (1,)
2025-12-02 19:51:22,757 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:22,757 | INFO | sqlalchemy.engine.Engine | [cached since 312.1s ago] (1,)
2025-12-02 19:51:22,759 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:22,761 | INFO | sqlalchemy.engine.Engine | [cached since 312.1s ago] (1,)
2025-12-02 19:51:22,764 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 19:51:22,765 | INFO | sqlalchemy.engine.Engine | [cached since 308.9s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 19:51:22,767 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 19:51:22,768 | INFO | sqlalchemy.engine.Engine | [cached since 308.9s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 19:51:22,784 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:51:22,796 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:51:32,033 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 19:51:32,168 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000019AFD1D9D50>
2025-12-02 19:51:32,170 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x0000019AFD3A8050> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 19:51:32,365 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000019AFCD13250>
2025-12-02 19:51:32,366 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 19:51:32,367 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 19:51:32,368 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 19:51:32,368 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 19:51:32,370 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 19:51:32,470 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 01:51:33 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'479'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1df-O0UQfobsonyUSrHWoFFkZgSmVOc"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T015133Z-1654ff75797x4s2vhC1MIA6ytw0000000t8000000000k1my'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-02 19:51:32,472 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 19:51:32,473 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 19:51:32,474 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 19:51:32,476 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 19:51:32,478 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 19:51:32,479 | DEBUG | httpcore.connection | close.started
2025-12-02 19:51:32,481 | DEBUG | httpcore.connection | close.complete
2025-12-02 19:51:36,803 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:36,803 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:51:36,806 | INFO | sqlalchemy.engine.Engine | [cached since 455.1s ago] ()
2025-12-02 19:51:36,813 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:51:36,814 | INFO | sqlalchemy.engine.Engine | [cached since 326.1s ago] (1,)
2025-12-02 19:51:36,995 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-02 19:51:36,997 | INFO | sqlalchemy.engine.Engine | [generated in 0.00175s] (UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "280", "windSpeed": "5", "temp": "21", "dewp": "20", "cloudCover": "FEW", "cloudBase": "800", "wind": "280/5"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 2, 19, 51, 36, 995491, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 2, 19, 51, 36, 995491, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-02 19:51:37,044 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:51:37,430 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:51:37,435 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-02 19:51:37,439 | INFO | sqlalchemy.engine.Engine | [generated in 0.00381s] (UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'),)
2025-12-02 19:51:37,471 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:52:08,726 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:52:08,727 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:52:08,727 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:52:08,729 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:52:08,730 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:52:08,731 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:52:08,733 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:52:08,734 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:52:08,736 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:52:08,737 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:52:08,737 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:52:08,739 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:52:08,740 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:52:08,741 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:52:08,743 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:52:08,744 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:52:08,745 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:52:08,746 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:52:08,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:52:08,749 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:52:08,749 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:52:08,750 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:52:08,751 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:52:08,751 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:52:08,753 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:52:08,754 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:52:08,755 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:52:08,756 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:52:08,756 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 19:52:08,757 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:52:08,758 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:52:08,759 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 19:52:08,761 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:52:08,877 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:08,879 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:09,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:09,010 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:09,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:52:09,157 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:09,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:09,163 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:09,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:09,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:09,301 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:09,451 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:09,453 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:09,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:09,581 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:09,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:09,699 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:09,701 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:09,704 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:52:09,831 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:09,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:09,970 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:09,972 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:09,974 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:10,105 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:10,107 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,240 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:10,242 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:10,243 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,374 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:10,376 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,507 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:10,509 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:10,633 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:10,635 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:10,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:10,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,868 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:10,869 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:10,871 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:10,985 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:10,987 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:10,991 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:11,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:11,111 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,113 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:11,234 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,235 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:52:11,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,349 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:11,351 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3811]
2025-12-02 19:52:11,476 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-02 19:52:11,476 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,478 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:11,479 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:11,634 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,636 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:11,637 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:52:11,784 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:11,786 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,789 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,791 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:52:11,929 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:11,932 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:11,934 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:12,080 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:52:12,083 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:12,219 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:52:12,220 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:52:12,222 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:52:12,231 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:537]
2025-12-02 19:52:12,233 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:52:12,233 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:52:12,406 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:52:12,407 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:52:12,408 | INFO | sqlalchemy.engine.Engine | [cached since 490.7s ago] ()
2025-12-02 19:52:12,419 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:52:12,420 | INFO | sqlalchemy.engine.Engine | [cached since 361.7s ago] (1,)
2025-12-02 19:52:13,491 | INFO | app.services.transcribe | Starting stream. Total bytes: 1574912. Chunk size: 8192. No throttling.
2025-12-02 19:52:13,495 | DEBUG | app.services.transcribe | Streamed 8192/1574912 bytes
2025-12-02 19:52:13,532 | DEBUG | app.services.transcribe | Streamed 417792/1574912 bytes
2025-12-02 19:52:13,571 | DEBUG | app.services.transcribe | Streamed 827392/1574912 bytes
2025-12-02 19:52:13,601 | DEBUG | app.services.transcribe | Streamed 1236992/1574912 bytes
2025-12-02 19:52:13,629 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:52:19,367 | DEBUG | app.services.transcribe | Received transcript chunk: superficie Alfa Novi...
2025-12-02 19:52:22,001 | DEBUG | app.services.transcribe | Received transcript chunk: nivel 7000 pies dos ...
2025-12-02 19:52:22,068 | INFO | app.services.transcribe | Transcription complete. Length: 186
2025-12-02 19:52:22,068 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía paso ocho. nivel 7000 pies dos almas a bordo, autonomía cinco horas.
2025-12-02 19:52:22,069 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=121.700 | text=superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía paso ocho. nivel 7000 pies dos almas a bordo, autonomía cinco horas.
2025-12-02 19:52:22,208 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:52:22,209 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:52:22,210 | INFO | sqlalchemy.engine.Engine | [cached since 356.1s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:52:22,233 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:52:23,257 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:52:23,259 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:52:23,261 | INFO | sqlalchemy.engine.Engine | [cached since 357.2s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:52:23,285 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:52:23,287 | INFO | sqlalchemy.engine.Engine | [cached since 237.2s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (14646 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-03T01:52:23Z"}]}', datetime.datetime(2025, 12, 2, 19, 52, 23, 285427, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:52:23,303 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:52:23,339 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-02 19:52:23,342 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 280 grados 5 nudos. QNH 1017. Transponder 0586. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": st...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía paso ocho. nivel 7000 pies dos almas a bordo, autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ...
2025-12-02 19:52:33,759 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 280 grados 5 nudos. QNH 1017. Transponder 0586. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "ground_readback"
...
2025-12-02 19:52:33,761 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=ground_departure_request a=ground_readback
2025-12-02 19:52:33,893 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:52:33,894 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:52:33,895 | INFO | sqlalchemy.engine.Engine | [cached since 367.8s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:52:33,916 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:52:33,917 | INFO | sqlalchemy.engine.Engine | [cached since 247.9s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (15918 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 19, 52, 33, 916021, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:52:33,931 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:52:33,969 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:52:33,970 | INFO | sqlalchemy.engine.Engine | [cached since 234.2s ago] (UUID('61b08458-37e1-4f5b-99d0-493aa90d8daa'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'ground_readback', 95.0, 'Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.')
2025-12-02 19:52:33,981 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:52:34,011 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=ground_readback score=95.00
2025-12-02 19:52:34,013 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 280 grados 5 nudos. QNH 1017. Transponder 0586. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.
2025-12-02 19:53:05,907 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:53:05,909 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:53:05,909 | INFO | sqlalchemy.engine.Engine | [cached since 544.2s ago] ()
2025-12-02 19:53:05,911 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:53:05,914 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:53:05,916 | INFO | sqlalchemy.engine.Engine | [cached since 544.2s ago] ()
2025-12-02 19:53:05,927 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:53:05,929 | INFO | sqlalchemy.engine.Engine | [cached since 415.2s ago] (1,)
2025-12-02 19:53:05,932 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:53:05,934 | INFO | sqlalchemy.engine.Engine | [cached since 415.2s ago] (1,)
2025-12-02 19:53:06,053 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:53:06,054 | INFO | sqlalchemy.engine.Engine | [cached since 415.4s ago] (1,)
2025-12-02 19:53:06,057 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:53:06,059 | INFO | sqlalchemy.engine.Engine | [cached since 415.4s ago] (1,)
2025-12-02 19:53:06,063 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 19:53:06,066 | INFO | sqlalchemy.engine.Engine | [cached since 412.2s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 19:53:06,070 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 19:53:06,072 | INFO | sqlalchemy.engine.Engine | [cached since 412.2s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 19:53:06,102 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:53:06,107 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:53:08,377 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:53:08,379 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:53:08,381 | INFO | sqlalchemy.engine.Engine | [cached since 546.6s ago] ()
2025-12-02 19:53:08,397 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:53:08,398 | INFO | sqlalchemy.engine.Engine | [cached since 417.7s ago] (1,)
2025-12-02 19:53:08,507 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:53:08,508 | INFO | sqlalchemy.engine.Engine | [cached since 402.4s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:53:08,528 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:53:08,529 | INFO | sqlalchemy.engine.Engine | [cached since 417.8s ago] (1,)
2025-12-02 19:53:08,533 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:53:40,271 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:53:40,272 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:53:40,273 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:53:40,274 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:53:40,276 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:53:40,276 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:53:40,277 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:53:40,278 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:53:40,280 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:53:40,281 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:53:40,281 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:53:40,282 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:53:40,284 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:53:40,285 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:53:40,287 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:53:40,287 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:53:40,289 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:53:40,290 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:53:40,291 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:53:40,292 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:53:40,293 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:53:40,294 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:53:40,295 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:53:40,295 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:53:40,296 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:53:40,297 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:53:40,298 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:53:40,299 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:53:40,301 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 19:53:40,302 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:53:40,303 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:53:40,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-02 19:53:40,306 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:40,309 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:53:40,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:40,497 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:40,500 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:40,684 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:40,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:40,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:40,851 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:40,853 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:40,855 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:53:40,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:53:41,018 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:41,020 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:41,022 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:41,025 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:53:41,230 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:53:41,231 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:41,233 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:53:41,389 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:41,391 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:41,393 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:41,396 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:53:41,544 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:41,546 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:41,548 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:41,736 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:41,738 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:41,740 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:41,903 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:41,904 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:41,907 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:42,072 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:42,073 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:42,076 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:42,250 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:42,252 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:42,254 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:42,256 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:53:42,438 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:42,440 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:42,442 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:42,594 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:42,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-02 19:53:42,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:42,752 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:42,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:42,912 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:42,914 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:42,916 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:43,082 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:43,083 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:43,085 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:43,232 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:43,234 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:43,236 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:43,240 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:53:43,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:43,419 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:43,422 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:43,592 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:53:43,594 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:43,597 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:53:43,746 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:43,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:43,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:43,914 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:43,915 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:43,920 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:44,092 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:44,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:44,100 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:44,261 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:53:44,263 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:53:44,265 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:53:44,284 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1080]
2025-12-02 19:53:44,285 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:53:44,285 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:53:44,440 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:53:44,440 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:53:44,443 | INFO | sqlalchemy.engine.Engine | [cached since 582.7s ago] ()
2025-12-02 19:53:44,452 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:53:44,453 | INFO | sqlalchemy.engine.Engine | [cached since 453.8s ago] (1,)
2025-12-02 19:53:45,478 | INFO | app.services.transcribe | Starting stream. Total bytes: 1400832. Chunk size: 8192. No throttling.
2025-12-02 19:53:45,483 | DEBUG | app.services.transcribe | Streamed 8192/1400832 bytes
2025-12-02 19:53:45,531 | DEBUG | app.services.transcribe | Streamed 417792/1400832 bytes
2025-12-02 19:53:45,581 | DEBUG | app.services.transcribe | Streamed 827392/1400832 bytes
2025-12-02 19:53:45,624 | DEBUG | app.services.transcribe | Streamed 1236992/1400832 bytes
2025-12-02 19:53:45,635 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:53:49,129 | DEBUG | app.services.transcribe | Received transcript chunk: UNH 1017 transponder...
2025-12-02 19:53:51,109 | DEBUG | app.services.transcribe | Received transcript chunk: rodaré vía Alfa tres...
2025-12-02 19:53:53,596 | DEBUG | app.services.transcribe | Received transcript chunk: al.de espera pista 1...
2025-12-02 19:53:53,670 | INFO | app.services.transcribe | Transcription complete. Length: 98
2025-12-02 19:53:53,671 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: UNH 1017 transponder 0586. rodaré vía Alfa tres Alfa. al.de espera pista 10 Alfa Noviembre India.
2025-12-02 19:53:53,672 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=121.700 | text=UNH 1017 transponder 0586. rodaré vía Alfa tres Alfa. al.de espera pista 10 Alfa Noviembre India.
2025-12-02 19:53:53,838 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:53:53,840 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:53:53,841 | INFO | sqlalchemy.engine.Engine | [cached since 447.8s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:53:53,863 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:53:56,143 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:53:56,144 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:53:56,145 | INFO | sqlalchemy.engine.Engine | [cached since 450.1s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:53:56,175 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:53:56,176 | INFO | sqlalchemy.engine.Engine | [cached since 330.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (16437 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 19, 53, 56, 175030, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:53:56,196 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:53:56,237 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 19:53:56,243 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
UNH 1017 transponder 0586. rodaré vía Alfa tres Alfa. al.de espera pista 10 Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacio...
2025-12-02 19:54:07,840 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista y restricciones. Puede proceder a Torre.",
  "confidence": 0.98,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_hold_short",
    "missingItems": [],
    "extraItems": []
  }
}
2025-12-02 19:54:07,842 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-02 19:54:07,844 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=ground_readback a=tower_hold_short
2025-12-02 19:54:08,086 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:54:08,088 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:54:08,089 | INFO | sqlalchemy.engine.Engine | [cached since 462s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:54:08,119 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:54:08,121 | INFO | sqlalchemy.engine.Engine | [cached since 342.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (17700 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 54, 8, 118968, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:54:08,145 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:54:08,176 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:54:08,178 | INFO | sqlalchemy.engine.Engine | [cached since 328.4s ago] (UUID('bfdce99e-7315-4df1-8f98-a4306b4fa45b'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'tower_hold_short', 95.0, 'Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista y restricciones. Puede proceder a Torre.')
2025-12-02 19:54:08,194 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:54:08,237 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_hold_short score=95.00
2025-12-02 19:54:08,238 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=121.700 | intent=ground_taxi_readback | phase=tower_hold_short | allow_response=True | text=Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-02 19:54:34,015 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:54:34,016 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:54:34,017 | INFO | sqlalchemy.engine.Engine | [cached since 632.3s ago] ()
2025-12-02 19:54:34,029 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:54:34,030 | INFO | sqlalchemy.engine.Engine | [cached since 503.3s ago] (1,)
2025-12-02 19:54:34,056 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:54:34,057 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:54:34,059 | INFO | sqlalchemy.engine.Engine | [cached since 632.3s ago] ()
2025-12-02 19:54:34,069 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:54:34,070 | INFO | sqlalchemy.engine.Engine | [cached since 503.4s ago] (1,)
2025-12-02 19:54:34,147 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:54:34,148 | INFO | sqlalchemy.engine.Engine | [cached since 503.5s ago] (1,)
2025-12-02 19:54:34,154 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 19:54:34,155 | INFO | sqlalchemy.engine.Engine | [cached since 500.3s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 19:54:34,160 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:54:34,161 | INFO | sqlalchemy.engine.Engine | [cached since 503.5s ago] (1,)
2025-12-02 19:54:34,169 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 19:54:34,170 | INFO | sqlalchemy.engine.Engine | [cached since 500.3s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 19:54:34,179 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:54:34,200 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:54:37,289 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:54:37,291 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:54:37,292 | INFO | sqlalchemy.engine.Engine | [cached since 635.6s ago] ()
2025-12-02 19:54:37,305 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:54:37,307 | INFO | sqlalchemy.engine.Engine | [cached since 506.6s ago] (1,)
2025-12-02 19:54:37,501 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:54:37,504 | INFO | sqlalchemy.engine.Engine | [cached since 491.4s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:54:37,531 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:54:37,533 | INFO | sqlalchemy.engine.Engine | [cached since 506.8s ago] (1,)
2025-12-02 19:54:37,539 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:55:13,905 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:55:13,906 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:55:13,908 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:55:13,909 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:13,911 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:55:13,913 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:55:13,914 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:13,915 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:55:13,916 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:55:13,917 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:55:13,917 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:55:13,920 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:55:13,921 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:55:13,922 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:13,922 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:55:13,923 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:55:13,924 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:13,925 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:55:13,926 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:55:13,927 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:55:13,927 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:55:13,929 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:55:13,930 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:55:13,932 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:13,932 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:55:13,933 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:55:13,935 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:13,936 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:55:13,937 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 19:55:13,940 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:13,942 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:55:13,944 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:5840]
2025-12-02 19:55:13,946 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:55:14,114 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:14,115 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:14,118 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:55:14,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:14,299 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:14,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:14,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:55:14,478 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:14,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:14,481 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:55:14,651 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:14,654 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:14,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:55:14,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:55:14,836 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:55:15,037 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:55:15,040 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,044 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:55:15,245 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:15,247 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,249 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:55:15,429 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,431 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:55:15,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,597 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 19:55:15,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:55:15,765 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:15,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,768 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:55:15,951 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:15,952 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,955 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:15,957 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:55:15,993 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1528]
2025-12-02 19:55:15,994 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:55:15,996 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:55:16,163 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:55:16,164 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:55:16,165 | INFO | sqlalchemy.engine.Engine | [cached since 674.4s ago] ()
2025-12-02 19:55:16,175 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:55:16,177 | INFO | sqlalchemy.engine.Engine | [cached since 545.5s ago] (1,)
2025-12-02 19:55:17,206 | INFO | app.services.transcribe | Starting stream. Total bytes: 706560. Chunk size: 8192. No throttling.
2025-12-02 19:55:17,210 | DEBUG | app.services.transcribe | Streamed 8192/706560 bytes
2025-12-02 19:55:17,258 | DEBUG | app.services.transcribe | Streamed 417792/706560 bytes
2025-12-02 19:55:17,303 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:55:18,811 | DEBUG | app.services.transcribe | Received transcript chunk: Torre Alfa Noviembre...
2025-12-02 19:55:20,710 | DEBUG | app.services.transcribe | Received transcript chunk: en.de espera pista 1...
2025-12-02 19:55:20,858 | INFO | app.services.transcribe | Transcription complete. Length: 70
2025-12-02 19:55:20,859 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: Torre Alfa Noviembre, India. en.de espera pista 10 listo para salida.
2025-12-02 19:55:20,860 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | text=Torre Alfa Noviembre, India. en.de espera pista 10 listo para salida.
2025-12-02 19:55:21,001 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:55:21,002 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:55:21,003 | INFO | sqlalchemy.engine.Engine | [cached since 534.9s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:55:21,026 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:55:22,498 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:55:22,499 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:55:22,501 | INFO | sqlalchemy.engine.Engine | [cached since 536.4s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:55:22,528 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:55:22,529 | INFO | sqlalchemy.engine.Engine | [cached since 416.5s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (18179 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 55, 22, 528026, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:55:22,557 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:55:22,599 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_hold_short intent=tower_ready_for_departure freq=tower
2025-12-02 19:55:22,603 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_ready_for_departure freq_group=tower
SYSTEM> Eres Pavas Torre (118.3). Cuando la aeronave se reporta lista, responde: '[Matrícula], mantenga fuera de pista, tránsito en final corto.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": num...
USER> Fase actual: Contacto inicial con Torre (mantener fuera)
Intent esperado: tower_ready_for_departure
Transcripción textual del alumno:
Torre Alfa Noviembre, India. en.de espera pista 10 listo para salida.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_hold_short

Checklist alumno:
- Reportar punto de espera pista uno cero.
- Colacionar: 'Mantengo fuera de pista' o 'A posición y mantengo'.
- Colacionar instrucciones condicionales (ej. 'detrás del tránsito'...
2025-12-02 19:55:33,357 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_ready_for_departure intento=1: {
  "intent": "tower_ready_for_departure",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.",
  "feedback": "Reporte correcto de posición y estado. Se usó 'listo para salida' correctamente. La fraseología cumple con los estándares ATC.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_line_up",
    "missingElements": [],
    "additionalNotes": "El alumno reportó correctamente su posición y estado...
2025-12-02 19:55:33,359 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=tower_hold_short a=tower_line_up
2025-12-02 19:55:33,534 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:55:33,535 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:55:33,538 | INFO | sqlalchemy.engine.Engine | [cached since 547.4s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:55:33,556 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:55:33,557 | INFO | sqlalchemy.engine.Engine | [cached since 427.5s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (19834 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 55, 33, 555298, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:55:33,575 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:55:33,613 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:55:33,614 | INFO | sqlalchemy.engine.Engine | [cached since 413.8s ago] (UUID('93405fc5-3335-4d5e-9af0-531e7bf0e72a'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'tower_line_up', 95.0, "Reporte correcto de posición y estado. Se usó 'listo para salida' correctamente. La fraseología cumple con los estándares ATC.")
2025-12-02 19:55:33,624 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:55:33,657 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_line_up score=95.00
2025-12-02 19:55:33,658 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | intent=tower_ready_for_departure | phase=tower_line_up | allow_response=True | text=Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.
2025-12-02 19:55:50,435 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:55:50,435 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:55:50,437 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:55:50,437 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:50,439 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:55:50,440 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:55:50,441 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:50,442 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:55:50,443 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:55:50,445 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:55:50,445 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:55:50,447 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:55:50,448 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:55:50,448 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:50,450 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:55:50,451 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:55:50,452 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:50,453 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:55:50,454 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:55:50,455 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:55:50,457 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:55:50,458 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:55:50,459 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:55:50,460 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:50,461 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:55:50,462 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:55:50,463 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:50,464 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:55:50,465 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 19:55:50,465 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:55:50,467 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:55:50,468 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:2920]
2025-12-02 19:55:50,469 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:55:50,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:50,630 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:50,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:55:50,807 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:50,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:50,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:55:51,043 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:51,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:51,048 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:55:51,250 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:55:51,251 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:51,254 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:55:51,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:51,434 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:51,437 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:51,439 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:55:51,549 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:55:51,551 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:55:51,553 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1180]
2025-12-02 19:55:51,554 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:55:51,555 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:55:51,724 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:55:51,725 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:55:51,727 | INFO | sqlalchemy.engine.Engine | [cached since 710s ago] ()
2025-12-02 19:55:51,735 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:55:51,737 | INFO | sqlalchemy.engine.Engine | [cached since 581s ago] (1,)
2025-12-02 19:55:52,240 | INFO | app.services.transcribe | Starting stream. Total bytes: 374784. Chunk size: 8192. No throttling.
2025-12-02 19:55:52,244 | DEBUG | app.services.transcribe | Streamed 8192/374784 bytes
2025-12-02 19:55:52,280 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:55:54,033 | DEBUG | app.services.transcribe | Received transcript chunk: mantengo fuera Alfa ...
2025-12-02 19:55:54,081 | INFO | app.services.transcribe | Transcription complete. Length: 38
2025-12-02 19:55:54,082 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: mantengo fuera Alfa Noviembre, India.
2025-12-02 19:55:54,083 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | text=mantengo fuera Alfa Noviembre, India.
2025-12-02 19:55:54,262 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:55:54,263 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:55:54,265 | INFO | sqlalchemy.engine.Engine | [cached since 568.2s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:55:54,287 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:55:57,023 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:55:57,025 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:55:57,028 | INFO | sqlalchemy.engine.Engine | [cached since 570.9s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:55:57,063 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:55:57,064 | INFO | sqlalchemy.engine.Engine | [cached since 451s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (20284 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 55, 57, 62822, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:55:57,096 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:55:57,147 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_line_up intent=tower_hold_short_instruction freq=tower
2025-12-02 19:55:57,150 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_hold_short_instruction freq_group=tower
SYSTEM> Sigues en Pavas Torre. Una vez libre el tránsito, instruye: '[Matrícula], ruede a posición y mantenga pista uno cero.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "meta...
USER> Fase actual: Autorización a posición y mantener
Intent esperado: tower_hold_short_instruction
Transcripción textual del alumno:
mantengo fuera Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_line_up

Checklist alumno:
- Reconocer la instrucción anterior y estar listo.

Checklist controlador:
- Autorizar 'ruede a posición y mantenga pista uno cero'.
- Mantener fraseología local.

Cuándo responder:
- allowResponse=true con la instrucc...
2025-12-02 19:56:07,761 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_hold_short_instruction intento=1: {
  "intent": "tower_hold_short_instruction",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, ruede a posición y mantenga pista uno cero.",
  "feedback": "La confirmación de 'mantengo fuera' fue correcta. Ahora se autoriza el rodaje a posición. Se mantiene la secuencia lógica de instrucciones.",
  "confidence": 0.92,
  "score": 85,
  "metadata": {
    "nextPhase": "tower_takeoff_clearance",
    "missingElements": [],
    "additionalNotes": "El alumno reconoció correctament...
2025-12-02 19:56:07,763 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=tower_line_up a=tower_takeoff_clearance
2025-12-02 19:56:07,981 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:56:07,983 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:56:07,984 | INFO | sqlalchemy.engine.Engine | [cached since 581.9s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:56:08,018 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:56:08,020 | INFO | sqlalchemy.engine.Engine | [cached since 462s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (21963 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 56, 8, 17804, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:56:08,048 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:56:08,078 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:56:08,082 | INFO | sqlalchemy.engine.Engine | [cached since 448.3s ago] (UUID('3ad8df1d-2a7a-4962-9b6e-221a07857910'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'tower_takeoff_clearance', 85.0, "La confirmación de 'mantengo fuera' fue correcta. Ahora se autoriza el rodaje a posición. Se mantiene la secuencia lógica de instrucciones.")
2025-12-02 19:56:08,099 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:56:08,148 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_takeoff_clearance score=85.00
2025-12-02 19:56:08,149 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | intent=tower_hold_short_instruction | phase=tower_takeoff_clearance | allow_response=True | text=Alfa Noviembre India, ruede a posición y mantenga pista uno cero.
2025-12-02 19:56:34,145 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:56:34,146 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:56:34,147 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:56:34,148 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:56:34,150 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:56:34,151 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:56:34,152 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:56:34,153 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:56:34,155 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:56:34,156 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:56:34,157 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:56:34,160 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:56:34,162 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:56:34,164 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:56:34,165 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:56:34,167 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:56:34,169 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:56:34,170 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:56:34,172 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:56:34,173 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:56:34,174 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:56:34,175 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:56:34,177 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:56:34,178 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:56:34,179 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:56:34,179 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:56:34,181 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:56:34,181 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:56:34,183 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 19:56:34,184 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:56:34,185 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:56:34,186 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:5840]
2025-12-02 19:56:34,189 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:56:34,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:56:34,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:56:34,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:56:34,501 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:56:34,504 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:56:34,507 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:56:34,669 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:56:34,672 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:56:34,675 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:56:34,871 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:56:34,873 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:56:34,874 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:56:35,056 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:56:35,060 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:56:35,264 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:56:35,265 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:56:35,267 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:56:35,438 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:56:35,442 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:56:35,444 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:56:35,596 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:56:35,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:56:35,600 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:56:35,615 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:481]
2025-12-02 19:56:35,617 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:56:35,618 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:56:35,770 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:56:35,772 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:56:35,773 | INFO | sqlalchemy.engine.Engine | [cached since 754s ago] ()
2025-12-02 19:56:35,781 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:56:35,782 | INFO | sqlalchemy.engine.Engine | [cached since 625.1s ago] (1,)
2025-12-02 19:56:36,280 | INFO | app.services.transcribe | Starting stream. Total bytes: 518144. Chunk size: 8192. No throttling.
2025-12-02 19:56:36,283 | DEBUG | app.services.transcribe | Streamed 8192/518144 bytes
2025-12-02 19:56:36,332 | DEBUG | app.services.transcribe | Streamed 417792/518144 bytes
2025-12-02 19:56:36,347 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:56:38,915 | DEBUG | app.services.transcribe | Received transcript chunk: a posición y manteni...
2025-12-02 19:56:38,971 | INFO | app.services.transcribe | Transcription complete. Length: 56
2025-12-02 19:56:38,973 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: a posición y manteniendo pista 10 Alfa Noviembre India.
2025-12-02 19:56:38,974 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | text=a posición y manteniendo pista 10 Alfa Noviembre India.
2025-12-02 19:56:39,187 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:56:39,190 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:56:39,192 | INFO | sqlalchemy.engine.Engine | [cached since 613.1s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:56:39,223 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:56:43,782 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:56:43,783 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:56:43,785 | INFO | sqlalchemy.engine.Engine | [cached since 617.7s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:56:43,816 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:56:43,817 | INFO | sqlalchemy.engine.Engine | [cached since 497.8s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (22430 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 56, 43, 815171, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:56:43,839 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:56:43,886 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_takeoff_clearance intent=tower_position_report freq=tower
2025-12-02 19:56:43,889 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_position_report freq_group=tower
SYSTEM> Como Torre, clearance final: '[Matrícula], viento 280 grados 5 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": ...
USER> Fase actual: Autorización de despegue
Intent esperado: tower_position_report
Transcripción textual del alumno:
a posición y manteniendo pista 10 Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_takeoff_clearance

Checklist alumno:
- Colacionar 'AUTORIZADO DESPEGAR'.
- Colacionar pista asignada.
- Colacionar restricciones (rumbo, altitud, reportes).
- NO colacionar viento ni estado de la pista.

Checklist controlador:
- Dar viento (ver...
2025-12-02 19:56:55,685 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_position_report intento=1: {
  "intent": "tower_position_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, viento 280 grados 5 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.",
  "feedback": "Reporte de posición correcto. Ahora se procede a dar autorización de despegue incluyendo viento, pista, instrucciones de rumbo y reporte de altitud. Se mantiene la secuencia lógica y se cumplen todos los requisitos de la fase.",
  "confidence": 0.95,...
2025-12-02 19:56:55,687 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=tower_takeoff_clearance a=tower_initial_climb
2025-12-02 19:56:55,849 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:56:55,850 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:56:55,851 | INFO | sqlalchemy.engine.Engine | [cached since 629.8s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:56:55,876 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:56:55,876 | INFO | sqlalchemy.engine.Engine | [cached since 509.8s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (24373 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 56, 55, 876212, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:56:55,900 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:56:55,937 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:56:55,938 | INFO | sqlalchemy.engine.Engine | [cached since 496.2s ago] (UUID('2d38432d-feed-471b-80db-88ba30515941'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'tower_initial_climb', 90.0, 'Reporte de posición correcto. Ahora se procede a dar autorización de despegue incluyendo viento, pista, instrucciones de rumbo y reporte de altitud. Se mantiene la secuencia lógica y se cumplen todos los requisitos de la fase.')
2025-12-02 19:56:55,953 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:56:55,991 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_initial_climb score=90.00
2025-12-02 19:56:55,992 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | intent=tower_position_report | phase=tower_initial_climb | allow_response=True | text=Alfa Noviembre India, viento 280 grados 5 nudos, autorizado despegar pista uno cero. Mantenga rumbo de pista y notifique pasando cinco mil pies.
2025-12-02 19:57:46,519 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:57:46,520 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 19:57:46,521 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 19:57:46,522 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:57:46,523 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 19:57:46,525 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 19:57:46,527 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:57:46,528 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:57:46,528 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 19:57:46,529 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:57:46,530 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:57:46,531 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 19:57:46,532 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 19:57:46,534 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:57:46,535 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 19:57:46,536 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 19:57:46,537 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:57:46,538 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:57:46,540 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 19:57:46,541 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:57:46,543 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 19:57:46,544 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 19:57:46,546 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 19:57:46,546 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:57:46,547 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 19:57:46,549 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 19:57:46,551 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:57:46,552 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 19:57:46,552 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 19:57:46,553 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 19:57:46,554 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 19:57:46,556 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 19:57:46,557 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:57:46,719 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:46,720 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:46,722 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:46,724 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:57:46,888 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:46,892 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:46,894 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 19:57:47,071 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:47,073 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:47,077 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:47,326 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:57:47,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:47,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:47,602 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:47,605 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:47,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:47,859 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:47,862 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:57:48,174 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:48,177 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:48,181 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:48,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:48,370 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:48,372 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:48,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:48,596 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:48,598 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:48,807 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:48,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:48,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:57:48,813 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 19:57:48,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:48,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:48,985 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:48,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 19:57:49,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 19:57:49,166 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:49,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:49,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:49,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:49,537 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:49,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:49,541 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:49,759 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 19:57:49,762 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:49,766 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 19:57:49,863 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 19:57:49,864 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1852]
2025-12-02 19:57:49,865 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 19:57:49,865 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 19:57:50,034 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:57:50,035 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 19:57:50,036 | INFO | sqlalchemy.engine.Engine | [cached since 828.3s ago] ()
2025-12-02 19:57:50,045 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 19:57:50,046 | INFO | sqlalchemy.engine.Engine | [cached since 699.4s ago] (1,)
2025-12-02 19:57:50,995 | INFO | app.services.transcribe | Starting stream. Total bytes: 960512. Chunk size: 8192. No throttling.
2025-12-02 19:57:50,998 | DEBUG | app.services.transcribe | Streamed 8192/960512 bytes
2025-12-02 19:57:51,049 | DEBUG | app.services.transcribe | Streamed 417792/960512 bytes
2025-12-02 19:57:51,092 | DEBUG | app.services.transcribe | Streamed 827392/960512 bytes
2025-12-02 19:57:51,112 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 19:57:52,996 | DEBUG | app.services.transcribe | Received transcript chunk: autorizado a despega...
2025-12-02 19:57:56,430 | DEBUG | app.services.transcribe | Received transcript chunk: mantengo el rumbo de...
2025-12-02 19:57:56,535 | INFO | app.services.transcribe | Transcription complete. Length: 110
2025-12-02 19:57:56,535 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: autorizado a despegar pista 10. mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.
2025-12-02 19:57:56,537 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | text=autorizado a despegar pista 10. mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.
2025-12-02 19:57:56,671 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:57:56,673 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:57:56,674 | INFO | sqlalchemy.engine.Engine | [cached since 690.6s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:57:56,698 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 19:57:57,638 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:57:57,642 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:57:57,644 | INFO | sqlalchemy.engine.Engine | [cached since 691.6s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:57:57,682 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:57:57,683 | INFO | sqlalchemy.engine.Engine | [cached since 571.6s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (24896 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 19, 57, 57, 681768, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:57:57,709 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:57:57,768 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=tower_initial_climb intent=tower_takeoff_clearance freq=tower
2025-12-02 19:57:57,772 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_takeoff_clearance freq_group=tower
SYSTEM> Ya en ascenso; al reportar 5000 pies instruyes cambio a COCO Aproximación. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe ser ...
USER> Fase actual: Reporte pasando 5000 y transferencia a Aproximación
Intent esperado: tower_takeoff_clearance
Transcripción textual del alumno:
autorizado a despegar pista 10. mantengo el rumbo de pista. Reportaré pasando 5000 pies Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_initial_climb

Checklist alumno:
- Reportar pasando 5000 pies.
- NO decir: 'Coco Aproximación' todavía (sigues con Torre).

Checklist controlador:
- Agradecer re...
2025-12-02 19:58:09,204 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_takeoff_clearance intento=1: {
  "intent": "tower_departure_handoff",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, recibido. Contacte COCO Aproximación 120.5. Buen día.",
  "feedback": "El reporte de altitud y la colación de instrucciones fueron correctos. Se detectó un intento de 'tower_takeoff_clearance' en lugar de 'tower_departure_handoff', pero la transmisión cumple con los requisitos de la fase actual. Se procede con transferencia a Aproximación.",
  "confidence": 0.92,
  "score": 85,
  "meta...
2025-12-02 19:58:09,207 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (tower_departure_handoff) difiere del esperado (tower_takeoff_clearance)
2025-12-02 19:58:09,209 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=tower_initial_climb a=approach_contact
2025-12-02 19:58:09,358 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 19:58:09,358 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 19:58:09,360 | INFO | sqlalchemy.engine.Engine | [cached since 703.3s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 19:58:09,390 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 19:58:09,391 | INFO | sqlalchemy.engine.Engine | [cached since 583.3s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (26920 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 19, 58, 9, 390694, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 19:58:09,429 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:58:09,457 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 19:58:09,459 | INFO | sqlalchemy.engine.Engine | [cached since 569.7s ago] (UUID('aaba0b58-6723-4b12-99a2-2ad372e1afb8'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'approach_contact', 85.0, "El reporte de altitud y la colación de instrucciones fueron correctos. Se detectó un intento de 'tower_takeoff_clearance' en lugar de 'tower_departure_handoff', pero la transmisión cumple con los requisitos de la fase actual. Se procede con transferencia a Aproximación.")
2025-12-02 19:58:09,490 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 19:58:09,524 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=approach_contact score=85.00
2025-12-02 19:58:09,527 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=118.300 | intent=tower_departure_handoff | phase=approach_contact | allow_response=True | text=Alfa Noviembre India, recibido. Contacte COCO Aproximación 120.5. Buen día.
2025-12-02 20:02:15,483 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:02:15,484 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:02:15,485 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:02:15,486 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:02:15,488 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:02:15,489 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:02:15,489 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:02:15,490 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:02:15,491 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:02:15,493 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:02:15,493 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:02:15,494 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:02:15,495 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:02:15,497 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:02:15,498 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:02:15,498 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:02:15,499 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:02:15,500 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:02:15,501 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:02:15,501 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:02:15,502 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:02:15,503 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:02:15,504 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:02:15,505 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:02:15,506 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:02:15,507 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:02:15,507 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:02:15,509 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:02:15,509 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:02:15,510 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:02:15,511 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:02:15,512 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 20:02:15,514 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:15,517 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:02:15,658 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:15,660 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:15,662 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:15,664 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:02:15,813 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:15,815 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:15,817 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:15,819 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:02:15,974 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:15,975 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:15,977 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:15,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:02:16,141 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:16,142 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:16,144 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:16,146 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:02:16,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:16,312 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:16,314 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:02:16,479 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:16,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 20:02:16,481 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:02:16,649 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:16,651 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:16,653 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:02:16,797 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:16,799 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:16,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:02:16,947 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:16,949 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:16,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:02:17,090 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:17,092 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:02:17,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:02:17,248 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:17,249 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 20:02:17,252 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:02:17,527 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:17,528 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:17,531 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:17,534 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:02:17,806 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:17,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:02:18,116 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:02:18,118 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:02:18,262 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:02:18,264 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:02:18,267 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:450]
2025-12-02 20:02:18,268 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:02:18,269 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:02:18,433 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:02:18,434 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:02:18,436 | INFO | sqlalchemy.engine.Engine | [cached since 1097s ago] ()
2025-12-02 20:02:18,446 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:02:18,447 | INFO | sqlalchemy.engine.Engine | [cached since 967.8s ago] (1,)
2025-12-02 20:02:19,425 | INFO | app.services.transcribe | Starting stream. Total bytes: 911360. Chunk size: 8192. No throttling.
2025-12-02 20:02:19,427 | DEBUG | app.services.transcribe | Streamed 8192/911360 bytes
2025-12-02 20:02:19,468 | DEBUG | app.services.transcribe | Streamed 417792/911360 bytes
2025-12-02 20:02:19,502 | DEBUG | app.services.transcribe | Streamed 827392/911360 bytes
2025-12-02 20:02:19,522 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:02:23,226 | DEBUG | app.services.transcribe | Received transcript chunk: coco aproximación Al...
2025-12-02 20:02:23,954 | DEBUG | app.services.transcribe | Received transcript chunk: rumbo a zona Eco....
2025-12-02 20:02:24,038 | INFO | app.services.transcribe | Transcription complete. Length: 92
2025-12-02 20:02:24,039 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: coco aproximación Alfa Noviembre India pasando 5000 pies ascendiendo a 7. rumbo a zona Eco.
2025-12-02 20:02:24,039 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=120.500 | text=coco aproximación Alfa Noviembre India pasando 5000 pies ascendiendo a 7. rumbo a zona Eco.
2025-12-02 20:02:24,198 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:02:24,199 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:02:24,200 | INFO | sqlalchemy.engine.Engine | [cached since 958.1s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:02:24,221 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:02:28,141 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:02:28,144 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:02:28,148 | INFO | sqlalchemy.engine.Engine | [cached since 962.1s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:02:28,176 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:02:28,178 | INFO | sqlalchemy.engine.Engine | [cached since 842.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (27429 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 20, 2, 28, 175044, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 20:02:28,201 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:02:28,272 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=approach_contact intent=approach_position_report freq=approach
2025-12-02 20:02:28,275 | INFO | app.services.audio_pipeline | Prompts generados intent=approach_position_report freq_group=approach
SYSTEM> Eres COCO Aproximación (120.5). Responde: '[Matrícula], Coco Aproximación, contacto radar. Continúe ascenso nivel siete mil pies. QNH 1017. Reporte ingresando Zona ECO.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence...
USER> Fase actual: Contacto inicial con COCO Aproximación
Intent esperado: approach_position_report
Transcripción textual del alumno:
coco aproximación Alfa Noviembre India pasando 5000 pies ascendiendo a 7. rumbo a zona Eco.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: approach
- Fase ID: approach_contact

Checklist alumno:
- Saludo inicial a COCO Aproximación.
- Reportar altitud actual.
- Reportar altitud asignada/ascenso.
- Reportar rumbo o destino.

Checklist controlador:
- De...
2025-12-02 20:02:38,980 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=approach_position_report intento=1: {
  "intent": "approach_position_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Coco Aproximación, contacto radar. Continúe ascenso nivel siete mil pies. QNH 1017. Reporte ingresando Zona ECO.",
  "feedback": "Reporte inicial correcto con altitud y rumbo. Falta mencionar 'nivel siete mil pies' en el ascenso, pero se entiende la intención. Se mantiene allowResponse=true ya que la información crítica está presente.",
  "confidence": 0.92,
  "score": 85,
  "metadata...
2025-12-02 20:02:38,981 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=approach_contact a=approach_readback
2025-12-02 20:02:39,132 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:02:39,133 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:02:39,134 | INFO | sqlalchemy.engine.Engine | [cached since 973s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:02:39,156 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:02:39,157 | INFO | sqlalchemy.engine.Engine | [cached since 853.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (29056 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 20, 2, 39, 156772, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 20:02:39,181 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:02:39,217 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:02:39,219 | INFO | sqlalchemy.engine.Engine | [cached since 839.4s ago] (UUID('dff752f3-633d-4113-997c-1740d08e2d8c'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'approach_readback', 85.0, "Reporte inicial correcto con altitud y rumbo. Falta mencionar 'nivel siete mil pies' en el ascenso, pero se entiende la intención. Se mantiene allowResponse=true ya que la información crítica está presente.")
2025-12-02 20:02:39,234 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:02:39,278 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=approach_readback score=85.00
2025-12-02 20:02:39,279 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=120.500 | intent=approach_position_report | phase=approach_readback | allow_response=True | text=Alfa Noviembre India, Coco Aproximación, contacto radar. Continúe ascenso nivel siete mil pies. QNH 1017. Reporte ingresando Zona ECO.
2025-12-02 20:04:08,995 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:04:08,997 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:04:08,998 | INFO | sqlalchemy.engine.Engine | [cached since 1207s ago] ()
2025-12-02 20:04:09,000 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:04:09,001 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:04:09,002 | INFO | sqlalchemy.engine.Engine | [cached since 1207s ago] ()
2025-12-02 20:04:09,010 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,010 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,014 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,016 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,022 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:04:09,024 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:04:09,025 | INFO | sqlalchemy.engine.Engine | [cached since 1207s ago] ()
2025-12-02 20:04:09,034 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,034 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,069 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:04:09,070 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:04:09,072 | INFO | sqlalchemy.engine.Engine | [cached since 1207s ago] ()
2025-12-02 20:04:09,083 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,083 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,128 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,129 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,131 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,133 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,136 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,138 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,142 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:04:09,143 | INFO | sqlalchemy.engine.Engine | [cached since 1075s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 20:04:09,147 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 20:04:09,147 | INFO | sqlalchemy.engine.Engine | [cached since 1075s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 20:04:09,150 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:04:09,152 | INFO | sqlalchemy.engine.Engine | [cached since 1075s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 20:04:09,174 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:04:09,178 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:04:09,179 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:04:09,182 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:09,183 | INFO | sqlalchemy.engine.Engine | [cached since 1078s ago] (1,)
2025-12-02 20:04:09,189 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 20:04:09,190 | INFO | sqlalchemy.engine.Engine | [cached since 1075s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 20:04:09,222 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:04:10,827 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:04:10,829 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:04:10,830 | INFO | sqlalchemy.engine.Engine | [cached since 1209s ago] ()
2025-12-02 20:04:10,843 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:10,844 | INFO | sqlalchemy.engine.Engine | [cached since 1080s ago] (1,)
2025-12-02 20:04:10,946 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:04:10,947 | INFO | sqlalchemy.engine.Engine | [cached since 1065s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:04:10,963 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:04:10,964 | INFO | sqlalchemy.engine.Engine | [cached since 1080s ago] (1,)
2025-12-02 20:04:10,968 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:06:19,537 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:06:19,537 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:06:19,539 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:06:19,540 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:06:19,542 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:06:19,543 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:06:19,544 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:06:19,544 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:06:19,547 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:06:19,548 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:06:19,549 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:06:19,551 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:06:19,551 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:06:19,554 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:06:19,556 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:06:19,557 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:06:19,558 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:06:19,559 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:06:19,560 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:06:19,561 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:06:19,563 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:06:19,564 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:06:19,565 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:06:19,566 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:06:19,566 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:06:19,567 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:06:19,569 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:06:19,570 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:06:19,571 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:06:19,573 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:06:19,575 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:06:19,584 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-02 20:06:19,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:19,765 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:19,766 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:19,768 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:19,915 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:19,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:19,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:20,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:06:20,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:20,219 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:20,222 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 20:06:20,226 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:06:20,374 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:20,375 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:20,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:20,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:20,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-02 20:06:20,661 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:20,662 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:20,665 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:20,826 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:20,828 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 20:06:20,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:06:21,009 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:06:21,010 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:06:21,157 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,158 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:21,161 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:21,291 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:21,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:06:21,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:06:21,417 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:21,536 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,537 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:21,539 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:21,664 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,666 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:21,668 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:21,790 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,792 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:06:21,795 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:06:21,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:06:21,858 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:933]
2025-12-02 20:06:21,859 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:06:21,861 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:06:21,989 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:06:21,990 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:06:21,991 | INFO | sqlalchemy.engine.Engine | [cached since 1340s ago] ()
2025-12-02 20:06:22,002 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:06:22,003 | INFO | sqlalchemy.engine.Engine | [cached since 1211s ago] (1,)
2025-12-02 20:06:23,012 | INFO | app.services.transcribe | Starting stream. Total bytes: 964608. Chunk size: 8192. No throttling.
2025-12-02 20:06:23,015 | DEBUG | app.services.transcribe | Streamed 8192/964608 bytes
2025-12-02 20:06:23,056 | DEBUG | app.services.transcribe | Streamed 417792/964608 bytes
2025-12-02 20:06:23,092 | DEBUG | app.services.transcribe | Streamed 827392/964608 bytes
2025-12-02 20:06:23,108 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:06:27,943 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017. Continuamo...
2025-12-02 20:06:28,039 | INFO | app.services.transcribe | Transcription complete. Length: 98
2025-12-02 20:06:28,040 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: QNH 1017. Continuamos ascenso a 7000 pies. Reportaremos ingreso a zona eco Alfa Noviembre, India.
2025-12-02 20:06:28,041 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=120.500 | text=QNH 1017. Continuamos ascenso a 7000 pies. Reportaremos ingreso a zona eco Alfa Noviembre, India.
2025-12-02 20:06:28,357 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:06:28,359 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:06:28,360 | INFO | sqlalchemy.engine.Engine | [cached since 1202s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:06:28,385 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:06:34,326 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:06:34,328 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:06:34,329 | INFO | sqlalchemy.engine.Engine | [cached since 1208s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:06:34,362 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:06:34,365 | INFO | sqlalchemy.engine.Engine | [cached since 1088s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (29559 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 20, 6, 34, 360810, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 20:06:34,382 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:06:34,426 | INFO | app.controllers.audio | Intent detector frequency mismatch session=65805fb8-94b1-40aa-93df-b424ee7c4528 detected=radar scenario=approach
2025-12-02 20:06:34,428 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=approach_readback intent=radar_altitude_report freq=approach
2025-12-02 20:06:34,433 | INFO | app.services.audio_pipeline | Prompts generados intent=radar_altitude_report freq_group=approach
SYSTEM> Validas la colación del alumno tras las instrucciones radar. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe ser un número de 0...
USER> Fase actual: Readback de COCO Aproximación
Intent esperado: radar_altitude_report
Transcripción textual del alumno:
QNH 1017. Continuamos ascenso a 7000 pies. Reportaremos ingreso a zona eco Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: approach
- Fase ID: approach_readback

Checklist alumno:
- Colacionar QNH.
- Colacionar nueva altitud asignada.
- Colacionar reportes solicitados.
- NO colacionar viento ni información general.

Checklist controlador:
- ...
2025-12-02 20:06:49,726 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=radar_altitude_report intento=1: {
  "intent": "radar_altitude_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Proceda.",
  "feedback": "La colación incluye QNH, altitud asignada y reporte solicitado. Aunque se repite 'Alfa Noviembre India' al final, no afecta la comprensión. Se mantiene allowResponse=true por claridad en elementos críticos.",
  "confidence": 0.92,
  "score": 95,
  "metadata": {
    "nextPhase": "approach_zone_entry",
    "missingItems": [],
    "extraItems": [...
2025-12-02 20:06:49,728 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=approach_readback a=approach_zone_entry
2025-12-02 20:06:49,860 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:06:49,861 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:06:49,862 | INFO | sqlalchemy.engine.Engine | [cached since 1224s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:06:49,888 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:06:49,891 | INFO | sqlalchemy.engine.Engine | [cached since 1104s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (31324 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 20, 6, 49, 886306, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 20:06:49,918 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:06:49,972 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:06:49,974 | INFO | sqlalchemy.engine.Engine | [cached since 1090s ago] (UUID('752558f6-6a99-47b2-99fa-5017f24626db'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'approach_zone_entry', 95.0, "La colación incluye QNH, altitud asignada y reporte solicitado. Aunque se repite 'Alfa Noviembre India' al final, no afecta la comprensión. Se mantiene allowResponse=true por claridad en elementos críticos.")
2025-12-02 20:06:49,994 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:06:50,059 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=approach_zone_entry score=95.00
2025-12-02 20:06:50,061 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=120.500 | intent=radar_altitude_report | phase=approach_zone_entry | allow_response=True | text=Alfa Noviembre India, colación correcta. Proceda.
2025-12-02 20:07:14,644 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:07:14,646 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:07:14,646 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:07:14,647 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:07:14,647 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:07:14,648 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:07:14,649 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:07:14,649 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:07:14,650 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:07:14,650 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:07:14,651 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:07:14,652 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:07:14,654 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:07:14,656 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:07:14,658 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:07:14,659 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:07:14,660 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:07:14,662 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:07:14,662 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:07:14,664 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:07:14,666 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:07:14,666 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:07:14,668 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:07:14,669 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:07:14,671 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:07:14,672 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:07:14,674 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:07:14,675 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:07:14,677 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 20:07:14,677 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:07:14,678 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:07:14,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:5840]
2025-12-02 20:07:14,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:07:14,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:14,812 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:14,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:07:14,961 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:14,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:14,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:14,968 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:07:15,118 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:15,120 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:15,122 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:15,125 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:07:15,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:07:15,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:15,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:07:15,430 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:07:15,432 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:15,436 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:07:15,577 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:15,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-02 20:07:15,704 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:15,707 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:15,708 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:07:15,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:15,834 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:15,835 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:07:15,957 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:15,958 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:15,959 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:07:16,086 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:16,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:16,090 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:07:16,213 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:07:16,215 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:07:16,216 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2591]
2025-12-02 20:07:16,217 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:07:16,219 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:07:16,391 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:07:16,392 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:07:16,393 | INFO | sqlalchemy.engine.Engine | [cached since 1395s ago] ()
2025-12-02 20:07:16,401 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:07:16,403 | INFO | sqlalchemy.engine.Engine | [cached since 1266s ago] (1,)
2025-12-02 20:07:16,860 | INFO | app.services.transcribe | Starting stream. Total bytes: 686080. Chunk size: 8192. No throttling.
2025-12-02 20:07:16,863 | DEBUG | app.services.transcribe | Streamed 8192/686080 bytes
2025-12-02 20:07:16,896 | DEBUG | app.services.transcribe | Streamed 417792/686080 bytes
2025-12-02 20:07:16,919 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:07:19,655 | DEBUG | app.services.transcribe | Received transcript chunk: coco aproximación al...
2025-12-02 20:07:20,443 | DEBUG | app.services.transcribe | Received transcript chunk: nivel 7000 pies....
2025-12-02 20:07:20,490 | INFO | app.services.transcribe | Transcription complete. Length: 81
2025-12-02 20:07:20,491 | INFO | app.controllers.audio | Transcripción recibida session=65805fb8-94b1-40aa-93df-b424ee7c4528: coco aproximación alfa noviembre, India, ingresando a zona Eco. nivel 7000 pies.
2025-12-02 20:07:20,493 | INFO | app.logs.transcript | student | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=120.500 | text=coco aproximación alfa noviembre, India, ingresando a zona Eco. nivel 7000 pies.
2025-12-02 20:07:20,617 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:07:20,618 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:07:20,619 | INFO | sqlalchemy.engine.Engine | [cached since 1255s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:07:20,642 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:07:23,054 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:07:23,055 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:07:23,057 | INFO | sqlalchemy.engine.Engine | [cached since 1257s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:07:23,080 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:07:23,081 | INFO | sqlalchemy.engine.Engine | [cached since 1137s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (31822 characters truncated) ... .0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": false, "default_frequency_group": "approach"}', datetime.datetime(2025, 12, 2, 20, 7, 23, 79785, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 20:07:23,097 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:07:23,135 | INFO | app.controllers.audio | Fase activa session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=approach_zone_entry intent=approach_position_report freq=approach
2025-12-02 20:07:23,138 | INFO | app.services.audio_pipeline | Prompts generados intent=approach_position_report freq_group=approach
SYSTEM> El alumno reporta 7000 pies ingresando Zona ECO. Responde: '[Matrícula], recibido. Contacte Coco Radio uno dos seis punto ocho.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | nul...
USER> Fase actual: Reporte ingresando Zona ECO
Intent esperado: approach_position_report
Transcripción textual del alumno:
coco aproximación alfa noviembre, India, ingresando a zona Eco. nivel 7000 pies.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: approach
- Fase ID: approach_zone_entry

Checklist alumno:
- Confirmar altitud y entrada a la zona.

Checklist controlador:
- Acusar recibo.
- Asignar contacto con COCO Radio 126.8.

Cuándo responder:
- Responde siempre con handoff clar...
2025-12-02 20:07:33,179 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=approach_position_report intento=1: {
  "intent": "approach_position_report",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, recibido. Contacte Coco Radio uno dos seis punto ocho.",
  "feedback": "Reporte completo con altitud y entrada a Zona ECO. La fraseología cumple los estándares requeridos. Se procede con transferencia a COCO Radio.",
  "confidence": 0.98,
  "score": 95,
  "metadata": {
    "nextPhase": "radio_check_in",
    "elementsPresent": [
      "altitud",
      "zona ECO"
    ],
    "missingElem...
2025-12-02 20:07:33,180 | INFO | app.controllers.audio | Transición automática de fase session=65805fb8-94b1-40aa-93df-b424ee7c4528 de=approach_zone_entry a=radio_check_in
2025-12-02 20:07:33,300 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:07:33,301 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:07:33,302 | INFO | sqlalchemy.engine.Engine | [cached since 1267s ago] (UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'),)
2025-12-02 20:07:33,320 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:07:33,320 | INFO | sqlalchemy.engine.Engine | [cached since 1147s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "280/5", "cloudBase": "800", "condition": "VMC", "windSpeed": "5", "clo ... (33124 characters truncated) ... "122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0586", "session_completed": true, "default_frequency_group": "radio"}', datetime.datetime(2025, 12, 2, 20, 7, 33, 319728, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('fdd09fc8-747d-48d4-b0ee-9c808701c793'))
2025-12-02 20:07:33,334 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:07:33,350 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:07:33,351 | INFO | sqlalchemy.engine.Engine | [cached since 1134s ago] (UUID('e2df606c-1e7f-4d25-9978-01e92119f04f'), UUID('65805fb8-94b1-40aa-93df-b424ee7c4528'), 1, 'radio_check_in', 95.0, 'Reporte completo con altitud y entrada a Zona ECO. La fraseología cumple los estándares requeridos. Se procede con transferencia a COCO Radio.')
2025-12-02 20:07:33,373 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:07:33,405 | INFO | app.controllers.audio | Puntuación guardada session=65805fb8-94b1-40aa-93df-b424ee7c4528 phase_id=radio_check_in score=95.00
2025-12-02 20:07:33,406 | INFO | app.logs.transcript | controller | session=65805fb8-94b1-40aa-93df-b424ee7c4528 | frequency=120.500 | intent=approach_position_report | phase=radio_check_in | allow_response=True | text=Alfa Noviembre India, recibido. Contacte Coco Radio uno dos seis punto ocho.
2025-12-02 20:08:53,955 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:08:53,956 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:08:53,957 | INFO | sqlalchemy.engine.Engine | [cached since 1492s ago] ()
2025-12-02 20:08:53,970 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:08:53,971 | INFO | sqlalchemy.engine.Engine | [cached since 1363s ago] (1,)
2025-12-02 20:08:53,978 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:08:53,980 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:08:53,981 | INFO | sqlalchemy.engine.Engine | [cached since 1492s ago] ()
2025-12-02 20:08:53,995 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:08:53,998 | INFO | sqlalchemy.engine.Engine | [cached since 1363s ago] (1,)
2025-12-02 20:08:54,128 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:08:54,129 | INFO | sqlalchemy.engine.Engine | [cached since 1363s ago] (1,)
2025-12-02 20:08:54,132 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:08:54,133 | INFO | sqlalchemy.engine.Engine | [cached since 1363s ago] (1,)
2025-12-02 20:08:54,137 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:08:54,138 | INFO | sqlalchemy.engine.Engine | [cached since 1360s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 20:08:54,141 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 20:08:54,142 | INFO | sqlalchemy.engine.Engine | [cached since 1360s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 20:08:54,167 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:08:54,173 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:09:49,084 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:09:49,085 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:09:49,086 | INFO | sqlalchemy.engine.Engine | [cached since 1547s ago] ()
2025-12-02 20:09:49,098 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:09:49,100 | INFO | sqlalchemy.engine.Engine | [cached since 1418s ago] (1,)
2025-12-02 20:09:49,196 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:09:49,197 | INFO | sqlalchemy.engine.Engine | [cached since 1419s ago] (1,)
2025-12-02 20:09:49,201 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.phase_id = $1::VARCHAR AND ecowhiskey.phase_scores.user_id = $2::INTEGER ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:09:49,202 | INFO | sqlalchemy.engine.Engine | [generated in 0.00097s] ('ground_readback', 1)
2025-12-02 20:09:54,748 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:10:04,648 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:10:04,651 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:10:04,654 | INFO | sqlalchemy.engine.Engine | [cached since 1563s ago] ()
2025-12-02 20:10:04,667 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:10:04,669 | INFO | sqlalchemy.engine.Engine | [cached since 1434s ago] (1,)
2025-12-02 20:10:04,691 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:10:04,692 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:10:04,693 | INFO | sqlalchemy.engine.Engine | [cached since 1563s ago] ()
2025-12-02 20:10:04,702 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:10:04,702 | INFO | sqlalchemy.engine.Engine | [cached since 1434s ago] (1,)
2025-12-02 20:10:04,798 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:10:04,799 | INFO | sqlalchemy.engine.Engine | [cached since 1434s ago] (1,)
2025-12-02 20:10:04,804 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:10:04,806 | INFO | sqlalchemy.engine.Engine | [cached since 1434s ago] (1,)
2025-12-02 20:10:04,811 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:10:04,814 | INFO | sqlalchemy.engine.Engine | [cached since 1431s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 20:10:04,820 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 20:10:04,822 | INFO | sqlalchemy.engine.Engine | [cached since 1431s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 20:10:04,842 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:10:04,845 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:10:45,331 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 20:10:45,466 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000019AFD159690>
2025-12-02 20:10:45,468 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x0000019AFD3AECC0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 20:10:45,585 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000019AFF413990>
2025-12-02 20:10:45,586 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 20:10:45,589 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 20:10:45,592 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 20:10:45,593 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 20:10:45,594 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 20:10:46,176 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 02:10:46 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'509'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1fd-5JoV5ZbNziyzb705UUgOCNIEoCw"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T021046Z-1654ff75797l26tbhC1MIAnzyw00000009p000000000sk25'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-02 20:10:46,177 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 20:10:46,179 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 20:10:46,181 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 20:10:46,183 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 20:10:46,185 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 20:10:46,187 | DEBUG | httpcore.connection | close.started
2025-12-02 20:10:46,188 | DEBUG | httpcore.connection | close.complete
2025-12-02 20:10:48,950 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:10:48,951 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:10:48,952 | INFO | sqlalchemy.engine.Engine | [cached since 1607s ago] ()
2025-12-02 20:10:48,960 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:10:48,960 | INFO | sqlalchemy.engine.Engine | [cached since 1478s ago] (1,)
2025-12-02 20:10:49,066 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-02 20:10:49,068 | INFO | sqlalchemy.engine.Engine | [cached since 1152s ago] (UUID('be2d04e2-e37d-45df-8970-41df8049e727'), UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "290", "windSpeed": "3", "temp": "21", "dewp": "20", "cloudCover": "SCT", "cloudBase": "300", "wind": "290/3"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 2, 20, 10, 49, 66553, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 2, 20, 10, 49, 66553, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-02 20:10:49,079 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:10:49,250 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:10:49,252 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-02 20:10:49,254 | INFO | sqlalchemy.engine.Engine | [cached since 1152s ago] (UUID('be2d04e2-e37d-45df-8970-41df8049e727'),)
2025-12-02 20:10:49,277 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:11:23,631 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:11:23,632 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:11:23,633 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:11:23,633 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:11:23,634 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:11:23,634 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:11:23,635 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:11:23,636 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:11:23,636 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:11:23,637 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:11:23,637 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:11:23,638 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:11:23,639 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:11:23,641 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:11:23,642 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:11:23,643 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:11:23,643 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:11:23,644 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:11:23,645 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:11:23,646 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:11:23,646 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:11:23,646 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:11:23,648 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:11:23,648 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:11:23,649 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:11:23,650 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:11:23,651 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:11:23,651 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:11:23,652 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:11:23,653 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:11:23,654 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:11:23,655 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 20:11:23,660 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:11:23,799 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:23,802 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:23,804 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:11:23,924 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:11:23,925 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:24,054 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:24,056 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:24,058 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:24,193 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:11:24,195 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:24,344 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:24,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:24,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:24,489 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:11:24,492 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:24,493 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:11:24,624 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:24,626 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:24,629 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:24,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:11:24,760 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:24,761 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:24,763 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:24,894 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:24,896 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:24,898 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:25,021 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:25,022 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:25,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:25,027 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:11:25,177 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:25,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:25,180 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:25,182 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:11:25,309 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:25,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:25,313 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:25,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:11:25,460 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:25,614 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:25,616 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:25,619 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:25,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:25,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:25,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:25,874 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:25,877 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:11:25,881 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:11:25,998 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:26,000 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:26,003 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:26,124 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:11:26,126 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:26,130 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:11:26,251 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:26,253 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:26,255 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:26,257 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:11:26,375 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:26,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:26,379 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:26,496 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:26,497 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:26,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:26,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:11:26,634 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:26,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:26,784 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:26,786 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:26,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:26,915 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:26,916 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:27,041 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:27,042 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:27,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:11:27,172 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:27,175 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:27,176 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:27,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:11:27,285 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:27,288 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:11:27,289 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:11:27,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:915]
2025-12-02 20:11:27,294 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:11:27,294 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:11:27,446 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:11:27,447 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:11:27,449 | INFO | sqlalchemy.engine.Engine | [cached since 1646s ago] ()
2025-12-02 20:11:27,458 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:11:27,459 | INFO | sqlalchemy.engine.Engine | [cached since 1517s ago] (1,)
2025-12-02 20:11:28,629 | INFO | app.services.transcribe | Starting stream. Total bytes: 1619968. Chunk size: 8192. No throttling.
2025-12-02 20:11:28,632 | DEBUG | app.services.transcribe | Streamed 8192/1619968 bytes
2025-12-02 20:11:28,704 | DEBUG | app.services.transcribe | Streamed 417792/1619968 bytes
2025-12-02 20:11:28,743 | DEBUG | app.services.transcribe | Streamed 827392/1619968 bytes
2025-12-02 20:11:28,763 | DEBUG | app.services.transcribe | Streamed 1236992/1619968 bytes
2025-12-02 20:11:28,781 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:11:35,118 | DEBUG | app.services.transcribe | Received transcript chunk: a superficie alfa no...
2025-12-02 20:11:36,580 | DEBUG | app.services.transcribe | Received transcript chunk: dos almas a bordo, a...
2025-12-02 20:11:36,636 | INFO | app.services.transcribe | Transcription complete. Length: 185
2025-12-02 20:11:36,637 | INFO | app.controllers.audio | Transcripción recibida session=59afa6b9-8c5b-4933-9d2a-e60864635fad: a superficie alfa noviembre India en plataforma remota tres solicito apertura del plan de vuelo VFR hacia zona eco vía Pasogo nivel 7000 pies. dos almas a bordo, autonomía cinco horas.
2025-12-02 20:11:36,639 | INFO | app.logs.transcript | student | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | text=a superficie alfa noviembre India en plataforma remota tres solicito apertura del plan de vuelo VFR hacia zona eco vía Pasogo nivel 7000 pies. dos almas a bordo, autonomía cinco horas.
2025-12-02 20:11:36,780 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:11:36,781 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:11:36,782 | INFO | sqlalchemy.engine.Engine | [cached since 1511s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:11:36,800 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:11:37,701 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:11:37,701 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:11:37,703 | INFO | sqlalchemy.engine.Engine | [cached since 1512s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:11:37,722 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:11:37,723 | INFO | sqlalchemy.engine.Engine | [cached since 1392s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (14645 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-03T02:11:37Z"}]}', datetime.datetime(2025, 12, 2, 20, 11, 37, 721656, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:11:37,753 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:11:37,806 | INFO | app.controllers.audio | Fase activa session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-02 20:11:37,809 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0503. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": st...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
a superficie alfa noviembre India en plataforma remota tres solicito apertura del plan de vuelo VFR hacia zona eco vía Pasogo nivel 7000 pies. dos almas a bordo, autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar u...
2025-12-02 20:11:48,765 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0503. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron incluidos correctamente.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-12-02 20:11:48,767 | INFO | app.controllers.audio | Transición automática de fase session=59afa6b9-8c5b-4933-9d2a-e60864635fad de=ground_departure_request a=ground_readback
2025-12-02 20:11:48,923 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:11:48,924 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:11:48,926 | INFO | sqlalchemy.engine.Engine | [cached since 1523s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:11:48,950 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:11:48,951 | INFO | sqlalchemy.engine.Engine | [cached since 1403s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (15907 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 11, 48, 950080, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:11:48,968 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:11:49,001 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:11:49,002 | INFO | sqlalchemy.engine.Engine | [cached since 1389s ago] (UUID('cc195e75-55e9-4a46-8de9-a9e0f616bd0e'), UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'), 1, 'ground_readback', 95.0, 'Solicitud completa. Todos los elementos requeridos fueron incluidos correctamente.')
2025-12-02 20:11:49,019 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:11:49,050 | INFO | app.controllers.audio | Puntuación guardada session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback score=95.00
2025-12-02 20:11:49,050 | INFO | app.logs.transcript | controller | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0503. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.
2025-12-02 20:12:34,160 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:12:34,161 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:12:34,162 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:12:34,163 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:12:34,164 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:12:34,165 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:12:34,167 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:12:34,167 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:12:34,168 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:12:34,170 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:12:34,171 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:12:34,171 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:12:34,172 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:12:34,173 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:12:34,173 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:12:34,175 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:12:34,176 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:12:34,176 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:12:34,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:12:34,179 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:12:34,181 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:12:34,182 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:12:34,182 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:12:34,183 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:12:34,185 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:12:34,185 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:12:34,186 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:12:34,189 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:12:34,190 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:12:34,191 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:12:34,192 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:12:34,193 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 20:12:34,195 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:12:34,327 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:34,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:34,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:34,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:12:34,467 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:34,470 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:34,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:34,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:34,601 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:34,606 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:34,738 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:34,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:34,745 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:34,882 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:12:34,883 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:34,884 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:12:35,046 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:35,049 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:35,051 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:35,225 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:35,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:35,231 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:35,233 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:12:35,379 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:35,381 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:35,385 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:35,543 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:35,545 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:35,547 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:35,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:35,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:35,695 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:35,840 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:12:35,842 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:35,991 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:35,993 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:35,996 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:36,136 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,138 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:36,142 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:36,325 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:36,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:36,336 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:12:36,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,504 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:36,506 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,510 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:12:36,645 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,647 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,649 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:12:36,784 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:36,785 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,788 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:36,930 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:12:36,934 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:36,938 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:12:37,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,072 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:37,074 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,075 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:12:37,212 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,215 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:37,216 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,218 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:12:37,359 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,362 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:37,363 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:37,534 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,535 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:37,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,540 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:12:37,697 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,698 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:37,701 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:12:37,810 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:12:37,813 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:12:37,815 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1568]
2025-12-02 20:12:37,816 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:12:37,818 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:12:38,059 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:12:38,064 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:12:38,067 | INFO | sqlalchemy.engine.Engine | [cached since 1716s ago] ()
2025-12-02 20:12:38,082 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:12:38,084 | INFO | sqlalchemy.engine.Engine | [cached since 1587s ago] (1,)
2025-12-02 20:12:39,194 | INFO | app.services.transcribe | Starting stream. Total bytes: 1435648. Chunk size: 8192. No throttling.
2025-12-02 20:12:39,196 | DEBUG | app.services.transcribe | Streamed 8192/1435648 bytes
2025-12-02 20:12:39,227 | DEBUG | app.services.transcribe | Streamed 417792/1435648 bytes
2025-12-02 20:12:39,251 | DEBUG | app.services.transcribe | Streamed 827392/1435648 bytes
2025-12-02 20:12:39,272 | DEBUG | app.services.transcribe | Streamed 1236992/1435648 bytes
2025-12-02 20:12:39,280 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:12:42,006 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017 transponder...
2025-12-02 20:12:45,148 | DEBUG | app.services.transcribe | Received transcript chunk: rodaremos vía Alfa t...
2025-12-02 20:12:45,849 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-02 20:12:45,898 | INFO | app.services.transcribe | Transcription complete. Length: 100
2025-12-02 20:12:45,899 | INFO | app.controllers.audio | Transcripción recibida session=59afa6b9-8c5b-4933-9d2a-e60864635fad: QNH 1017 transponder 0503. rodaremos vía Alfa tres Alpha al.de espera pista. Alfa Noviembre, India.
2025-12-02 20:12:45,900 | INFO | app.logs.transcript | student | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | text=QNH 1017 transponder 0503. rodaremos vía Alfa tres Alpha al.de espera pista. Alfa Noviembre, India.
2025-12-02 20:12:46,066 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:12:46,067 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:12:46,069 | INFO | sqlalchemy.engine.Engine | [cached since 1580s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:12:46,090 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:12:48,746 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:12:48,746 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:12:48,747 | INFO | sqlalchemy.engine.Engine | [cached since 1583s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:12:48,770 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:12:48,771 | INFO | sqlalchemy.engine.Engine | [cached since 1463s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (16422 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 12, 48, 770416, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:12:48,784 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:12:48,813 | INFO | app.controllers.audio | Fase activa session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 20:12:48,815 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH 1017 transponder 0503. rodaremos vía Alfa tres Alpha al.de espera pista. Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colac...
2025-12-02 20:13:01,327 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Falta mencionar la pista asignada (uno cero) y la instrucción de espera ('punto de espera'). Corrija: '...al punto de espera pista uno cero'.",
  "confidence": 0.85,
  "score": 60,
  "metadata": {
    "missingItems": [
      "Pista asignada (uno cero)",
      "Instrucción de espera ('punto de espera')"
    ]
  }
}
2025-12-02 20:13:01,328 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-02 20:13:01,456 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:13:01,457 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:13:01,458 | INFO | sqlalchemy.engine.Engine | [cached since 1595s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:13:01,477 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:13:01,478 | INFO | sqlalchemy.engine.Engine | [cached since 1475s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (17546 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 13, 1, 476810, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:13:01,496 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:13:01,534 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:13:01,536 | INFO | sqlalchemy.engine.Engine | [cached since 1462s ago] (UUID('eee43552-0c20-4abb-a9ea-e15505510a64'), UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'), 1, 'ground_readback', 60.0, "Falta mencionar la pista asignada (uno cero) y la instrucción de espera ('punto de espera'). Corrija: '...al punto de espera pista uno cero'.")
2025-12-02 20:13:01,553 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:13:01,589 | INFO | app.controllers.audio | Puntuación guardada session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback score=60.00
2025-12-02 20:13:01,591 | INFO | app.logs.transcript | controller | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | intent=ground_taxi_readback | phase=ground_readback | allow_response=False | text=
2025-12-02 20:14:10,544 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:14:10,544 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:14:10,546 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:14:10,547 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:14:10,548 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:14:10,548 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:14:10,549 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:14:10,550 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:14:10,551 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:14:10,552 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:14:10,553 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:14:10,554 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:14:10,556 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:14:10,557 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:14:10,559 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:14:10,559 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:14:10,561 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:14:10,563 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:14:10,564 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:14:10,565 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:14:10,566 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:14:10,567 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:14:10,568 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:14:10,569 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:14:10,570 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:14:10,571 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:14:10,573 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:14:10,588 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:14:10,590 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:14:10,593 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:14:10,594 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:14:10,595 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-02 20:14:10,597 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:10,601 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:14:10,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:10,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:10,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:10,758 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:14:10,933 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:10,936 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:10,938 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:11,083 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:11,085 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 20:14:11,087 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:14:11,221 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,223 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:11,224 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,227 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:14:11,354 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,356 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:11,357 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,360 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:14:11,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,496 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:14:11,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,631 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:11,632 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:11,773 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,777 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:14:11,914 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:11,916 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:11,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:12,061 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:14:12,063 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:12,065 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:14:12,201 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:12,203 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:12,206 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:12,334 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:12,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:12,338 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:12,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:12,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:12,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:12,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:12,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:12,590 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:12,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:12,716 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:12,717 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:12,844 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:14:12,847 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:12,848 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:14:13,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:13,015 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:13,016 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:13,172 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:14:13,175 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:13,178 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:14:13,318 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:13,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:13,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:13,450 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:13,451 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:13,452 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:13,578 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:14:13,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:14:13,678 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:14:13,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:14:13,681 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2090]
2025-12-02 20:14:13,682 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:14:13,682 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:14:13,824 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:14:13,825 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:14:13,826 | INFO | sqlalchemy.engine.Engine | [cached since 1812s ago] ()
2025-12-02 20:14:13,834 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:14:13,836 | INFO | sqlalchemy.engine.Engine | [cached since 1683s ago] (1,)
2025-12-02 20:14:14,802 | INFO | app.services.transcribe | Starting stream. Total bytes: 1320960. Chunk size: 8192. No throttling.
2025-12-02 20:14:14,807 | DEBUG | app.services.transcribe | Streamed 8192/1320960 bytes
2025-12-02 20:14:14,858 | DEBUG | app.services.transcribe | Streamed 417792/1320960 bytes
2025-12-02 20:14:14,885 | DEBUG | app.services.transcribe | Streamed 827392/1320960 bytes
2025-12-02 20:14:14,916 | DEBUG | app.services.transcribe | Streamed 1236992/1320960 bytes
2025-12-02 20:14:14,919 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:14:15,859 | DEBUG | app.services.transcribe | Received transcript chunk: QNH....
2025-12-02 20:14:17,676 | DEBUG | app.services.transcribe | Received transcript chunk: 1017 transponder 050...
2025-12-02 20:14:20,306 | DEBUG | app.services.transcribe | Received transcript chunk: rodaremos vía Alfa t...
2025-12-02 20:14:20,378 | INFO | app.services.transcribe | Transcription complete. Length: 96
2025-12-02 20:14:20,380 | INFO | app.controllers.audio | Transcripción recibida session=59afa6b9-8c5b-4933-9d2a-e60864635fad: QNH. 1017 transponder 0503. rodaremos vía Alfa tres Alpha al.de espera 10 Alfa Noviembre India.
2025-12-02 20:14:20,380 | INFO | app.logs.transcript | student | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | text=QNH. 1017 transponder 0503. rodaremos vía Alfa tres Alpha al.de espera 10 Alfa Noviembre India.
2025-12-02 20:14:20,549 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:14:20,549 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:14:20,551 | INFO | sqlalchemy.engine.Engine | [cached since 1674s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:14:20,580 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:14:25,058 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:14:25,060 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:14:25,062 | INFO | sqlalchemy.engine.Engine | [cached since 1679s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:14:25,087 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:14:25,088 | INFO | sqlalchemy.engine.Engine | [cached since 1559s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (18057 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 14, 25, 86285, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:14:25,110 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:14:25,151 | INFO | app.controllers.audio | Fase activa session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 20:14:25,154 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH. 1017 transponder 0503. rodaremos vía Alfa tres Alpha al.de espera 10 Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colaciona...
2025-12-02 20:14:35,170 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persiste el error en la pista asignada ('10' en lugar de 'uno cero') y la instrucción de espera sigue incompleta. Corrija: '...al punto de espera pista uno cero'.",
  "confidence": 0.85,
  "score": 60,
  "metadata": {
    "missingItems": [
      "Pista asignada correcta (uno cero)",
      "Instrucción completa de espera ('punto de espera pista uno cero')"
    ],
    "nextPhase": null
  }
}
2025-12-02 20:14:35,172 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-02 20:14:35,303 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:14:35,306 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:14:35,306 | INFO | sqlalchemy.engine.Engine | [cached since 1689s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:14:35,323 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:14:35,323 | INFO | sqlalchemy.engine.Engine | [cached since 1569s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (19341 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 14, 35, 322313, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:14:35,344 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:14:35,376 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:14:35,379 | INFO | sqlalchemy.engine.Engine | [cached since 1556s ago] (UUID('e01ed784-e446-498a-91b3-d6c61bbf0eda'), UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'), 1, 'ground_readback', 60.0, "Persiste el error en la pista asignada ('10' en lugar de 'uno cero') y la instrucción de espera sigue incompleta. Corrija: '...al punto de espera pista uno cero'.")
2025-12-02 20:14:35,393 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:14:35,421 | INFO | app.controllers.audio | Puntuación guardada session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback score=60.00
2025-12-02 20:14:35,422 | INFO | app.logs.transcript | controller | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | intent=ground_taxi_readback | phase=ground_readback | allow_response=False | text=
2025-12-02 20:15:23,583 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:15:23,584 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:15:23,585 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:15:23,587 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:15:23,588 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:15:23,590 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:15:23,592 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:15:23,593 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:15:23,594 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:15:23,596 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:15:23,597 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:15:23,598 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:15:23,599 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:15:23,599 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:15:23,600 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:15:23,601 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:15:23,601 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:15:23,602 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:15:23,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:15:23,605 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:15:23,606 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:15:23,607 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:15:23,608 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:15:23,609 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:15:23,609 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:15:23,610 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:15:23,611 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:15:23,612 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:15:23,613 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:15:23,615 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:15:23,616 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:15:23,617 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 20:15:23,620 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:15:23,781 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:23,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:23,785 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:23,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:23,920 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:23,923 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:23,926 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:15:24,099 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:24,101 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:24,104 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:15:24,273 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:24,277 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:24,423 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:24,424 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:24,427 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:24,429 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:15:24,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:24,583 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:24,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:15:24,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:24,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:24,736 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:24,880 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:24,882 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:25,018 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:25,021 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:25,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:25,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:25,153 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:25,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:25,308 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:25,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:25,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:25,460 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-02 20:15:25,605 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:25,606 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:25,763 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:25,765 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:25,926 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:25,927 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:15:26,064 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:26,065 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:26,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:26,207 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:26,211 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:15:26,366 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:15:26,367 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:26,370 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:15:26,486 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:15:26,488 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:15:26,491 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1950]
2025-12-02 20:15:26,493 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:15:26,493 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:15:26,672 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:15:26,674 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:15:26,675 | INFO | sqlalchemy.engine.Engine | [cached since 1885s ago] ()
2025-12-02 20:15:26,682 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:15:26,683 | INFO | sqlalchemy.engine.Engine | [cached since 1756s ago] (1,)
2025-12-02 20:15:27,670 | INFO | app.services.transcribe | Starting stream. Total bytes: 1163264. Chunk size: 8192. No throttling.
2025-12-02 20:15:27,675 | DEBUG | app.services.transcribe | Streamed 8192/1163264 bytes
2025-12-02 20:15:27,765 | DEBUG | app.services.transcribe | Streamed 417792/1163264 bytes
2025-12-02 20:15:27,874 | DEBUG | app.services.transcribe | Streamed 827392/1163264 bytes
2025-12-02 20:15:27,934 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:15:29,969 | DEBUG | app.services.transcribe | Received transcript chunk: 1017 Transponder....
2025-12-02 20:15:32,791 | DEBUG | app.services.transcribe | Received transcript chunk: 0503 rodaremos vía A...
2025-12-02 20:15:33,922 | DEBUG | app.services.transcribe | Received transcript chunk: 10 Alfa Noviembre In...
2025-12-02 20:15:33,963 | INFO | app.services.transcribe | Transcription complete. Length: 91
2025-12-02 20:15:33,965 | INFO | app.controllers.audio | Transcripción recibida session=59afa6b9-8c5b-4933-9d2a-e60864635fad: 1017 Transponder. 0503 rodaremos vía Alfa tres Alfa al.de espera. 10 Alfa Noviembre India.
2025-12-02 20:15:33,966 | INFO | app.logs.transcript | student | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | text=1017 Transponder. 0503 rodaremos vía Alfa tres Alfa al.de espera. 10 Alfa Noviembre India.
2025-12-02 20:15:34,101 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:15:34,104 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:15:34,105 | INFO | sqlalchemy.engine.Engine | [cached since 1748s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:15:34,125 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:15:38,231 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:15:38,233 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:15:38,237 | INFO | sqlalchemy.engine.Engine | [cached since 1752s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:15:38,270 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:15:38,272 | INFO | sqlalchemy.engine.Engine | [cached since 1632s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (19847 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 15, 38, 269544, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:15:38,300 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:15:38,352 | INFO | app.controllers.audio | Fase activa session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 20:15:38,356 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
1017 Transponder. 0503 rodaremos vía Alfa tres Alfa al.de espera. 10 Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar res...
2025-12-02 20:15:48,951 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Se mantiene el error en la pista asignada ('10' en vez de 'uno cero') y falta la instrucción completa de espera. Debe decir: '...al punto de espera pista uno cero'.",
  "confidence": 0.85,
  "score": 40,
  "metadata": {
    "missingItems": [
      "Pista asignada (uno cero)",
      "Instrucción completa de espera ('punto de espera pista uno cero')"
    ],
    "attempts": 3
  }
}
2025-12-02 20:15:48,953 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-02 20:15:49,071 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:15:49,072 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:15:49,074 | INFO | sqlalchemy.engine.Engine | [cached since 1763s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:15:49,090 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:15:49,091 | INFO | sqlalchemy.engine.Engine | [cached since 1643s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (21109 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 15, 49, 89952, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:15:49,105 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:15:49,134 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:15:49,135 | INFO | sqlalchemy.engine.Engine | [cached since 1629s ago] (UUID('2d70fe3c-85e1-4681-9ee8-8d8979b5da97'), UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'), 1, 'ground_readback', 40.0, "Se mantiene el error en la pista asignada ('10' en vez de 'uno cero') y falta la instrucción completa de espera. Debe decir: '...al punto de espera pista uno cero'.")
2025-12-02 20:15:49,146 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:15:49,174 | INFO | app.controllers.audio | Puntuación guardada session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback score=40.00
2025-12-02 20:15:49,176 | INFO | app.logs.transcript | controller | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | intent=ground_taxi_readback | phase=ground_readback | allow_response=False | text=
2025-12-02 20:16:25,564 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:16:25,564 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:16:25,565 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:16:25,566 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:16:25,568 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:16:25,569 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:16:25,569 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:16:25,570 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:16:25,572 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:16:25,572 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:16:25,573 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:16:25,574 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:16:25,575 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:16:25,577 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:16:25,579 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:16:25,581 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:16:25,584 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:16:25,585 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:16:25,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:16:25,587 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:16:25,589 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:16:25,590 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:16:25,591 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:16:25,591 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:16:25,592 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:16:25,595 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:16:25,595 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:16:25,596 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:16:25,596 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:16:25,598 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:16:25,599 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:16:25,600 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 20:16:25,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:16:25,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:25,735 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:25,737 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:25,878 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:25,879 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:25,882 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:26,044 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:16:26,047 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,050 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:26,188 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,189 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:26,191 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:26,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:16:26,331 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:26,501 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,503 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:26,506 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,509 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:26,671 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,673 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:26,675 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:26,812 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:26,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:16:26,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:26,936 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:16:26,938 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:27,064 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:27,067 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:27,202 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:16:27,203 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,206 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,210 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:27,338 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:16:27,340 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:27,345 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:27,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:27,469 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:27,475 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:16:27,620 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,622 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:27,625 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:16:27,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:27,777 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:27,908 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:27,909 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:27,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:28,086 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:28,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:28,092 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:28,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:28,299 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:28,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:28,522 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:28,524 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:28,527 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:28,752 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:28,755 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:28,758 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:28,762 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:16:28,995 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:28,997 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:28,999 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:29,130 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:16:29,133 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:16:29,135 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:16:29,139 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:23]
2025-12-02 20:16:29,140 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:16:29,141 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:16:29,287 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:16:29,289 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:16:29,290 | INFO | sqlalchemy.engine.Engine | [cached since 1948s ago] ()
2025-12-02 20:16:29,301 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:16:29,302 | INFO | sqlalchemy.engine.Engine | [cached since 1819s ago] (1,)
2025-12-02 20:16:30,315 | INFO | app.services.transcribe | Starting stream. Total bytes: 1333248. Chunk size: 8192. No throttling.
2025-12-02 20:16:30,316 | DEBUG | app.services.transcribe | Streamed 8192/1333248 bytes
2025-12-02 20:16:30,364 | DEBUG | app.services.transcribe | Streamed 417792/1333248 bytes
2025-12-02 20:16:30,398 | DEBUG | app.services.transcribe | Streamed 827392/1333248 bytes
2025-12-02 20:16:30,429 | DEBUG | app.services.transcribe | Streamed 1236992/1333248 bytes
2025-12-02 20:16:30,434 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:16:31,285 | DEBUG | app.services.transcribe | Received transcript chunk: UH....
2025-12-02 20:16:32,656 | DEBUG | app.services.transcribe | Received transcript chunk: 1017 Transponder....
2025-12-02 20:16:36,320 | DEBUG | app.services.transcribe | Received transcript chunk: 0503 lo daremos vía ...
2025-12-02 20:16:36,899 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-02 20:16:36,959 | INFO | app.services.transcribe | Transcription complete. Length: 98
2025-12-02 20:16:36,960 | INFO | app.controllers.audio | Transcripción recibida session=59afa6b9-8c5b-4933-9d2a-e60864635fad: UH. 1017 Transponder. 0503 lo daremos vía alfa tres Alpha al.de espera 10. Alfa Noviembre, India.
2025-12-02 20:16:36,962 | INFO | app.logs.transcript | student | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | text=UH. 1017 Transponder. 0503 lo daremos vía alfa tres Alpha al.de espera 10. Alfa Noviembre, India.
2025-12-02 20:16:37,081 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:16:37,082 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:16:37,084 | INFO | sqlalchemy.engine.Engine | [cached since 1811s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:16:37,111 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:16:41,400 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:16:41,401 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:16:41,402 | INFO | sqlalchemy.engine.Engine | [cached since 1815s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:16:41,429 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:16:41,431 | INFO | sqlalchemy.engine.Engine | [cached since 1695s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (21626 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 16, 41, 428431, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:16:41,447 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:16:41,479 | INFO | app.controllers.audio | Intent detector frequency mismatch session=59afa6b9-8c5b-4933-9d2a-e60864635fad detected=tower scenario=ground
2025-12-02 20:16:41,481 | INFO | app.controllers.audio | Fase activa session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback intent=tower_transponder_instruction freq=ground
2025-12-02 20:16:41,483 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_transponder_instruction freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: tower_transponder_instruction
Transcripción textual del alumno:
UH. 1017 Transponder. 0503 lo daremos vía alfa tres Alpha al.de espera 10. Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Co...
2025-12-02 20:16:51,608 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_transponder_instruction intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persisten errores críticos en la pista asignada ('10' en vez de 'uno cero') y la instrucción de espera sigue incompleta. Corrija: '...al punto de espera pista uno cero'. No cambie a Torre hasta corregir.",
  "confidence": 0.75,
  "score": 40,
  "metadata": {
    "missingItems": [
      "Pista asignada (uno cero)",
      "Instrucción completa de espera"
    ],
    "attempts": 4
  }
}
2025-12-02 20:16:51,609 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (tower_transponder_instruction)
2025-12-02 20:16:51,744 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:16:51,746 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:16:51,747 | INFO | sqlalchemy.engine.Engine | [cached since 1826s ago] (UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'),)
2025-12-02 20:16:51,770 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:16:51,771 | INFO | sqlalchemy.engine.Engine | [cached since 1706s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (22908 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0503", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 16, 51, 770866, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('be2d04e2-e37d-45df-8970-41df8049e727'))
2025-12-02 20:16:51,792 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:16:51,832 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:16:51,834 | INFO | sqlalchemy.engine.Engine | [cached since 1692s ago] (UUID('d2479f0b-6756-4e0b-89d6-cc29c1114809'), UUID('59afa6b9-8c5b-4933-9d2a-e60864635fad'), 1, 'ground_readback', 40.0, "Persisten errores críticos en la pista asignada ('10' en vez de 'uno cero') y la instrucción de espera sigue incompleta. Corrija: '...al punto de espera pista uno cero'. No cambie a Torre hasta corregir.")
2025-12-02 20:16:51,846 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:16:51,876 | INFO | app.controllers.audio | Puntuación guardada session=59afa6b9-8c5b-4933-9d2a-e60864635fad phase_id=ground_readback score=40.00
2025-12-02 20:16:51,877 | INFO | app.logs.transcript | controller | session=59afa6b9-8c5b-4933-9d2a-e60864635fad | frequency=121.700 | intent=ground_taxi_readback | phase=ground_readback | allow_response=False | text=
2025-12-02 20:18:07,160 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 20:18:07,291 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000019AFD271810>
2025-12-02 20:18:07,294 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x0000019AFD3AEC30> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 20:18:07,402 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000019AFC822DD0>
2025-12-02 20:18:07,403 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 20:18:07,406 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 20:18:07,406 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 20:18:07,408 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 20:18:07,409 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 20:18:07,507 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 02:18:08 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'509'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1fd-5JoV5ZbNziyzb705UUgOCNIEoCw"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T021808Z-1654ff757978pmzshC1MIAvvp80000002ydg00000000pzdu'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-02 20:18:07,508 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 20:18:07,509 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 20:18:07,511 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 20:18:07,512 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 20:18:07,513 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 20:18:07,514 | DEBUG | httpcore.connection | close.started
2025-12-02 20:18:07,515 | DEBUG | httpcore.connection | close.complete
2025-12-02 20:18:09,767 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:18:09,768 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:18:09,769 | INFO | sqlalchemy.engine.Engine | [cached since 2048s ago] ()
2025-12-02 20:18:09,777 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:18:09,778 | INFO | sqlalchemy.engine.Engine | [cached since 1919s ago] (1,)
2025-12-02 20:18:09,895 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-02 20:18:09,896 | INFO | sqlalchemy.engine.Engine | [cached since 1593s ago] (UUID('05e881d9-c9af-4a9b-a160-8900e32e2b88'), UUID('c453967b-0129-4862-83a1-0e5adc7a8941'), 1, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "290", "windSpeed": "3", "temp": "21", "dewp": "20", "cloudCover": "SCT", "cloudBase": "300", "wind": "290/3"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 2, 20, 18, 9, 895782, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 2, 20, 18, 9, 895782, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-02 20:18:09,929 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:18:10,155 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:18:10,158 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-02 20:18:10,160 | INFO | sqlalchemy.engine.Engine | [cached since 1593s ago] (UUID('05e881d9-c9af-4a9b-a160-8900e32e2b88'),)
2025-12-02 20:18:10,198 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:18:47,297 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:18:47,298 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:18:47,298 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:18:47,299 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:18:47,299 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:18:47,301 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:18:47,301 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:18:47,302 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:18:47,303 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:18:47,304 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:18:47,305 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:18:47,306 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:18:47,308 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:18:47,309 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:18:47,311 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:18:47,313 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:18:47,313 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:18:47,315 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:18:47,317 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:18:47,318 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:18:47,319 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:18:47,320 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:18:47,321 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:18:47,321 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:18:47,323 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:18:47,324 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:18:47,325 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:18:47,326 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:18:47,328 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:18:47,331 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:18:47,333 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:18:47,336 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:1460]
2025-12-02 20:18:47,338 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,341 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:18:47,456 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:47,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,460 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:47,462 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:18:47,607 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,609 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,611 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:47,615 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:18:47,764 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,771 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,773 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:18:47,946 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:47,949 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:47,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:48,090 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:48,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:48,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:48,099 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:18:48,294 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:48,297 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:48,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:48,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:48,504 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:48,509 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:48,719 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:48,723 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:48,726 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:18:48,729 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:18:48,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:48,916 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:48,919 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:49,116 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,119 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:49,122 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:49,317 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:49,321 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:49,443 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,445 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:49,447 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:49,572 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,575 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:18:49,709 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:49,711 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:49,843 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:49,844 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,846 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:49,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:49,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:49,991 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:49,994 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:18:50,148 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:18:50,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:50,152 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:18:50,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:50,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:50,299 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:50,444 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:18:50,445 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:50,447 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:18:50,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:50,574 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:50,576 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:50,578 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:18:50,710 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:18:50,711 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:18:50,714 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:18:50,818 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:18:50,820 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2109]
2025-12-02 20:18:50,820 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:18:50,821 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:18:50,984 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:18:50,985 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:18:50,986 | INFO | sqlalchemy.engine.Engine | [cached since 2089s ago] ()
2025-12-02 20:18:50,994 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:18:50,995 | INFO | sqlalchemy.engine.Engine | [cached since 1960s ago] (1,)
2025-12-02 20:18:52,069 | INFO | app.services.transcribe | Starting stream. Total bytes: 1320960. Chunk size: 8192. No throttling.
2025-12-02 20:18:52,071 | DEBUG | app.services.transcribe | Streamed 8192/1320960 bytes
2025-12-02 20:18:52,106 | DEBUG | app.services.transcribe | Streamed 417792/1320960 bytes
2025-12-02 20:18:52,133 | DEBUG | app.services.transcribe | Streamed 827392/1320960 bytes
2025-12-02 20:18:52,157 | DEBUG | app.services.transcribe | Streamed 1236992/1320960 bytes
2025-12-02 20:18:52,161 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:18:59,361 | DEBUG | app.services.transcribe | Received transcript chunk: va superficie Alfa N...
2025-12-02 20:18:59,541 | INFO | app.services.transcribe | Transcription complete. Length: 193
2025-12-02 20:18:59,543 | INFO | app.controllers.audio | Transcripción recibida session=c453967b-0129-4862-83a1-0e5adc7a8941: va superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo UFR hacia zona Eco vía Paso Ochomogo nivel 7000 pies, dos almas a bordo, autonomía cinco horas.
2025-12-02 20:18:59,543 | INFO | app.logs.transcript | student | session=c453967b-0129-4862-83a1-0e5adc7a8941 | frequency=121.700 | text=va superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo UFR hacia zona Eco vía Paso Ochomogo nivel 7000 pies, dos almas a bordo, autonomía cinco horas.
2025-12-02 20:18:59,687 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:18:59,687 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:18:59,688 | INFO | sqlalchemy.engine.Engine | [cached since 1954s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-02 20:18:59,703 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:19:00,396 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:19:00,398 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:19:00,399 | INFO | sqlalchemy.engine.Engine | [cached since 1954s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-02 20:19:00,415 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:19:00,416 | INFO | sqlalchemy.engine.Engine | [cached since 1834s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (14641 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-03T02:19:00Z"}]}', datetime.datetime(2025, 12, 2, 20, 19, 0, 415908, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('05e881d9-c9af-4a9b-a160-8900e32e2b88'))
2025-12-02 20:19:00,433 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:19:00,464 | INFO | app.controllers.audio | Fase activa session=c453967b-0129-4862-83a1-0e5adc7a8941 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-02 20:19:00,466 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0570. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": str...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
va superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo UFR hacia zona Eco vía Paso Ochomogo nivel 7000 pies, dos almas a bordo, autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- I...
2025-12-02 20:19:10,531 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0570. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron incluidos correctamente.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-12-02 20:19:10,533 | INFO | app.controllers.audio | Transición automática de fase session=c453967b-0129-4862-83a1-0e5adc7a8941 de=ground_departure_request a=ground_readback
2025-12-02 20:19:10,677 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:19:10,678 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:19:10,679 | INFO | sqlalchemy.engine.Engine | [cached since 1965s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-02 20:19:10,701 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:19:10,702 | INFO | sqlalchemy.engine.Engine | [cached since 1845s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (15901 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0570", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 19, 10, 701027, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('05e881d9-c9af-4a9b-a160-8900e32e2b88'))
2025-12-02 20:19:10,717 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:19:10,752 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:19:10,754 | INFO | sqlalchemy.engine.Engine | [cached since 1831s ago] (UUID('387d141a-1108-43a0-aadc-719b96d29f3b'), UUID('c453967b-0129-4862-83a1-0e5adc7a8941'), 1, 'ground_readback', 95.0, 'Solicitud completa. Todos los elementos requeridos fueron incluidos correctamente.')
2025-12-02 20:19:10,768 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:19:10,801 | INFO | app.controllers.audio | Puntuación guardada session=c453967b-0129-4862-83a1-0e5adc7a8941 phase_id=ground_readback score=95.00
2025-12-02 20:19:10,802 | INFO | app.logs.transcript | controller | session=c453967b-0129-4862-83a1-0e5adc7a8941 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0570. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.
2025-12-02 20:19:48,301 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:19:48,302 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:19:48,303 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:19:48,304 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:19:48,306 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:19:48,308 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:19:48,308 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:19:48,310 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:19:48,312 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:19:48,313 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:19:48,315 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:19:48,317 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:19:48,319 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:19:48,320 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:19:48,320 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:19:48,323 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:19:48,324 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:19:48,325 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:19:48,327 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:19:48,328 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:19:48,328 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:19:48,330 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:19:48,331 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:19:48,332 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:19:48,334 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:19:48,334 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:19:48,336 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:19:48,338 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:19:48,339 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:19:48,339 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:19:48,341 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:19:48,343 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 20:19:48,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:19:48,496 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:48,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:48,503 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:48,718 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:48,721 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:48,724 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:48,915 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:48,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:48,921 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:49,158 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:19:49,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:49,284 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:49,286 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:49,290 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:49,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:49,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:19:49,424 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:19:49,426 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:49,553 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:19:49,555 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:49,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:49,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:49,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:49,808 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:19:49,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:49,810 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:19:49,931 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:49,932 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:49,935 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:49,936 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:50,065 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,067 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:50,068 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:50,222 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:50,224 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,226 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:50,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:50,369 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,372 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:50,374 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:19:50,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:50,501 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,504 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:50,635 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,636 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,639 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,640 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:19:50,766 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:50,768 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,769 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,770 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:19:50,896 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:19:50,897 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:50,898 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:19:51,023 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:51,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:51,026 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:51,028 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:19:51,145 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:19:51,148 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:19:51,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2778]
2025-12-02 20:19:51,152 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:19:51,154 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:19:51,364 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:19:51,366 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:19:51,367 | INFO | sqlalchemy.engine.Engine | [cached since 2150s ago] ()
2025-12-02 20:19:51,380 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:19:51,383 | INFO | sqlalchemy.engine.Engine | [cached since 2021s ago] (1,)
2025-12-02 20:19:52,420 | INFO | app.services.transcribe | Starting stream. Total bytes: 1169408. Chunk size: 8192. No throttling.
2025-12-02 20:19:52,424 | DEBUG | app.services.transcribe | Streamed 8192/1169408 bytes
2025-12-02 20:19:52,463 | DEBUG | app.services.transcribe | Streamed 417792/1169408 bytes
2025-12-02 20:19:52,508 | DEBUG | app.services.transcribe | Streamed 827392/1169408 bytes
2025-12-02 20:19:52,533 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:19:55,435 | DEBUG | app.services.transcribe | Received transcript chunk: UNH 1017 Transponder...
2025-12-02 20:19:58,019 | DEBUG | app.services.transcribe | Received transcript chunk: rodaré vía Alfa Brav...
2025-12-02 20:19:58,629 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-02 20:19:58,665 | INFO | app.services.transcribe | Transcription complete. Length: 89
2025-12-02 20:19:58,667 | INFO | app.controllers.audio | Transcripción recibida session=c453967b-0129-4862-83a1-0e5adc7a8941: UNH 1017 Transponder 0570. rodaré vía Alfa Bravo al.de espera 10. Alfa Noviembre, India.
2025-12-02 20:19:58,668 | INFO | app.logs.transcript | student | session=c453967b-0129-4862-83a1-0e5adc7a8941 | frequency=121.700 | text=UNH 1017 Transponder 0570. rodaré vía Alfa Bravo al.de espera 10. Alfa Noviembre, India.
2025-12-02 20:19:58,958 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:19:58,959 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:19:58,962 | INFO | sqlalchemy.engine.Engine | [cached since 2013s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-02 20:19:58,996 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:20:02,229 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:20:02,230 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:20:02,232 | INFO | sqlalchemy.engine.Engine | [cached since 2016s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-02 20:20:02,255 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:20:02,256 | INFO | sqlalchemy.engine.Engine | [cached since 1896s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (16411 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0570", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 20, 2, 254864, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('05e881d9-c9af-4a9b-a160-8900e32e2b88'))
2025-12-02 20:20:02,277 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:20:02,320 | INFO | app.controllers.audio | Fase activa session=c453967b-0129-4862-83a1-0e5adc7a8941 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 20:20:02,324 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
UNH 1017 Transponder 0570. rodaré vía Alfa Bravo al.de espera 10. Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar restr...
2025-12-02 20:20:11,845 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista y restricciones. Puede proceder a Torre.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_hold_short",
    "missingItems": [],
    "extraItems": []
  }
}
2025-12-02 20:20:11,848 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-02 20:20:11,849 | INFO | app.controllers.audio | Transición automática de fase session=c453967b-0129-4862-83a1-0e5adc7a8941 de=ground_readback a=tower_hold_short
2025-12-02 20:20:12,069 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:20:12,072 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:20:12,075 | INFO | sqlalchemy.engine.Engine | [cached since 2026s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-02 20:20:12,109 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:20:12,110 | INFO | sqlalchemy.engine.Engine | [cached since 1906s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (17674 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0570", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 20, 20, 12, 108549, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('05e881d9-c9af-4a9b-a160-8900e32e2b88'))
2025-12-02 20:20:12,131 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:20:12,175 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:20:12,177 | INFO | sqlalchemy.engine.Engine | [cached since 1892s ago] (UUID('e4f33ea2-d2c8-4a43-8be3-78c0210d4c32'), UUID('c453967b-0129-4862-83a1-0e5adc7a8941'), 1, 'tower_hold_short', 95.0, 'Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista y restricciones. Puede proceder a Torre.')
2025-12-02 20:20:12,196 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:20:12,246 | INFO | app.controllers.audio | Puntuación guardada session=c453967b-0129-4862-83a1-0e5adc7a8941 phase_id=tower_hold_short score=95.00
2025-12-02 20:20:12,246 | INFO | app.logs.transcript | controller | session=c453967b-0129-4862-83a1-0e5adc7a8941 | frequency=121.700 | intent=ground_taxi_readback | phase=tower_hold_short | allow_response=True | text=Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-02 20:38:25,067 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:38:25,067 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:38:25,068 | INFO | sqlalchemy.engine.Engine | [cached since 3263s ago] ()
2025-12-02 20:38:25,077 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:38:25,080 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:38:25,081 | INFO | sqlalchemy.engine.Engine | [cached since 3263s ago] ()
2025-12-02 20:38:25,087 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,091 | INFO | sqlalchemy.engine.Engine | [cached since 3134s ago] (1,)
2025-12-02 20:38:25,100 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:38:25,103 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:38:25,105 | INFO | sqlalchemy.engine.Engine | [cached since 3263s ago] ()
2025-12-02 20:38:25,111 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,113 | INFO | sqlalchemy.engine.Engine | [cached since 3134s ago] (1,)
2025-12-02 20:38:25,128 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,131 | INFO | sqlalchemy.engine.Engine | [cached since 3134s ago] (1,)
2025-12-02 20:38:25,196 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:38:25,197 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:38:25,198 | INFO | sqlalchemy.engine.Engine | [cached since 3263s ago] ()
2025-12-02 20:38:25,212 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,214 | INFO | sqlalchemy.engine.Engine | [cached since 3135s ago] (1,)
2025-12-02 20:38:25,256 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,257 | INFO | sqlalchemy.engine.Engine | [cached since 3135s ago] (1,)
2025-12-02 20:38:25,261 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,262 | INFO | sqlalchemy.engine.Engine | [cached since 3135s ago] (1,)
2025-12-02 20:38:25,266 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,266 | INFO | sqlalchemy.engine.Engine | [cached since 3135s ago] (1,)
2025-12-02 20:38:25,270 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:38:25,271 | INFO | sqlalchemy.engine.Engine | [cached since 3131s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 20:38:25,275 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:38:25,276 | INFO | sqlalchemy.engine.Engine | [cached since 3131s ago] (1, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 20:38:25,279 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 20:38:25,281 | INFO | sqlalchemy.engine.Engine | [cached since 3131s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 20:38:25,309 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:38:25,313 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:38:25,315 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:38:25,319 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:25,323 | INFO | sqlalchemy.engine.Engine | [cached since 3135s ago] (1,)
2025-12-02 20:38:25,329 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 20:38:25,332 | INFO | sqlalchemy.engine.Engine | [cached since 3131s ago] ('scenario_id', 'session_completed', 1)
2025-12-02 20:38:25,356 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:38:29,737 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:38:29,739 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:38:29,741 | INFO | sqlalchemy.engine.Engine | [cached since 3268s ago] ()
2025-12-02 20:38:29,755 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:29,758 | INFO | sqlalchemy.engine.Engine | [cached since 3139s ago] (1,)
2025-12-02 20:38:29,896 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:38:29,897 | INFO | sqlalchemy.engine.Engine | [cached since 3124s ago] (UUID('c453967b-0129-4862-83a1-0e5adc7a8941'),)
2025-12-02 20:38:29,924 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:38:29,927 | INFO | sqlalchemy.engine.Engine | [cached since 3139s ago] (1,)
2025-12-02 20:38:29,933 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:41:32,368 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 20:41:32,369 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 20:41:32,378 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 20:41:32,379 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 20:41:32,386 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 20:41:32,387 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 20:41:32,394 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:41:32,396 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 20:41:32,397 | INFO | sqlalchemy.engine.Engine | [generated in 0.00134s] ()
2025-12-02 20:41:32,413 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:41:32,415 | INFO | sqlalchemy.engine.Engine | [generated in 0.00162s] ()
2025-12-02 20:41:32,427 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,430 | INFO | sqlalchemy.engine.Engine | [generated in 0.00241s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,476 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,479 | INFO | sqlalchemy.engine.Engine | [cached since 0.0524s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,487 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,491 | INFO | sqlalchemy.engine.Engine | [cached since 0.06434s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,498 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,502 | INFO | sqlalchemy.engine.Engine | [cached since 0.07481s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,511 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,512 | INFO | sqlalchemy.engine.Engine | [cached since 0.08572s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,518 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,519 | INFO | sqlalchemy.engine.Engine | [cached since 0.0923s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,525 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,527 | INFO | sqlalchemy.engine.Engine | [cached since 0.09968s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,533 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:41:32,537 | INFO | sqlalchemy.engine.Engine | [cached since 0.1093s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:41:32,545 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:41:32,546 | INFO | sqlalchemy.engine.Engine | [generated in 0.00166s] ('group_role', 'pg_catalog')
2025-12-02 20:41:32,560 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:41:32,561 | INFO | sqlalchemy.engine.Engine | [cached since 0.01676s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 20:41:32,569 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:41:32,570 | INFO | sqlalchemy.engine.Engine | [cached since 0.02535s ago] ('user_status', 'pg_catalog')
2025-12-02 20:41:32,577 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:41:32,580 | INFO | sqlalchemy.engine.Engine | [cached since 0.03564s ago] ('account_type', 'pg_catalog')
2025-12-02 20:41:32,588 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 20:41:32,591 | INFO | sqlalchemy.engine.Engine | [generated in 0.00241s] ()
2025-12-02 20:41:32,600 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 20:41:32,601 | INFO | sqlalchemy.engine.Engine | [generated in 0.00109s] ()
2025-12-02 20:41:32,651 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 20:41:32,653 | INFO | sqlalchemy.engine.Engine | [generated in 0.00232s] ()
2025-12-02 20:41:32,797 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:41:32,872 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 20:42:33,846 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:42:33,848 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:42:33,850 | INFO | sqlalchemy.engine.Engine | [cached since 61.44s ago] ()
2025-12-02 20:42:33,914 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.schools.id, ecowhiskey.schools.name, ecowhiskey.schools.value, ecowhiskey.schools.location, ecowhiskey.schools.created_at 
FROM ecowhiskey.schools ORDER BY ecowhiskey.schools.name
2025-12-02 20:42:33,915 | INFO | sqlalchemy.engine.Engine | [generated in 0.00121s] ()
2025-12-02 20:42:33,963 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:43:17,927 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:43:17,928 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:43:17,929 | INFO | sqlalchemy.engine.Engine | [cached since 105.5s ago] ()
2025-12-02 20:43:17,950 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 20:43:17,951 | INFO | sqlalchemy.engine.Engine | [generated in 0.00142s] ('usuariotest@gmail.com',)
2025-12-02 20:43:18,156 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.users (email, first_name, last_name, password_hash, status, account_type, school_id, photo) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::user_status, $6::account_type, $7::INTEGER, $8::VARCHAR) RETURNING ecowhiskey.users.id, ecowhiskey.users.created_at, ecowhiskey.users.updated_at
2025-12-02 20:43:18,158 | INFO | sqlalchemy.engine.Engine | [generated in 0.00184s] ('usuariotest@gmail.com', 'Usuario', 'Test', '1KMcAF1BTmV9SlnviG/yLkYnlaeS8VzrBIIQosx+y3krEdZaKyniKAfZzH5EzWnv', 'ACTIVE', 'STUDENT', None, None)
2025-12-02 20:43:18,233 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:43:18,516 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:43:18,522 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:43:18,524 | INFO | sqlalchemy.engine.Engine | [generated in 0.00239s] (6,)
2025-12-02 20:43:18,683 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:43:35,571 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:43:35,573 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:43:35,574 | INFO | sqlalchemy.engine.Engine | [cached since 123.2s ago] ()
2025-12-02 20:43:35,585 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 20:43:35,587 | INFO | sqlalchemy.engine.Engine | [cached since 17.64s ago] ('usuariotest@gmail.com',)
2025-12-02 20:43:35,778 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:43:39,780 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:43:39,783 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:43:39,786 | INFO | sqlalchemy.engine.Engine | [cached since 127.4s ago] ()
2025-12-02 20:43:39,800 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:43:39,803 | INFO | sqlalchemy.engine.Engine | [generated in 0.00284s] (6,)
2025-12-02 20:43:40,054 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:43:41,278 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:43:41,279 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:43:41,280 | INFO | sqlalchemy.engine.Engine | [cached since 128.9s ago] ()
2025-12-02 20:43:41,292 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:43:41,293 | INFO | sqlalchemy.engine.Engine | [cached since 1.493s ago] (6,)
2025-12-02 20:43:41,304 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:43:41,304 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:43:41,305 | INFO | sqlalchemy.engine.Engine | [cached since 128.9s ago] ()
2025-12-02 20:43:41,314 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:43:41,315 | INFO | sqlalchemy.engine.Engine | [cached since 1.515s ago] (6,)
2025-12-02 20:43:41,400 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:43:41,401 | INFO | sqlalchemy.engine.Engine | [cached since 1.601s ago] (6,)
2025-12-02 20:43:41,405 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:43:41,406 | INFO | sqlalchemy.engine.Engine | [cached since 1.606s ago] (6,)
2025-12-02 20:43:41,414 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 20:43:41,416 | INFO | sqlalchemy.engine.Engine | [generated in 0.00279s] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 20:43:41,426 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 20:43:41,429 | INFO | sqlalchemy.engine.Engine | [generated in 0.00257s] ('scenario_id', 'session_completed', 6)
2025-12-02 20:43:41,452 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:43:41,455 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:44:16,863 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 20:44:16,999 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001B86BFF8E50>
2025-12-02 20:44:17,001 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x000001B86C04ECC0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 20:44:17,117 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001B86BFE6C50>
2025-12-02 20:44:17,119 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 20:44:17,121 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 20:44:17,123 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 20:44:17,124 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 20:44:17,126 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 20:44:17,219 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 02:44:18 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'509'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1fd-5JoV5ZbNziyzb705UUgOCNIEoCw"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T024417Z-1654ff75797kk9hrhC1MIAp1180000002yx000000000k72v'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-02 20:44:17,221 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 20:44:17,222 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 20:44:17,223 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 20:44:17,224 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 20:44:17,225 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 20:44:17,227 | DEBUG | httpcore.connection | close.started
2025-12-02 20:44:17,227 | DEBUG | httpcore.connection | close.complete
2025-12-02 20:44:27,265 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:44:27,267 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:44:27,268 | INFO | sqlalchemy.engine.Engine | [cached since 174.9s ago] ()
2025-12-02 20:44:27,281 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:44:27,283 | INFO | sqlalchemy.engine.Engine | [cached since 47.48s ago] (6,)
2025-12-02 20:44:27,443 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-02 20:44:27,443 | INFO | sqlalchemy.engine.Engine | [generated in 0.01345s] (UUID('b52317b9-1f62-4922-bf32-f327f228ada3'), UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'), 6, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1017", "windDirection": "290", "windSpeed": "3", "temp": "21", "dewp": "20", "cloudCover": "SCT", "cloudBase": "300", "wind": "290/3"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 2, 20, 44, 27, 443138, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 2, 20, 44, 27, 443138, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-02 20:44:27,459 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:44:27,709 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:44:27,713 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-02 20:44:27,715 | INFO | sqlalchemy.engine.Engine | [generated in 0.00181s] (UUID('b52317b9-1f62-4922-bf32-f327f228ada3'),)
2025-12-02 20:44:27,737 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:45:46,662 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:45:46,662 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:45:46,663 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:45:46,664 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:45:46,664 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:45:46,666 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:45:46,666 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:45:46,666 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:45:46,668 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:45:46,669 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:45:46,670 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:45:46,673 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:45:46,674 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:45:46,675 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:45:46,676 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:45:46,679 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:45:46,680 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:45:46,681 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:45:46,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:45:46,684 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:45:46,685 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:45:46,686 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:45:46,688 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:45:46,689 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:45:46,690 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:45:46,691 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:45:46,693 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:45:46,695 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:45:46,697 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:45:46,700 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:45:46,702 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:45:46,703 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-02 20:45:46,706 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:46,710 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:45:46,850 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:46,854 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:46,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:47,003 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:47,005 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:47,008 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:47,010 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:47,216 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:47,218 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:47,221 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:47,413 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:47,414 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:47,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:47,570 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:47,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:47,577 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:45:47,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:47,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:47,909 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:47,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:47,912 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:47,914 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:48,065 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:48,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:48,073 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:48,077 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:48,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:48,229 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:45:48,402 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:48,404 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:48,407 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:48,409 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:48,598 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:48,599 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:48,602 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:48,604 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:48,752 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:48,753 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:48,755 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:48,757 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:48,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:48,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:49,081 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:49,083 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:49,084 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:49,230 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:49,231 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:49,443 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:49,445 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:49,448 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:49,694 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:49,696 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:49,698 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:49,956 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:49,959 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:49,963 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:50,249 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:50,253 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:45:50,468 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:50,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:50,476 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:50,681 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:50,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:50,686 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:50,828 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:50,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:50,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:45:51,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:51,014 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:51,019 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:51,190 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:51,192 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:51,196 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:45:51,345 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:45:51,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:51,348 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:51,485 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:51,489 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:51,493 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:45:51,654 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:51,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:51,659 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:45:51,665 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:45:51,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:51,776 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:51,778 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:45:51,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:978]
2025-12-02 20:45:51,780 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:45:51,781 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:45:51,961 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:45:51,963 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:45:51,964 | INFO | sqlalchemy.engine.Engine | [cached since 259.6s ago] ()
2025-12-02 20:45:51,976 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:45:51,978 | INFO | sqlalchemy.engine.Engine | [cached since 132.2s ago] (6,)
2025-12-02 20:45:53,808 | INFO | app.services.transcribe | Starting stream. Total bytes: 1669120. Chunk size: 8192. No throttling.
2025-12-02 20:45:53,811 | DEBUG | app.services.transcribe | Streamed 8192/1669120 bytes
2025-12-02 20:45:53,850 | DEBUG | app.services.transcribe | Streamed 417792/1669120 bytes
2025-12-02 20:45:53,880 | DEBUG | app.services.transcribe | Streamed 827392/1669120 bytes
2025-12-02 20:45:53,901 | DEBUG | app.services.transcribe | Streamed 1236992/1669120 bytes
2025-12-02 20:45:53,938 | DEBUG | app.services.transcribe | Streamed 1646592/1669120 bytes
2025-12-02 20:45:53,943 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:46:01,914 | DEBUG | app.services.transcribe | Received transcript chunk: superficie Alfa Novi...
2025-12-02 20:46:02,998 | DEBUG | app.services.transcribe | Received transcript chunk: autonomía cinco hora...
2025-12-02 20:46:03,039 | INFO | app.services.transcribe | Transcription complete. Length: 199
2025-12-02 20:46:03,040 | INFO | app.controllers.audio | Transcripción recibida session=a3b93282-8c1e-40d4-91df-60b93bcc8f24: superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VEFR hacia zona Eco vía Paso Ochomogo nivel 7000 pies, dos almas a bordo. autonomía cinco horas y media.
2025-12-02 20:46:03,042 | INFO | app.logs.transcript | student | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | text=superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VEFR hacia zona Eco vía Paso Ochomogo nivel 7000 pies, dos almas a bordo. autonomía cinco horas y media.
2025-12-02 20:46:03,200 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:46:03,201 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:46:03,203 | INFO | sqlalchemy.engine.Engine | [generated in 0.00146s] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:46:03,236 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:46:05,439 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:46:05,440 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:46:05,441 | INFO | sqlalchemy.engine.Engine | [cached since 2.24s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:46:05,466 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:46:05,467 | INFO | sqlalchemy.engine.Engine | [generated in 0.00110s] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (14671 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-03T02:46:05Z"}]}', datetime.datetime(2025, 12, 2, 20, 46, 5, 466246, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:46:05,491 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:46:05,529 | INFO | app.controllers.audio | Fase activa session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-02 20:46:05,532 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0502. Ruede vía Alfa, Charlie al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": s...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VEFR hacia zona Eco vía Paso Ochomogo nivel 7000 pies, dos almas a bordo. autonomía cinco horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superfici...
2025-12-02 20:46:19,483 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0502. Ruede vía Alfa, Charlie al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "ground_readback"...
2025-12-02 20:46:19,486 | INFO | app.controllers.audio | Transición automática de fase session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 de=ground_departure_request a=ground_readback
2025-12-02 20:46:19,754 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:46:19,756 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:46:19,758 | INFO | sqlalchemy.engine.Engine | [cached since 16.56s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:46:19,791 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:46:19,792 | INFO | sqlalchemy.engine.Engine | [cached since 14.33s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (16475 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 46, 19, 790937, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:46:19,827 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:46:19,896 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:46:19,898 | INFO | sqlalchemy.engine.Engine | [generated in 0.00150s] (UUID('749cb262-f196-4f34-b65b-e492aa61e546'), UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'), 6, 'ground_readback', 95.0, 'Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.')
2025-12-02 20:46:19,916 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:46:19,971 | INFO | app.controllers.audio | Puntuación guardada session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback score=95.00
2025-12-02 20:46:19,973 | INFO | app.logs.transcript | controller | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 290 grados 3 nudos. QNH 1017. Transponder 0502. Ruede vía Alfa, Charlie al punto de espera pista uno cero. Llame listo.
2025-12-02 20:48:06,376 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:48:06,377 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:48:06,379 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:48:06,380 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:48:06,381 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:48:06,382 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:48:06,383 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:48:06,385 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:48:06,386 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:48:06,387 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:48:06,387 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:48:06,390 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:48:06,392 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:48:06,394 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:48:06,396 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:48:06,396 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:48:06,398 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:48:06,400 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:48:06,401 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:48:06,403 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:48:06,403 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:48:06,404 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:48:06,405 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:48:06,405 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:48:06,406 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:48:06,409 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:48:06,411 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:48:06,415 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:48:06,416 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:48:06,418 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:48:06,421 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:48:06,422 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 20:48:06,424 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:06,426 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:06,610 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:06,611 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:06,614 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:06,617 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:48:06,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:06,769 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:06,772 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:06,929 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:48:06,932 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:07,077 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:07,078 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:07,081 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:07,087 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:48:07,382 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:07,385 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:07,388 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:07,569 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:07,570 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:07,571 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:07,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:48:07,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:48:07,738 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:07,884 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:07,886 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:07,888 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:08,094 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:08,097 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:08,102 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:48:08,308 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:08,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:08,316 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:08,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:48:08,535 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:48:08,537 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:08,540 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:08,543 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:48:08,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:48:08,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:08,719 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:48:08,866 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:08,868 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:08,869 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:09,025 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:09,027 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:48:09,029 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:48:09,184 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:09,186 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:09,187 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:48:09,382 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:09,385 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:09,388 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:09,391 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:48:09,643 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:48:09,645 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:09,868 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:09,872 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:09,875 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:10,134 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:10,136 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:48:10,139 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:48:10,268 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:48:10,270 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1337]
2025-12-02 20:48:10,272 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:48:10,272 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:48:10,607 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:48:10,609 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:48:10,611 | INFO | sqlalchemy.engine.Engine | [cached since 398.2s ago] ()
2025-12-02 20:48:10,623 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:48:10,626 | INFO | sqlalchemy.engine.Engine | [cached since 270.8s ago] (6,)
2025-12-02 20:48:11,690 | INFO | app.services.transcribe | Starting stream. Total bytes: 1208320. Chunk size: 8192. No throttling.
2025-12-02 20:48:11,694 | DEBUG | app.services.transcribe | Streamed 8192/1208320 bytes
2025-12-02 20:48:11,740 | DEBUG | app.services.transcribe | Streamed 417792/1208320 bytes
2025-12-02 20:48:11,789 | DEBUG | app.services.transcribe | Streamed 827392/1208320 bytes
2025-12-02 20:48:11,840 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:48:12,936 | DEBUG | app.services.transcribe | Received transcript chunk: QNH....
2025-12-02 20:48:14,880 | DEBUG | app.services.transcribe | Received transcript chunk: 1017 Transponder 050...
2025-12-02 20:48:18,303 | DEBUG | app.services.transcribe | Received transcript chunk: rodaremos vía Alpha ...
2025-12-02 20:48:18,393 | INFO | app.services.transcribe | Transcription complete. Length: 95
2025-12-02 20:48:18,394 | INFO | app.controllers.audio | Transcripción recibida session=a3b93282-8c1e-40d4-91df-60b93bcc8f24: QNH. 1017 Transponder 0502. rodaremos vía Alpha Charlie al.de espera 10 Alfa Noviembre, India.
2025-12-02 20:48:18,395 | INFO | app.logs.transcript | student | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | text=QNH. 1017 Transponder 0502. rodaremos vía Alpha Charlie al.de espera 10 Alfa Noviembre, India.
2025-12-02 20:48:18,578 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:48:18,579 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:48:18,580 | INFO | sqlalchemy.engine.Engine | [cached since 135.4s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:48:18,601 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:48:24,246 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:48:24,247 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:48:24,249 | INFO | sqlalchemy.engine.Engine | [cached since 141s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:48:24,278 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:48:24,280 | INFO | sqlalchemy.engine.Engine | [cached since 138.8s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (16985 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 48, 24, 278141, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:48:24,307 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:48:24,344 | INFO | app.controllers.audio | Fase activa session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 20:48:24,347 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH. 1017 Transponder 0502. rodaremos vía Alpha Charlie al.de espera 10 Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar...
2025-12-02 20:48:38,408 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Falta colacionar la pista asignada (uno cero) y la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.",
  "confidence": 0.85,
  "score": 60,
  "metadata": {
    "missingItems": [
      "Pista asignada (uno cero)",
      "Instrucción de espera (Llame listo)"
    ]
  }
}
2025-12-02 20:48:38,410 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-02 20:48:38,563 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:48:38,564 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:48:38,566 | INFO | sqlalchemy.engine.Engine | [cached since 155.4s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:48:38,598 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:48:38,600 | INFO | sqlalchemy.engine.Engine | [cached since 153.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (18245 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 48, 38, 597090, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:48:38,629 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:48:38,681 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:48:38,682 | INFO | sqlalchemy.engine.Engine | [cached since 138.8s ago] (UUID('bac93878-aa3e-4938-9f83-468cdf14b568'), UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'), 6, 'ground_readback', 60.0, "Falta colacionar la pista asignada (uno cero) y la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.")
2025-12-02 20:48:38,699 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:48:38,747 | INFO | app.controllers.audio | Puntuación guardada session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback score=60.00
2025-12-02 20:48:38,749 | INFO | app.logs.transcript | controller | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | intent=ground_taxi_readback | phase=ground_readback | allow_response=False | text=
2025-12-02 20:55:25,036 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:55:25,037 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:55:25,039 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:55:25,040 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:55:25,041 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:55:25,042 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:55:25,042 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:55:25,044 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:55:25,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:55:25,046 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:55:25,049 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:55:25,050 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:55:25,053 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:55:25,054 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:55:25,056 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:55:25,057 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:55:25,059 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:55:25,059 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:55:25,061 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:55:25,062 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:55:25,063 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:55:25,064 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:55:25,065 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:55:25,066 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:55:25,067 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:55:25,067 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:55:25,069 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:55:25,070 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:55:25,071 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:55:25,072 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:55:25,073 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:55:25,077 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 20:55:25,080 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:25,082 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:25,227 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:55:25,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:25,229 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:55:25,371 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:25,374 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:25,376 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:25,378 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:25,532 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:25,535 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:25,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:25,689 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:25,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:25,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:25,696 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:55:25,839 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:25,841 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:25,844 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:26,032 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:55:26,034 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:26,195 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:26,199 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:26,203 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 20:55:26,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:55:26,371 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:26,529 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:26,532 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:26,534 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:26,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:55:26,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:26,684 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:26,823 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:26,824 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:26,827 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:26,829 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:27,010 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,018 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:27,189 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,191 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,194 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,196 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,198 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:27,344 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:27,522 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,524 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,525 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,527 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:27,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:27,833 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,834 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,836 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,838 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:55:27,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:27,976 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:27,978 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:28,116 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:28,117 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:28,119 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:28,121 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:28,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:28,312 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:28,316 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:28,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:55:28,492 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:28,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:28,497 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:28,684 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:28,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:55:28,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:55:28,689 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:55:28,842 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:55:28,846 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:55:28,872 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1383]
2025-12-02 20:55:28,873 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:55:28,874 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:55:29,032 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:55:29,033 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:55:29,035 | INFO | sqlalchemy.engine.Engine | [cached since 836.6s ago] ()
2025-12-02 20:55:29,048 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:55:29,049 | INFO | sqlalchemy.engine.Engine | [cached since 709.2s ago] (6,)
2025-12-02 20:55:30,751 | INFO | app.services.transcribe | Starting stream. Total bytes: 1402880. Chunk size: 8192. No throttling.
2025-12-02 20:55:30,756 | DEBUG | app.services.transcribe | Streamed 8192/1402880 bytes
2025-12-02 20:55:30,811 | DEBUG | app.services.transcribe | Streamed 417792/1402880 bytes
2025-12-02 20:55:30,860 | DEBUG | app.services.transcribe | Streamed 827392/1402880 bytes
2025-12-02 20:55:30,918 | DEBUG | app.services.transcribe | Streamed 1236992/1402880 bytes
2025-12-02 20:55:30,950 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:55:32,595 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017....
2025-12-02 20:55:34,442 | DEBUG | app.services.transcribe | Received transcript chunk: transponder 05....
2025-12-02 20:55:36,974 | DEBUG | app.services.transcribe | Received transcript chunk: lo daremos vía Alpha...
2025-12-02 20:55:38,288 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre India...
2025-12-02 20:55:38,333 | INFO | app.services.transcribe | Transcription complete. Length: 96
2025-12-02 20:55:38,334 | INFO | app.controllers.audio | Transcripción recibida session=a3b93282-8c1e-40d4-91df-60b93bcc8f24: QNH 1017. transponder 05. lo daremos vía Alpha Charlie al puntode espera. Alfa Noviembre India.
2025-12-02 20:55:38,335 | INFO | app.logs.transcript | student | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | text=QNH 1017. transponder 05. lo daremos vía Alpha Charlie al puntode espera. Alfa Noviembre India.
2025-12-02 20:55:38,497 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:55:38,498 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:55:38,499 | INFO | sqlalchemy.engine.Engine | [cached since 575.3s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:55:38,523 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:55:42,268 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:55:42,270 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:55:42,271 | INFO | sqlalchemy.engine.Engine | [cached since 579.1s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:55:42,292 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:55:42,294 | INFO | sqlalchemy.engine.Engine | [cached since 576.8s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (18759 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 55, 42, 292317, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:55:42,321 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:55:42,361 | INFO | app.controllers.audio | Intent detector frequency mismatch session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 detected=tower scenario=ground
2025-12-02 20:55:42,363 | INFO | app.controllers.audio | Fase activa session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback intent=tower_departure_instructions freq=ground
2025-12-02 20:55:42,365 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_departure_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: tower_departure_instructions
Transcripción textual del alumno:
QNH 1017. transponder 05. lo daremos vía Alpha Charlie al puntode espera. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colac...
2025-12-02 20:55:53,956 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_departure_instructions intento=1: {
  "intent": "tower_departure_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Errores críticos en la colación: código transponder incorrecto (debería ser 0502), pista asignada omitida (uno cero), y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.",
  "confidence": 0.85,
  "score": 30,
  "metadata": {
    "missingItems": [
      "Código transpond...
2025-12-02 20:55:54,129 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:55:54,131 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:55:54,132 | INFO | sqlalchemy.engine.Engine | [cached since 590.9s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:55:54,156 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:55:54,160 | INFO | sqlalchemy.engine.Engine | [cached since 588.7s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (20326 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 55, 54, 156958, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:55:54,183 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:55:54,238 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:55:54,240 | INFO | sqlalchemy.engine.Engine | [cached since 574.3s ago] (UUID('9108e4a5-97f9-442d-a7af-7b585e841e22'), UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'), 6, 'ground_readback', 30.0, "Errores críticos en la colación: código transponder incorrecto (debería ser 0502), pista asignada omitida (uno cero), y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.")
2025-12-02 20:55:54,255 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:55:54,305 | INFO | app.controllers.audio | Puntuación guardada session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback score=30.00
2025-12-02 20:55:54,306 | INFO | app.logs.transcript | controller | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | intent=tower_departure_instructions | phase=ground_readback | allow_response=False | text=
2025-12-02 20:56:44,284 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:56:44,285 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 20:56:44,286 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 20:56:44,287 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:56:44,288 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 20:56:44,288 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 20:56:44,289 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:56:44,290 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:56:44,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 20:56:44,292 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:56:44,293 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:56:44,294 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 20:56:44,295 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 20:56:44,295 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:56:44,297 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 20:56:44,297 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 20:56:44,300 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:56:44,302 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:56:44,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 20:56:44,305 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:56:44,306 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 20:56:44,308 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 20:56:44,310 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 20:56:44,310 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:56:44,312 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 20:56:44,313 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 20:56:44,315 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:56:44,318 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 20:56:44,318 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 20:56:44,319 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 20:56:44,321 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 20:56:44,324 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:5840]
2025-12-02 20:56:44,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:56:44,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:56:44,465 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:44,467 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:44,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:44,605 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:44,608 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:44,757 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:56:44,760 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:44,918 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:44,919 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:44,920 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:44,924 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:45,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:45,091 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:45,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:45,299 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:56:45,301 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:45,305 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:45,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:56:45,497 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:45,654 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:45,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:45,659 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:45,663 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:45,806 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:45,808 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:45,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:45,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:45,972 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:45,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:45,978 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:46,148 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:46,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,152 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:46,329 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:46,331 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:46,503 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:46,505 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,507 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,510 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:46,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:46,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,688 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:46,838 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,840 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:46,843 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:46,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:46,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:46,991 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:47,143 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:47,145 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:47,147 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:47,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:56:47,333 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:47,334 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:47,337 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:47,341 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 20:56:47,503 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:47,504 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:47,506 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:47,678 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:56:47,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:47,850 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:47,853 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:47,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:47,861 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 20:56:48,032 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:48,035 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:48,037 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:48,186 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:48,188 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:48,190 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:48,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 20:56:48,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 20:56:48,434 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 20:56:48,435 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 20:56:48,438 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1232]
2025-12-02 20:56:48,439 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 20:56:48,439 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 20:56:48,591 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:56:48,592 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:56:48,593 | INFO | sqlalchemy.engine.Engine | [cached since 916.2s ago] ()
2025-12-02 20:56:48,599 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 20:56:48,600 | INFO | sqlalchemy.engine.Engine | [cached since 788.8s ago] (6,)
2025-12-02 20:56:49,692 | INFO | app.services.transcribe | Starting stream. Total bytes: 1492992. Chunk size: 8192. No throttling.
2025-12-02 20:56:49,696 | DEBUG | app.services.transcribe | Streamed 8192/1492992 bytes
2025-12-02 20:56:49,739 | DEBUG | app.services.transcribe | Streamed 417792/1492992 bytes
2025-12-02 20:56:49,780 | DEBUG | app.services.transcribe | Streamed 827392/1492992 bytes
2025-12-02 20:56:49,819 | DEBUG | app.services.transcribe | Streamed 1236992/1492992 bytes
2025-12-02 20:56:49,839 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 20:56:50,524 | DEBUG | app.services.transcribe | Received transcript chunk: QNH....
2025-12-02 20:56:52,210 | DEBUG | app.services.transcribe | Received transcript chunk: 1017 Transponder 050...
2025-12-02 20:56:53,222 | DEBUG | app.services.transcribe | Received transcript chunk: rodaremos vía Alpha ...
2025-12-02 20:56:53,838 | DEBUG | app.services.transcribe | Received transcript chunk: al.de espera....
2025-12-02 20:56:54,971 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre India...
2025-12-02 20:56:55,005 | INFO | app.services.transcribe | Transcription complete. Length: 93
2025-12-02 20:56:55,007 | INFO | app.controllers.audio | Transcripción recibida session=a3b93282-8c1e-40d4-91df-60b93bcc8f24: QNH. 1017 Transponder 0502. rodaremos vía Alpha Charlie. al.de espera. Alfa Noviembre India.
2025-12-02 20:56:55,008 | INFO | app.logs.transcript | student | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | text=QNH. 1017 Transponder 0502. rodaremos vía Alpha Charlie. al.de espera. Alfa Noviembre India.
2025-12-02 20:56:55,206 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:56:55,207 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:56:55,208 | INFO | sqlalchemy.engine.Engine | [cached since 652s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:56:55,235 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 20:56:57,729 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:56:57,731 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:56:57,735 | INFO | sqlalchemy.engine.Engine | [cached since 654.5s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:56:57,763 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:56:57,764 | INFO | sqlalchemy.engine.Engine | [cached since 652.3s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (20834 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 56, 57, 761219, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:56:57,797 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:56:57,833 | INFO | app.controllers.audio | Fase activa session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 20:56:57,837 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH. 1017 Transponder 0502. rodaremos vía Alpha Charlie. al.de espera. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar r...
2025-12-02 20:57:13,536 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persisten errores en la colación: pista asignada omitida (uno cero) y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.",
  "confidence": 0.85,
  "score": 40,
  "metadata": {
    "missingItems": [
      "Pista asignada (uno cero)",
      "Instrucción de espera ('Llame listo...
2025-12-02 20:57:13,708 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:57:13,709 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 20:57:13,711 | INFO | sqlalchemy.engine.Engine | [cached since 670.5s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 20:57:13,731 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 20:57:13,734 | INFO | sqlalchemy.engine.Engine | [cached since 668.3s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (22218 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 20, 57, 13, 731898, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 20:57:13,765 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:57:13,818 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 20:57:13,819 | INFO | sqlalchemy.engine.Engine | [cached since 653.9s ago] (UUID('bee1c883-399a-47bd-b81e-8e25d67a9859'), UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'), 6, 'ground_readback', 40.0, "Persisten errores en la colación: pista asignada omitida (uno cero) y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.")
2025-12-02 20:57:13,843 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:57:13,888 | INFO | app.controllers.audio | Puntuación guardada session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback score=40.00
2025-12-02 20:57:13,890 | INFO | app.logs.transcript | controller | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-02 20:59:39,595 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 20:59:39,596 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 20:59:39,602 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 20:59:39,603 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 20:59:39,611 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 20:59:39,612 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 20:59:39,618 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 20:59:39,619 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 20:59:39,620 | INFO | sqlalchemy.engine.Engine | [generated in 0.00094s] ()
2025-12-02 20:59:39,627 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 20:59:39,628 | INFO | sqlalchemy.engine.Engine | [generated in 0.00072s] ()
2025-12-02 20:59:39,636 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,637 | INFO | sqlalchemy.engine.Engine | [generated in 0.00143s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,666 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,668 | INFO | sqlalchemy.engine.Engine | [cached since 0.03176s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,674 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,675 | INFO | sqlalchemy.engine.Engine | [cached since 0.0389s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,680 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,681 | INFO | sqlalchemy.engine.Engine | [cached since 0.04531s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,685 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,686 | INFO | sqlalchemy.engine.Engine | [cached since 0.05065s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,690 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,692 | INFO | sqlalchemy.engine.Engine | [cached since 0.05604s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,696 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,697 | INFO | sqlalchemy.engine.Engine | [cached since 0.06197s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,702 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 20:59:39,704 | INFO | sqlalchemy.engine.Engine | [cached since 0.06809s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 20:59:39,716 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:59:39,719 | INFO | sqlalchemy.engine.Engine | [generated in 0.00266s] ('group_role', 'pg_catalog')
2025-12-02 20:59:39,729 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:59:39,730 | INFO | sqlalchemy.engine.Engine | [cached since 0.01393s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 20:59:39,736 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:59:39,738 | INFO | sqlalchemy.engine.Engine | [cached since 0.02172s ago] ('user_status', 'pg_catalog')
2025-12-02 20:59:39,743 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 20:59:39,745 | INFO | sqlalchemy.engine.Engine | [cached since 0.02952s ago] ('account_type', 'pg_catalog')
2025-12-02 20:59:39,750 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 20:59:39,752 | INFO | sqlalchemy.engine.Engine | [generated in 0.00099s] ()
2025-12-02 20:59:39,758 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 20:59:39,759 | INFO | sqlalchemy.engine.Engine | [generated in 0.00105s] ()
2025-12-02 20:59:39,792 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 20:59:39,794 | INFO | sqlalchemy.engine.Engine | [generated in 0.00171s] ()
2025-12-02 20:59:39,902 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 20:59:39,961 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 21:00:22,454 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:00:22,455 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:00:22,457 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:00:22,458 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:00:22,460 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:00:22,461 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:00:22,461 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:00:22,462 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:00:22,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:00:22,465 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:00:22,466 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:00:22,466 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:00:22,467 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:00:22,468 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:00:22,469 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:00:22,471 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:00:22,471 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:00:22,473 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:00:22,474 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:00:22,475 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:00:22,476 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:00:22,477 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:00:22,479 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:00:22,481 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:00:22,482 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:00:22,483 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:00:22,484 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:00:22,484 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:00:22,488 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:00:22,489 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:00:22,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:8192]
2025-12-02 21:00:22,625 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:22,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:22,631 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:22,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:22,802 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:22,807 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:22,959 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:22,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:22,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:22,968 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:00:23,100 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:23,102 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:23,105 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:23,252 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:00:23,253 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:23,255 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:00:23,398 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:23,401 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:23,405 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:23,555 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:23,557 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-02 21:00:23,709 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:23,711 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:23,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:23,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:23,717 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:00:23,869 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:23,872 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:23,876 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:24,074 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:00:24,076 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:24,079 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:00:24,224 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:24,226 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:24,230 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:24,365 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:24,366 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:24,368 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:24,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:24,504 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:24,507 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:24,646 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:24,647 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:24,650 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:24,789 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:00:24,790 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:24,792 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:00:24,925 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:24,928 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:24,930 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:24,932 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:00:25,090 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:00:25,091 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:25,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:00:25,266 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:25,269 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:25,271 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:25,439 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:25,440 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:00:25,443 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:00:25,585 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:00:25,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:00:25,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:00:25,592 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:230]
2025-12-02 21:00:25,593 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:00:25,594 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:00:25,747 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:00:25,750 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:00:25,751 | INFO | sqlalchemy.engine.Engine | [cached since 46.12s ago] ()
2025-12-02 21:00:25,792 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:00:25,793 | INFO | sqlalchemy.engine.Engine | [generated in 0.00110s] (6,)
2025-12-02 21:00:27,385 | INFO | app.services.transcribe | Starting stream. Total bytes: 1239040. Chunk size: 8192. No throttling.
2025-12-02 21:00:27,388 | DEBUG | app.services.transcribe | Streamed 8192/1239040 bytes
2025-12-02 21:00:27,409 | DEBUG | app.services.transcribe | Streamed 417792/1239040 bytes
2025-12-02 21:00:27,436 | DEBUG | app.services.transcribe | Streamed 827392/1239040 bytes
2025-12-02 21:00:27,451 | DEBUG | app.services.transcribe | Streamed 1236992/1239040 bytes
2025-12-02 21:00:27,453 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:00:32,172 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017 Transponder...
2025-12-02 21:00:33,984 | DEBUG | app.services.transcribe | Received transcript chunk: pista Alfa Noviembre...
2025-12-02 21:00:34,050 | INFO | app.services.transcribe | Transcription complete. Length: 96
2025-12-02 21:00:34,051 | INFO | app.controllers.audio | Transcripción recibida session=a3b93282-8c1e-40d4-91df-60b93bcc8f24: QNH 1017 Transponder 0502 rodaremos vía Alpha Charlie al.de espera. pista Alfa Noviembre India.
2025-12-02 21:00:34,052 | INFO | app.logs.transcript | student | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | text=QNH 1017 Transponder 0502 rodaremos vía Alpha Charlie al.de espera. pista Alfa Noviembre India.
2025-12-02 21:00:34,202 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:00:34,204 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:00:34,206 | INFO | sqlalchemy.engine.Engine | [generated in 0.00125s] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:00:34,233 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:00:39,617 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:00:39,618 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:00:39,619 | INFO | sqlalchemy.engine.Engine | [cached since 5.415s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:00:39,653 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:00:39,654 | INFO | sqlalchemy.engine.Engine | [generated in 0.00825s] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (22729 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 0, 39, 652594, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 21:00:39,684 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:00:39,717 | INFO | app.controllers.audio | Fase activa session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 21:00:39,722 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH 1017 Transponder 0502 rodaremos vía Alpha Charlie al.de espera. pista Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colaciona...
2025-12-02 21:00:50,531 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Errores repetidos en la colación: pista asignada incorrecta (debería ser 'uno cero', no 'Alfa Noviembre India') y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.",
  "confidence": 0.85,
  "score": 40,
  "metadata": {
    "missingItems": [
      "Pista asignada correcta",
...
2025-12-02 21:00:50,900 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:00:50,904 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:00:50,905 | INFO | sqlalchemy.engine.Engine | [cached since 16.7s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:00:50,942 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:00:50,944 | INFO | sqlalchemy.engine.Engine | [cached since 11.3s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (24217 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 0, 50, 941045, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 21:00:50,967 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:00:51,017 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:00:51,019 | INFO | sqlalchemy.engine.Engine | [generated in 0.00163s] (UUID('98122cca-6c0b-467b-861c-d23e55fc85f8'), UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'), 6, 'ground_readback', 40.0, "Errores repetidos en la colación: pista asignada incorrecta (debería ser 'uno cero', no 'Alfa Noviembre India') y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.")
2025-12-02 21:00:51,038 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:00:51,089 | INFO | app.controllers.audio | Puntuación guardada session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback score=40.00
2025-12-02 21:00:51,091 | INFO | app.logs.transcript | controller | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-02 21:02:07,931 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:02:07,932 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:02:07,933 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:02:07,934 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:02:07,934 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:02:07,936 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:02:07,936 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:02:07,937 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:02:07,938 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:02:07,940 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:02:07,941 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:02:07,942 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:02:07,943 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:02:07,943 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:02:07,944 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:02:07,944 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:02:07,947 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:02:07,948 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:02:07,949 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:02:07,950 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:02:07,951 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:02:07,953 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:02:07,955 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:02:07,957 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:02:07,958 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:02:07,960 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:02:07,962 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:02:07,963 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:02:07,964 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:02:07,965 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:02:07,967 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:02:07,969 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 21:02:07,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 21:02:08,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:08,096 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:08,098 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:02:08,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:08,230 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:08,233 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:08,234 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:08,410 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:08,412 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:08,414 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:08,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:08,622 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:08,624 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:08,627 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:02:08,808 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:02:08,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:08,814 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:02:08,990 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:02:08,992 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:08,994 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:08,997 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:09,138 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,141 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,146 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,149 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,153 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:02:09,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:09,301 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:09,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:09,459 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:09,462 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:02:09,640 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:09,644 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:02:09,844 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:09,846 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:09,849 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:09,851 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:10,058 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:10,061 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:02:10,064 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:10,290 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:10,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:10,296 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:02:10,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:10,590 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:10,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:10,596 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:10,899 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:10,904 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:10,907 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:10,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:02:11,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:11,300 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:11,303 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:02:11,487 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:11,490 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:11,493 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:11,496 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:11,653 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:11,655 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:11,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:11,659 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:11,847 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:02:11,848 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:02:11,851 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:12,015 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:12,019 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:02:12,023 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:02:12,027 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:02:12,146 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:02:12,150 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:875]
2025-12-02 21:02:12,151 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:02:12,151 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:02:12,347 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:02:12,349 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:02:12,351 | INFO | sqlalchemy.engine.Engine | [cached since 152.7s ago] ()
2025-12-02 21:02:12,364 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:02:12,367 | INFO | sqlalchemy.engine.Engine | [cached since 106.6s ago] (6,)
2025-12-02 21:02:13,417 | INFO | app.services.transcribe | Starting stream. Total bytes: 1275904. Chunk size: 8192. No throttling.
2025-12-02 21:02:13,421 | DEBUG | app.services.transcribe | Streamed 8192/1275904 bytes
2025-12-02 21:02:13,476 | DEBUG | app.services.transcribe | Streamed 417792/1275904 bytes
2025-12-02 21:02:13,527 | DEBUG | app.services.transcribe | Streamed 827392/1275904 bytes
2025-12-02 21:02:13,575 | DEBUG | app.services.transcribe | Streamed 1236992/1275904 bytes
2025-12-02 21:02:13,579 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:02:16,348 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 1017 Transponder...
2025-12-02 21:02:18,623 | DEBUG | app.services.transcribe | Received transcript chunk: lo daremos vía Alpha...
2025-12-02 21:02:19,698 | DEBUG | app.services.transcribe | Received transcript chunk: pista....
2025-12-02 21:02:20,447 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre India...
2025-12-02 21:02:20,484 | INFO | app.services.transcribe | Transcription complete. Length: 99
2025-12-02 21:02:20,484 | INFO | app.controllers.audio | Transcripción recibida session=a3b93282-8c1e-40d4-91df-60b93bcc8f24: QNH 1017 Transponder 0502. lo daremos vía Alpha Charlie al.de espera. pista. Alfa Noviembre India.
2025-12-02 21:02:20,486 | INFO | app.logs.transcript | student | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | text=QNH 1017 Transponder 0502. lo daremos vía Alpha Charlie al.de espera. pista. Alfa Noviembre India.
2025-12-02 21:02:20,830 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:02:20,833 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:02:20,834 | INFO | sqlalchemy.engine.Engine | [cached since 106.6s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:02:20,870 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:02:32,748 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:02:32,750 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:02:32,752 | INFO | sqlalchemy.engine.Engine | [cached since 118.5s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:02:32,767 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:02:32,767 | INFO | sqlalchemy.engine.Engine | [cached since 113.1s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (24734 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 2, 32, 766357, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 21:02:32,792 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:02:32,826 | INFO | app.controllers.audio | Intent detector frequency mismatch session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 detected=tower scenario=ground
2025-12-02 21:02:32,828 | INFO | app.controllers.audio | Fase activa session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback intent=tower_departure_instructions freq=ground
2025-12-02 21:02:32,832 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_departure_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: tower_departure_instructions
Transcripción textual del alumno:
QNH 1017 Transponder 0502. lo daremos vía Alpha Charlie al.de espera. pista. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Co...
2025-12-02 21:02:44,685 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_departure_instructions intento=1: {
  "intent": "tower_departure_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Errores críticos en la colación: pista asignada incorrecta (debe ser 'uno cero', no 'Alfa Noviembre India') y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.",
  "confidence": 0.89,
  "score": 35,
  "metadata": {
    "missingItems": [
      "Pista asignada correcta",
...
2025-12-02 21:02:44,836 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:02:44,838 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:02:44,838 | INFO | sqlalchemy.engine.Engine | [cached since 130.6s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:02:44,853 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:02:44,855 | INFO | sqlalchemy.engine.Engine | [cached since 125.2s ago] ('{"meteo": {"qnh": "1017", "vis": ">10km", "dewp": "20", "temp": "21", "wind": "290/3", "cloudBase": "300", "condition": "VMC", "windSpeed": "3", "clo ... (26217 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0502", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 2, 44, 853678, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('b52317b9-1f62-4922-bf32-f327f228ada3'))
2025-12-02 21:02:44,880 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:02:44,915 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:02:44,916 | INFO | sqlalchemy.engine.Engine | [cached since 113.9s ago] (UUID('3181e16a-ba28-4e90-9e41-6c42ba086bd5'), UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'), 6, 'ground_readback', 35.0, "Errores críticos en la colación: pista asignada incorrecta (debe ser 'uno cero', no 'Alfa Noviembre India') y falta la instrucción de espera ('Llame listo'). Corrija: 'QNH 1017, transponder 0502, rodaremos vía Alfa Charlie al punto de espera pista uno cero. Llamaré listo'.")
2025-12-02 21:02:44,935 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:02:44,972 | INFO | app.controllers.audio | Puntuación guardada session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 phase_id=ground_readback score=35.00
2025-12-02 21:02:44,973 | INFO | app.logs.transcript | controller | session=a3b93282-8c1e-40d4-91df-60b93bcc8f24 | frequency=121.700 | intent=tower_departure_instructions | phase=ground_readback | allow_response=False | text=
2025-12-02 21:04:14,497 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 21:04:14,498 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:04:14,506 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 21:04:14,507 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:04:14,519 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 21:04:14,519 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:04:14,527 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:04:14,529 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 21:04:14,531 | INFO | sqlalchemy.engine.Engine | [generated in 0.00129s] ()
2025-12-02 21:04:14,542 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:04:14,543 | INFO | sqlalchemy.engine.Engine | [generated in 0.00191s] ()
2025-12-02 21:04:14,556 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,557 | INFO | sqlalchemy.engine.Engine | [generated in 0.00140s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,582 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,582 | INFO | sqlalchemy.engine.Engine | [cached since 0.02664s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,587 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,589 | INFO | sqlalchemy.engine.Engine | [cached since 0.03252s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,593 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,595 | INFO | sqlalchemy.engine.Engine | [cached since 0.0389s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,603 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,604 | INFO | sqlalchemy.engine.Engine | [cached since 0.04837s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,610 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,611 | INFO | sqlalchemy.engine.Engine | [cached since 0.05501s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,619 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,620 | INFO | sqlalchemy.engine.Engine | [cached since 0.06366s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,624 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:04:14,625 | INFO | sqlalchemy.engine.Engine | [cached since 0.06874s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:04:14,631 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:04:14,631 | INFO | sqlalchemy.engine.Engine | [generated in 0.00102s] ('group_role', 'pg_catalog')
2025-12-02 21:04:14,639 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:04:14,641 | INFO | sqlalchemy.engine.Engine | [cached since 0.00948s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 21:04:14,645 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:04:14,646 | INFO | sqlalchemy.engine.Engine | [cached since 0.01491s ago] ('user_status', 'pg_catalog')
2025-12-02 21:04:14,651 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:04:14,652 | INFO | sqlalchemy.engine.Engine | [cached since 0.02132s ago] ('account_type', 'pg_catalog')
2025-12-02 21:04:14,657 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 21:04:14,659 | INFO | sqlalchemy.engine.Engine | [generated in 0.00144s] ()
2025-12-02 21:04:14,669 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 21:04:14,670 | INFO | sqlalchemy.engine.Engine | [generated in 0.00166s] ()
2025-12-02 21:04:14,692 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 21:04:14,692 | INFO | sqlalchemy.engine.Engine | [generated in 0.00131s] ()
2025-12-02 21:04:14,790 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:04:14,840 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 21:04:31,142 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:04:31,145 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:04:31,146 | INFO | sqlalchemy.engine.Engine | [cached since 16.6s ago] ()
2025-12-02 21:04:31,210 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 21:04:31,211 | INFO | sqlalchemy.engine.Engine | [generated in 0.00122s] ('usuariotest@gmail.com',)
2025-12-02 21:04:31,440 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:04:35,290 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:04:35,291 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:04:35,293 | INFO | sqlalchemy.engine.Engine | [cached since 20.75s ago] ()
2025-12-02 21:04:35,301 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:04:35,303 | INFO | sqlalchemy.engine.Engine | [generated in 0.00141s] (6,)
2025-12-02 21:04:35,404 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:04:36,729 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:04:36,730 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:04:36,730 | INFO | sqlalchemy.engine.Engine | [cached since 22.19s ago] ()
2025-12-02 21:04:36,740 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:04:36,742 | INFO | sqlalchemy.engine.Engine | [cached since 1.44s ago] (6,)
2025-12-02 21:04:36,751 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:04:36,755 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:04:36,757 | INFO | sqlalchemy.engine.Engine | [cached since 22.22s ago] ()
2025-12-02 21:04:36,770 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:04:36,774 | INFO | sqlalchemy.engine.Engine | [cached since 1.472s ago] (6,)
2025-12-02 21:04:36,901 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:04:36,903 | INFO | sqlalchemy.engine.Engine | [cached since 1.603s ago] (6,)
2025-12-02 21:04:36,908 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:04:36,910 | INFO | sqlalchemy.engine.Engine | [cached since 1.609s ago] (6,)
2025-12-02 21:04:36,919 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:04:36,920 | INFO | sqlalchemy.engine.Engine | [generated in 0.00227s] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:04:36,930 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:04:36,931 | INFO | sqlalchemy.engine.Engine | [generated in 0.00128s] ('scenario_id', 'session_completed', 6)
2025-12-02 21:04:36,972 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:04:36,978 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:04:40,651 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:04:40,653 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:04:40,658 | INFO | sqlalchemy.engine.Engine | [cached since 26.12s ago] ()
2025-12-02 21:04:40,677 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:04:40,680 | INFO | sqlalchemy.engine.Engine | [cached since 5.378s ago] (6,)
2025-12-02 21:04:40,886 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:04:40,888 | INFO | sqlalchemy.engine.Engine | [generated in 0.00218s] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:04:40,923 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:04:40,928 | INFO | sqlalchemy.engine.Engine | [cached since 5.626s ago] (6,)
2025-12-02 21:04:40,938 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:05:06,510 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:05:06,511 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:05:06,512 | INFO | sqlalchemy.engine.Engine | [cached since 51.97s ago] ()
2025-12-02 21:05:06,520 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:05:06,521 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:05:06,523 | INFO | sqlalchemy.engine.Engine | [cached since 51.98s ago] ()
2025-12-02 21:05:06,528 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:05:06,531 | INFO | sqlalchemy.engine.Engine | [cached since 31.23s ago] (6,)
2025-12-02 21:05:06,543 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:05:06,544 | INFO | sqlalchemy.engine.Engine | [cached since 31.24s ago] (6,)
2025-12-02 21:05:06,667 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:05:06,668 | INFO | sqlalchemy.engine.Engine | [cached since 31.37s ago] (6,)
2025-12-02 21:05:06,672 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:05:06,673 | INFO | sqlalchemy.engine.Engine | [cached since 31.37s ago] (6,)
2025-12-02 21:05:06,677 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:05:06,678 | INFO | sqlalchemy.engine.Engine | [cached since 29.76s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:05:06,681 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:05:06,682 | INFO | sqlalchemy.engine.Engine | [cached since 29.75s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:05:06,700 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:05:06,704 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:06:24,082 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 21:06:24,083 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:06:24,090 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 21:06:24,091 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:06:24,102 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 21:06:24,102 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:06:24,109 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:06:24,111 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 21:06:24,111 | INFO | sqlalchemy.engine.Engine | [generated in 0.00102s] ()
2025-12-02 21:06:24,119 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:06:24,119 | INFO | sqlalchemy.engine.Engine | [generated in 0.00073s] ()
2025-12-02 21:06:24,128 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,129 | INFO | sqlalchemy.engine.Engine | [generated in 0.00104s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,163 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,164 | INFO | sqlalchemy.engine.Engine | [cached since 0.03583s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,168 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,169 | INFO | sqlalchemy.engine.Engine | [cached since 0.04132s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,172 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,174 | INFO | sqlalchemy.engine.Engine | [cached since 0.04617s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,179 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,179 | INFO | sqlalchemy.engine.Engine | [cached since 0.05167s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,184 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,185 | INFO | sqlalchemy.engine.Engine | [cached since 0.05701s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,191 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,193 | INFO | sqlalchemy.engine.Engine | [cached since 0.06523s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,198 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:06:24,199 | INFO | sqlalchemy.engine.Engine | [cached since 0.07231s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:06:24,210 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:06:24,212 | INFO | sqlalchemy.engine.Engine | [generated in 0.00196s] ('group_role', 'pg_catalog')
2025-12-02 21:06:24,222 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:06:24,222 | INFO | sqlalchemy.engine.Engine | [cached since 0.01288s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 21:06:24,228 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:06:24,229 | INFO | sqlalchemy.engine.Engine | [cached since 0.01949s ago] ('user_status', 'pg_catalog')
2025-12-02 21:06:24,233 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:06:24,234 | INFO | sqlalchemy.engine.Engine | [cached since 0.02451s ago] ('account_type', 'pg_catalog')
2025-12-02 21:06:24,238 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 21:06:24,239 | INFO | sqlalchemy.engine.Engine | [generated in 0.00132s] ()
2025-12-02 21:06:24,246 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 21:06:24,246 | INFO | sqlalchemy.engine.Engine | [generated in 0.00067s] ()
2025-12-02 21:06:24,270 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 21:06:24,272 | INFO | sqlalchemy.engine.Engine | [generated in 0.00157s] ()
2025-12-02 21:06:24,394 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:06:24,445 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 21:06:38,123 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:06:38,126 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:06:38,127 | INFO | sqlalchemy.engine.Engine | [cached since 14.01s ago] ()
2025-12-02 21:06:38,177 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:06:38,179 | INFO | sqlalchemy.engine.Engine | [generated in 0.00144s] (6,)
2025-12-02 21:06:38,308 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:06:38,309 | INFO | sqlalchemy.engine.Engine | [generated in 0.00087s] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:06:38,327 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:06:38,330 | INFO | sqlalchemy.engine.Engine | [cached since 0.1521s ago] (6,)
2025-12-02 21:06:38,336 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:06:57,177 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:06:57,179 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:06:57,180 | INFO | sqlalchemy.engine.Engine | [cached since 33.06s ago] ()
2025-12-02 21:06:57,197 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:06:57,199 | INFO | sqlalchemy.engine.Engine | [cached since 19.02s ago] (6,)
2025-12-02 21:06:57,212 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:06:57,214 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:06:57,217 | INFO | sqlalchemy.engine.Engine | [cached since 33.1s ago] ()
2025-12-02 21:06:57,233 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:06:57,236 | INFO | sqlalchemy.engine.Engine | [cached since 19.06s ago] (6,)
2025-12-02 21:06:57,375 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:06:57,377 | INFO | sqlalchemy.engine.Engine | [cached since 19.2s ago] (6,)
2025-12-02 21:06:57,380 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:06:57,382 | INFO | sqlalchemy.engine.Engine | [cached since 19.2s ago] (6,)
2025-12-02 21:06:57,389 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:06:57,390 | INFO | sqlalchemy.engine.Engine | [generated in 0.00225s] ('scenario_id', 'session_completed', 6)
2025-12-02 21:06:57,398 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:06:57,400 | INFO | sqlalchemy.engine.Engine | [generated in 0.00139s] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:06:57,420 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:06:57,436 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:07:03,782 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:07:03,783 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:07:03,784 | INFO | sqlalchemy.engine.Engine | [cached since 39.67s ago] ()
2025-12-02 21:07:03,793 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:07:03,796 | INFO | sqlalchemy.engine.Engine | [cached since 25.62s ago] (6,)
2025-12-02 21:07:03,900 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:07:03,902 | INFO | sqlalchemy.engine.Engine | [cached since 25.59s ago] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:07:03,929 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-02 21:07:03,930 | INFO | sqlalchemy.engine.Engine | [generated in 0.00098s] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:07:03,956 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:07:03,958 | INFO | sqlalchemy.engine.Engine | [generated in 0.00119s] (UUID('a3b93282-8c1e-40d4-91df-60b93bcc8f24'),)
2025-12-02 21:07:03,967 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:07:04,471 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:07:04,473 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:07:04,475 | INFO | sqlalchemy.engine.Engine | [cached since 40.36s ago] ()
2025-12-02 21:07:04,491 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:07:04,495 | INFO | sqlalchemy.engine.Engine | [cached since 26.32s ago] (6,)
2025-12-02 21:07:04,498 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:07:04,500 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:07:04,503 | INFO | sqlalchemy.engine.Engine | [cached since 40.38s ago] ()
2025-12-02 21:07:04,515 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:07:04,520 | INFO | sqlalchemy.engine.Engine | [cached since 26.34s ago] (6,)
2025-12-02 21:07:04,673 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:07:04,674 | INFO | sqlalchemy.engine.Engine | [cached since 26.5s ago] (6,)
2025-12-02 21:07:04,678 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:07:04,680 | INFO | sqlalchemy.engine.Engine | [cached since 26.5s ago] (6,)
2025-12-02 21:07:04,687 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:07:04,689 | INFO | sqlalchemy.engine.Engine | [cached since 7.29s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:07:04,695 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:07:04,697 | INFO | sqlalchemy.engine.Engine | [cached since 7.308s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:07:04,718 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:07:04,721 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:08:08,408 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 21:08:08,409 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:08:08,419 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 21:08:08,420 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:08:08,431 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 21:08:08,431 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:08:08,442 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:08:08,446 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 21:08:08,448 | INFO | sqlalchemy.engine.Engine | [generated in 0.00181s] ()
2025-12-02 21:08:08,461 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:08:08,463 | INFO | sqlalchemy.engine.Engine | [generated in 0.00260s] ()
2025-12-02 21:08:08,481 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,484 | INFO | sqlalchemy.engine.Engine | [generated in 0.00248s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,557 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,558 | INFO | sqlalchemy.engine.Engine | [cached since 0.07734s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,564 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,567 | INFO | sqlalchemy.engine.Engine | [cached since 0.08642s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,575 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,577 | INFO | sqlalchemy.engine.Engine | [cached since 0.09641s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,584 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,585 | INFO | sqlalchemy.engine.Engine | [cached since 0.1043s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,591 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,593 | INFO | sqlalchemy.engine.Engine | [cached since 0.1115s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,597 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,599 | INFO | sqlalchemy.engine.Engine | [cached since 0.1177s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,603 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:08:08,604 | INFO | sqlalchemy.engine.Engine | [cached since 0.1234s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:08:08,614 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:08:08,617 | INFO | sqlalchemy.engine.Engine | [generated in 0.00329s] ('group_role', 'pg_catalog')
2025-12-02 21:08:08,627 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:08:08,628 | INFO | sqlalchemy.engine.Engine | [cached since 0.01427s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 21:08:08,633 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:08:08,634 | INFO | sqlalchemy.engine.Engine | [cached since 0.01988s ago] ('user_status', 'pg_catalog')
2025-12-02 21:08:08,639 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:08:08,640 | INFO | sqlalchemy.engine.Engine | [cached since 0.02656s ago] ('account_type', 'pg_catalog')
2025-12-02 21:08:08,646 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 21:08:08,647 | INFO | sqlalchemy.engine.Engine | [generated in 0.00158s] ()
2025-12-02 21:08:08,659 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 21:08:08,660 | INFO | sqlalchemy.engine.Engine | [generated in 0.00118s] ()
2025-12-02 21:08:08,684 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 21:08:08,685 | INFO | sqlalchemy.engine.Engine | [generated in 0.00137s] ()
2025-12-02 21:08:08,780 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:08:08,831 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 21:08:17,543 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 21:08:17,684 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001BA5264E190>
2025-12-02 21:08:17,686 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x000001BA5259BBF0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 21:08:17,805 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001BA520F6090>
2025-12-02 21:08:17,806 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 21:08:17,807 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 21:08:17,809 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 21:08:17,810 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 21:08:17,811 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 21:08:17,916 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 03:08:18 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'502'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1f6-JMQmg/jiI+z4im4LtZdgaA2+X04"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T030818Z-1654ff75797kk9hrhC1MIAp1180000002z2g000000005wb9'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-02 21:08:17,918 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 21:08:17,920 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 21:08:17,921 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 21:08:17,923 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 21:08:17,926 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 21:08:17,931 | DEBUG | httpcore.connection | close.started
2025-12-02 21:08:17,933 | DEBUG | httpcore.connection | close.complete
2025-12-02 21:08:24,689 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 21:08:24,746 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001BA5265D390>
2025-12-02 21:08:24,746 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x000001BA5259BF50> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 21:08:24,859 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001BA5265D2D0>
2025-12-02 21:08:24,860 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 21:08:24,863 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 21:08:24,864 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 21:08:24,865 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 21:08:24,867 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 21:08:24,920 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 03:08:25 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'502'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1f6-JMQmg/jiI+z4im4LtZdgaA2+X04"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T030825Z-1654ff75797x2v2dhC1MIAwxdw00000014c0000000009azs'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_HIT'), (b'X-Cache-Info', b'L1_T2'), (b'Accept-Ranges', b'bytes')])
2025-12-02 21:08:24,922 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 21:08:24,924 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 21:08:24,927 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 21:08:24,929 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 21:08:24,930 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 21:08:24,933 | DEBUG | httpcore.connection | close.started
2025-12-02 21:08:24,935 | DEBUG | httpcore.connection | close.complete
2025-12-02 21:08:55,993 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:08:55,994 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:08:55,996 | INFO | sqlalchemy.engine.Engine | [cached since 47.54s ago] ()
2025-12-02 21:08:56,032 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:08:56,033 | INFO | sqlalchemy.engine.Engine | [generated in 0.00182s] (6,)
2025-12-02 21:08:56,164 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-02 21:08:56,164 | INFO | sqlalchemy.engine.Engine | [generated in 0.00767s] (UUID('8ff77919-1fe4-4192-861c-af2ddfbca2c2'), UUID('0d768209-f297-4b46-ad69-e702b333376b'), 6, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": "10km", "qnh": "983", "windDirection": "020", "windSpeed": "2", "temp": "-18", "dewp": "-17", "cloudCover": "SCT", "cloudBase": "2000", "wind": "020/2"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 2, 21, 8, 56, 164461, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 2, 21, 8, 56, 164461, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-02 21:08:56,182 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:08:56,431 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:08:56,436 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-02 21:08:56,437 | INFO | sqlalchemy.engine.Engine | [generated in 0.00132s] (UUID('8ff77919-1fe4-4192-861c-af2ddfbca2c2'),)
2025-12-02 21:08:56,465 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:09:54,826 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:09:54,828 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:09:54,830 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:09:54,831 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:09:54,834 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:09:54,835 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:09:54,836 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:09:54,837 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:09:54,838 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:09:54,840 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:09:54,840 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:09:54,841 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:09:54,841 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:09:54,842 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:09:54,843 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:09:54,844 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:09:54,846 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:09:54,847 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:09:54,848 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:09:54,849 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:09:54,850 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:09:54,851 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:09:54,852 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:09:54,853 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:09:54,854 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:09:54,854 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:09:54,856 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:09:54,857 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:09:54,858 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:09:54,860 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:09:54,860 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:09:54,861 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 21:09:54,866 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 21:09:55,203 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:55,205 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:55,208 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:09:55,461 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:55,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:55,625 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:09:55,734 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:55,737 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:55,740 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:55,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:09:55,962 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:55,963 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:55,967 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:09:56,290 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:56,292 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:56,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:56,298 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:09:56,587 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:56,590 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 21:09:56,849 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:56,851 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:56,853 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:09:57,038 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:57,040 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:57,042 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:57,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:09:57,262 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:57,264 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:57,268 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:09:57,487 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:57,488 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:57,492 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:57,496 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:09:57,837 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:57,839 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:57,842 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:09:58,037 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:58,042 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:58,044 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:09:58,241 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:58,245 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:58,254 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:58,257 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:09:58,524 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:58,528 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:58,531 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:09:58,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:58,748 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:58,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:58,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:09:58,933 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:58,936 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:58,940 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:09:59,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:59,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:59,114 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:09:59,340 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:59,343 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:09:59,344 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:09:59,621 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:59,624 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:59,626 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:59,628 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:09:59,631 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:09:59,903 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:09:59,907 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:10:00,092 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:10:00,093 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:10:00,095 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:10:00,273 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:10:00,276 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:10:00,278 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:10:00,456 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:10:00,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:10:00,462 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:10:00,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:10:00,878 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:10:00,883 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:10:00,885 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:10:01,577 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:10:01,581 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:10:01,584 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:10:01,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2807]
2025-12-02 21:10:01,748 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:10:01,748 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:10:01,917 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:10:01,918 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:10:01,919 | INFO | sqlalchemy.engine.Engine | [cached since 113.5s ago] ()
2025-12-02 21:10:01,932 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:10:01,933 | INFO | sqlalchemy.engine.Engine | [cached since 65.9s ago] (6,)
2025-12-02 21:10:03,440 | INFO | app.services.transcribe | Starting stream. Total bytes: 1531904. Chunk size: 8192. No throttling.
2025-12-02 21:10:03,444 | DEBUG | app.services.transcribe | Streamed 8192/1531904 bytes
2025-12-02 21:10:03,463 | DEBUG | app.services.transcribe | Streamed 417792/1531904 bytes
2025-12-02 21:10:03,487 | DEBUG | app.services.transcribe | Streamed 827392/1531904 bytes
2025-12-02 21:10:03,511 | DEBUG | app.services.transcribe | Streamed 1236992/1531904 bytes
2025-12-02 21:10:03,521 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:10:12,046 | DEBUG | app.services.transcribe | Received transcript chunk: superficie Alfa Novi...
2025-12-02 21:10:12,220 | INFO | app.services.transcribe | Transcription complete. Length: 183
2025-12-02 21:10:12,222 | INFO | app.controllers.audio | Transcripción recibida session=0d768209-f297-4b46-ad69-e702b333376b: superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía pasogo nivel 7000 pies, dos almas a bordo, autonomía cinco horas.
2025-12-02 21:10:12,223 | INFO | app.logs.transcript | student | session=0d768209-f297-4b46-ad69-e702b333376b | frequency=121.700 | text=superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía pasogo nivel 7000 pies, dos almas a bordo, autonomía cinco horas.
2025-12-02 21:10:12,363 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:10:12,365 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:10:12,366 | INFO | sqlalchemy.engine.Engine | [generated in 0.00142s] (UUID('0d768209-f297-4b46-ad69-e702b333376b'),)
2025-12-02 21:10:12,386 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:10:14,555 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:10:14,558 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:10:14,560 | INFO | sqlalchemy.engine.Engine | [cached since 2.196s ago] (UUID('0d768209-f297-4b46-ad69-e702b333376b'),)
2025-12-02 21:10:14,583 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:10:14,584 | INFO | sqlalchemy.engine.Engine | [generated in 0.00125s] ('{"meteo": {"qnh": "983", "vis": "10km", "dewp": "-17", "temp": "-18", "wind": "020/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cl ... (14635 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-03T03:10:14Z"}]}', datetime.datetime(2025, 12, 2, 21, 10, 14, 583365, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('8ff77919-1fe4-4192-861c-af2ddfbca2c2'))
2025-12-02 21:10:14,609 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:10:14,639 | INFO | app.controllers.audio | Fase activa session=0d768209-f297-4b46-ad69-e702b333376b phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-02 21:10:14,642 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 20 grados 2 nudos. QNH 983. Transponder 0538. Ruede vía Alfa, Charlie al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": str...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie Alfa Noviembre India en plataformas remota tres solicito apertura de plan de vuelo VFR hacia zona Eco vía pasogo nivel 7000 pies, dos almas a bordo, autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubi...
2025-12-02 21:10:26,093 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 20 grados 2 nudos. QNH 983. Transponder 0538. Ruede vía Alfa, Charlie al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "ground_readback",
...
2025-12-02 21:10:26,096 | INFO | app.controllers.audio | Transición automática de fase session=0d768209-f297-4b46-ad69-e702b333376b de=ground_departure_request a=ground_readback
2025-12-02 21:10:26,225 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:10:26,226 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:10:26,227 | INFO | sqlalchemy.engine.Engine | [cached since 13.86s ago] (UUID('0d768209-f297-4b46-ad69-e702b333376b'),)
2025-12-02 21:10:26,245 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:10:26,246 | INFO | sqlalchemy.engine.Engine | [cached since 11.66s ago] ('{"meteo": {"qnh": "983", "vis": "10km", "dewp": "-17", "temp": "-18", "wind": "020/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cl ... (16435 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0538", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 10, 26, 245248, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('8ff77919-1fe4-4192-861c-af2ddfbca2c2'))
2025-12-02 21:10:26,266 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:10:26,295 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:10:26,296 | INFO | sqlalchemy.engine.Engine | [generated in 0.00153s] (UUID('22a16364-98e8-4481-9b23-8a668130fe8c'), UUID('0d768209-f297-4b46-ad69-e702b333376b'), 6, 'ground_readback', 95.0, 'Solicitud completa. Todos los elementos requeridos fueron proporcionados correctamente.')
2025-12-02 21:10:26,313 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:10:26,345 | INFO | app.controllers.audio | Puntuación guardada session=0d768209-f297-4b46-ad69-e702b333376b phase_id=ground_readback score=95.00
2025-12-02 21:10:26,346 | INFO | app.logs.transcript | controller | session=0d768209-f297-4b46-ad69-e702b333376b | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 20 grados 2 nudos. QNH 983. Transponder 0538. Ruede vía Alfa, Charlie al punto de espera pista uno cero. Llame listo.
2025-12-02 21:11:08,159 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:08,160 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:08,161 | INFO | sqlalchemy.engine.Engine | [cached since 179.7s ago] ()
2025-12-02 21:11:08,169 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:08,170 | INFO | sqlalchemy.engine.Engine | [cached since 132.1s ago] (6,)
2025-12-02 21:11:08,172 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:08,174 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:08,175 | INFO | sqlalchemy.engine.Engine | [cached since 179.7s ago] ()
2025-12-02 21:11:08,196 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:08,198 | INFO | sqlalchemy.engine.Engine | [cached since 132.2s ago] (6,)
2025-12-02 21:11:08,243 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:08,244 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:08,245 | INFO | sqlalchemy.engine.Engine | [cached since 179.8s ago] ()
2025-12-02 21:11:08,256 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:08,259 | INFO | sqlalchemy.engine.Engine | [cached since 132.2s ago] (6,)
2025-12-02 21:11:08,305 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:08,306 | INFO | sqlalchemy.engine.Engine | [cached since 132.3s ago] (6,)
2025-12-02 21:11:08,310 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:08,311 | INFO | sqlalchemy.engine.Engine | [cached since 132.3s ago] (6,)
2025-12-02 21:11:08,318 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:11:08,318 | INFO | sqlalchemy.engine.Engine | [generated in 0.00200s] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:11:08,323 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:11:08,326 | INFO | sqlalchemy.engine.Engine | [cached since 0.008467s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:11:08,349 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:08,350 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:08,353 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:08,354 | INFO | sqlalchemy.engine.Engine | [cached since 132.3s ago] (6,)
2025-12-02 21:11:08,363 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:11:08,365 | INFO | sqlalchemy.engine.Engine | [generated in 0.00135s] ('scenario_id', 'session_completed', 6)
2025-12-02 21:11:08,384 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:18,342 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:18,342 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:18,344 | INFO | sqlalchemy.engine.Engine | [cached since 189.9s ago] ()
2025-12-02 21:11:18,356 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:18,359 | INFO | sqlalchemy.engine.Engine | [cached since 142.3s ago] (6,)
2025-12-02 21:11:18,498 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:11:18,499 | INFO | sqlalchemy.engine.Engine | [cached since 66.13s ago] (UUID('0d768209-f297-4b46-ad69-e702b333376b'),)
2025-12-02 21:11:18,528 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-02 21:11:18,529 | INFO | sqlalchemy.engine.Engine | [generated in 0.00094s] (UUID('0d768209-f297-4b46-ad69-e702b333376b'),)
2025-12-02 21:11:18,552 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:11:18,554 | INFO | sqlalchemy.engine.Engine | [generated in 0.00141s] (UUID('0d768209-f297-4b46-ad69-e702b333376b'),)
2025-12-02 21:11:18,561 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:11:18,821 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:18,822 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:18,824 | INFO | sqlalchemy.engine.Engine | [cached since 190.4s ago] ()
2025-12-02 21:11:18,831 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:18,832 | INFO | sqlalchemy.engine.Engine | [cached since 142.8s ago] (6,)
2025-12-02 21:11:18,842 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:18,843 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:18,844 | INFO | sqlalchemy.engine.Engine | [cached since 190.4s ago] ()
2025-12-02 21:11:18,855 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:18,856 | INFO | sqlalchemy.engine.Engine | [cached since 142.8s ago] (6,)
2025-12-02 21:11:18,964 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:18,965 | INFO | sqlalchemy.engine.Engine | [cached since 142.9s ago] (6,)
2025-12-02 21:11:18,968 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:18,969 | INFO | sqlalchemy.engine.Engine | [cached since 142.9s ago] (6,)
2025-12-02 21:11:18,973 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:11:18,975 | INFO | sqlalchemy.engine.Engine | [cached since 10.66s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:11:18,980 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:11:18,983 | INFO | sqlalchemy.engine.Engine | [cached since 10.62s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:11:19,010 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:19,013 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:29,883 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:29,884 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:29,886 | INFO | sqlalchemy.engine.Engine | [cached since 201.4s ago] ()
2025-12-02 21:11:29,894 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:29,895 | INFO | sqlalchemy.engine.Engine | [cached since 153.9s ago] (6,)
2025-12-02 21:11:29,906 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:29,907 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:29,908 | INFO | sqlalchemy.engine.Engine | [cached since 201.4s ago] ()
2025-12-02 21:11:29,917 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:29,917 | INFO | sqlalchemy.engine.Engine | [cached since 153.9s ago] (6,)
2025-12-02 21:11:30,005 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:30,006 | INFO | sqlalchemy.engine.Engine | [cached since 154s ago] (6,)
2025-12-02 21:11:30,009 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:30,010 | INFO | sqlalchemy.engine.Engine | [cached since 154s ago] (6,)
2025-12-02 21:11:30,014 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:11:30,015 | INFO | sqlalchemy.engine.Engine | [cached since 21.7s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:11:30,019 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:11:30,020 | INFO | sqlalchemy.engine.Engine | [cached since 21.66s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:11:30,044 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:30,045 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:35,426 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:35,426 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:35,428 | INFO | sqlalchemy.engine.Engine | [cached since 207s ago] ()
2025-12-02 21:11:35,441 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:35,442 | INFO | sqlalchemy.engine.Engine | [cached since 159.4s ago] (6,)
2025-12-02 21:11:35,585 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:35,586 | INFO | sqlalchemy.engine.Engine | [cached since 159.6s ago] (6,)
2025-12-02 21:11:35,595 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.phase_id = $1::VARCHAR AND ecowhiskey.phase_scores.user_id = $2::INTEGER ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:11:35,596 | INFO | sqlalchemy.engine.Engine | [generated in 0.00189s] ('ground_readback', 6)
2025-12-02 21:11:35,633 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:38,502 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:38,505 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:38,506 | INFO | sqlalchemy.engine.Engine | [cached since 210s ago] ()
2025-12-02 21:11:38,522 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:38,523 | INFO | sqlalchemy.engine.Engine | [cached since 162.5s ago] (6,)
2025-12-02 21:11:38,557 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:38,559 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:38,560 | INFO | sqlalchemy.engine.Engine | [cached since 210.1s ago] ()
2025-12-02 21:11:38,572 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:38,574 | INFO | sqlalchemy.engine.Engine | [cached since 162.5s ago] (6,)
2025-12-02 21:11:38,669 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:38,670 | INFO | sqlalchemy.engine.Engine | [cached since 162.6s ago] (6,)
2025-12-02 21:11:38,675 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:38,676 | INFO | sqlalchemy.engine.Engine | [cached since 162.6s ago] (6,)
2025-12-02 21:11:38,680 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:11:38,680 | INFO | sqlalchemy.engine.Engine | [cached since 30.32s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:11:38,685 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:11:38,686 | INFO | sqlalchemy.engine.Engine | [cached since 30.37s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:11:38,709 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:38,725 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:49,104 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:49,104 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:49,105 | INFO | sqlalchemy.engine.Engine | [cached since 220.6s ago] ()
2025-12-02 21:11:49,115 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:49,116 | INFO | sqlalchemy.engine.Engine | [cached since 173.1s ago] (6,)
2025-12-02 21:11:49,131 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:11:49,133 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:11:49,135 | INFO | sqlalchemy.engine.Engine | [cached since 220.7s ago] ()
2025-12-02 21:11:49,147 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:49,150 | INFO | sqlalchemy.engine.Engine | [cached since 173.1s ago] (6,)
2025-12-02 21:11:49,248 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:49,250 | INFO | sqlalchemy.engine.Engine | [cached since 173.2s ago] (6,)
2025-12-02 21:11:49,253 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:11:49,255 | INFO | sqlalchemy.engine.Engine | [cached since 173.2s ago] (6,)
2025-12-02 21:11:49,258 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:11:49,260 | INFO | sqlalchemy.engine.Engine | [cached since 40.9s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:11:49,264 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:11:49,266 | INFO | sqlalchemy.engine.Engine | [cached since 40.95s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:11:49,284 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:11:49,301 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:12:45,124 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:12:45,125 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:12:45,127 | INFO | sqlalchemy.engine.Engine | [cached since 276.7s ago] ()
2025-12-02 21:12:45,144 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 21:12:45,145 | INFO | sqlalchemy.engine.Engine | [generated in 0.00112s] ('usuariotest@gmail.com',)
2025-12-02 21:12:45,308 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:12:52,723 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:12:52,724 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:12:52,724 | INFO | sqlalchemy.engine.Engine | [cached since 284.3s ago] ()
2025-12-02 21:12:52,730 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:12:52,732 | INFO | sqlalchemy.engine.Engine | [cached since 236.7s ago] (6,)
2025-12-02 21:12:52,829 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:12:54,642 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:12:54,643 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:12:54,645 | INFO | sqlalchemy.engine.Engine | [cached since 286.2s ago] ()
2025-12-02 21:12:54,656 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:12:54,658 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:12:54,660 | INFO | sqlalchemy.engine.Engine | [cached since 286.2s ago] ()
2025-12-02 21:12:54,664 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:12:54,665 | INFO | sqlalchemy.engine.Engine | [cached since 238.6s ago] (6,)
2025-12-02 21:12:54,677 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:12:54,683 | INFO | sqlalchemy.engine.Engine | [cached since 238.7s ago] (6,)
2025-12-02 21:12:54,863 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:12:54,865 | INFO | sqlalchemy.engine.Engine | [cached since 238.8s ago] (6,)
2025-12-02 21:12:54,868 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:12:54,869 | INFO | sqlalchemy.engine.Engine | [cached since 238.8s ago] (6,)
2025-12-02 21:12:54,875 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:12:54,877 | INFO | sqlalchemy.engine.Engine | [cached since 106.5s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:12:54,880 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:12:54,882 | INFO | sqlalchemy.engine.Engine | [cached since 106.6s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:12:54,905 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:12:54,916 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:13:35,711 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 21:13:35,711 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:13:35,718 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 21:13:35,718 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:13:35,725 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 21:13:35,725 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:13:35,732 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:13:35,734 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 21:13:35,735 | INFO | sqlalchemy.engine.Engine | [generated in 0.00132s] ()
2025-12-02 21:13:35,743 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:13:35,744 | INFO | sqlalchemy.engine.Engine | [generated in 0.00102s] ()
2025-12-02 21:13:35,754 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,755 | INFO | sqlalchemy.engine.Engine | [generated in 0.00093s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,795 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,796 | INFO | sqlalchemy.engine.Engine | [cached since 0.04284s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,801 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,803 | INFO | sqlalchemy.engine.Engine | [cached since 0.04943s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,807 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,808 | INFO | sqlalchemy.engine.Engine | [cached since 0.05457s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,813 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,815 | INFO | sqlalchemy.engine.Engine | [cached since 0.06138s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,820 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,821 | INFO | sqlalchemy.engine.Engine | [cached since 0.06797s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,826 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,829 | INFO | sqlalchemy.engine.Engine | [cached since 0.07513s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,834 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:13:35,836 | INFO | sqlalchemy.engine.Engine | [cached since 0.082s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:13:35,844 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:13:35,846 | INFO | sqlalchemy.engine.Engine | [generated in 0.00246s] ('group_role', 'pg_catalog')
2025-12-02 21:13:35,856 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:13:35,857 | INFO | sqlalchemy.engine.Engine | [cached since 0.01338s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 21:13:35,864 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:13:35,865 | INFO | sqlalchemy.engine.Engine | [cached since 0.02158s ago] ('user_status', 'pg_catalog')
2025-12-02 21:13:35,872 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:13:35,873 | INFO | sqlalchemy.engine.Engine | [cached since 0.02955s ago] ('account_type', 'pg_catalog')
2025-12-02 21:13:35,877 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 21:13:35,880 | INFO | sqlalchemy.engine.Engine | [generated in 0.00156s] ()
2025-12-02 21:13:35,887 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 21:13:35,888 | INFO | sqlalchemy.engine.Engine | [generated in 0.00095s] ()
2025-12-02 21:13:35,918 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 21:13:35,921 | INFO | sqlalchemy.engine.Engine | [generated in 0.00269s] ()
2025-12-02 21:13:36,022 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:13:36,086 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 21:13:54,621 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:13:54,623 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:13:54,625 | INFO | sqlalchemy.engine.Engine | [cached since 18.88s ago] ()
2025-12-02 21:13:54,680 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 21:13:54,682 | INFO | sqlalchemy.engine.Engine | [generated in 0.00176s] ('usuariotest@gmail.com',)
2025-12-02 21:13:54,871 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:14:01,076 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:14:01,077 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:14:01,079 | INFO | sqlalchemy.engine.Engine | [cached since 25.34s ago] ()
2025-12-02 21:14:01,096 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:01,098 | INFO | sqlalchemy.engine.Engine | [generated in 0.00211s] (6,)
2025-12-02 21:14:01,309 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:14:03,216 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:14:03,216 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:14:03,217 | INFO | sqlalchemy.engine.Engine | [cached since 27.47s ago] ()
2025-12-02 21:14:03,225 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:03,225 | INFO | sqlalchemy.engine.Engine | [cached since 2.131s ago] (6,)
2025-12-02 21:14:03,256 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:14:03,257 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:14:03,259 | INFO | sqlalchemy.engine.Engine | [cached since 27.52s ago] ()
2025-12-02 21:14:03,267 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:03,269 | INFO | sqlalchemy.engine.Engine | [cached since 2.174s ago] (6,)
2025-12-02 21:14:03,357 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:03,359 | INFO | sqlalchemy.engine.Engine | [cached since 2.264s ago] (6,)
2025-12-02 21:14:03,367 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:14:03,369 | INFO | sqlalchemy.engine.Engine | [generated in 0.00161s] ('scenario_id', 'session_completed', 6)
2025-12-02 21:14:03,371 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:03,373 | INFO | sqlalchemy.engine.Engine | [cached since 2.277s ago] (6,)
2025-12-02 21:14:03,380 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:14:03,381 | INFO | sqlalchemy.engine.Engine | [generated in 0.00152s] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:14:03,390 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:14:03,414 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:14:40,290 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:14:40,292 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:14:40,293 | INFO | sqlalchemy.engine.Engine | [cached since 64.55s ago] ()
2025-12-02 21:14:40,304 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:40,307 | INFO | sqlalchemy.engine.Engine | [cached since 39.21s ago] (6,)
2025-12-02 21:14:40,321 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:14:40,321 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:14:40,323 | INFO | sqlalchemy.engine.Engine | [cached since 64.58s ago] ()
2025-12-02 21:14:40,333 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:40,335 | INFO | sqlalchemy.engine.Engine | [cached since 39.24s ago] (6,)
2025-12-02 21:14:40,448 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:40,449 | INFO | sqlalchemy.engine.Engine | [cached since 39.35s ago] (6,)
2025-12-02 21:14:40,452 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:14:40,453 | INFO | sqlalchemy.engine.Engine | [cached since 39.36s ago] (6,)
2025-12-02 21:14:40,457 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:14:40,457 | INFO | sqlalchemy.engine.Engine | [cached since 37.08s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:14:40,462 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:14:40,464 | INFO | sqlalchemy.engine.Engine | [cached since 37.1s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:14:40,491 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:14:40,494 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:15:13,729 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 21:15:13,882 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002B8E8B02C90>
2025-12-02 21:15:13,883 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x000002B8E8B4ACC0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 21:15:14,015 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002B8E8B12610>
2025-12-02 21:15:14,016 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 21:15:14,019 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 21:15:14,020 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 21:15:14,021 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 21:15:14,021 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 21:15:14,466 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 03:15:15 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'502'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1f6-qzkbCB6dUT6xE5guleX+8dB0P6c"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T031514Z-1654ff757974tq5jhC1MIAc7e80000001dn000000000b4w5'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-02 21:15:14,468 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 21:15:14,470 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 21:15:14,471 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 21:15:14,473 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 21:15:14,475 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 21:15:14,476 | DEBUG | httpcore.connection | close.started
2025-12-02 21:15:14,478 | DEBUG | httpcore.connection | close.complete
2025-12-02 21:15:43,596 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:15:43,598 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:15:43,599 | INFO | sqlalchemy.engine.Engine | [cached since 127.9s ago] ()
2025-12-02 21:15:43,608 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:15:43,610 | INFO | sqlalchemy.engine.Engine | [cached since 102.5s ago] (6,)
2025-12-02 21:15:43,749 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-02 21:15:43,750 | INFO | sqlalchemy.engine.Engine | [generated in 0.00820s] (UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'), UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'), 6, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "VMC", "vis": "3km", "qnh": "982", "windDirection": "030", "windSpeed": "2", "temp": "6", "dewp": "-17", "cloudCover": "SCT", "cloudBase": "2000", "wind": "030/2"}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 2, 21, 15, 43, 749964, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 2, 21, 15, 43, 749964, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-02 21:15:43,766 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:15:44,042 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:15:44,046 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-02 21:15:44,048 | INFO | sqlalchemy.engine.Engine | [generated in 0.00125s] (UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'),)
2025-12-02 21:15:44,076 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:16:16,550 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:16:16,551 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:16:16,552 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:16:16,552 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:16:16,553 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:16:16,555 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:16:16,556 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:16:16,556 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:16:16,557 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:16:16,559 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:16:16,560 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:16:16,561 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:16:16,562 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:16:16,563 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:16:16,563 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:16:16,564 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:16:16,564 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:16:16,566 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:16:16,566 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:16:16,569 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:16:16,570 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:16:16,571 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:16:16,572 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:16:16,573 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:16:16,574 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:16:16,575 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:16:16,576 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:16:16,577 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:16:16,578 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:16:16,579 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:16:16,580 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:16:16,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 21:16:16,584 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 21:16:16,827 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:16,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:16,834 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:17,166 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:17,170 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:17,172 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:17,410 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:17,412 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:17,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:17,642 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:17,645 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:17,648 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:17,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:17,859 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:17,864 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:18,127 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:18,129 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:18,131 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:18,349 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:18,350 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:18,353 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:18,566 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:18,569 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:18,570 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:18,574 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:18,762 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:18,765 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:18,767 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:19,057 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:19,059 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:19,062 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:19,309 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:19,311 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:19,316 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:19,521 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:19,525 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:19,529 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:19,533 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:19,753 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:19,754 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:19,965 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:19,966 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:19,968 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:19,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:20,216 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:20,217 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:20,461 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:20,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:20,464 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:20,468 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:20,677 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:20,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:20,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:20,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:20,975 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:20,977 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:21,567 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:21,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:21,576 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:16:22,186 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:22,189 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:22,193 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:22,564 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:22,566 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:22,570 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:22,815 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:22,816 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:22,818 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:22,820 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:22,823 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:23,065 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:23,069 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:23,071 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:16:23,335 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:23,337 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:23,340 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:16:23,508 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:23,509 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:23,512 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:16:23,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:16:23,681 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:16:23,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:16:23,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:16:23,718 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1097]
2025-12-02 21:16:23,719 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:16:23,720 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:16:23,911 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:16:23,912 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:16:23,913 | INFO | sqlalchemy.engine.Engine | [cached since 168.2s ago] ()
2025-12-02 21:16:23,925 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:16:23,928 | INFO | sqlalchemy.engine.Engine | [cached since 142.8s ago] (6,)
2025-12-02 21:16:25,611 | INFO | app.services.transcribe | Starting stream. Total bytes: 1579008. Chunk size: 8192. No throttling.
2025-12-02 21:16:25,614 | DEBUG | app.services.transcribe | Streamed 8192/1579008 bytes
2025-12-02 21:16:25,641 | DEBUG | app.services.transcribe | Streamed 417792/1579008 bytes
2025-12-02 21:16:25,665 | DEBUG | app.services.transcribe | Streamed 827392/1579008 bytes
2025-12-02 21:16:25,682 | DEBUG | app.services.transcribe | Streamed 1236992/1579008 bytes
2025-12-02 21:16:25,701 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:16:33,774 | DEBUG | app.services.transcribe | Received transcript chunk: superficie alfa novi...
2025-12-02 21:16:33,979 | INFO | app.services.transcribe | Transcription complete. Length: 182
2025-12-02 21:16:33,980 | INFO | app.controllers.audio | Transcripción recibida session=69aaa822-7eea-4f79-a29f-f2746d5b6601: superficie alfa noviembre, India en plataforma remota tres solicitamos apertura de plan de vuelo VFR hacia zona Eco vía Paso Chomgo niveles, dos almas a bordo autonomía cinco horas.
2025-12-02 21:16:33,981 | INFO | app.logs.transcript | student | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | text=superficie alfa noviembre, India en plataforma remota tres solicitamos apertura de plan de vuelo VFR hacia zona Eco vía Paso Chomgo niveles, dos almas a bordo autonomía cinco horas.
2025-12-02 21:16:34,153 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:16:34,155 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:16:34,157 | INFO | sqlalchemy.engine.Engine | [generated in 0.00230s] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:16:34,181 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:16:35,374 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:16:35,377 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:16:35,380 | INFO | sqlalchemy.engine.Engine | [cached since 1.225s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:16:35,404 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:16:35,405 | INFO | sqlalchemy.engine.Engine | [generated in 0.00157s] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (14616 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-03T03:16:35Z"}]}', datetime.datetime(2025, 12, 2, 21, 16, 35, 404260, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:16:35,426 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:16:35,463 | INFO | app.controllers.audio | Fase activa session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-02 21:16:35,467 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 30 grados 2 nudos. QNH 982. Transponder 0561. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": stri...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie alfa noviembre, India en plataforma remota tres solicitamos apertura de plan de vuelo VFR hacia zona Eco vía Paso Chomgo niveles, dos almas a bordo autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubic...
2025-12-02 21:16:50,612 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 30 grados 2 nudos. QNH 982. Transponder 0561. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, altitud, almas y autonomía. Proceda con autorización de rodaje.",
  "confidence": 0.95,
  "sco...
2025-12-02 21:16:50,614 | INFO | app.controllers.audio | Transición automática de fase session=69aaa822-7eea-4f79-a29f-f2746d5b6601 de=ground_departure_request a=ground_readback
2025-12-02 21:16:50,777 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:16:50,778 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:16:50,779 | INFO | sqlalchemy.engine.Engine | [cached since 16.62s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:16:50,799 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:16:50,800 | INFO | sqlalchemy.engine.Engine | [cached since 15.4s ago] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (16100 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0561", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 16, 50, 799146, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:16:50,816 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:16:50,859 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:16:50,861 | INFO | sqlalchemy.engine.Engine | [generated in 0.00309s] (UUID('fee41c80-2d56-4a23-a3a1-9a13042e51cc'), UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'), 6, 'ground_readback', 95.0, 'Solicitud completa. Se incluyeron todos los elementos requeridos: ubicación, destino, ruta, altitud, almas y autonomía. Proceda con autorización de rodaje.')
2025-12-02 21:16:50,881 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:16:50,944 | INFO | app.controllers.audio | Puntuación guardada session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_readback score=95.00
2025-12-02 21:16:50,945 | INFO | app.logs.transcript | controller | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 30 grados 2 nudos. QNH 982. Transponder 0561. Ruede vía Alfa 3, Alfa al punto de espera pista uno cero. Llame listo.
2025-12-02 21:17:33,484 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:17:33,485 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:17:33,487 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:17:33,489 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:17:33,491 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:17:33,492 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:17:33,493 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:17:33,493 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:17:33,494 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:17:33,495 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:17:33,497 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:17:33,497 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:17:33,501 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:17:33,503 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:17:33,504 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:17:33,505 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:17:33,507 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:17:33,508 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:17:33,509 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:17:33,509 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:17:33,510 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:17:33,511 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:17:33,511 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:17:33,513 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:17:33,513 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:17:33,515 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:17:33,515 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:17:33,515 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:17:33,517 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:17:33,518 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:17:33,519 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:17:33,521 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 21:17:33,524 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:17:33,528 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:17:33,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:33,695 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:33,699 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1459]
2025-12-02 21:17:33,702 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-02 21:17:33,703 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:17:33,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:17:33,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:33,921 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:17:34,210 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:34,213 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:34,216 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:34,460 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:17:34,463 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:34,466 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:17:34,638 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:17:34,640 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:34,804 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:34,807 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:34,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:34,812 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:34,815 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:17:34,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:34,991 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:34,993 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:35,158 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:35,159 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,160 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,163 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:17:35,355 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,357 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,360 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,362 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:35,602 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,607 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,610 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,615 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:17:35,803 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:35,804 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:35,807 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:36,018 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:36,019 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:36,022 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:36,025 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:17:36,209 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:36,212 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:36,214 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:36,215 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:17:36,389 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:36,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:36,394 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:36,605 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:17:36,608 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:36,610 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:17:36,849 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:36,852 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:36,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:37,039 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:37,041 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 21:17:37,044 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:17:37,223 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:37,225 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:37,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:37,232 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:37,415 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:37,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:37,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:37,589 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:37,591 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:37,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:37,779 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:37,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:37,785 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:37,789 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:17:38,020 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:17:38,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:17:38,030 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:17:38,134 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3932]
2025-12-02 21:17:38,136 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:17:38,137 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:17:38,323 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:17:38,324 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:17:38,325 | INFO | sqlalchemy.engine.Engine | [cached since 242.6s ago] ()
2025-12-02 21:17:38,334 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:17:38,335 | INFO | sqlalchemy.engine.Engine | [cached since 217.2s ago] (6,)
2025-12-02 21:17:39,401 | INFO | app.services.transcribe | Starting stream. Total bytes: 1361920. Chunk size: 8192. No throttling.
2025-12-02 21:17:39,405 | DEBUG | app.services.transcribe | Streamed 8192/1361920 bytes
2025-12-02 21:17:39,444 | DEBUG | app.services.transcribe | Streamed 417792/1361920 bytes
2025-12-02 21:17:39,483 | DEBUG | app.services.transcribe | Streamed 827392/1361920 bytes
2025-12-02 21:17:39,519 | DEBUG | app.services.transcribe | Streamed 1236992/1361920 bytes
2025-12-02 21:17:39,526 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:17:42,373 | DEBUG | app.services.transcribe | Received transcript chunk: QNH 982 Transponder ...
2025-12-02 21:17:45,783 | DEBUG | app.services.transcribe | Received transcript chunk: rodaremos vía Alfa t...
2025-12-02 21:17:45,924 | INFO | app.services.transcribe | Transcription complete. Length: 76
2025-12-02 21:17:45,925 | INFO | app.controllers.audio | Transcripción recibida session=69aaa822-7eea-4f79-a29f-f2746d5b6601: QNH 982 Transponder 0561. rodaremos vía Alfa tres Alpha Al.de espera pista.
2025-12-02 21:17:45,926 | INFO | app.logs.transcript | student | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | text=QNH 982 Transponder 0561. rodaremos vía Alfa tres Alpha Al.de espera pista.
2025-12-02 21:17:46,099 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:17:46,101 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:17:46,102 | INFO | sqlalchemy.engine.Engine | [cached since 71.95s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:17:46,125 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:17:48,564 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:17:48,565 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:17:48,566 | INFO | sqlalchemy.engine.Engine | [cached since 74.41s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:17:48,596 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:17:48,597 | INFO | sqlalchemy.engine.Engine | [cached since 73.19s ago] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (16589 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0561", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 17, 48, 596694, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:17:48,625 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:17:48,670 | INFO | app.controllers.audio | Fase activa session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 21:17:48,673 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH 982 Transponder 0561. rodaremos vía Alfa tres Alpha Al.de espera pista.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar restricciones (man...
2025-12-02 21:18:01,599 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Falta mencionar la pista asignada (uno cero) y la instrucción 'punto de espera'. La frase 'Al.de espera pista' está incompleta. Corrija: 'rodaremos vía Alfa tres, Alfa al punto de espera pista uno cero'.",
  "confidence": 0.85,
  "score": 60,
  "metadata": {
    "missingItems": [
      "Pista asignada (uno cero)",
      "Instrucción completa 'punto de espera'"
    ]
  }
}
2025-12-02 21:18:01,870 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:18:01,871 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:18:01,874 | INFO | sqlalchemy.engine.Engine | [cached since 87.72s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:18:01,908 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:18:01,910 | INFO | sqlalchemy.engine.Engine | [cached since 86.51s ago] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (17867 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0561", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 18, 1, 908297, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:18:01,932 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:18:01,986 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:18:01,989 | INFO | sqlalchemy.engine.Engine | [cached since 71.13s ago] (UUID('9d1d6151-6f5f-4374-a7ed-58c4f829d83b'), UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'), 6, 'ground_readback', 60.0, "Falta mencionar la pista asignada (uno cero) y la instrucción 'punto de espera'. La frase 'Al.de espera pista' está incompleta. Corrija: 'rodaremos vía Alfa tres, Alfa al punto de espera pista uno cero'.")
2025-12-02 21:18:02,008 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:18:02,054 | INFO | app.controllers.audio | Puntuación guardada session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_readback score=60.00
2025-12-02 21:18:02,056 | INFO | app.logs.transcript | controller | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-02 21:19:38,139 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-12-02 21:19:38,141 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:19:38,151 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-12-02 21:19:38,152 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:19:38,167 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-12-02 21:19:38,168 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-12-02 21:19:38,181 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:19:38,182 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-12-02 21:19:38,186 | INFO | sqlalchemy.engine.Engine | [generated in 0.00365s] ()
2025-12-02 21:19:38,201 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:19:38,204 | INFO | sqlalchemy.engine.Engine | [generated in 0.00273s] ()
2025-12-02 21:19:38,224 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,227 | INFO | sqlalchemy.engine.Engine | [generated in 0.00334s] ('groups', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,280 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,282 | INFO | sqlalchemy.engine.Engine | [cached since 0.05875s ago] ('group_memberships', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,288 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,291 | INFO | sqlalchemy.engine.Engine | [cached since 0.06799s ago] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,297 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,298 | INFO | sqlalchemy.engine.Engine | [cached since 0.07524s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,303 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,305 | INFO | sqlalchemy.engine.Engine | [cached since 0.08146s ago] ('phase_scores', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,311 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,312 | INFO | sqlalchemy.engine.Engine | [cached since 0.0887s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,320 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,322 | INFO | sqlalchemy.engine.Engine | [cached since 0.09821s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,328 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-12-02 21:19:38,329 | INFO | sqlalchemy.engine.Engine | [cached since 0.1066s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-12-02 21:19:38,340 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:19:38,341 | INFO | sqlalchemy.engine.Engine | [generated in 0.00196s] ('group_role', 'pg_catalog')
2025-12-02 21:19:38,353 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:19:38,354 | INFO | sqlalchemy.engine.Engine | [cached since 0.01452s ago] ('group_membership_status', 'pg_catalog')
2025-12-02 21:19:38,361 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:19:38,362 | INFO | sqlalchemy.engine.Engine | [cached since 0.02351s ago] ('user_status', 'pg_catalog')
2025-12-02 21:19:38,368 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-12-02 21:19:38,369 | INFO | sqlalchemy.engine.Engine | [cached since 0.02968s ago] ('account_type', 'pg_catalog')
2025-12-02 21:19:38,372 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-12-02 21:19:38,374 | INFO | sqlalchemy.engine.Engine | [generated in 0.00123s] ()
2025-12-02 21:19:38,380 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-12-02 21:19:38,381 | INFO | sqlalchemy.engine.Engine | [generated in 0.00060s] ()
2025-12-02 21:19:38,407 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-12-02 21:19:38,409 | INFO | sqlalchemy.engine.Engine | [generated in 0.00215s] ()
2025-12-02 21:19:38,522 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:19:38,583 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-12-02 21:20:10,449 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:20:10,451 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:20:10,451 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:20:10,453 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:20:10,454 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:20:10,454 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:20:10,456 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:20:10,457 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:20:10,458 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:20:10,460 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:20:10,461 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:20:10,462 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:20:10,463 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:20:10,464 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:20:10,465 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:20:10,465 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:20:10,467 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:20:10,469 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:20:10,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:20:10,474 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:20:10,476 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:20:10,479 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:20:10,481 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:20:10,482 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:20:10,485 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:20:10,486 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:20:10,487 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:20:10,489 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:20:10,491 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:20:10,491 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:20:10,495 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:20:10,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:8192]
2025-12-02 21:20:10,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:10,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:10,755 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:10,759 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:11,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:11,337 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:11,343 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:11,347 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:20:11,913 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:11,917 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:11,924 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:20:12,326 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:12,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:12,330 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:12,332 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:20:12,641 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:12,646 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:12,651 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:12,655 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:12,949 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:12,952 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:12,955 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:12,961 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:13,319 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:20:13,322 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:20:13,725 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2919]
2025-12-02 21:20:13,725 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-02 21:20:13,727 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:13,729 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:20:13,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:13,982 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:13,984 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:13,987 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:14,323 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:14,326 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:14,329 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:14,331 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:14,602 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:14,604 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:14,609 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:20:14,894 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:20:14,896 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:14,898 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:14,900 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:15,210 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:15,216 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5840]
2025-12-02 21:20:15,218 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:15,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:15,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:15,497 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:15,499 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:20:15,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:15,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:20:15,783 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:20:15,786 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:20:15,920 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:20:15,928 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:69]
2025-12-02 21:20:15,929 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:20:15,930 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:20:16,110 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:20:16,110 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:20:16,112 | INFO | sqlalchemy.engine.Engine | [cached since 37.91s ago] ()
2025-12-02 21:20:16,152 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:20:16,153 | INFO | sqlalchemy.engine.Engine | [generated in 0.00139s] (6,)
2025-12-02 21:20:17,615 | INFO | app.services.transcribe | Starting stream. Total bytes: 968704. Chunk size: 8192. No throttling.
2025-12-02 21:20:17,617 | DEBUG | app.services.transcribe | Streamed 8192/968704 bytes
2025-12-02 21:20:17,650 | DEBUG | app.services.transcribe | Streamed 417792/968704 bytes
2025-12-02 21:20:17,669 | DEBUG | app.services.transcribe | Streamed 827392/968704 bytes
2025-12-02 21:20:17,683 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:20:22,845 | DEBUG | app.services.transcribe | Received transcript chunk: NH982 transponder 05...
2025-12-02 21:20:22,959 | INFO | app.services.transcribe | Transcription complete. Length: 75
2025-12-02 21:20:22,960 | INFO | app.controllers.audio | Transcripción recibida session=69aaa822-7eea-4f79-a29f-f2746d5b6601: NH982 transponder 0560 y uno rodaremos vía Alpha Alpha Al.de espera pista.
2025-12-02 21:20:22,961 | INFO | app.logs.transcript | student | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | text=NH982 transponder 0560 y uno rodaremos vía Alpha Alpha Al.de espera pista.
2025-12-02 21:20:23,090 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:20:23,092 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:20:23,093 | INFO | sqlalchemy.engine.Engine | [generated in 0.00158s] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:20:23,121 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:20:24,901 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:20:24,902 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:20:24,903 | INFO | sqlalchemy.engine.Engine | [cached since 1.811s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:20:24,939 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:20:24,941 | INFO | sqlalchemy.engine.Engine | [generated in 0.01070s] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (18355 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0561", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 20, 24, 937684, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:20:24,967 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:20:25,009 | INFO | app.controllers.audio | Fase activa session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 21:20:25,013 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
NH982 transponder 0560 y uno rodaremos vía Alpha Alpha Al.de espera pista.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar restricciones (mant...
2025-12-02 21:20:45,928 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_instructions",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Errores detectados: código transponder incorrecto (0560 vs 0561), pista asignada mal expresada ('y uno' en vez de 'uno cero'), y falta la instrucción 'punto de espera'. Corrija: 'rodaremos vía Alfa tres, Alfa al punto de espera pista uno cero'.",
  "confidence": 0.85,
  "score": 30,
  "metadata": {
    "missingItems": [
      "Código transponder correcto",
      "Pista asignada complet...
2025-12-02 21:20:46,119 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:20:46,121 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:20:46,122 | INFO | sqlalchemy.engine.Engine | [cached since 23.03s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:20:46,154 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:20:46,155 | INFO | sqlalchemy.engine.Engine | [cached since 21.23s ago] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (19963 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0561", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 20, 46, 154308, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:20:46,201 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:20:46,264 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:20:46,265 | INFO | sqlalchemy.engine.Engine | [generated in 0.00186s] (UUID('c7255ee5-8781-4d60-8dbd-07302a3d8327'), UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'), 6, 'ground_readback', 30.0, "Errores detectados: código transponder incorrecto (0560 vs 0561), pista asignada mal expresada ('y uno' en vez de 'uno cero'), y falta la instrucción 'punto de espera'. Corrija: 'rodaremos vía Alfa tres, Alfa al punto de espera pista uno cero'.")
2025-12-02 21:20:46,295 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:20:46,342 | INFO | app.controllers.audio | Puntuación guardada session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_readback score=30.00
2025-12-02 21:20:46,343 | INFO | app.logs.transcript | controller | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | intent=ground_taxi_instructions | phase=ground_readback | allow_response=False | text=
2025-12-02 21:22:10,500 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:22:10,501 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:22:10,502 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:22:10,503 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:22:10,504 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:22:10,505 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:22:10,507 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:22:10,508 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:22:10,508 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:22:10,509 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:22:10,511 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:22:10,511 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:22:10,512 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:22:10,513 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:22:10,514 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:22:10,514 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:22:10,516 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:22:10,518 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:22:10,518 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:22:10,519 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:22:10,520 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:22:10,521 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:22:10,521 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:22:10,522 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:22:10,523 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:22:10,524 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:22:10,525 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:22:10,526 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:22:10,527 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:22:10,528 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:22:10,529 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:22:10,531 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 21:22:10,534 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:10,538 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:22:10,725 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:10,729 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:10,934 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:10,935 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:10,938 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:10,939 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:11,229 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:11,234 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:11,239 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:22:11,875 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:11,878 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:11,884 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:11,887 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:12,334 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:12,336 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:12,339 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:12,342 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:12,578 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:12,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:12,585 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:22:12,827 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:12,831 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:12,835 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:12,838 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:13,149 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:13,151 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:13,154 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:13,156 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:22:13,567 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:13,569 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:13,931 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:13,935 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:13,942 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:14,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:14,304 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:14,306 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:14,308 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:14,580 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:14,582 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:14,585 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:14,827 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:14,830 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:14,834 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:15,114 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:15,116 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:15,119 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:15,121 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:15,398 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:15,401 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:15,405 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:15,408 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:15,412 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:15,625 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:15,629 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:15,630 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:15,825 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:15,827 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:15,832 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:15,836 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:16,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:16,112 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:16,122 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:16,377 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:16,380 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:16,381 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:16,384 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:16,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:16,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:16,718 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:16,925 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:16,926 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:16,928 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:17,166 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:17,168 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:17,171 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:17,403 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:17,405 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:17,409 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:22:17,729 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:22:17,730 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:17,735 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:22:17,929 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:17,931 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:22:17,933 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:22:17,936 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:335]
2025-12-02 21:22:17,936 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:22:17,938 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:22:18,122 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:22:18,125 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:22:18,126 | INFO | sqlalchemy.engine.Engine | [cached since 159.9s ago] ()
2025-12-02 21:22:18,139 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:22:18,140 | INFO | sqlalchemy.engine.Engine | [cached since 122s ago] (6,)
2025-12-02 21:22:19,214 | INFO | app.services.transcribe | Starting stream. Total bytes: 1507328. Chunk size: 8192. No throttling.
2025-12-02 21:22:19,216 | DEBUG | app.services.transcribe | Streamed 8192/1507328 bytes
2025-12-02 21:22:19,251 | DEBUG | app.services.transcribe | Streamed 417792/1507328 bytes
2025-12-02 21:22:19,288 | DEBUG | app.services.transcribe | Streamed 827392/1507328 bytes
2025-12-02 21:22:19,315 | DEBUG | app.services.transcribe | Streamed 1236992/1507328 bytes
2025-12-02 21:22:19,329 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:22:25,844 | DEBUG | app.services.transcribe | Received transcript chunk: QNH982 Transponder 0...
2025-12-02 21:22:26,840 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-02 21:22:26,884 | INFO | app.services.transcribe | Transcription complete. Length: 105
2025-12-02 21:22:26,885 | INFO | app.controllers.audio | Transcripción recibida session=69aaa822-7eea-4f79-a29f-f2746d5b6601: QNH982 Transponder 0560 y uno rodaremos vía Alfa tres Alfa al.de espera pista 10. Alfa Noviembre, India.
2025-12-02 21:22:26,886 | INFO | app.logs.transcript | student | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | text=QNH982 Transponder 0560 y uno rodaremos vía Alfa tres Alfa al.de espera pista 10. Alfa Noviembre, India.
2025-12-02 21:22:27,036 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:22:27,037 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:22:27,038 | INFO | sqlalchemy.engine.Engine | [cached since 123.9s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:22:27,065 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:22:31,027 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:22:31,030 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:22:31,031 | INFO | sqlalchemy.engine.Engine | [cached since 127.9s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:22:31,066 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:22:31,069 | INFO | sqlalchemy.engine.Engine | [cached since 126.1s ago] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (20480 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0561", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 22, 31, 66047, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:22:31,102 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:22:31,162 | INFO | app.controllers.audio | Fase activa session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_readback intent=ground_taxi_instruction freq=ground
2025-12-02 21:22:31,167 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instruction freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instruction
Transcripción textual del alumno:
QNH982 Transponder 0560 y uno rodaremos vía Alfa tres Alfa al.de espera pista 10. Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- C...
2025-12-02 21:22:44,957 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instruction intento=1: {
  "intent": "ground_taxi_instruction",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Persisten errores críticos: código transponder sigue siendo 0560 (debería ser 0561), pista asignada incorrecta ('pista 10' en vez de 'uno cero') y falta la instrucción 'punto de espera'. Corrija: 'rodaremos vía Alfa tres, Alfa al punto de espera pista uno cero'.",
  "confidence": 0.85,
  "score": 35,
  "metadata": {
    "missingItems": [
      "Código transponder correcto",
      "Pista...
2025-12-02 21:22:45,118 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:22:45,120 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:22:45,121 | INFO | sqlalchemy.engine.Engine | [cached since 142s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:22:45,155 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:22:45,155 | INFO | sqlalchemy.engine.Engine | [cached since 140.2s ago] ('{"meteo": {"qnh": "982", "vis": "3km", "dewp": "-17", "temp": "6", "wind": "030/2", "cloudBase": "2000", "condition": "VMC", "windSpeed": "2", "cloud ... (22005 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0561", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 22, 45, 155225, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('e8b7b8a7-534b-4b81-8a8c-c0747ee258fe'))
2025-12-02 21:22:45,175 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:22:45,222 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:22:45,222 | INFO | sqlalchemy.engine.Engine | [cached since 119s ago] (UUID('52f59588-fac4-4a2a-a63c-5685d7b81ad1'), UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'), 6, 'ground_readback', 35.0, "Persisten errores críticos: código transponder sigue siendo 0560 (debería ser 0561), pista asignada incorrecta ('pista 10' en vez de 'uno cero') y falta la instrucción 'punto de espera'. Corrija: 'rodaremos vía Alfa tres, Alfa al punto de espera pista uno cero'.")
2025-12-02 21:22:45,234 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:22:45,287 | INFO | app.controllers.audio | Puntuación guardada session=69aaa822-7eea-4f79-a29f-f2746d5b6601 phase_id=ground_readback score=35.00
2025-12-02 21:22:45,288 | INFO | app.logs.transcript | controller | session=69aaa822-7eea-4f79-a29f-f2746d5b6601 | frequency=121.700 | intent=ground_taxi_instruction | phase=ground_readback | allow_response=False | text=
2025-12-02 21:24:28,163 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:28,165 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:28,166 | INFO | sqlalchemy.engine.Engine | [cached since 290s ago] ()
2025-12-02 21:24:28,170 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:28,172 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:28,172 | INFO | sqlalchemy.engine.Engine | [cached since 290s ago] ()
2025-12-02 21:24:28,180 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:28,183 | INFO | sqlalchemy.engine.Engine | [cached since 252s ago] (6,)
2025-12-02 21:24:28,193 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:28,195 | INFO | sqlalchemy.engine.Engine | [cached since 252s ago] (6,)
2025-12-02 21:24:28,302 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:28,305 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:28,308 | INFO | sqlalchemy.engine.Engine | [cached since 290.1s ago] ()
2025-12-02 21:24:28,324 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:28,326 | INFO | sqlalchemy.engine.Engine | [cached since 252.2s ago] (6,)
2025-12-02 21:24:28,370 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:28,371 | INFO | sqlalchemy.engine.Engine | [cached since 252.2s ago] (6,)
2025-12-02 21:24:28,375 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:28,375 | INFO | sqlalchemy.engine.Engine | [cached since 252.2s ago] (6,)
2025-12-02 21:24:28,384 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:24:28,386 | INFO | sqlalchemy.engine.Engine | [generated in 0.00158s] ('scenario_id', 'session_completed', 6)
2025-12-02 21:24:28,392 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:24:28,394 | INFO | sqlalchemy.engine.Engine | [generated in 0.00205s] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:24:28,420 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:24:28,429 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:24:28,438 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:28,439 | INFO | sqlalchemy.engine.Engine | [cached since 252.3s ago] (6,)
2025-12-02 21:24:28,447 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:24:28,450 | INFO | sqlalchemy.engine.Engine | [cached since 0.06505s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:24:28,474 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:24:33,299 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:33,299 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:33,301 | INFO | sqlalchemy.engine.Engine | [cached since 295.1s ago] ()
2025-12-02 21:24:33,309 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:33,310 | INFO | sqlalchemy.engine.Engine | [cached since 257.2s ago] (6,)
2025-12-02 21:24:33,439 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:24:33,440 | INFO | sqlalchemy.engine.Engine | [cached since 250.3s ago] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:24:33,464 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.phase_scores WHERE ecowhiskey.phase_scores.training_session_id = $1::UUID
2025-12-02 21:24:33,465 | INFO | sqlalchemy.engine.Engine | [generated in 0.00192s] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:24:33,498 | INFO | sqlalchemy.engine.Engine | DELETE FROM ecowhiskey.training_contexts WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:24:33,499 | INFO | sqlalchemy.engine.Engine | [generated in 0.00124s] (UUID('69aaa822-7eea-4f79-a29f-f2746d5b6601'),)
2025-12-02 21:24:33,509 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:24:33,861 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:33,863 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:33,863 | INFO | sqlalchemy.engine.Engine | [cached since 295.7s ago] ()
2025-12-02 21:24:33,873 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:33,876 | INFO | sqlalchemy.engine.Engine | [cached since 257.7s ago] (6,)
2025-12-02 21:24:33,914 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:33,916 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:33,917 | INFO | sqlalchemy.engine.Engine | [cached since 295.7s ago] ()
2025-12-02 21:24:33,926 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:33,928 | INFO | sqlalchemy.engine.Engine | [cached since 257.8s ago] (6,)
2025-12-02 21:24:34,009 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:34,009 | INFO | sqlalchemy.engine.Engine | [cached since 257.9s ago] (6,)
2025-12-02 21:24:34,016 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:24:34,017 | INFO | sqlalchemy.engine.Engine | [cached since 5.632s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:24:34,021 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:34,022 | INFO | sqlalchemy.engine.Engine | [cached since 257.9s ago] (6,)
2025-12-02 21:24:34,030 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:24:34,033 | INFO | sqlalchemy.engine.Engine | [cached since 5.641s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:24:34,043 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:24:34,065 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:24:52,749 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:52,751 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:52,752 | INFO | sqlalchemy.engine.Engine | [cached since 314.6s ago] ()
2025-12-02 21:24:52,762 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-12-02 21:24:52,762 | INFO | sqlalchemy.engine.Engine | [generated in 0.00097s] ('usuariotest@gmail.com',)
2025-12-02 21:24:52,932 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:24:58,672 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:24:58,672 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:24:58,674 | INFO | sqlalchemy.engine.Engine | [cached since 320.5s ago] ()
2025-12-02 21:24:58,681 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:24:58,681 | INFO | sqlalchemy.engine.Engine | [cached since 282.5s ago] (6,)
2025-12-02 21:24:58,786 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:25:00,694 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:25:00,696 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:25:00,696 | INFO | sqlalchemy.engine.Engine | [cached since 322.5s ago] ()
2025-12-02 21:25:00,704 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:00,706 | INFO | sqlalchemy.engine.Engine | [cached since 284.6s ago] (6,)
2025-12-02 21:25:00,714 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:25:00,716 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:25:00,717 | INFO | sqlalchemy.engine.Engine | [cached since 322.5s ago] ()
2025-12-02 21:25:00,728 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:00,729 | INFO | sqlalchemy.engine.Engine | [cached since 284.6s ago] (6,)
2025-12-02 21:25:00,823 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:00,824 | INFO | sqlalchemy.engine.Engine | [cached since 284.7s ago] (6,)
2025-12-02 21:25:00,827 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:00,827 | INFO | sqlalchemy.engine.Engine | [cached since 284.7s ago] (6,)
2025-12-02 21:25:00,831 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:25:00,833 | INFO | sqlalchemy.engine.Engine | [cached since 32.45s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:25:00,837 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:25:00,839 | INFO | sqlalchemy.engine.Engine | [cached since 32.45s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:25:00,859 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:25:00,866 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:25:04,025 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:25:04,027 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:25:04,027 | INFO | sqlalchemy.engine.Engine | [cached since 325.8s ago] ()
2025-12-02 21:25:04,037 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:25:04,038 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:25:04,040 | INFO | sqlalchemy.engine.Engine | [cached since 325.8s ago] ()
2025-12-02 21:25:04,047 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:04,050 | INFO | sqlalchemy.engine.Engine | [cached since 287.9s ago] (6,)
2025-12-02 21:25:04,063 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:04,069 | INFO | sqlalchemy.engine.Engine | [cached since 287.9s ago] (6,)
2025-12-02 21:25:04,227 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:04,228 | INFO | sqlalchemy.engine.Engine | [cached since 288.1s ago] (6,)
2025-12-02 21:25:04,234 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:04,237 | INFO | sqlalchemy.engine.Engine | [cached since 288.1s ago] (6,)
2025-12-02 21:25:04,242 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.phase_scores.id, ecowhiskey.phase_scores.training_session_id, ecowhiskey.phase_scores.user_id, ecowhiskey.phase_scores.phase_id, ecowhiskey.phase_scores.score, ecowhiskey.phase_scores.feedback, ecowhiskey.phase_scores.created_at 
FROM ecowhiskey.phase_scores 
WHERE ecowhiskey.phase_scores.user_id = $1::INTEGER AND ecowhiskey.phase_scores.phase_id IN ($2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR) ORDER BY ecowhiskey.phase_scores.created_at DESC
2025-12-02 21:25:04,243 | INFO | sqlalchemy.engine.Engine | [cached since 35.85s ago] (6, 'ground_departure_request', 'frequency_usage_error', 'ground_readback', 'tower_hold_short', 'tower_line_up', 'tower_takeoff_clearance', 'tower_initial_climb', 'approach_contact', 'approach_readback', 'approach_zone_entry', 'radio_check_in', 'radio_position_reporting', 'radio_exit_zone', 'approach_return_contact')
2025-12-02 21:25:04,250 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.context[$1::TEXT] AS scenario_id, ecowhiskey.training_contexts.context[$2::TEXT] AS session_completed, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.user_id = $3::INTEGER ORDER BY ecowhiskey.training_contexts.created_at DESC
2025-12-02 21:25:04,252 | INFO | sqlalchemy.engine.Engine | [cached since 35.87s ago] ('scenario_id', 'session_completed', 6)
2025-12-02 21:25:04,278 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:25:04,281 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:25:36,619 | DEBUG | httpcore.connection | connect_tcp.started host='aviationweather.gov' port=443 local_address=None timeout=10.0 socket_options=None
2025-12-02 21:25:36,755 | DEBUG | httpcore.connection | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000245DC25E850>
2025-12-02 21:25:36,756 | DEBUG | httpcore.connection | start_tls.started ssl_context=<ssl.SSLContext object at 0x00000245DC66B5C0> server_hostname='aviationweather.gov' timeout=10.0
2025-12-02 21:25:36,863 | DEBUG | httpcore.connection | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000245DC63FF10>
2025-12-02 21:25:36,865 | DEBUG | httpcore.http11 | send_request_headers.started request=<Request [b'GET']>
2025-12-02 21:25:36,867 | DEBUG | httpcore.http11 | send_request_headers.complete
2025-12-02 21:25:36,869 | DEBUG | httpcore.http11 | send_request_body.started request=<Request [b'GET']>
2025-12-02 21:25:36,870 | DEBUG | httpcore.http11 | send_request_body.complete
2025-12-02 21:25:36,871 | DEBUG | httpcore.http11 | receive_response_headers.started request=<Request [b'GET']>
2025-12-02 21:25:36,977 | DEBUG | httpcore.http11 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Wed, 03 Dec 2025 03:25:37 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'502'), (b'Connection', b'keep-alive'), (b'Cache-control', b'max-age=60'), (b'ETag', b'W/"1f6-qzkbCB6dUT6xE5guleX+8dB0P6c"'), (b'X-Frame-Options', b'SAMEORIGIN'), (b'Content-Security-Policy', b"frame-ancestors 'self' *.weather.gov"), (b'Strict-Transport-Security', b'max-age=63072000; includeSubDomains'), (b'x-azure-ref', b'20251203T032537Z-1654ff75797ljk9bhC1MIAszf80000000rx000000000hx11'), (b'x-fd-int-roxy-purgeid', b'66958921'), (b'X-Cache', b'TCP_MISS'), (b'Accept-Ranges', b'bytes')])
2025-12-02 21:25:36,978 | INFO | httpx | HTTP Request: GET https://aviationweather.gov/api/data/metar?ids=MROC&format=json "HTTP/1.1 200 OK"
2025-12-02 21:25:36,979 | DEBUG | httpcore.http11 | receive_response_body.started request=<Request [b'GET']>
2025-12-02 21:25:36,980 | DEBUG | httpcore.http11 | receive_response_body.complete
2025-12-02 21:25:36,982 | DEBUG | httpcore.http11 | response_closed.started
2025-12-02 21:25:36,984 | DEBUG | httpcore.http11 | response_closed.complete
2025-12-02 21:25:36,985 | DEBUG | httpcore.connection | close.started
2025-12-02 21:25:36,986 | DEBUG | httpcore.connection | close.complete
2025-12-02 21:25:40,667 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:25:40,668 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:25:40,669 | INFO | sqlalchemy.engine.Engine | [cached since 362.5s ago] ()
2025-12-02 21:25:40,681 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:25:40,682 | INFO | sqlalchemy.engine.Engine | [cached since 324.5s ago] (6,)
2025-12-02 21:25:40,810 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB, $5::TIMESTAMP WITH TIME ZONE, $6::TIMESTAMP WITH TIME ZONE)
2025-12-02 21:25:40,811 | INFO | sqlalchemy.engine.Engine | [generated in 0.00169s] (UUID('168a3791-d15a-4505-948b-9ebd42115919'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, '{"route": "MRPV-mrpv_zone_echo", "meteo": {"condition": "", "vis": "", "qnh": "", "windDirection": "", "windSpeed": "", "temp": "", "dewp": "", "cloudCover": "", "cloudBase": "", "wind": ""}, "scenario_id": "mrpv_zone_echo", "session_completed": false}', datetime.datetime(2025, 12, 2, 21, 25, 40, 810334, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), datetime.datetime(2025, 12, 2, 21, 25, 40, 810334, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')))
2025-12-02 21:25:40,828 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:25:41,101 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:25:41,104 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-12-02 21:25:41,105 | INFO | sqlalchemy.engine.Engine | [generated in 0.00187s] (UUID('168a3791-d15a-4505-948b-9ebd42115919'),)
2025-12-02 21:25:41,127 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:26:14,468 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:26:14,469 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:26:14,472 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:26:14,473 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:26:14,475 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:26:14,476 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:26:14,478 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:26:14,479 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:26:14,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:26:14,483 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:26:14,485 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:26:14,486 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:26:14,488 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:26:14,488 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:26:14,490 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:26:14,491 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:26:14,492 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:26:14,493 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:26:14,495 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:26:14,496 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:26:14,496 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:26:14,498 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:26:14,500 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:26:14,501 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:26:14,503 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:26:14,504 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:26:14,506 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:26:14,509 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:26:14,510 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:26:14,511 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:26:14,512 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:26:14,513 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-02 21:26:14,516 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:14,520 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:15,076 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:15,078 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:15,085 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:15,088 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:15,470 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:15,472 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:15,476 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:15,483 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:15,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:26:15,747 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:15,750 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:16,162 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:16,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:16,169 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:16,174 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:16,176 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:16,583 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:16,585 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:16,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:16,589 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:16,808 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:26:16,809 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:16,811 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:17,007 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:17,011 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,013 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,017 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:17,224 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,227 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,231 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:17,477 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:17,478 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:17,483 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:17,670 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:17,672 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,675 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,676 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:17,861 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:17,863 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:17,865 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:18,040 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:18,041 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:18,043 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:18,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:18,228 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2919]
2025-12-02 21:26:18,231 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1]
2025-12-02 21:26:18,232 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:18,236 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:18,411 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:18,415 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:18,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:18,690 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:18,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:18,695 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:18,870 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:18,872 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:18,874 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:18,877 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:19,070 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:19,073 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:19,075 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:19,266 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:19,268 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:19,271 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:19,275 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:19,471 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:19,472 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:19,478 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:19,755 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:19,758 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:19,762 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:20,004 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:20,006 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:20,008 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:20,009 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:26:20,310 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:20,312 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:20,321 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:20,675 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:20,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:20,680 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:20,999 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:21,001 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:21,003 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:26:21,238 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:26:21,240 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:21,242 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:21,543 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:26:21,547 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:21,550 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:26:21,554 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:26:21,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2880]
2025-12-02 21:26:21,685 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:26:21,688 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:26:22,012 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:26:22,014 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:26:22,017 | INFO | sqlalchemy.engine.Engine | [cached since 403.8s ago] ()
2025-12-02 21:26:22,032 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:26:22,034 | INFO | sqlalchemy.engine.Engine | [cached since 365.9s ago] (6,)
2025-12-02 21:26:23,221 | INFO | app.services.transcribe | Starting stream. Total bytes: 1591296. Chunk size: 8192. No throttling.
2025-12-02 21:26:23,224 | DEBUG | app.services.transcribe | Streamed 8192/1591296 bytes
2025-12-02 21:26:23,262 | DEBUG | app.services.transcribe | Streamed 417792/1591296 bytes
2025-12-02 21:26:23,302 | DEBUG | app.services.transcribe | Streamed 827392/1591296 bytes
2025-12-02 21:26:23,335 | DEBUG | app.services.transcribe | Streamed 1236992/1591296 bytes
2025-12-02 21:26:23,358 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:26:28,692 | DEBUG | app.services.transcribe | Received transcript chunk: superficie Alfa Novi...
2025-12-02 21:26:32,062 | DEBUG | app.services.transcribe | Received transcript chunk: vía paso ochoomogo n...
2025-12-02 21:26:32,168 | INFO | app.services.transcribe | Transcription complete. Length: 191
2025-12-02 21:26:32,169 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: superficie Alfa Noviembre India en plataforma remota tres solicita apertura del plan de vuelo VFR hacia zona Eco. vía paso ochoomogo nivel 7000 pies dos almas a bordo, autonomía cinco horas.
2025-12-02 21:26:32,170 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=121.700 | text=superficie Alfa Noviembre India en plataforma remota tres solicita apertura del plan de vuelo VFR hacia zona Eco. vía paso ochoomogo nivel 7000 pies dos almas a bordo, autonomía cinco horas.
2025-12-02 21:26:32,399 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:26:32,400 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:26:32,401 | INFO | sqlalchemy.engine.Engine | [cached since 369.3s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:26:32,425 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:26:33,481 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:26:33,483 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:26:33,486 | INFO | sqlalchemy.engine.Engine | [cached since 370.4s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:26:33,519 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:26:33,522 | INFO | sqlalchemy.engine.Engine | [cached since 368.6s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (14585 characters truncated) ... pv_zone_echo", "intent": "ground_flight_plan_request", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-12-03T03:26:33Z"}]}', datetime.datetime(2025, 12, 2, 21, 26, 33, 519948, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:26:33,546 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:26:33,594 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=ground_departure_request intent=ground_flight_plan_request freq=ground
2025-12-02 21:26:33,597 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_flight_plan_request freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial. Responde: '[Matrícula], Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 70 grados 11 nudos. QNH 3012. Transponder 0539. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": str...
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_flight_plan_request
Transcripción textual del alumno:
superficie Alfa Noviembre India en plataforma remota tres solicita apertura del plan de vuelo VFR hacia zona Eco. vía paso ochoomogo nivel 7000 pies dos almas a bordo, autonomía cinco horas.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Ind...
2025-12-02 21:26:45,201 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_flight_plan_request intento=1: {
  "intent": "ground_flight_plan_request",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 70 grados 11 nudos. QNH 3012. Transponder 0539. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.",
  "feedback": "Solicitud completa. Todos los elementos requeridos fueron incluidos correctamente.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-12-02 21:26:45,203 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=ground_departure_request a=ground_readback
2025-12-02 21:26:45,377 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:26:45,377 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:26:45,379 | INFO | sqlalchemy.engine.Engine | [cached since 382.3s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:26:45,408 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:26:45,409 | INFO | sqlalchemy.engine.Engine | [cached since 380.5s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (15845 characters truncated) ... "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 26, 45, 407928, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:26:45,427 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:26:45,472 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:26:45,473 | INFO | sqlalchemy.engine.Engine | [cached since 359.2s ago] (UUID('96aaac09-85ce-4086-bca8-400edf54b4c8'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'ground_readback', 95.0, 'Solicitud completa. Todos los elementos requeridos fueron incluidos correctamente.')
2025-12-02 21:26:45,490 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:26:45,532 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=ground_readback score=95.00
2025-12-02 21:26:45,534 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=121.700 | intent=ground_flight_plan_request | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie, recibido su solicitud. Pista en uso uno cero, viento 70 grados 11 nudos. QNH 3012. Transponder 0539. Ruede vía Alfa, Bravo al punto de espera pista uno cero. Llame listo.
2025-12-02 21:27:26,127 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:27:26,128 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:27:26,129 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:27:26,131 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:27:26,132 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:27:26,133 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:27:26,134 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:27:26,135 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:27:26,136 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:27:26,137 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:27:26,139 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:27:26,141 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:27:26,143 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:27:26,145 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:27:26,147 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:27:26,149 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:27:26,151 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:27:26,152 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:27:26,154 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:27:26,157 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:27:26,157 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:27:26,160 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:27:26,161 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:27:26,162 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:27:26,164 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:27:26,165 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:27:26,167 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:27:26,168 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:27:26,169 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:27:26,171 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:27:26,173 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:27:26,174 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:4380]
2025-12-02 21:27:26,179 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:26,182 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:27:26,465 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:27:26,467 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:26,469 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:27:26,679 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:26,683 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:26,685 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:27:26,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:27:26,906 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:26,908 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:26,910 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:27,121 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:27,124 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:27,127 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:27,394 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:27,396 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:27,400 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:27,404 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:27:27,655 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:27,656 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:27,659 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:27,661 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:27:27,857 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:27,859 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:27,861 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:28,061 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:28,063 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:28,066 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:28,302 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:28,303 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:28,306 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:28,566 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:27:28,568 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:28,840 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:28,846 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:28,849 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:29,139 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:29,141 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:29,142 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:27:29,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:29,419 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:29,422 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:29,428 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:29,729 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:27:29,732 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:30,055 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:30,058 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:30,060 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:30,062 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:30,275 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:27:30,277 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:30,280 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:27:30,491 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:30,493 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:30,496 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:30,856 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:30,858 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:30,863 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:30,866 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:27:31,236 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:31,239 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:31,242 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:27:31,584 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:31,586 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:27:31,588 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:27:31,591 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:27:31,660 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:812]
2025-12-02 21:27:31,664 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:27:31,665 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:27:32,145 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:27:32,149 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:27:32,151 | INFO | sqlalchemy.engine.Engine | [cached since 474s ago] ()
2025-12-02 21:27:32,170 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:27:32,173 | INFO | sqlalchemy.engine.Engine | [cached since 436s ago] (6,)
2025-12-02 21:27:33,304 | INFO | app.services.transcribe | Starting stream. Total bytes: 1243136. Chunk size: 8192. No throttling.
2025-12-02 21:27:33,306 | DEBUG | app.services.transcribe | Streamed 8192/1243136 bytes
2025-12-02 21:27:33,356 | DEBUG | app.services.transcribe | Streamed 417792/1243136 bytes
2025-12-02 21:27:33,399 | DEBUG | app.services.transcribe | Streamed 827392/1243136 bytes
2025-12-02 21:27:33,453 | DEBUG | app.services.transcribe | Streamed 1236992/1243136 bytes
2025-12-02 21:27:33,455 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:27:36,053 | DEBUG | app.services.transcribe | Received transcript chunk: QNH3012 Transponder ...
2025-12-02 21:27:39,063 | DEBUG | app.services.transcribe | Received transcript chunk: rodaré vía Alfa Brav...
2025-12-02 21:27:39,846 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-02 21:27:39,889 | INFO | app.services.transcribe | Transcription complete. Length: 93
2025-12-02 21:27:39,891 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: QNH3012 Transponder 0539. rodaré vía Alfa Bravo al.de espera pista 10 Alfa Noviembre, India.
2025-12-02 21:27:39,891 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=121.700 | text=QNH3012 Transponder 0539. rodaré vía Alfa Bravo al.de espera pista 10 Alfa Noviembre, India.
2025-12-02 21:27:40,041 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:27:40,042 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:27:40,043 | INFO | sqlalchemy.engine.Engine | [cached since 437s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:27:40,067 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:27:42,942 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:27:42,943 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:27:42,944 | INFO | sqlalchemy.engine.Engine | [cached since 439.9s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:27:42,969 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:27:42,969 | INFO | sqlalchemy.engine.Engine | [cached since 438s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (16332 characters truncated) ... 22.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "ground"}', datetime.datetime(2025, 12, 2, 21, 27, 42, 968325, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:27:42,994 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:27:43,035 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=ground_readback intent=ground_taxi_instructions freq=ground
2025-12-02 21:27:43,039 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_instructions freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "metadata": object
 }.
El campo "score" debe se...
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_instructions
Transcripción textual del alumno:
QNH3012 Transponder 0539. rodaré vía Alfa Bravo al.de espera pista 10 Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Colacionar QNH correctamente.
- Colacionar código transponder asignado.
- Colacionar ruta de rodaje completa asignada.
- Colacionar pista asignada.
- Colacionar r...
2025-12-02 21:27:53,591 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_instructions intento=1: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.",
  "feedback": "Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista y restricciones. Puede proceder a contactar Torre.",
  "confidence": 0.98,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_hold_short",
    "missingItems": [],
    "extraItems": ["Alfa Noviembr...
2025-12-02 21:27:53,592 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_readback) difiere del esperado (ground_taxi_instructions)
2025-12-02 21:27:53,594 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=ground_readback a=tower_hold_short
2025-12-02 21:27:53,732 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:27:53,733 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:27:53,734 | INFO | sqlalchemy.engine.Engine | [cached since 450.6s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:27:53,754 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:27:53,755 | INFO | sqlalchemy.engine.Engine | [cached since 448.8s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (18069 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 27, 53, 754339, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:27:53,774 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:27:53,793 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:27:53,796 | INFO | sqlalchemy.engine.Engine | [cached since 427.5s ago] (UUID('817cb9bc-37ba-4c76-a739-6c118804d957'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'tower_hold_short', 95.0, 'Colación completa y precisa. Se incluyeron todos los elementos requeridos: QNH, transponder, ruta de rodaje, pista y restricciones. Puede proceder a contactar Torre.')
2025-12-02 21:27:53,813 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:27:53,850 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_hold_short score=95.00
2025-12-02 21:27:53,852 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=121.700 | intent=ground_taxi_readback | phase=tower_hold_short | allow_response=True | text=Alfa Noviembre India, colación correcta. Cambie a Torre 118.3 cuando esté listo.
2025-12-02 21:29:30,033 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:29:30,034 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:29:30,035 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:29:30,037 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:29:30,038 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:29:30,040 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:29:30,042 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:29:30,043 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:29:30,045 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:29:30,046 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:29:30,048 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:29:30,049 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:29:30,051 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:29:30,051 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:29:30,053 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:29:30,055 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:29:30,056 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:29:30,056 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:29:30,058 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:29:30,059 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:29:30,060 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:29:30,063 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:29:30,064 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:29:30,067 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:29:30,068 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:29:30,070 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:29:30,072 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:29:30,073 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:29:30,076 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:436]
2025-12-02 21:29:30,076 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:29:30,077 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:29:30,077 | DEBUG | python_multipart.multipart | Calling on_part_data with data[440:2920]
2025-12-02 21:29:30,081 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:30,083 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:29:30,337 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:30,341 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:30,346 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:30,349 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:30,353 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:29:30,573 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:29:30,575 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:29:30,797 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:30,801 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:30,804 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:30,806 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:29:31,055 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:31,058 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:31,061 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:29:31,254 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:29:31,256 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:31,259 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:29:31,682 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:31,687 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:31,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:29:32,692 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:32,693 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:32,696 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:32,700 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:29:32,971 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:29:32,973 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:29:33,199 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:33,200 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:33,204 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:33,207 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:29:33,439 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:33,441 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:33,443 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:29:33,711 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:33,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:33,715 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:29:34,056 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:34,059 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:34,063 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:29:34,328 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:34,329 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:29:34,331 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:29:34,336 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:29:34,456 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1892]
2025-12-02 21:29:34,458 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:29:34,459 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:29:34,670 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:29:34,671 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:29:34,672 | INFO | sqlalchemy.engine.Engine | [cached since 596.5s ago] ()
2025-12-02 21:29:34,685 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:29:34,687 | INFO | sqlalchemy.engine.Engine | [cached since 558.5s ago] (6,)
2025-12-02 21:29:35,688 | INFO | app.services.transcribe | Starting stream. Total bytes: 829440. Chunk size: 8192. No throttling.
2025-12-02 21:29:35,691 | DEBUG | app.services.transcribe | Streamed 8192/829440 bytes
2025-12-02 21:29:35,744 | DEBUG | app.services.transcribe | Streamed 417792/829440 bytes
2025-12-02 21:29:35,793 | DEBUG | app.services.transcribe | Streamed 827392/829440 bytes
2025-12-02 21:29:35,795 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:29:37,099 | DEBUG | app.services.transcribe | Received transcript chunk: Torre Alfa Noviembre...
2025-12-02 21:29:38,605 | DEBUG | app.services.transcribe | Received transcript chunk: en.de espera pista 1...
2025-12-02 21:29:38,710 | INFO | app.services.transcribe | Transcription complete. Length: 68
2025-12-02 21:29:38,711 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: Torre Alfa Noviembre India en.de espera pista 10 listo para salida.
2025-12-02 21:29:38,712 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | text=Torre Alfa Noviembre India en.de espera pista 10 listo para salida.
2025-12-02 21:29:38,925 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:29:38,928 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:29:38,929 | INFO | sqlalchemy.engine.Engine | [cached since 555.8s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:29:38,962 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:29:39,974 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:29:39,976 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:29:39,977 | INFO | sqlalchemy.engine.Engine | [cached since 556.9s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:29:40,003 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:29:40,007 | INFO | sqlalchemy.engine.Engine | [cached since 555.1s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (18513 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 29, 40, 3264, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:29:40,033 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:29:40,081 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_hold_short intent=tower_takeoff_ready freq=tower
2025-12-02 21:29:40,086 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_takeoff_ready freq_group=tower
SYSTEM> Eres Pavas Torre (118.3). Cuando la aeronave se reporta lista, responde: '[Matrícula], mantenga fuera de pista, tránsito en final corto.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": num...
USER> Fase actual: Contacto inicial con Torre (mantener fuera)
Intent esperado: tower_takeoff_ready
Transcripción textual del alumno:
Torre Alfa Noviembre India en.de espera pista 10 listo para salida.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_hold_short

Checklist alumno:
- Reportar punto de espera pista uno cero.
- Colacionar: 'Mantengo fuera de pista' o 'A posición y mantengo'.
- Colacionar instrucciones condicionales (ej. 'detrás del tránsito').
- NO ...
2025-12-02 21:29:50,501 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_takeoff_ready intento=1: {
  "intent": "tower_takeoff_ready",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.",
  "feedback": "Reporte correcto de posición y estado. Se usó 'listo para salida' en lugar de 'listo para despegar', lo cual es aceptable. La fraseología cumple con los estándares requeridos.",
  "confidence": 0.95,
  "score": 95,
  "metadata": {
    "nextPhase": "tower_line_up",
    "missingElements": [],
    "additionalNotes": "El alumno...
2025-12-02 21:29:50,502 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=tower_hold_short a=tower_line_up
2025-12-02 21:29:50,664 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:29:50,665 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:29:50,666 | INFO | sqlalchemy.engine.Engine | [cached since 567.6s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:29:50,690 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:29:50,693 | INFO | sqlalchemy.engine.Engine | [cached since 565.8s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (20242 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 29, 50, 689634, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:29:50,718 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:29:50,739 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:29:50,741 | INFO | sqlalchemy.engine.Engine | [cached since 544.5s ago] (UUID('8e9bd1ba-8414-4a32-bfcd-e6317828bb28'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'tower_line_up', 95.0, "Reporte correcto de posición y estado. Se usó 'listo para salida' en lugar de 'listo para despegar', lo cual es aceptable. La fraseología cumple con los estándares requeridos.")
2025-12-02 21:29:50,761 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:29:50,804 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_line_up score=95.00
2025-12-02 21:29:50,805 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | intent=tower_takeoff_ready | phase=tower_line_up | allow_response=True | text=Alfa Noviembre India, mantenga fuera de pista, tránsito en final corto.
2025-12-02 21:30:10,567 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:30:10,569 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:30:10,570 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:30:10,571 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:10,573 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:30:10,574 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:30:10,576 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:10,577 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:30:10,579 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:30:10,580 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:30:10,581 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:30:10,582 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:30:10,583 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:30:10,583 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:10,586 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:30:10,587 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:30:10,590 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:10,592 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:30:10,593 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:30:10,594 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:30:10,595 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:30:10,596 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:30:10,597 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:30:10,598 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:10,599 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:30:10,600 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:30:10,600 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:10,602 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:30:10,602 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 21:30:10,603 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:10,604 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:30:10,605 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:1460]
2025-12-02 21:30:10,608 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:10,609 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:10,823 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:10,825 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:6732]
2025-12-02 21:30:11,053 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:30:11,056 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:11,061 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:11,062 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:30:11,293 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:11,294 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:11,295 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:11,597 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:11,600 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:11,603 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:12,014 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:12,017 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:12,020 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:12,024 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:12,537 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:12,539 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 21:30:12,651 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:12,652 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1427]
2025-12-02 21:30:12,660 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:30:12,660 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:30:12,826 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:30:12,827 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:30:12,830 | INFO | sqlalchemy.engine.Engine | [cached since 634.6s ago] ()
2025-12-02 21:30:12,842 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:30:12,843 | INFO | sqlalchemy.engine.Engine | [cached since 596.7s ago] (6,)
2025-12-02 21:30:13,344 | INFO | app.services.transcribe | Starting stream. Total bytes: 425984. Chunk size: 8192. No throttling.
2025-12-02 21:30:13,347 | DEBUG | app.services.transcribe | Streamed 8192/425984 bytes
2025-12-02 21:30:13,396 | DEBUG | app.services.transcribe | Streamed 417792/425984 bytes
2025-12-02 21:30:13,400 | INFO | app.services.transcribe | Finished streaming audio bytes. Ending stream.
2025-12-02 21:30:14,441 | DEBUG | app.services.transcribe | Received transcript chunk: mantengo fuera....
2025-12-02 21:30:15,214 | DEBUG | app.services.transcribe | Received transcript chunk: Alfa Noviembre, Indi...
2025-12-02 21:30:15,295 | INFO | app.services.transcribe | Transcription complete. Length: 39
2025-12-02 21:30:15,295 | INFO | app.controllers.audio | Transcripción recibida session=2ab6af95-094e-4a42-ae02-443cac08bfa7: mantengo fuera. Alfa Noviembre, India.
2025-12-02 21:30:15,296 | INFO | app.logs.transcript | student | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | text=mantengo fuera. Alfa Noviembre, India.
2025-12-02 21:30:15,427 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:30:15,430 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:30:15,431 | INFO | sqlalchemy.engine.Engine | [cached since 592.3s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:30:15,453 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-12-02 21:30:18,783 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:30:18,785 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:30:18,786 | INFO | sqlalchemy.engine.Engine | [cached since 595.7s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:30:18,816 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:30:18,816 | INFO | sqlalchemy.engine.Engine | [cached since 593.9s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (20663 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 30, 18, 816592, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:30:18,836 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:30:18,874 | INFO | app.controllers.audio | Fase activa session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_line_up intent=tower_holding_instruction freq=tower
2025-12-02 21:30:18,877 | INFO | app.services.audio_pipeline | Prompts generados intent=tower_holding_instruction freq_group=tower
SYSTEM> Sigues en Pavas Torre. Una vez libre el tránsito, instruye: '[Matrícula], ruede a posición y mantenga pista uno cero.' Modo normal: Balancea la precisión con la fluidez. Penaliza errores de seguridad o información crítica, pero permite ligeras variaciones. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "score": number | null,
  "meta...
USER> Fase actual: Autorización a posición y mantener
Intent esperado: tower_holding_instruction
Transcripción textual del alumno:
mantengo fuera. Alfa Noviembre, India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: tower
- Fase ID: tower_line_up

Checklist alumno:
- Reconocer la instrucción anterior y estar listo.

Checklist controlador:
- Autorizar 'ruede a posición y mantenga pista uno cero'.
- Mantener fraseología local.

Cuándo responder:
- allowResponse=true con la instrucció...
2025-12-02 21:30:28,700 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=tower_holding_instruction intento=1: {
  "intent": "tower_holding_instruction",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, ruede a posición y mantenga pista uno cero.",
  "feedback": "Se reconoce correctamente la instrucción de mantener fuera. Ahora se autoriza rodar a posición. La fraseología cumple con los estándares requeridos.",
  "confidence": 0.92,
  "score": 85,
  "metadata": {
    "nextPhase": "tower_takeoff_clearance",
    "missingElements": [
      "Faltaba la autorización explícita para rodar ...
2025-12-02 21:30:28,702 | INFO | app.controllers.audio | Transición automática de fase session=2ab6af95-094e-4a42-ae02-443cac08bfa7 de=tower_line_up a=tower_takeoff_clearance
2025-12-02 21:30:28,840 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:30:28,842 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-12-02 21:30:28,843 | INFO | sqlalchemy.engine.Engine | [cached since 605.8s ago] (UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'),)
2025-12-02 21:30:28,867 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITH TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-12-02 21:30:28,868 | INFO | sqlalchemy.engine.Engine | [cached since 603.9s ago] ('{"meteo": {"qnh": "3012", "vis": "", "dewp": "", "temp": "", "wind": "", "cloudBase": "", "condition": "", "windSpeed": 11, "cloudCover": "", "windDi ... (22075 characters truncated) ... 122.0", "approach": "120.5"}, "scenario_id": "mrpv_zone_echo", "transponder": "0539", "session_completed": false, "default_frequency_group": "tower"}', datetime.datetime(2025, 12, 2, 21, 30, 28, 866082, tzinfo=zoneinfo.ZoneInfo(key='America/Costa_Rica')), UUID('168a3791-d15a-4505-948b-9ebd42115919'))
2025-12-02 21:30:28,891 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:30:28,925 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.phase_scores (id, training_session_id, user_id, phase_id, score, feedback) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::VARCHAR, $5::FLOAT, $6::VARCHAR) RETURNING ecowhiskey.phase_scores.created_at
2025-12-02 21:30:28,927 | INFO | sqlalchemy.engine.Engine | [cached since 582.7s ago] (UUID('1170a0c5-1bf6-4386-8ff6-adaf8c0a84e4'), UUID('2ab6af95-094e-4a42-ae02-443cac08bfa7'), 6, 'tower_takeoff_clearance', 85.0, 'Se reconoce correctamente la instrucción de mantener fuera. Ahora se autoriza rodar a posición. La fraseología cumple con los estándares requeridos.')
2025-12-02 21:30:28,943 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-12-02 21:30:28,987 | INFO | app.controllers.audio | Puntuación guardada session=2ab6af95-094e-4a42-ae02-443cac08bfa7 phase_id=tower_takeoff_clearance score=85.00
2025-12-02 21:30:28,988 | INFO | app.logs.transcript | controller | session=2ab6af95-094e-4a42-ae02-443cac08bfa7 | frequency=118.300 | intent=tower_holding_instruction | phase=tower_takeoff_clearance | allow_response=True | text=Alfa Noviembre India, ruede a posición y mantenga pista uno cero.
2025-12-02 21:30:45,244 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:30:45,245 | DEBUG | python_multipart.multipart | Calling on_header_field with data[40:59]
2025-12-02 21:30:45,247 | DEBUG | python_multipart.multipart | Calling on_header_value with data[61:89]
2025-12-02 21:30:45,248 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:45,249 | DEBUG | python_multipart.multipart | Calling on_header_field with data[91:105]
2025-12-02 21:30:45,250 | DEBUG | python_multipart.multipart | Calling on_header_value with data[107:109]
2025-12-02 21:30:45,251 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:45,252 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:30:45,253 | DEBUG | python_multipart.multipart | Calling on_part_data with data[113:149]
2025-12-02 21:30:45,254 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:30:45,255 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:30:45,256 | DEBUG | python_multipart.multipart | Calling on_header_field with data[191:210]
2025-12-02 21:30:45,257 | DEBUG | python_multipart.multipart | Calling on_header_value with data[212:239]
2025-12-02 21:30:45,257 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:45,258 | DEBUG | python_multipart.multipart | Calling on_header_field with data[241:255]
2025-12-02 21:30:45,259 | DEBUG | python_multipart.multipart | Calling on_header_value with data[257:258]
2025-12-02 21:30:45,261 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:45,262 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:30:45,263 | DEBUG | python_multipart.multipart | Calling on_part_data with data[262:269]
2025-12-02 21:30:45,264 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:30:45,265 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-12-02 21:30:45,265 | DEBUG | python_multipart.multipart | Calling on_header_field with data[311:330]
2025-12-02 21:30:45,266 | DEBUG | python_multipart.multipart | Calling on_header_value with data[332:386]
2025-12-02 21:30:45,267 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:45,268 | DEBUG | python_multipart.multipart | Calling on_header_field with data[388:400]
2025-12-02 21:30:45,269 | DEBUG | python_multipart.multipart | Calling on_header_value with data[402:412]
2025-12-02 21:30:45,272 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:45,273 | DEBUG | python_multipart.multipart | Calling on_header_field with data[414:428]
2025-12-02 21:30:45,275 | DEBUG | python_multipart.multipart | Calling on_header_value with data[430:435]
2025-12-02 21:30:45,276 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-12-02 21:30:45,277 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-12-02 21:30:45,278 | DEBUG | python_multipart.multipart | Calling on_part_data with data[439:1460]
2025-12-02 21:30:45,283 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:45,287 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:5272]
2025-12-02 21:30:45,544 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:45,545 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:45,548 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:45,770 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:30:45,773 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:45,980 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:45,983 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:45,986 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:45,988 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:30:46,213 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:30:46,216 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:46,220 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:892]
2025-12-02 21:30:46,443 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:46,445 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:46,447 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:46,613 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:4380]
2025-12-02 21:30:46,617 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:46,782 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:46,785 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:46,788 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:3812]
2025-12-02 21:30:46,941 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:46,945 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:46,948 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:46,950 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:30:47,132 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:47,133 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:47,137 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:47,139 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2352]
2025-12-02 21:30:47,414 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1460]
2025-12-02 21:30:47,416 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:2920]
2025-12-02 21:30:47,417 | DEBUG | python_multipart.multipart | Calling on_part_data with data[0:1584]
2025-12-02 21:30:47,419 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-12-02 21:30:47,420 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-12-02 21:30:47,605 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-12-02 21:30:47,608 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-12-02 21:30:47,609 | INFO | sqlalchemy.engine.Engine | [cached since 669.4s ago] ()
2025-12-02 21:30:47,623 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-12-02 21:30:47,625 | INFO | sqlalchemy.engine.Engine | [cached since 631.5s ago] (6,)
2025-12-02 21:30:48,118 | INFO | app.services.transcribe | Starting stream. Total bytes: 618496. Chunk size: 8192. No throttling.
2025-12-02 21:30:48,123 | DEBUG | app.services.transcribe | Streamed 8192/618496 bytes
2025-12-02 21:30:48,169 | DEBUG | app.services.transcribe | Streamed 417792/618496 bytes
