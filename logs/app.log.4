2025-10-28 21:48:40,797 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 21:48:40,798 | INFO | sqlalchemy.engine.Engine | [cached since 0.002075s ago] ('account_type', 'pg_catalog')
2025-10-28 21:48:40,799 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 21:48:40,799 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 21:48:40,800 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 21:48:40,800 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 21:48:40,801 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 21:48:40,801 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 21:48:40,812 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 21:48:40,821 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 21:49:24,400 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 21:49:24,400 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 21:49:24,402 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 21:49:24,402 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 21:49:24,404 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 21:49:24,404 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 21:49:24,406 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:49:24,406 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 21:49:24,406 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 21:49:24,407 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 21:49:24,408 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 21:49:24,410 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:24,410 | INFO | sqlalchemy.engine.Engine | [generated in 0.00020s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:24,414 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:24,414 | INFO | sqlalchemy.engine.Engine | [cached since 0.003863s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:24,415 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:24,415 | INFO | sqlalchemy.engine.Engine | [cached since 0.004882s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:24,416 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:24,416 | INFO | sqlalchemy.engine.Engine | [cached since 0.005674s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:24,416 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:24,417 | INFO | sqlalchemy.engine.Engine | [cached since 0.006738s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:24,418 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 21:49:24,418 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-10-28 21:49:24,422 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 21:49:24,422 | INFO | sqlalchemy.engine.Engine | [cached since 0.003329s ago] ('account_type', 'pg_catalog')
2025-10-28 21:49:24,422 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 21:49:24,422 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 21:49:24,424 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 21:49:24,424 | INFO | sqlalchemy.engine.Engine | [generated in 0.00004s] ()
2025-10-28 21:49:24,426 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 21:49:24,426 | INFO | sqlalchemy.engine.Engine | [generated in 0.00020s] ()
2025-10-28 21:49:24,440 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 21:49:24,451 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 21:49:28,600 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 21:49:28,600 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 21:49:28,603 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 21:49:28,603 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 21:49:28,605 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 21:49:28,605 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 21:49:28,606 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:49:28,607 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 21:49:28,607 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 21:49:28,608 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 21:49:28,608 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 21:49:28,611 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:28,611 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:28,614 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:28,614 | INFO | sqlalchemy.engine.Engine | [cached since 0.003133s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:28,615 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:28,615 | INFO | sqlalchemy.engine.Engine | [cached since 0.004195s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:28,616 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:28,616 | INFO | sqlalchemy.engine.Engine | [cached since 0.005042s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:28,616 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 21:49:28,616 | INFO | sqlalchemy.engine.Engine | [cached since 0.00587s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 21:49:28,618 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 21:49:28,618 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ('user_status', 'pg_catalog')
2025-10-28 21:49:28,620 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 21:49:28,620 | INFO | sqlalchemy.engine.Engine | [cached since 0.001944s ago] ('account_type', 'pg_catalog')
2025-10-28 21:49:28,621 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 21:49:28,621 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 21:49:28,623 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 21:49:28,623 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 21:49:28,625 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 21:49:28,625 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ()
2025-10-28 21:49:28,652 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 21:49:28,662 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 21:50:53,508 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:50:53,509 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 21:50:53,509 | INFO | sqlalchemy.engine.Engine | [cached since 84.9s ago] ()
2025-10-28 21:50:53,523 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-10-28 21:50:53,523 | INFO | sqlalchemy.engine.Engine | [generated in 0.00020s] ('hola@mail.com',)
2025-10-28 21:50:53,565 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 21:51:07,755 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:51:07,756 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 21:51:07,756 | INFO | sqlalchemy.engine.Engine | [cached since 99.15s ago] ()
2025-10-28 21:51:07,759 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 21:51:07,760 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] (1,)
2025-10-28 21:51:07,775 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-10-28 21:51:07,775 | INFO | sqlalchemy.engine.Engine | [generated in 0.00019s] (UUID('60a5825c-e75d-484c-86f4-e2a6ca0d55a0'), UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "986", "windDirection": "040", "windSpeed": "4", "wind": "040/4"}, "objectives": []}')
2025-10-28 21:51:07,777 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 21:51:07,812 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:51:07,813 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-10-28 21:51:07,813 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] (UUID('60a5825c-e75d-484c-86f4-e2a6ca0d55a0'),)
2025-10-28 21:51:07,816 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 21:58:34,779 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 21:58:34,779 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 21:58:34,779 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 21:58:34,779 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 21:58:34,779 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:58909]
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 21:58:34,780 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 21:58:34,811 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:58:34,812 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 21:58:34,812 | INFO | sqlalchemy.engine.Engine | [cached since 546.2s ago] ()
2025-10-28 21:58:34,815 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 21:58:34,815 | INFO | sqlalchemy.engine.Engine | [cached since 447.1s ago] (1,)
2025-10-28 21:58:34,830 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 21:58:34,830 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x115d2d6a0>}) about to wait for the following futures []
2025-10-28 21:58:34,830 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x115d2d6a0>}) done waiting for dependent futures
2025-10-28 21:58:34,830 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x115d2d6a0>}) with kwargs {'client': <botocore.client.S3 object at 0x115565940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x115b82cf0>, 'osutil': <s3transfer.utils.OSUtils object at 0x115b82ba0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x115d2cec0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x115d2d6a0>}
2025-10-28 21:58:34,830 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/f88bcd018d964123a50c31c920cec6d2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x115d2cec0> for transfer request: 0.
2025-10-28 21:58:34,831 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 21:58:34,831 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/f88bcd018d964123a50c31c920cec6d2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 21:58:34,831 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 21:58:34,831 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/f88bcd018d964123a50c31c920cec6d2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 21:58:34,831 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/f88bcd018d964123a50c31c920cec6d2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x115565940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x115d2dfd0>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/f88bcd018d964123a50c31c920cec6d2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 21:58:35,688 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 21:58:47,909 | INFO | app.controllers.audio | Transcripción recibida session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349: pavas superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía paso de ocho moos 7000 pies dos almas a bordo Capitán Salas. tres horas y media de combustible.
2025-10-28 21:58:47,910 | INFO | app.logs.transcript | student | session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349 | frequency=121.7 | text=pavas superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía paso de ocho moos 7000 pies dos almas a bordo Capitán Salas. tres horas y media de combustible.
2025-10-28 21:58:47,953 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:58:47,954 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 21:58:47,954 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 21:58:47,956 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 21:58:47,983 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:58:47,983 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 21:58:47,983 | INFO | sqlalchemy.engine.Engine | [cached since 0.02955s ago] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 21:58:47,986 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 21:58:47,987 | INFO | app.services.audio_pipeline | Intent detectado id=ground_taxi_clearance confianza=1.00 tokens=['abrir plan de vuelo', 'plan de vuelo', 'zona eco', 'almas a bordo', 'superficie', 'plan de vuelo', 'zona eco']
2025-10-28 21:58:48,009 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 21:58:48,010 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 21:58:48,010 | INFO | sqlalchemy.engine.Engine | [cached since 0.05578s ago] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 21:58:48,011 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 21:58:48,013 | INFO | app.logs.transcript | feedback | session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349 | frequency=121.7 | intent=ground_taxi_clearance | text=Falta incluir: punto de paso (Ochomogo), capitán al mando.
2025-10-28 21:58:48,013 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:00:29,466 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:00:29,466 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:00:29,468 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:00:29,468 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:00:29,470 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:00:29,470 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:00:29,472 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:00:29,472 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:00:29,472 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:00:29,474 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:00:29,474 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:00:29,476 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:00:29,476 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:00:29,479 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:00:29,479 | INFO | sqlalchemy.engine.Engine | [cached since 0.003265s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:00:29,480 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:00:29,480 | INFO | sqlalchemy.engine.Engine | [cached since 0.004241s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:00:29,482 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:00:29,482 | INFO | sqlalchemy.engine.Engine | [cached since 0.006234s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:00:29,483 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:00:29,484 | INFO | sqlalchemy.engine.Engine | [cached since 0.007933s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:00:29,485 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:00:29,485 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-10-28 22:00:29,487 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:00:29,487 | INFO | sqlalchemy.engine.Engine | [cached since 0.001427s ago] ('account_type', 'pg_catalog')
2025-10-28 22:00:29,487 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:00:29,487 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:00:29,488 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:00:29,488 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:00:29,489 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:00:29,489 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:00:29,499 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:00:29,509 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:03:10,829 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:03:10,829 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:03:10,832 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:03:10,832 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:03:10,834 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:03:10,834 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:03:10,836 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:03:10,836 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:03:10,836 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:03:10,838 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:03:10,838 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:03:10,840 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:03:10,840 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:03:10,844 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:03:10,844 | INFO | sqlalchemy.engine.Engine | [cached since 0.004038s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:03:10,845 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:03:10,845 | INFO | sqlalchemy.engine.Engine | [cached since 0.005202s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:03:10,846 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:03:10,846 | INFO | sqlalchemy.engine.Engine | [cached since 0.005975s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:03:10,847 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:03:10,847 | INFO | sqlalchemy.engine.Engine | [cached since 0.006814s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:03:10,848 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:03:10,848 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:03:10,850 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:03:10,850 | INFO | sqlalchemy.engine.Engine | [cached since 0.001707s ago] ('account_type', 'pg_catalog')
2025-10-28 22:03:10,851 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:03:10,851 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:03:10,852 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:03:10,852 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:03:10,854 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:03:10,854 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:03:10,865 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:03:10,874 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:04:47,023 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:04:47,023 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:04:47,025 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:04:47,025 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:04:47,027 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:04:47,027 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:04:47,029 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:04:47,029 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:04:47,029 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-10-28 22:04:47,030 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:04:47,030 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:04:47,032 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:47,032 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:47,035 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:47,035 | INFO | sqlalchemy.engine.Engine | [cached since 0.003097s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:47,036 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:47,036 | INFO | sqlalchemy.engine.Engine | [cached since 0.003921s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:47,037 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:47,037 | INFO | sqlalchemy.engine.Engine | [cached since 0.004604s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:47,038 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:47,038 | INFO | sqlalchemy.engine.Engine | [cached since 0.005293s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:47,039 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:04:47,039 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:04:47,041 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:04:47,041 | INFO | sqlalchemy.engine.Engine | [cached since 0.001864s ago] ('account_type', 'pg_catalog')
2025-10-28 22:04:47,042 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:04:47,042 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:04:47,043 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:04:47,043 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:04:47,045 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:04:47,045 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:04:47,057 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:04:47,069 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:04:58,838 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:04:58,839 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:04:58,841 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:04:58,841 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:04:58,843 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:04:58,843 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:04:58,844 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:04:58,844 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:04:58,844 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:04:58,845 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:04:58,845 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:04:58,848 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:58,848 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:58,851 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:58,851 | INFO | sqlalchemy.engine.Engine | [cached since 0.003027s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:58,852 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:58,852 | INFO | sqlalchemy.engine.Engine | [cached since 0.004155s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:58,853 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:58,853 | INFO | sqlalchemy.engine.Engine | [cached since 0.005026s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:58,853 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:04:58,853 | INFO | sqlalchemy.engine.Engine | [cached since 0.005822s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:04:58,856 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:04:58,856 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-10-28 22:04:58,857 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:04:58,858 | INFO | sqlalchemy.engine.Engine | [cached since 0.002032s ago] ('account_type', 'pg_catalog')
2025-10-28 22:04:58,858 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:04:58,858 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:04:58,860 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:04:58,860 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:04:58,862 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:04:58,862 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:04:58,874 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:04:58,881 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 22:05:44,712 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:05:44,713 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:05:44,713 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:58909]
2025-10-28 22:05:44,713 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:05:44,713 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 22:05:44,732 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:05:44,733 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:05:44,733 | INFO | sqlalchemy.engine.Engine | [cached since 45.89s ago] ()
2025-10-28 22:05:44,742 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:05:44,742 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] (1,)
2025-10-28 22:05:44,750 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:05:44,750 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x144926660>}) about to wait for the following futures []
2025-10-28 22:05:44,750 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x144926660>}) done waiting for dependent futures
2025-10-28 22:05:44,750 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x144926660>}) with kwargs {'client': <botocore.client.S3 object at 0x144265a90>, 'config': <boto3.s3.transfer.TransferConfig object at 0x144925550>, 'osutil': <s3transfer.utils.OSUtils object at 0x1449257f0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x144925e80>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x144926660>}
2025-10-28 22:05:44,750 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/b1309e77ed2f481ca91a47461ceec2fc.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x144925e80> for transfer request: 0.
2025-10-28 22:05:44,751 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:05:44,751 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/b1309e77ed2f481ca91a47461ceec2fc.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 22:05:44,751 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:05:44,751 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/b1309e77ed2f481ca91a47461ceec2fc.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 22:05:44,751 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/b1309e77ed2f481ca91a47461ceec2fc.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x144265a90>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x144926f90>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/b1309e77ed2f481ca91a47461ceec2fc.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 22:05:45,632 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:05:57,934 | INFO | app.controllers.audio | Transcripción recibida session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349: pavas superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía paso de ocho moos 7000 pies dos almas a bordo Capitán Salas. tres horas y media de combustible.
2025-10-28 22:05:57,934 | INFO | app.logs.transcript | student | session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349 | frequency=121.7 | text=pavas superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía paso de ocho moos 7000 pies dos almas a bordo Capitán Salas. tres horas y media de combustible.
2025-10-28 22:05:57,984 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:05:57,985 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:05:57,985 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 22:05:57,989 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:05:58,025 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:05:58,025 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:05:58,025 | INFO | sqlalchemy.engine.Engine | [cached since 0.04026s ago] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 22:05:58,028 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:05:58,031 | INFO | app.services.audio_pipeline | Intent detectado id=ground_taxi_clearance confianza=1.00 tokens=['abrir plan de vuelo', 'plan de vuelo', 'zona eco', 'almas a bordo', 'superficie', 'plan de vuelo', 'zona eco']
2025-10-28 22:05:58,033 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en español (Costa Rica). Gestionas rodajes, puntos de espera y pistas activas. Responde únicamente en formato JSON válido, sin comentarios ni texto adicional.
USER> Transcripción textual del alumno:
pavas superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía paso de ocho moos 7000 pies dos almas a bordo Capitán Salas. tres horas y media de combustible.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Condiciones de pista: Pista en uso uno cero
- Clima relevante: Viento 040/04, QNH 986

Turnos previos:
  1. Student: pavas superficie Alfa Noviembre India frente a hangar 37 solicitando abrir...
2025-10-28 22:05:58,967 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "confidence": 0.8,
  "slots": {
    "callsign_spelled": "Alfa Noviembre India",
    "runway_human": "uno cero"
  },
  "notes": {
    "observations": []
  }
}
2025-10-28 22:05:58,968 | INFO | app.services.audio_pipeline | Respuesta LLM estructurada intent=ground_taxi_clearance slots={'callsign': None, 'callsign_spelled': 'Alfa Noviembre India', 'runway': None, 'runway_human': 'uno cero', 'instruction_code': None, 'instruction': None, 'heading': None, 'altitude_ft': None, 'instruction_codes': None, 'wind_direction': None, 'wind_speed': None, 'wind_report': None, 'qnh_value': None, 'squawk_code': None, 'taxi_route': None, 'advisory_text': None, 'climb_instruction': None, 'report_altitude_ft': None, 'next_frequency_phrase': None, 'souls_on_board': None, 'fuel_endurance_minutes': None}
2025-10-28 22:05:58,969 | INFO | app.services.audio_pipeline | Slots normalizados: {'callsign': 'ANIE', 'callsign_spelled': 'Alfa Noviembre India', 'runway': '10', 'runway_human': 'uno cero', 'instruction_codes': ['acknowledge', 'runway_in_use', 'wind_report', 'squawk_assignment', 'qnh_assignment', 'taxi_clearance', 'advise_ready'], 'wind_direction': 40, 'wind_speed': 4, 'wind_report': '040/04', 'qnh_value': '986', 'squawk_code': '0522', 'taxi_route': 'Alfa 2, Alfa', 'advisory_text': 'Avise listo', 'instruction_code': 'taxi_clearance'}
2025-10-28 22:05:58,969 | INFO | app.services.audio_pipeline | Plantilla renderizada intent=ground_taxi_clearance texto='Alfa Noviembre India, recibido. Pista en uso uno cero. Viento 040/04. Transponder 0522. QNH 986. Ruede vía Alfa 2, Alfa al punto de espera pista uno cero. Avise listo'
2025-10-28 22:05:58,970 | INFO | app.controllers.audio | Frase final para Polly session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349 intent=ground_taxi_clearance fallback=False: Alfa Noviembre India, recibido. Pista en uso uno cero. Viento 040/04. Transponder 0522. QNH 986. Ruede vía Alfa 2, Alfa al punto de espera pista uno cero. Avise listo
2025-10-28 22:05:59,013 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:05:59,013 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:05:59,013 | INFO | sqlalchemy.engine.Engine | [cached since 1.029s ago] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 22:05:59,016 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:05:59,019 | INFO | app.logs.transcript | controller | session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349 | frequency=121.7 | intent=ground_taxi_clearance | fallback=None | text=Alfa Noviembre India, recibido. Pista en uso uno cero. Viento 040/04. Transponder 0522. QNH 986. Ruede vía Alfa 2, Alfa al punto de espera pista uno cero. Avise listo
2025-10-28 22:06:01,447 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:07:19,274 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:07:19,274 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 22:07:19,274 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 22:07:19,274 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:07:19,274 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:45301]
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:07:19,275 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 22:07:19,301 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:07:19,301 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:07:19,301 | INFO | sqlalchemy.engine.Engine | [cached since 140.5s ago] ()
2025-10-28 22:07:19,303 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:07:19,303 | INFO | sqlalchemy.engine.Engine | [cached since 94.56s ago] (1,)
2025-10-28 22:07:19,315 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:07:19,315 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x14498bd90>}) about to wait for the following futures []
2025-10-28 22:07:19,315 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x14498bd90>}) done waiting for dependent futures
2025-10-28 22:07:19,315 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x14498bd90>}) with kwargs {'client': <botocore.client.S3 object at 0x144265a90>, 'config': <boto3.s3.transfer.TransferConfig object at 0x14498a850>, 'osutil': <s3transfer.utils.OSUtils object at 0x14498b610>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x144983490>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x14498bd90>}
2025-10-28 22:07:19,315 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/cf01a30d96db4fd3803a828bd45acd69.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x144983490> for transfer request: 0.
2025-10-28 22:07:19,315 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:07:19,316 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/cf01a30d96db4fd3803a828bd45acd69.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 22:07:19,316 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/cf01a30d96db4fd3803a828bd45acd69.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 22:07:19,316 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/cf01a30d96db4fd3803a828bd45acd69.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x144265a90>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x144c2c690>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/ed7683a7-2fa9-47a2-9e33-fbbb9fee3349/cf01a30d96db4fd3803a828bd45acd69.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 22:07:19,316 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:07:20,413 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:07:32,585 | INFO | app.controllers.audio | Transcripción recibida session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349: QNH986 Transponder 0522 Viento 04004 nudos Redo Alfa dos Alfa Al.de espera Alfa Noviembre India.
2025-10-28 22:07:32,585 | INFO | app.logs.transcript | student | session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349 | frequency=121.7 | text=QNH986 Transponder 0522 Viento 04004 nudos Redo Alfa dos Alfa Al.de espera Alfa Noviembre India.
2025-10-28 22:07:32,634 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:07:32,634 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:07:32,634 | INFO | sqlalchemy.engine.Engine | [cached since 94.65s ago] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 22:07:32,638 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:07:32,672 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:07:32,672 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:07:32,672 | INFO | sqlalchemy.engine.Engine | [cached since 94.69s ago] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 22:07:32,675 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:07:32,677 | INFO | app.services.audio_pipeline | Intent detectado id=ground_taxi_clearance confianza=0.90 tokens=['transponder', 'transponder', 'qnh']
2025-10-28 22:07:32,704 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:07:32,704 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:07:32,704 | INFO | sqlalchemy.engine.Engine | [cached since 94.72s ago] (UUID('ed7683a7-2fa9-47a2-9e33-fbbb9fee3349'),)
2025-10-28 22:07:32,707 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:07:32,709 | INFO | app.logs.transcript | feedback | session=ed7683a7-2fa9-47a2-9e33-fbbb9fee3349 | frequency=121.7 | intent=ground_taxi_clearance | text=Colación incompleta. Incluya: QNH 986, Pista uno cero.
2025-10-28 22:07:32,709 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:08:16,004 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:08:16,004 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:08:16,007 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:08:16,007 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:08:16,008 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:08:16,008 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:08:16,009 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:08:16,010 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:08:16,010 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:08:16,011 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:08:16,011 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:08:16,013 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:08:16,013 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:08:16,015 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:08:16,015 | INFO | sqlalchemy.engine.Engine | [cached since 0.002114s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:08:16,015 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:08:16,015 | INFO | sqlalchemy.engine.Engine | [cached since 0.002639s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:08:16,016 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:08:16,016 | INFO | sqlalchemy.engine.Engine | [cached since 0.003209s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:08:16,016 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:08:16,016 | INFO | sqlalchemy.engine.Engine | [cached since 0.003744s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:08:16,017 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:08:16,017 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:08:16,020 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:08:16,020 | INFO | sqlalchemy.engine.Engine | [cached since 0.002811s ago] ('account_type', 'pg_catalog')
2025-10-28 22:08:16,021 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:08:16,021 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:08:16,022 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:08:16,022 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:08:16,023 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:08:16,023 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:08:16,034 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:08:16,041 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:12:25,452 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:12:25,452 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:25,455 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:12:25,455 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:25,456 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:12:25,456 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:25,457 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:12:25,458 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:12:25,458 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:12:25,458 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:12:25,459 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:12:25,461 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:25,461 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:25,462 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:25,462 | INFO | sqlalchemy.engine.Engine | [cached since 0.001792s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:25,463 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:25,463 | INFO | sqlalchemy.engine.Engine | [cached since 0.00227s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:25,463 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:25,463 | INFO | sqlalchemy.engine.Engine | [cached since 0.002739s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:25,464 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:25,464 | INFO | sqlalchemy.engine.Engine | [cached since 0.003165s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:25,465 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:12:25,465 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:12:25,466 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:12:25,466 | INFO | sqlalchemy.engine.Engine | [cached since 0.001066s ago] ('account_type', 'pg_catalog')
2025-10-28 22:12:25,466 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:12:25,466 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:12:25,467 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:12:25,467 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:12:25,468 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:12:25,468 | INFO | sqlalchemy.engine.Engine | [generated in 0.00025s] ()
2025-10-28 22:12:25,479 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:12:25,486 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:12:50,992 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:12:50,993 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:50,995 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:12:50,995 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:51,000 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:12:51,000 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:51,001 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:12:51,002 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:12:51,002 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:12:51,003 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:12:51,003 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:12:51,005 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:51,005 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:51,009 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:51,009 | INFO | sqlalchemy.engine.Engine | [cached since 0.003588s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:51,010 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:51,010 | INFO | sqlalchemy.engine.Engine | [cached since 0.004644s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:51,011 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:51,011 | INFO | sqlalchemy.engine.Engine | [cached since 0.005471s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:51,011 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:51,011 | INFO | sqlalchemy.engine.Engine | [cached since 0.006112s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:51,013 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:12:51,013 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:12:51,015 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:12:51,015 | INFO | sqlalchemy.engine.Engine | [cached since 0.002161s ago] ('account_type', 'pg_catalog')
2025-10-28 22:12:51,016 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:12:51,016 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:12:51,017 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:12:51,017 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:12:51,019 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:12:51,019 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 22:12:51,033 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:12:51,040 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:12:58,910 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:12:58,910 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:58,912 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:12:58,912 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:58,914 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:12:58,914 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:12:58,915 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:12:58,915 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:12:58,915 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 22:12:58,917 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:12:58,917 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:12:58,919 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:58,919 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:58,922 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:58,922 | INFO | sqlalchemy.engine.Engine | [cached since 0.00308s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:58,923 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:58,923 | INFO | sqlalchemy.engine.Engine | [cached since 0.004052s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:58,924 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:58,924 | INFO | sqlalchemy.engine.Engine | [cached since 0.004962s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:58,925 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:12:58,925 | INFO | sqlalchemy.engine.Engine | [cached since 0.005637s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:12:58,926 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:12:58,926 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-10-28 22:12:58,928 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:12:58,928 | INFO | sqlalchemy.engine.Engine | [cached since 0.001663s ago] ('account_type', 'pg_catalog')
2025-10-28 22:12:58,929 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:12:58,929 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:12:58,930 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:12:58,930 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:12:58,932 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:12:58,932 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:12:58,944 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:12:58,954 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:13:07,224 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:13:07,224 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:13:07,227 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:13:07,227 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:13:07,229 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:13:07,229 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:13:07,230 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:13:07,230 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:13:07,230 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:13:07,232 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:13:07,232 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:13:07,234 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:13:07,234 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:13:07,238 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:13:07,238 | INFO | sqlalchemy.engine.Engine | [cached since 0.004359s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:13:07,239 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:13:07,239 | INFO | sqlalchemy.engine.Engine | [cached since 0.005174s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:13:07,239 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:13:07,240 | INFO | sqlalchemy.engine.Engine | [cached since 0.005791s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:13:07,240 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:13:07,240 | INFO | sqlalchemy.engine.Engine | [cached since 0.006453s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:13:07,242 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:13:07,242 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:13:07,243 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:13:07,243 | INFO | sqlalchemy.engine.Engine | [cached since 0.001621s ago] ('account_type', 'pg_catalog')
2025-10-28 22:13:07,244 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:13:07,244 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:13:07,245 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:13:07,245 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:13:07,247 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:13:07,247 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 22:13:07,258 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:13:07,265 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:16:44,201 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:16:44,202 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:16:44,204 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:16:44,204 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:16:44,206 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:16:44,206 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:16:44,208 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:16:44,208 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:16:44,208 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:16:44,210 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:16:44,210 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:16:44,212 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:16:44,212 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:16:44,216 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:16:44,216 | INFO | sqlalchemy.engine.Engine | [cached since 0.003777s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:16:44,216 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:16:44,216 | INFO | sqlalchemy.engine.Engine | [cached since 0.004477s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:16:44,217 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:16:44,217 | INFO | sqlalchemy.engine.Engine | [cached since 0.005288s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:16:44,218 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:16:44,218 | INFO | sqlalchemy.engine.Engine | [cached since 0.006071s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:16:44,219 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:16:44,220 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:16:44,222 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:16:44,222 | INFO | sqlalchemy.engine.Engine | [cached since 0.002256s ago] ('account_type', 'pg_catalog')
2025-10-28 22:16:44,223 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:16:44,223 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:16:44,224 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:16:44,224 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:16:44,226 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:16:44,226 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:16:44,244 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:16:44,254 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:19:04,900 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:19:04,900 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:19:04,902 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:19:04,902 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:19:04,904 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:19:04,904 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:19:04,906 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:19:04,906 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:19:04,906 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:19:04,907 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:19:04,907 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 22:19:04,909 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:19:04,909 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:19:04,913 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:19:04,913 | INFO | sqlalchemy.engine.Engine | [cached since 0.003278s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:19:04,913 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:19:04,914 | INFO | sqlalchemy.engine.Engine | [cached since 0.004138s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:19:04,914 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:19:04,914 | INFO | sqlalchemy.engine.Engine | [cached since 0.004949s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:19:04,915 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:19:04,915 | INFO | sqlalchemy.engine.Engine | [cached since 0.005578s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:19:04,916 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:19:04,916 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-10-28 22:19:04,918 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:19:04,918 | INFO | sqlalchemy.engine.Engine | [cached since 0.001892s ago] ('account_type', 'pg_catalog')
2025-10-28 22:19:04,919 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:19:04,919 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:19:04,920 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:19:04,920 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:19:04,922 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:19:04,922 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:19:04,933 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:19:04,943 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:20:28,031 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:20:28,031 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:20:28,033 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:20:28,034 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:20:28,035 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:20:28,035 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:20:28,037 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:20:28,037 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:20:28,037 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-10-28 22:20:28,039 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:20:28,039 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:20:28,041 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:20:28,041 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:20:28,044 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:20:28,044 | INFO | sqlalchemy.engine.Engine | [cached since 0.003179s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:20:28,045 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:20:28,045 | INFO | sqlalchemy.engine.Engine | [cached since 0.004069s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:20:28,046 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:20:28,046 | INFO | sqlalchemy.engine.Engine | [cached since 0.004997s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:20:28,047 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:20:28,047 | INFO | sqlalchemy.engine.Engine | [cached since 0.00575s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:20:28,048 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:20:28,048 | INFO | sqlalchemy.engine.Engine | [generated in 0.00034s] ('user_status', 'pg_catalog')
2025-10-28 22:20:28,051 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:20:28,051 | INFO | sqlalchemy.engine.Engine | [cached since 0.002513s ago] ('account_type', 'pg_catalog')
2025-10-28 22:20:28,051 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:20:28,051 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:20:28,053 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:20:28,053 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:20:28,054 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:20:28,055 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-10-28 22:20:28,068 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:20:28,075 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:21:27,067 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:21:27,067 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:27,069 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:21:27,069 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:27,071 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:21:27,071 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:27,072 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:21:27,072 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:21:27,072 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:21:27,074 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:21:27,074 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:21:27,076 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:27,076 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:27,079 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:27,079 | INFO | sqlalchemy.engine.Engine | [cached since 0.003061s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:27,080 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:27,080 | INFO | sqlalchemy.engine.Engine | [cached since 0.003985s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:27,080 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:27,080 | INFO | sqlalchemy.engine.Engine | [cached since 0.004807s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:27,081 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:27,081 | INFO | sqlalchemy.engine.Engine | [cached since 0.005625s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:27,083 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:21:27,083 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-10-28 22:21:27,085 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:21:27,085 | INFO | sqlalchemy.engine.Engine | [cached since 0.002179s ago] ('account_type', 'pg_catalog')
2025-10-28 22:21:27,086 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:21:27,086 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:21:27,087 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:21:27,087 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:21:27,089 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:21:27,089 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:21:27,100 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:21:27,110 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:21:42,928 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:21:42,928 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:42,930 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:21:42,930 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:42,931 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:21:42,931 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:42,933 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:21:42,934 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:21:42,934 | INFO | sqlalchemy.engine.Engine | [generated in 0.00021s] ()
2025-10-28 22:21:42,935 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:21:42,935 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:21:42,937 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:42,937 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:42,939 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:42,939 | INFO | sqlalchemy.engine.Engine | [cached since 0.001874s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:42,940 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:42,940 | INFO | sqlalchemy.engine.Engine | [cached since 0.002622s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:42,941 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:42,941 | INFO | sqlalchemy.engine.Engine | [cached since 0.004059s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:42,942 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:42,942 | INFO | sqlalchemy.engine.Engine | [cached since 0.004624s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:42,943 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:21:42,943 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-10-28 22:21:42,945 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:21:42,945 | INFO | sqlalchemy.engine.Engine | [cached since 0.001692s ago] ('account_type', 'pg_catalog')
2025-10-28 22:21:42,945 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:21:42,945 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:21:42,946 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:21:42,946 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:21:42,947 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:21:42,947 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-10-28 22:21:42,954 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:21:42,963 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:21:59,648 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:21:59,648 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:59,650 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:21:59,650 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:59,652 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:21:59,652 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:21:59,653 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:21:59,653 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:21:59,654 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:21:59,655 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:21:59,655 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:21:59,658 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:59,658 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:59,661 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:59,661 | INFO | sqlalchemy.engine.Engine | [cached since 0.003096s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:59,661 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:59,662 | INFO | sqlalchemy.engine.Engine | [cached since 0.004025s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:59,662 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:59,662 | INFO | sqlalchemy.engine.Engine | [cached since 0.004962s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:59,663 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:21:59,663 | INFO | sqlalchemy.engine.Engine | [cached since 0.005802s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:21:59,665 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:21:59,665 | INFO | sqlalchemy.engine.Engine | [generated in 0.00022s] ('user_status', 'pg_catalog')
2025-10-28 22:21:59,667 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:21:59,667 | INFO | sqlalchemy.engine.Engine | [cached since 0.002024s ago] ('account_type', 'pg_catalog')
2025-10-28 22:21:59,667 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:21:59,667 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:21:59,669 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:21:59,669 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:21:59,670 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:21:59,671 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:21:59,683 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:21:59,692 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:22:44,202 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:22:44,203 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:22:44,205 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:22:44,205 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:22:44,207 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:22:44,207 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:22:44,208 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:22:44,208 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:22:44,209 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:22:44,210 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:22:44,210 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:22:44,212 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:22:44,212 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:22:44,215 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:22:44,216 | INFO | sqlalchemy.engine.Engine | [cached since 0.003701s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:22:44,216 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:22:44,216 | INFO | sqlalchemy.engine.Engine | [cached since 0.00461s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:22:44,217 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:22:44,217 | INFO | sqlalchemy.engine.Engine | [cached since 0.00526s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:22:44,218 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:22:44,218 | INFO | sqlalchemy.engine.Engine | [cached since 0.006077s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:22:44,219 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:22:44,219 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:22:44,221 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:22:44,221 | INFO | sqlalchemy.engine.Engine | [cached since 0.002071s ago] ('account_type', 'pg_catalog')
2025-10-28 22:22:44,222 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:22:44,222 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:22:44,225 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:22:44,225 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:22:44,226 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:22:44,226 | INFO | sqlalchemy.engine.Engine | [generated in 0.00024s] ()
2025-10-28 22:22:44,239 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:22:44,246 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:23:02,528 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:23:02,528 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:23:02,531 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:23:02,531 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:23:02,534 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:23:02,534 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:23:02,536 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:23:02,536 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:23:02,536 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:23:02,538 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:23:02,538 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:23:02,541 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:23:02,541 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:23:02,545 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:23:02,545 | INFO | sqlalchemy.engine.Engine | [cached since 0.004173s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:23:02,546 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:23:02,546 | INFO | sqlalchemy.engine.Engine | [cached since 0.005281s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:23:02,547 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:23:02,547 | INFO | sqlalchemy.engine.Engine | [cached since 0.006074s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:23:02,548 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:23:02,548 | INFO | sqlalchemy.engine.Engine | [cached since 0.007234s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:23:02,550 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:23:02,550 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-10-28 22:23:02,552 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:23:02,552 | INFO | sqlalchemy.engine.Engine | [cached since 0.002472s ago] ('account_type', 'pg_catalog')
2025-10-28 22:23:02,554 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:23:02,554 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:23:02,556 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:23:02,556 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:23:02,557 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:23:02,557 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-10-28 22:23:02,566 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:23:02,578 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:24:27,835 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:24:27,835 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:24:27,838 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:24:27,838 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:24:27,839 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:24:27,839 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:24:27,841 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:24:27,841 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:24:27,841 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-10-28 22:24:27,842 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:24:27,842 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:24:27,844 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:27,844 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:27,847 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:27,847 | INFO | sqlalchemy.engine.Engine | [cached since 0.003272s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:27,848 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:27,848 | INFO | sqlalchemy.engine.Engine | [cached since 0.004126s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:27,849 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:27,849 | INFO | sqlalchemy.engine.Engine | [cached since 0.004914s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:27,850 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:27,850 | INFO | sqlalchemy.engine.Engine | [cached since 0.005683s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:27,851 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:24:27,851 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:24:27,853 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:24:27,853 | INFO | sqlalchemy.engine.Engine | [cached since 0.00189s ago] ('account_type', 'pg_catalog')
2025-10-28 22:24:27,854 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:24:27,854 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:24:27,855 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:24:27,856 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:24:27,857 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:24:27,857 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-10-28 22:24:27,870 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:24:27,878 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:24:58,216 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:24:58,216 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:24:58,218 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:24:58,218 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:24:58,220 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:24:58,220 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:24:58,221 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:24:58,221 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:24:58,221 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:24:58,223 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:24:58,223 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 22:24:58,225 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:58,225 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:58,228 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:58,228 | INFO | sqlalchemy.engine.Engine | [cached since 0.003104s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:58,229 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:58,229 | INFO | sqlalchemy.engine.Engine | [cached since 0.00404s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:58,230 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:58,230 | INFO | sqlalchemy.engine.Engine | [cached since 0.004853s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:58,231 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:24:58,231 | INFO | sqlalchemy.engine.Engine | [cached since 0.005644s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:24:58,232 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:24:58,233 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('user_status', 'pg_catalog')
2025-10-28 22:24:58,238 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:24:58,238 | INFO | sqlalchemy.engine.Engine | [cached since 0.005428s ago] ('account_type', 'pg_catalog')
2025-10-28 22:24:58,262 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:24:58,262 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] ()
2025-10-28 22:24:58,264 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:24:58,264 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:24:58,271 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:24:58,272 | INFO | sqlalchemy.engine.Engine | [generated in 0.00021s] ()
2025-10-28 22:24:58,285 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:24:58,292 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:32:17,895 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:32:17,896 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:32:17,898 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:32:17,898 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:32:17,899 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:32:17,899 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:32:17,901 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:32:17,901 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:32:17,901 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:32:17,903 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:32:17,903 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:32:17,905 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:32:17,905 | INFO | sqlalchemy.engine.Engine | [generated in 0.00022s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:32:17,908 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:32:17,909 | INFO | sqlalchemy.engine.Engine | [cached since 0.003546s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:32:17,909 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:32:17,909 | INFO | sqlalchemy.engine.Engine | [cached since 0.004313s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:32:17,912 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:32:17,912 | INFO | sqlalchemy.engine.Engine | [cached since 0.006875s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:32:17,913 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:32:17,913 | INFO | sqlalchemy.engine.Engine | [cached since 0.008021s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:32:17,915 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:32:17,915 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-10-28 22:32:17,917 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:32:17,917 | INFO | sqlalchemy.engine.Engine | [cached since 0.001974s ago] ('account_type', 'pg_catalog')
2025-10-28 22:32:17,918 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:32:17,918 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:32:17,920 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:32:17,920 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:32:17,921 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:32:17,921 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 22:32:17,935 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:32:17,944 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:33:07,308 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:33:07,308 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:33:07,310 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:33:07,310 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:33:07,312 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:33:07,312 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:33:07,313 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:33:07,313 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:33:07,313 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:33:07,314 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:33:07,314 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:33:07,316 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:07,316 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:07,319 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:07,320 | INFO | sqlalchemy.engine.Engine | [cached since 0.003432s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:07,321 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:07,321 | INFO | sqlalchemy.engine.Engine | [cached since 0.004528s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:07,324 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:07,324 | INFO | sqlalchemy.engine.Engine | [cached since 0.007577s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:07,324 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:07,325 | INFO | sqlalchemy.engine.Engine | [cached since 0.008433s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:07,326 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:33:07,326 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-10-28 22:33:07,329 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:33:07,329 | INFO | sqlalchemy.engine.Engine | [cached since 0.002466s ago] ('account_type', 'pg_catalog')
2025-10-28 22:33:07,329 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:33:07,329 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:33:07,331 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:33:07,331 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:33:07,332 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:33:07,333 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:33:07,348 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:33:07,357 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:33:54,284 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:33:54,284 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:33:54,287 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:33:54,287 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:33:54,289 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:33:54,289 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:33:54,290 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:33:54,290 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:33:54,290 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:33:54,292 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:33:54,292 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:33:54,294 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:54,294 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:54,297 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:54,297 | INFO | sqlalchemy.engine.Engine | [cached since 0.003121s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:54,298 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:54,298 | INFO | sqlalchemy.engine.Engine | [cached since 0.00387s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:54,298 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:54,298 | INFO | sqlalchemy.engine.Engine | [cached since 0.004488s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:54,299 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:33:54,299 | INFO | sqlalchemy.engine.Engine | [cached since 0.005285s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:33:54,301 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:33:54,301 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:33:54,303 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:33:54,303 | INFO | sqlalchemy.engine.Engine | [cached since 0.002097s ago] ('account_type', 'pg_catalog')
2025-10-28 22:33:54,304 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:33:54,304 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:33:54,306 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:33:54,306 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:33:54,308 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:33:54,308 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:33:54,318 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:33:54,326 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:35:18,771 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:35:18,772 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:35:18,774 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:35:18,774 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:35:18,776 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:35:18,776 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:35:18,778 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:35:18,778 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:35:18,778 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:35:18,781 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:35:18,781 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:35:18,783 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:35:18,783 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:35:18,786 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:35:18,787 | INFO | sqlalchemy.engine.Engine | [cached since 0.003841s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:35:18,787 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:35:18,787 | INFO | sqlalchemy.engine.Engine | [cached since 0.004618s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:35:18,788 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:35:18,788 | INFO | sqlalchemy.engine.Engine | [cached since 0.005289s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:35:18,789 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:35:18,789 | INFO | sqlalchemy.engine.Engine | [cached since 0.006151s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:35:18,790 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:35:18,790 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:35:18,792 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:35:18,792 | INFO | sqlalchemy.engine.Engine | [cached since 0.002117s ago] ('account_type', 'pg_catalog')
2025-10-28 22:35:18,793 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:35:18,795 | INFO | sqlalchemy.engine.Engine | [generated in 0.00170s] ()
2025-10-28 22:35:18,797 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:35:18,800 | INFO | sqlalchemy.engine.Engine | [generated in 0.00312s] ()
2025-10-28 22:35:18,802 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:35:18,802 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:35:18,814 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:35:18,819 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:38:36,037 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:38:36,038 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:38:36,040 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:38:36,040 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:38:36,042 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:38:36,042 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:38:36,044 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:38:36,044 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:38:36,044 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:38:36,046 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:38:36,046 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 22:38:36,049 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:38:36,049 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:38:36,053 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:38:36,053 | INFO | sqlalchemy.engine.Engine | [cached since 0.004065s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:38:36,053 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:38:36,053 | INFO | sqlalchemy.engine.Engine | [cached since 0.004789s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:38:36,054 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:38:36,054 | INFO | sqlalchemy.engine.Engine | [cached since 0.005465s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:38:36,055 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:38:36,055 | INFO | sqlalchemy.engine.Engine | [cached since 0.006191s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:38:36,056 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:38:36,056 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:38:36,057 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:38:36,057 | INFO | sqlalchemy.engine.Engine | [cached since 0.001246s ago] ('account_type', 'pg_catalog')
2025-10-28 22:38:36,058 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:38:36,058 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:38:36,059 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:38:36,059 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:38:36,060 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:38:36,060 | INFO | sqlalchemy.engine.Engine | [generated in 0.00019s] ()
2025-10-28 22:38:36,067 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:38:36,077 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:40:44,539 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:40:44,540 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:40:44,542 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:40:44,542 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:40:44,544 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:40:44,544 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:40:44,545 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:40:44,546 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:40:44,546 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-10-28 22:40:44,550 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:40:44,550 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:40:44,555 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:40:44,555 | INFO | sqlalchemy.engine.Engine | [generated in 0.00022s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:40:44,559 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:40:44,559 | INFO | sqlalchemy.engine.Engine | [cached since 0.004172s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:40:44,560 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:40:44,560 | INFO | sqlalchemy.engine.Engine | [cached since 0.004993s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:40:44,560 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:40:44,560 | INFO | sqlalchemy.engine.Engine | [cached since 0.005604s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:40:44,561 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:40:44,561 | INFO | sqlalchemy.engine.Engine | [cached since 0.006236s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:40:44,562 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:40:44,563 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:40:44,565 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:40:44,565 | INFO | sqlalchemy.engine.Engine | [cached since 0.002413s ago] ('account_type', 'pg_catalog')
2025-10-28 22:40:44,566 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:40:44,566 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:40:44,568 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:40:44,568 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:40:44,569 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:40:44,570 | INFO | sqlalchemy.engine.Engine | [generated in 0.00020s] ()
2025-10-28 22:40:44,583 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:40:44,592 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:41:18,614 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:41:18,614 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:41:18,617 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:41:18,617 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:41:18,619 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:41:18,619 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:41:18,621 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:41:18,621 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:41:18,622 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:41:18,623 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:41:18,623 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:41:18,625 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:18,625 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:18,628 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:18,628 | INFO | sqlalchemy.engine.Engine | [cached since 0.003087s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:18,629 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:18,629 | INFO | sqlalchemy.engine.Engine | [cached since 0.003894s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:18,630 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:18,630 | INFO | sqlalchemy.engine.Engine | [cached since 0.004612s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:18,630 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:18,630 | INFO | sqlalchemy.engine.Engine | [cached since 0.005219s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:18,632 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:41:18,632 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:41:18,633 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:41:18,633 | INFO | sqlalchemy.engine.Engine | [cached since 0.001615s ago] ('account_type', 'pg_catalog')
2025-10-28 22:41:18,634 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:41:18,634 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:41:18,635 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:41:18,635 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:41:18,637 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:41:18,637 | INFO | sqlalchemy.engine.Engine | [generated in 0.00023s] ()
2025-10-28 22:41:18,645 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:41:18,652 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:41:44,150 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:41:44,150 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:41:44,152 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:41:44,152 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:41:44,154 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:41:44,154 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:41:44,155 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:41:44,156 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:41:44,156 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:41:44,157 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:41:44,157 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 22:41:44,159 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:44,159 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:44,162 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:44,162 | INFO | sqlalchemy.engine.Engine | [cached since 0.003325s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:44,163 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:44,163 | INFO | sqlalchemy.engine.Engine | [cached since 0.004116s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:44,164 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:44,164 | INFO | sqlalchemy.engine.Engine | [cached since 0.004819s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:44,165 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:41:44,165 | INFO | sqlalchemy.engine.Engine | [cached since 0.005509s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:41:44,166 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:41:44,166 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:41:44,168 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:41:44,168 | INFO | sqlalchemy.engine.Engine | [cached since 0.002187s ago] ('account_type', 'pg_catalog')
2025-10-28 22:41:44,169 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:41:44,169 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:41:44,170 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:41:44,171 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 22:41:44,172 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:41:44,172 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-10-28 22:41:44,183 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:41:44,193 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:42:09,812 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:42:09,812 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:42:09,815 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:42:09,815 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:42:09,816 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:42:09,816 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:42:09,818 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:42:09,818 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:42:09,818 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:42:09,820 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:42:09,821 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:42:09,823 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:09,823 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:09,827 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:09,827 | INFO | sqlalchemy.engine.Engine | [cached since 0.004287s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:09,828 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:09,828 | INFO | sqlalchemy.engine.Engine | [cached since 0.005268s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:09,829 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:09,829 | INFO | sqlalchemy.engine.Engine | [cached since 0.006101s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:09,830 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:09,830 | INFO | sqlalchemy.engine.Engine | [cached since 0.006805s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:09,832 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:42:09,832 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-10-28 22:42:09,834 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:42:09,834 | INFO | sqlalchemy.engine.Engine | [cached since 0.002742s ago] ('account_type', 'pg_catalog')
2025-10-28 22:42:09,835 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:42:09,836 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:42:09,837 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:42:09,837 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:42:09,839 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:42:09,839 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:42:09,848 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:42:09,855 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:42:53,245 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:42:53,245 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:42:53,248 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:42:53,248 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:42:53,249 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:42:53,249 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:42:53,251 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:42:53,251 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:42:53,251 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:42:53,252 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:42:53,252 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:42:53,254 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:53,255 | INFO | sqlalchemy.engine.Engine | [generated in 0.00021s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:53,257 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:53,257 | INFO | sqlalchemy.engine.Engine | [cached since 0.00243s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:53,257 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:53,257 | INFO | sqlalchemy.engine.Engine | [cached since 0.003071s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:53,258 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:53,258 | INFO | sqlalchemy.engine.Engine | [cached since 0.00361s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:53,258 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:42:53,258 | INFO | sqlalchemy.engine.Engine | [cached since 0.00407s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:42:53,260 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:42:53,260 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:42:53,261 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:42:53,261 | INFO | sqlalchemy.engine.Engine | [cached since 0.001427s ago] ('account_type', 'pg_catalog')
2025-10-28 22:42:53,262 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:42:53,262 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 22:42:53,263 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:42:53,263 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:42:53,264 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:42:53,264 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 22:42:53,274 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:42:53,281 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:44:06,424 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:44:06,425 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:44:06,427 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:44:06,427 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:44:06,429 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:44:06,429 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:44:06,430 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:44:06,431 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:44:06,431 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:44:06,432 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:44:06,432 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:44:06,434 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:44:06,435 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:44:06,437 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:44:06,437 | INFO | sqlalchemy.engine.Engine | [cached since 0.003066s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:44:06,438 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:44:06,438 | INFO | sqlalchemy.engine.Engine | [cached since 0.003777s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:44:06,439 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:44:06,439 | INFO | sqlalchemy.engine.Engine | [cached since 0.004587s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:44:06,440 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:44:06,440 | INFO | sqlalchemy.engine.Engine | [cached since 0.005446s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:44:06,441 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:44:06,441 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-10-28 22:44:06,443 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:44:06,443 | INFO | sqlalchemy.engine.Engine | [cached since 0.002206s ago] ('account_type', 'pg_catalog')
2025-10-28 22:44:06,444 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:44:06,444 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:44:06,446 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:44:06,446 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:44:06,447 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:44:06,447 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 22:44:06,462 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:44:06,472 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:45:27,215 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:45:27,215 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:45:27,217 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:45:27,217 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:45:27,218 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:45:27,218 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:45:27,220 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:45:27,221 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:45:27,221 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-10-28 22:45:27,222 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:45:27,222 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:45:27,224 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:27,224 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:27,226 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:27,226 | INFO | sqlalchemy.engine.Engine | [cached since 0.001685s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:27,226 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:27,226 | INFO | sqlalchemy.engine.Engine | [cached since 0.002245s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:27,227 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:27,227 | INFO | sqlalchemy.engine.Engine | [cached since 0.00276s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:27,227 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:27,227 | INFO | sqlalchemy.engine.Engine | [cached since 0.003228s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:27,229 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:45:27,229 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ('user_status', 'pg_catalog')
2025-10-28 22:45:27,230 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:45:27,230 | INFO | sqlalchemy.engine.Engine | [cached since 0.001366s ago] ('account_type', 'pg_catalog')
2025-10-28 22:45:27,231 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:45:27,231 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:45:27,231 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:45:27,232 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:45:27,232 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:45:27,233 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 22:45:27,243 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:45:27,250 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:45:37,137 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:45:37,137 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:45:37,139 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:45:37,139 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:45:37,141 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:45:37,141 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:45:37,143 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:45:37,143 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:45:37,143 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:45:37,144 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:45:37,144 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-10-28 22:45:37,147 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:37,147 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:37,172 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:37,172 | INFO | sqlalchemy.engine.Engine | [cached since 0.02521s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:37,173 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:37,173 | INFO | sqlalchemy.engine.Engine | [cached since 0.02627s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:37,174 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:37,174 | INFO | sqlalchemy.engine.Engine | [cached since 0.02705s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:37,175 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:45:37,175 | INFO | sqlalchemy.engine.Engine | [cached since 0.02822s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:45:37,176 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:45:37,176 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 22:45:37,179 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:45:37,179 | INFO | sqlalchemy.engine.Engine | [cached since 0.002343s ago] ('account_type', 'pg_catalog')
2025-10-28 22:45:37,179 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:45:37,180 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:45:37,181 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:45:37,181 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:45:37,183 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:45:37,183 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:45:37,196 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:45:37,203 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:50:24,584 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:50:24,584 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:50:24,584 | INFO | sqlalchemy.engine.Engine | [cached since 287.4s ago] ()
2025-10-28 22:50:24,594 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:50:24,594 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] (1,)
2025-10-28 22:50:24,616 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-10-28 22:50:24,616 | INFO | sqlalchemy.engine.Engine | [generated in 0.00024s] (UUID('8464c587-56c4-4bc3-87b5-ccded7f434fa'), UUID('9b268dfc-5334-43ae-b773-5a9d7c473c26'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "986", "windDirection": "040", "windSpeed": "4", "wind": "040/4"}, "objectives": []}')
2025-10-28 22:50:24,618 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:50:24,655 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:50:24,656 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-10-28 22:50:24,656 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] (UUID('8464c587-56c4-4bc3-87b5-ccded7f434fa'),)
2025-10-28 22:50:24,660 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 22:51:11,763 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:55993]
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:51:11,764 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 22:51:11,788 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:51:11,788 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:51:11,788 | INFO | sqlalchemy.engine.Engine | [cached since 334.6s ago] ()
2025-10-28 22:51:11,790 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:51:18,528 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:51:18,529 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:51:18,529 | INFO | sqlalchemy.engine.Engine | [cached since 341.4s ago] ()
2025-10-28 22:51:18,541 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-10-28 22:51:18,542 | INFO | sqlalchemy.engine.Engine | [generated in 0.00020s] ('hola@mail.com',)
2025-10-28 22:51:18,577 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:51:22,637 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:51:22,637 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 22:51:22,637 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 22:51:22,637 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:22,637 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:51:22,637 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:55993]
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:51:22,638 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 22:51:22,672 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:51:22,672 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:51:22,672 | INFO | sqlalchemy.engine.Engine | [cached since 345.5s ago] ()
2025-10-28 22:51:22,674 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:51:22,674 | INFO | sqlalchemy.engine.Engine | [cached since 58.08s ago] (1,)
2025-10-28 22:51:22,688 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:51:22,688 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110884980>}) about to wait for the following futures []
2025-10-28 22:51:22,688 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110884980>}) done waiting for dependent futures
2025-10-28 22:51:22,688 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110884980>}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x1106534d0>, 'osutil': <s3transfer.utils.OSUtils object at 0x110650d70>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x1108841a0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x110884980>}
2025-10-28 22:51:22,688 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/a51e3101b9604aca841ac2567fa5c340.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x1108841a0> for transfer request: 0.
2025-10-28 22:51:22,688 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:51:22,688 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/a51e3101b9604aca841ac2567fa5c340.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 22:51:22,688 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/a51e3101b9604aca841ac2567fa5c340.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 22:51:22,688 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/a51e3101b9604aca841ac2567fa5c340.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x1108852b0>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/a51e3101b9604aca841ac2567fa5c340.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 22:51:22,691 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:51:23,849 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:51:34,123 | INFO | app.controllers.audio | Transcripción recibida session=9b268dfc-5334-43ae-b773-5a9d7c473c26: Pava superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a Zona Eo vía paso de ocho moo 7000 pies dos almas a bordo. Capitán al mando salas tres horas y media de autonomía.
2025-10-28 22:51:34,124 | INFO | app.logs.transcript | student | session=9b268dfc-5334-43ae-b773-5a9d7c473c26 | frequency=121.7 | text=Pava superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a Zona Eo vía paso de ocho moo 7000 pies dos almas a bordo. Capitán al mando salas tres horas y media de autonomía.
2025-10-28 22:51:34,167 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:51:34,168 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:51:34,169 | INFO | sqlalchemy.engine.Engine | [generated in 0.00137s] (UUID('9b268dfc-5334-43ae-b773-5a9d7c473c26'),)
2025-10-28 22:51:34,172 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:51:34,210 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:51:34,210 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:51:34,210 | INFO | sqlalchemy.engine.Engine | [cached since 0.04232s ago] (UUID('9b268dfc-5334-43ae-b773-5a9d7c473c26'),)
2025-10-28 22:51:34,213 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:51:34,216 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
Pava superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a Zona Eo vía paso de ocho moo 7000 pies dos almas a bordo. Capitán al mando salas tres horas y media de autonomía.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie /...
2025-10-28 22:51:35,500 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Pista uno cero activa, viento 40 grados, velocidad 4 nudos, QNH 986. Rodaje Alfa 2, Alfa. Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 22:51:35,546 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:51:35,547 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:51:35,547 | INFO | sqlalchemy.engine.Engine | [cached since 1.379s ago] (UUID('9b268dfc-5334-43ae-b773-5a9d7c473c26'),)
2025-10-28 22:51:35,550 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:51:35,552 | INFO | app.logs.transcript | controller | session=9b268dfc-5334-43ae-b773-5a9d7c473c26 | frequency=121.7 | intent=ground_taxi_clearance | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Pista uno cero activa, viento 40 grados, velocidad 4 nudos, QNH 986. Rodaje Alfa 2, Alfa. Avise listo.
2025-10-28 22:51:38,264 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:52:35,774 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:32125]
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:52:35,775 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 22:52:35,799 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:52:35,799 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:52:35,799 | INFO | sqlalchemy.engine.Engine | [cached since 418.6s ago] ()
2025-10-28 22:52:35,801 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:52:35,801 | INFO | sqlalchemy.engine.Engine | [cached since 131.2s ago] (1,)
2025-10-28 22:52:35,815 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:52:35,815 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}) about to wait for the following futures []
2025-10-28 22:52:35,815 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}) done waiting for dependent futures
2025-10-28 22:52:35,815 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110695d10>, 'osutil': <s3transfer.utils.OSUtils object at 0x110627c50>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x110758b00>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}
2025-10-28 22:52:35,815 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/300bd9457a2e47d59b02b969e5eae86a.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x110758b00> for transfer request: 0.
2025-10-28 22:52:35,815 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:52:35,816 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/300bd9457a2e47d59b02b969e5eae86a.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 22:52:35,816 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/300bd9457a2e47d59b02b969e5eae86a.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 22:52:35,816 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:52:35,816 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/300bd9457a2e47d59b02b969e5eae86a.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11088a5d0>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/9b268dfc-5334-43ae-b773-5a9d7c473c26/300bd9457a2e47d59b02b969e5eae86a.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 22:52:36,525 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:52:46,461 | INFO | app.controllers.audio | Transcripción recibida session=9b268dfc-5334-43ae-b773-5a9d7c473c26: Ruedo vía Alfa dos Alfa al.de espera pista 10QNH986.
2025-10-28 22:52:46,462 | INFO | app.logs.transcript | student | session=9b268dfc-5334-43ae-b773-5a9d7c473c26 | frequency=121.7 | text=Ruedo vía Alfa dos Alfa al.de espera pista 10QNH986.
2025-10-28 22:52:46,508 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:52:46,508 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:52:46,508 | INFO | sqlalchemy.engine.Engine | [cached since 72.34s ago] (UUID('9b268dfc-5334-43ae-b773-5a9d7c473c26'),)
2025-10-28 22:52:46,511 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:52:46,546 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:52:46,546 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:52:46,546 | INFO | sqlalchemy.engine.Engine | [cached since 72.38s ago] (UUID('9b268dfc-5334-43ae-b773-5a9d7c473c26'),)
2025-10-28 22:52:46,549 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:52:46,553 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
Ruedo vía Alfa dos Alfa al.de espera pista 10QNH986.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuencia 121.7)
- Identificador y ubicación de la aeronave (ANI en hangar 37)
- Ruta solicitada, punto de paso y altitud (Zona Eco vía Ochomogo, 700...
2025-10-28 22:52:47,325 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Avise listo Alfa Noviembre India, Pavas Superficie. Pista uno cero activa, viento 40 grados, velocidad 4 nudos, QNH 986. Rodaje Alfa 2, Alfa.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 22:52:47,373 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:52:47,374 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:52:47,374 | INFO | sqlalchemy.engine.Engine | [cached since 73.21s ago] (UUID('9b268dfc-5334-43ae-b773-5a9d7c473c26'),)
2025-10-28 22:52:47,377 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:52:47,381 | INFO | app.logs.transcript | controller | session=9b268dfc-5334-43ae-b773-5a9d7c473c26 | frequency=121.7 | intent=ground_taxi_clearance | allow_response=True | text=Avise listo Alfa Noviembre India, Pavas Superficie. Pista uno cero activa, viento 40 grados, velocidad 4 nudos, QNH 986. Rodaje Alfa 2, Alfa.
2025-10-28 22:52:49,305 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:54:08,992 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:54:08,993 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:54:08,993 | INFO | sqlalchemy.engine.Engine | [cached since 511.8s ago] ()
2025-10-28 22:54:08,995 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:54:08,995 | INFO | sqlalchemy.engine.Engine | [cached since 224.4s ago] (1,)
2025-10-28 22:54:09,011 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-10-28 22:54:09,011 | INFO | sqlalchemy.engine.Engine | [cached since 224.4s ago] (UUID('051486bc-0d6b-4164-9c48-fa527006767d'), UUID('7464d1af-bb6e-494b-b146-937b27487fc3'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1001", "windDirection": "040", "windSpeed": "4", "wind": "040/4"}, "objectives": []}')
2025-10-28 22:54:09,012 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:54:09,049 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:54:09,049 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-10-28 22:54:09,049 | INFO | sqlalchemy.engine.Engine | [cached since 224.4s ago] (UUID('051486bc-0d6b-4164-9c48-fa527006767d'),)
2025-10-28 22:54:09,052 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:54:53,120 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:48325]
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:54:53,121 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 22:54:53,146 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:54:53,146 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:54:53,146 | INFO | sqlalchemy.engine.Engine | [cached since 556s ago] ()
2025-10-28 22:54:53,148 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:54:53,148 | INFO | sqlalchemy.engine.Engine | [cached since 268.6s ago] (1,)
2025-10-28 22:54:53,162 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:54:53,162 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}) about to wait for the following futures []
2025-10-28 22:54:53,162 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}) done waiting for dependent futures
2025-10-28 22:54:53,162 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110626fd0>, 'osutil': <s3transfer.utils.OSUtils object at 0x110695450>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x1108ad370>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x110889bd0>}
2025-10-28 22:54:53,163 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/5a401a30ae1f4137bdcf624483fb97a7.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x1108ad370> for transfer request: 0.
2025-10-28 22:54:53,163 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:54:53,163 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/5a401a30ae1f4137bdcf624483fb97a7.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 22:54:53,163 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/5a401a30ae1f4137bdcf624483fb97a7.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 22:54:53,163 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/5a401a30ae1f4137bdcf624483fb97a7.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11088a5d0>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/5a401a30ae1f4137bdcf624483fb97a7.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 22:54:53,163 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:54:53,957 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:55:04,019 | INFO | app.controllers.audio | Transcripción recibida session=7464d1af-bb6e-494b-b146-937b27487fc3: pavas superficie Alfa Noviembre India en hangar 37 Solicitamos abrir plan de vuelo a zona Eco vía paso de Oumogo a 7000 pies dos almas a bordo. Capitán Salas Autonomía tres horas y media.
2025-10-28 22:55:04,019 | INFO | app.logs.transcript | student | session=7464d1af-bb6e-494b-b146-937b27487fc3 | frequency=121.7 | text=pavas superficie Alfa Noviembre India en hangar 37 Solicitamos abrir plan de vuelo a zona Eco vía paso de Oumogo a 7000 pies dos almas a bordo. Capitán Salas Autonomía tres horas y media.
2025-10-28 22:55:04,059 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:55:04,059 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:55:04,060 | INFO | sqlalchemy.engine.Engine | [cached since 209.9s ago] (UUID('7464d1af-bb6e-494b-b146-937b27487fc3'),)
2025-10-28 22:55:04,063 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:55:04,094 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:55:04,095 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:55:04,095 | INFO | sqlalchemy.engine.Engine | [cached since 209.9s ago] (UUID('7464d1af-bb6e-494b-b146-937b27487fc3'),)
2025-10-28 22:55:04,098 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:55:04,101 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
pavas superficie Alfa Noviembre India en hangar 37 Solicitamos abrir plan de vuelo a zona Eco vía paso de Oumogo a 7000 pies dos almas a bordo. Capitán Salas Autonomía tres horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuencia 121....
2025-10-28 22:55:05,051 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Asignamos pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa. Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 22:55:05,085 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:55:05,086 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:55:05,086 | INFO | sqlalchemy.engine.Engine | [cached since 210.9s ago] (UUID('7464d1af-bb6e-494b-b146-937b27487fc3'),)
2025-10-28 22:55:05,089 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:55:05,092 | INFO | app.logs.transcript | controller | session=7464d1af-bb6e-494b-b146-937b27487fc3 | frequency=121.7 | intent=ground_taxi_clearance | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Asignamos pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa. Avise listo.
2025-10-28 22:55:07,310 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:56:28,922 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 22:56:28,923 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:43897]
2025-10-28 22:56:28,924 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 22:56:28,924 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 22:56:28,967 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:56:28,967 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:56:28,967 | INFO | sqlalchemy.engine.Engine | [cached since 651.8s ago] ()
2025-10-28 22:56:28,970 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:56:28,970 | INFO | sqlalchemy.engine.Engine | [cached since 364.4s ago] (1,)
2025-10-28 22:56:28,987 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:56:28,988 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110759ba0>}) about to wait for the following futures []
2025-10-28 22:56:28,988 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110759ba0>}) done waiting for dependent futures
2025-10-28 22:56:28,988 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110759ba0>}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110666650>, 'osutil': <s3transfer.utils.OSUtils object at 0x110758770>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x11074b650>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x110759ba0>}
2025-10-28 22:56:28,988 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/436a305373604589908462d09ca6ea84.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x11074b650> for transfer request: 0.
2025-10-28 22:56:28,988 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 22:56:28,988 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/436a305373604589908462d09ca6ea84.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 22:56:28,988 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:56:28,988 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/436a305373604589908462d09ca6ea84.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 22:56:28,988 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/436a305373604589908462d09ca6ea84.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x110265940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11075b490>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/7464d1af-bb6e-494b-b146-937b27487fc3/436a305373604589908462d09ca6ea84.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 22:56:29,716 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 22:56:39,810 | INFO | app.controllers.audio | Transcripción recibida session=7464d1af-bb6e-494b-b146-937b27487fc3: QNH1001 transponder 0522. Redo Alfa dos Alfa Al.de espera pista 10. Alfa Noviembre India.
2025-10-28 22:56:39,810 | INFO | app.logs.transcript | student | session=7464d1af-bb6e-494b-b146-937b27487fc3 | frequency=121.7 | text=QNH1001 transponder 0522. Redo Alfa dos Alfa Al.de espera pista 10. Alfa Noviembre India.
2025-10-28 22:56:39,852 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:56:39,852 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:56:39,852 | INFO | sqlalchemy.engine.Engine | [cached since 305.7s ago] (UUID('7464d1af-bb6e-494b-b146-937b27487fc3'),)
2025-10-28 22:56:39,855 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:56:39,890 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:56:39,890 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:56:39,890 | INFO | sqlalchemy.engine.Engine | [cached since 305.7s ago] (UUID('7464d1af-bb6e-494b-b146-937b27487fc3'),)
2025-10-28 22:56:39,894 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:56:39,897 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
QNH1001 transponder 0522. Redo Alfa dos Alfa Al.de espera pista 10. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuencia 121.7)
- Identificador y ubicación de la aeronave (ANI en hangar 37)
- Ruta solicitada, punto de paso ...
2025-10-28 22:56:40,795 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Asignamos pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa. Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1.0,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 22:56:40,832 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:56:40,832 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 22:56:40,832 | INFO | sqlalchemy.engine.Engine | [cached since 306.7s ago] (UUID('7464d1af-bb6e-494b-b146-937b27487fc3'),)
2025-10-28 22:56:40,836 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:56:40,839 | INFO | app.logs.transcript | controller | session=7464d1af-bb6e-494b-b146-937b27487fc3 | frequency=121.7 | intent=ground_taxi_clearance | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Asignamos pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa. Avise listo.
2025-10-28 22:56:42,581 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 22:59:22,557 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 22:59:22,558 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:59:22,560 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 22:59:22,560 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:59:22,561 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 22:59:22,561 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 22:59:22,563 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:59:22,563 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 22:59:22,563 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:59:22,564 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:59:22,564 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 22:59:22,567 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:59:22,567 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:59:22,570 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:59:22,570 | INFO | sqlalchemy.engine.Engine | [cached since 0.003276s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:59:22,571 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:59:22,571 | INFO | sqlalchemy.engine.Engine | [cached since 0.004141s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:59:22,572 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:59:22,572 | INFO | sqlalchemy.engine.Engine | [cached since 0.004918s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:59:22,573 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 22:59:22,573 | INFO | sqlalchemy.engine.Engine | [cached since 0.005935s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 22:59:22,574 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:59:22,574 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 22:59:22,576 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 22:59:22,576 | INFO | sqlalchemy.engine.Engine | [cached since 0.001911s ago] ('account_type', 'pg_catalog')
2025-10-28 22:59:22,577 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 22:59:22,577 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 22:59:22,578 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 22:59:22,578 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 22:59:22,580 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 22:59:22,581 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 22:59:22,596 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:59:22,606 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 22:59:59,875 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:59:59,875 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 22:59:59,875 | INFO | sqlalchemy.engine.Engine | [cached since 37.31s ago] ()
2025-10-28 22:59:59,884 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 22:59:59,884 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] (1,)
2025-10-28 22:59:59,906 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-10-28 22:59:59,906 | INFO | sqlalchemy.engine.Engine | [generated in 0.00020s] (UUID('0bb32cc4-28d8-498e-a585-251bab7e8fc1'), UUID('f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1001", "windDirection": "040", "windSpeed": "4", "wind": "040/4"}, "objectives": []}')
2025-10-28 22:59:59,907 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 22:59:59,941 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 22:59:59,942 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-10-28 22:59:59,942 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] (UUID('0bb32cc4-28d8-498e-a585-251bab7e8fc1'),)
2025-10-28 22:59:59,945 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:00:22,479 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:00:22,480 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:53185]
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:00:22,481 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 23:00:22,513 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:00:22,514 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:00:22,514 | INFO | sqlalchemy.engine.Engine | [cached since 59.95s ago] ()
2025-10-28 23:00:22,517 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:00:22,517 | INFO | sqlalchemy.engine.Engine | [cached since 22.63s ago] (1,)
2025-10-28 23:00:22,530 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:00:22,530 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce68c20>}) about to wait for the following futures []
2025-10-28 23:00:22,530 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce68c20>}) done waiting for dependent futures
2025-10-28 23:00:22,530 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce68c20>}) with kwargs {'client': <botocore.client.S3 object at 0x10c789940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x10cb74d70>, 'osutil': <s3transfer.utils.OSUtils object at 0x10cb742f0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x10ce68440>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce68c20>}
2025-10-28 23:00:22,530 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/52e33be83f9742e59eaf016b8050e938.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x10ce68440> for transfer request: 0.
2025-10-28 23:00:22,530 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:00:22,531 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/52e33be83f9742e59eaf016b8050e938.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 23:00:22,531 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:00:22,531 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/52e33be83f9742e59eaf016b8050e938.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 23:00:22,531 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/52e33be83f9742e59eaf016b8050e938.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10c789940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x10ce69550>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/52e33be83f9742e59eaf016b8050e938.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 23:00:23,369 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:00:33,566 | INFO | app.controllers.audio | Transcripción recibida session=f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c: pa superficie Alfa Noviembre India solicitando abrir plan de vuelo a zona Eco vía paso de ocho Mogo 7000 pies dos almas a bordo. Capitán Salas. tres horas y media de autonomía.
2025-10-28 23:00:33,568 | INFO | app.logs.transcript | student | session=f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c | frequency=121.7 | text=pa superficie Alfa Noviembre India solicitando abrir plan de vuelo a zona Eco vía paso de ocho Mogo 7000 pies dos almas a bordo. Capitán Salas. tres horas y media de autonomía.
2025-10-28 23:00:33,609 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:00:33,610 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:00:33,610 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] (UUID('f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c'),)
2025-10-28 23:00:33,613 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:00:33,648 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:00:33,649 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:00:33,649 | INFO | sqlalchemy.engine.Engine | [cached since 0.03889s ago] (UUID('f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c'),)
2025-10-28 23:00:33,652 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:00:33,655 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
pa superficie Alfa Noviembre India solicitando abrir plan de vuelo a zona Eco vía paso de ocho Mogo 7000 pies dos almas a bordo. Capitán Salas. tres horas y media de autonomía.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuencia 121.7)
- Identi...
2025-10-28 23:00:34,884 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa, Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 23:00:34,933 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:00:34,934 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:00:34,934 | INFO | sqlalchemy.engine.Engine | [cached since 1.324s ago] (UUID('f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c'),)
2025-10-28 23:00:34,937 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:00:34,941 | INFO | app.logs.transcript | controller | session=f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c | frequency=121.7 | intent=ground_taxi_clearance | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa, Avise listo.
2025-10-28 23:00:37,402 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:01:14,317 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:01:14,317 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 23:01:14,317 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 23:01:14,317 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:01:14,317 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:38173]
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:01:14,318 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 23:01:14,346 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:01:14,346 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:01:14,346 | INFO | sqlalchemy.engine.Engine | [cached since 111.8s ago] ()
2025-10-28 23:01:14,348 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:01:14,348 | INFO | sqlalchemy.engine.Engine | [cached since 74.46s ago] (1,)
2025-10-28 23:01:14,361 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:01:14,361 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce6ec10>}) about to wait for the following futures []
2025-10-28 23:01:14,361 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce6ec10>}) done waiting for dependent futures
2025-10-28 23:01:14,361 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce6ec10>}) with kwargs {'client': <botocore.client.S3 object at 0x10c789940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x10cbb5590>, 'osutil': <s3transfer.utils.OSUtils object at 0x10ce6dbd0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x10ce50510>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x10ce6ec10>}
2025-10-28 23:01:14,361 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/415be48bcc2d43f1a4c5ec882a001698.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x10ce50510> for transfer request: 0.
2025-10-28 23:01:14,361 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:01:14,361 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/415be48bcc2d43f1a4c5ec882a001698.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 23:01:14,361 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/415be48bcc2d43f1a4c5ec882a001698.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 23:01:14,361 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/415be48bcc2d43f1a4c5ec882a001698.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10c789940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x10ce6f4d0>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c/415be48bcc2d43f1a4c5ec882a001698.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 23:01:14,362 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:01:15,388 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:01:25,353 | INFO | app.controllers.audio | Transcripción recibida session=f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c: QNH1001 Transponder 0522 R Vía Alfa dos Alfa al.de espera de pista 10 Alfa Noviembre India.
2025-10-28 23:01:25,353 | INFO | app.logs.transcript | student | session=f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c | frequency=121.7 | text=QNH1001 Transponder 0522 R Vía Alfa dos Alfa al.de espera de pista 10 Alfa Noviembre India.
2025-10-28 23:01:25,401 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:01:25,401 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:01:25,401 | INFO | sqlalchemy.engine.Engine | [cached since 51.79s ago] (UUID('f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c'),)
2025-10-28 23:01:25,404 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:01:25,439 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:01:25,440 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:01:25,440 | INFO | sqlalchemy.engine.Engine | [cached since 51.83s ago] (UUID('f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c'),)
2025-10-28 23:01:25,442 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:01:25,445 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
QNH1001 Transponder 0522 R Vía Alfa dos Alfa al.de espera de pista 10 Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuencia 121.7)
- Identificador y ubicación de la aeronave (ANI en hangar 37)
- Ruta solicitada, punto de pas...
2025-10-28 23:01:26,238 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa, Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 23:01:26,282 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:01:26,283 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:01:26,283 | INFO | sqlalchemy.engine.Engine | [cached since 52.67s ago] (UUID('f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c'),)
2025-10-28 23:01:26,286 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:01:26,290 | INFO | app.logs.transcript | controller | session=f4bb0ff3-6cf5-4063-ab8f-5f875f89b20c | frequency=121.7 | intent=ground_taxi_clearance | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Rodaje Alfa 2, Alfa, Avise listo.
2025-10-28 23:01:28,207 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:02:59,251 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 23:02:59,251 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:02:59,253 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 23:02:59,253 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:02:59,255 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 23:02:59,255 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:02:59,257 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:02:59,257 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 23:02:59,257 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-10-28 23:02:59,259 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:02:59,259 | INFO | sqlalchemy.engine.Engine | [generated in 0.00035s] ()
2025-10-28 23:02:59,261 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:02:59,261 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:02:59,265 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:02:59,265 | INFO | sqlalchemy.engine.Engine | [cached since 0.00361s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:02:59,266 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:02:59,266 | INFO | sqlalchemy.engine.Engine | [cached since 0.004585s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:02:59,267 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:02:59,267 | INFO | sqlalchemy.engine.Engine | [cached since 0.005406s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:02:59,268 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:02:59,268 | INFO | sqlalchemy.engine.Engine | [cached since 0.006398s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:02:59,269 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:02:59,269 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 23:02:59,271 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:02:59,271 | INFO | sqlalchemy.engine.Engine | [cached since 0.002415s ago] ('account_type', 'pg_catalog')
2025-10-28 23:02:59,272 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 23:02:59,272 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 23:02:59,275 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 23:02:59,275 | INFO | sqlalchemy.engine.Engine | [generated in 0.00022s] ()
2025-10-28 23:02:59,278 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 23:02:59,278 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ()
2025-10-28 23:02:59,293 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:02:59,302 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 23:03:42,252 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 23:03:42,252 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:03:42,254 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 23:03:42,254 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:03:42,255 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 23:03:42,255 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:03:42,256 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:03:42,256 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 23:03:42,257 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 23:03:42,257 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:03:42,258 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-10-28 23:03:42,260 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:03:42,260 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:03:42,262 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:03:42,262 | INFO | sqlalchemy.engine.Engine | [cached since 0.002126s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:03:42,262 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:03:42,262 | INFO | sqlalchemy.engine.Engine | [cached since 0.002727s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:03:42,263 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:03:42,263 | INFO | sqlalchemy.engine.Engine | [cached since 0.003229s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:03:42,263 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:03:42,263 | INFO | sqlalchemy.engine.Engine | [cached since 0.003747s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:03:42,265 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:03:42,265 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-10-28 23:03:42,266 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:03:42,266 | INFO | sqlalchemy.engine.Engine | [cached since 0.001185s ago] ('account_type', 'pg_catalog')
2025-10-28 23:03:42,266 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 23:03:42,266 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 23:03:42,267 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 23:03:42,267 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 23:03:42,268 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 23:03:42,268 | INFO | sqlalchemy.engine.Engine | [generated in 0.00022s] ()
2025-10-28 23:03:42,276 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:03:42,285 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 23:04:16,547 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 23:04:16,547 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:04:16,549 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 23:04:16,549 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:04:16,551 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 23:04:16,551 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:04:16,553 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:04:16,553 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 23:04:16,553 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 23:04:16,555 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:04:16,555 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ()
2025-10-28 23:04:16,557 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:16,557 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:16,560 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:16,560 | INFO | sqlalchemy.engine.Engine | [cached since 0.00324s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:16,561 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:16,561 | INFO | sqlalchemy.engine.Engine | [cached since 0.004066s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:16,562 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:16,562 | INFO | sqlalchemy.engine.Engine | [cached since 0.00466s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:16,563 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:16,563 | INFO | sqlalchemy.engine.Engine | [cached since 0.005737s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:16,564 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:04:16,564 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-10-28 23:04:16,566 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:04:16,566 | INFO | sqlalchemy.engine.Engine | [cached since 0.001447s ago] ('account_type', 'pg_catalog')
2025-10-28 23:04:16,566 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 23:04:16,566 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 23:04:16,567 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 23:04:16,567 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 23:04:16,568 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 23:04:16,568 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-10-28 23:04:16,580 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:04:16,592 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 23:04:34,943 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 23:04:34,943 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:04:34,946 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 23:04:34,946 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:04:34,947 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 23:04:34,947 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:04:34,949 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:04:34,949 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 23:04:34,949 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 23:04:34,950 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:04:34,950 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 23:04:34,953 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:34,953 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:34,955 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:34,955 | INFO | sqlalchemy.engine.Engine | [cached since 0.002902s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:34,956 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:34,956 | INFO | sqlalchemy.engine.Engine | [cached since 0.003764s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:34,957 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:34,957 | INFO | sqlalchemy.engine.Engine | [cached since 0.004553s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:34,958 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:04:34,958 | INFO | sqlalchemy.engine.Engine | [cached since 0.005362s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:04:34,959 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:04:34,959 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-10-28 23:04:34,962 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:04:34,962 | INFO | sqlalchemy.engine.Engine | [cached since 0.002258s ago] ('account_type', 'pg_catalog')
2025-10-28 23:04:34,963 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 23:04:34,963 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 23:04:34,964 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 23:04:34,964 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 23:04:34,966 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 23:04:34,966 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-10-28 23:04:34,981 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:04:34,987 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 23:05:34,038 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:05:34,038 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:05:34,038 | INFO | sqlalchemy.engine.Engine | [cached since 59.09s ago] ()
2025-10-28 23:05:34,046 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:05:34,046 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] (1,)
2025-10-28 23:05:34,057 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-10-28 23:05:34,057 | INFO | sqlalchemy.engine.Engine | [generated in 0.00019s] (UUID('235a995d-3b9e-4e88-b54f-464d7b19a4b9'), UUID('a3c317f1-6a78-4605-8fb8-fcf3d83c8353'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1001", "windDirection": "040", "windSpeed": "4", "wind": "040/4"}, "objectives": []}')
2025-10-28 23:05:34,059 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:05:34,095 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:05:34,096 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-10-28 23:05:34,096 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] (UUID('235a995d-3b9e-4e88-b54f-464d7b19a4b9'),)
2025-10-28 23:05:34,098 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:06:00,882 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:06:00,882 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 23:06:00,882 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 23:06:00,882 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:06:00,882 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:51889]
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:06:00,883 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 23:06:00,915 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:06:00,916 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:06:00,916 | INFO | sqlalchemy.engine.Engine | [cached since 85.96s ago] ()
2025-10-28 23:06:00,918 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:06:00,918 | INFO | sqlalchemy.engine.Engine | [cached since 26.87s ago] (1,)
2025-10-28 23:06:00,939 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:06:00,939 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a68c20>}) about to wait for the following futures []
2025-10-28 23:06:00,939 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a68c20>}) done waiting for dependent futures
2025-10-28 23:06:00,939 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a68c20>}) with kwargs {'client': <botocore.client.S3 object at 0x10c4f1940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110950d70>, 'osutil': <s3transfer.utils.OSUtils object at 0x1109502f0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x110a68440>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a68c20>}
2025-10-28 23:06:00,939 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/20fa116dc7a64dfaa667b40f48734cf2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x110a68440> for transfer request: 0.
2025-10-28 23:06:00,939 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:06:00,939 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/20fa116dc7a64dfaa667b40f48734cf2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 23:06:00,939 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/20fa116dc7a64dfaa667b40f48734cf2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 23:06:00,939 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/20fa116dc7a64dfaa667b40f48734cf2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10c4f1940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x110a69550>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/20fa116dc7a64dfaa667b40f48734cf2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 23:06:00,941 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:06:01,880 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:06:14,208 | INFO | app.controllers.audio | Transcripción recibida session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353: pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir el plan de vuelo a zona Eco vía paso de Oomogo 7000 pies dos almas a bordo. Capitán Salas Autonomía tres horas 30 minutos.
2025-10-28 23:06:14,208 | INFO | app.logs.transcript | student | session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 | frequency=121.7 | text=pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir el plan de vuelo a zona Eco vía paso de Oomogo 7000 pies dos almas a bordo. Capitán Salas Autonomía tres horas 30 minutos.
2025-10-28 23:06:14,248 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:06:14,248 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:06:14,248 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] (UUID('a3c317f1-6a78-4605-8fb8-fcf3d83c8353'),)
2025-10-28 23:06:14,251 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:06:14,285 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:06:14,285 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:06:14,285 | INFO | sqlalchemy.engine.Engine | [cached since 0.03677s ago] (UUID('a3c317f1-6a78-4605-8fb8-fcf3d83c8353'),)
2025-10-28 23:06:14,288 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:06:14,291 | INFO | app.controllers.audio | Fase activa session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 phase_id=ground_departure_request intent=ground_taxi_clearance freq=ground
2025-10-28 23:06:14,291 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir el plan de vuelo a zona Eco vía paso de Oomogo 7000 pies dos almas a bordo. Capitán Salas Autonomía tres horas 30 minutos.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuenc...
2025-10-28 23:06:15,687 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Taxi vía Alfa 2, Alfa. Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 23:06:15,688 | INFO | app.controllers.audio | Transición automática de fase session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 de=ground_departure_request a=ground_readback
2025-10-28 23:06:15,730 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:06:15,731 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:06:15,731 | INFO | sqlalchemy.engine.Engine | [cached since 1.482s ago] (UUID('a3c317f1-6a78-4605-8fb8-fcf3d83c8353'),)
2025-10-28 23:06:15,734 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:06:15,737 | INFO | app.logs.transcript | controller | session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Taxi vía Alfa 2, Alfa. Avise listo.
2025-10-28 23:06:18,378 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:07:13,446 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 23:07:13,448 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:07:13,449 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:07:13,449 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:33205]
2025-10-28 23:07:13,449 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:07:13,449 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 23:07:13,472 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:07:13,472 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:07:13,472 | INFO | sqlalchemy.engine.Engine | [cached since 158.5s ago] ()
2025-10-28 23:07:13,474 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:07:13,474 | INFO | sqlalchemy.engine.Engine | [cached since 99.43s ago] (1,)
2025-10-28 23:07:13,482 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:07:13,482 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a6ec10>}) about to wait for the following futures []
2025-10-28 23:07:13,482 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a6ec10>}) done waiting for dependent futures
2025-10-28 23:07:13,482 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a6ec10>}) with kwargs {'client': <botocore.client.S3 object at 0x10c4f1940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110991590>, 'osutil': <s3transfer.utils.OSUtils object at 0x110a6dbd0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x110a50510>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x110a6ec10>}
2025-10-28 23:07:13,482 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/e0bbd8d71d1d4de6ac02733cb6b1c094.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x110a50510> for transfer request: 0.
2025-10-28 23:07:13,482 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:07:13,482 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/e0bbd8d71d1d4de6ac02733cb6b1c094.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 23:07:13,482 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/e0bbd8d71d1d4de6ac02733cb6b1c094.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 23:07:13,482 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/e0bbd8d71d1d4de6ac02733cb6b1c094.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10c4f1940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x110a6f4d0>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/a3c317f1-6a78-4605-8fb8-fcf3d83c8353/e0bbd8d71d1d4de6ac02733cb6b1c094.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 23:07:13,483 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:07:14,630 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:07:24,556 | INFO | app.controllers.audio | Transcripción recibida session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353: QNH1001 transponder 0522. Redo Vía Alfa dos Alfa el.de espera pista 10.
2025-10-28 23:07:24,557 | INFO | app.logs.transcript | student | session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 | frequency=121.7 | text=QNH1001 transponder 0522. Redo Vía Alfa dos Alfa el.de espera pista 10.
2025-10-28 23:07:24,595 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:07:24,596 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:07:24,596 | INFO | sqlalchemy.engine.Engine | [cached since 70.35s ago] (UUID('a3c317f1-6a78-4605-8fb8-fcf3d83c8353'),)
2025-10-28 23:07:24,599 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:07:24,633 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:07:24,634 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:07:24,634 | INFO | sqlalchemy.engine.Engine | [cached since 70.39s ago] (UUID('a3c317f1-6a78-4605-8fb8-fcf3d83c8353'),)
2025-10-28 23:07:24,637 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:07:24,640 | INFO | app.controllers.audio | Fase activa session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 phase_id=ground_departure_request intent=ground_taxi_clearance freq=ground
2025-10-28 23:07:24,640 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
QNH1001 transponder 0522. Redo Vía Alfa dos Alfa el.de espera pista 10.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuencia 121.7)
- Identificador y ubicación de la aeronave (ANI en hangar 37)
- Ruta solicitada, punto de paso y altitud (Zona Ec...
2025-10-28 23:07:25,416 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Taxi vía Alfa 2, Alfa. Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 23:07:25,417 | INFO | app.controllers.audio | Transición automática de fase session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 de=ground_departure_request a=ground_readback
2025-10-28 23:07:25,467 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:07:25,467 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:07:25,467 | INFO | sqlalchemy.engine.Engine | [cached since 71.22s ago] (UUID('a3c317f1-6a78-4605-8fb8-fcf3d83c8353'),)
2025-10-28 23:07:25,470 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:07:25,474 | INFO | app.logs.transcript | controller | session=a3c317f1-6a78-4605-8fb8-fcf3d83c8353 | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados, 4 nudos, QNH 1001, squawk 0522. Taxi vía Alfa 2, Alfa. Avise listo.
2025-10-28 23:07:27,392 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:22:14,079 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-10-28 23:22:14,080 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:22:14,082 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-10-28 23:22:14,082 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:22:14,084 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-10-28 23:22:14,084 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-10-28 23:22:14,086 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:22:14,086 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-10-28 23:22:14,086 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-10-28 23:22:14,088 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:22:14,088 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-10-28 23:22:14,091 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:22:14,091 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:22:14,094 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:22:14,094 | INFO | sqlalchemy.engine.Engine | [cached since 0.003725s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:22:14,095 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:22:14,095 | INFO | sqlalchemy.engine.Engine | [cached since 0.004694s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:22:14,096 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:22:14,097 | INFO | sqlalchemy.engine.Engine | [cached since 0.005771s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:22:14,097 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-10-28 23:22:14,097 | INFO | sqlalchemy.engine.Engine | [cached since 0.006591s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-10-28 23:22:14,099 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:22:14,099 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ('user_status', 'pg_catalog')
2025-10-28 23:22:14,101 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-10-28 23:22:14,101 | INFO | sqlalchemy.engine.Engine | [cached since 0.002063s ago] ('account_type', 'pg_catalog')
2025-10-28 23:22:14,102 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-10-28 23:22:14,102 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 23:22:14,103 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-10-28 23:22:14,104 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-10-28 23:22:14,106 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-10-28 23:22:14,106 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] ()
2025-10-28 23:22:14,119 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:22:14,130 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-10-28 23:22:51,019 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:22:51,019 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:22:51,019 | INFO | sqlalchemy.engine.Engine | [cached since 36.93s ago] ()
2025-10-28 23:22:51,028 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:22:51,028 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] (1,)
2025-10-28 23:22:51,044 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-10-28 23:22:51,044 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] (UUID('e213ada5-435f-438c-9527-70b5d3fee928'), UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1001", "windDirection": "040", "windSpeed": "4", "wind": "040/4"}, "objectives": []}')
2025-10-28 23:22:51,046 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:22:51,081 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:22:51,081 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-10-28 23:22:51,082 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] (UUID('e213ada5-435f-438c-9527-70b5d3fee928'),)
2025-10-28 23:22:51,083 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:23:23,742 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:23:23,743 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:48433]
2025-10-28 23:23:23,743 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:23:23,743 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 23:23:23,767 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:23:23,768 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:23:23,768 | INFO | sqlalchemy.engine.Engine | [cached since 69.68s ago] ()
2025-10-28 23:23:23,770 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:23:23,770 | INFO | sqlalchemy.engine.Engine | [cached since 32.74s ago] (1,)
2025-10-28 23:23:23,783 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:23:23,783 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x111068c20>}) about to wait for the following futures []
2025-10-28 23:23:23,783 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x111068c20>}) done waiting for dependent futures
2025-10-28 23:23:23,784 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x111068c20>}) with kwargs {'client': <botocore.client.S3 object at 0x110b61940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110f50d70>, 'osutil': <s3transfer.utils.OSUtils object at 0x110f502f0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x111068440>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x111068c20>}
2025-10-28 23:23:23,784 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/c216895948214eb49e4fbec788bb1951.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x111068440> for transfer request: 0.
2025-10-28 23:23:23,784 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:23:23,784 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/c216895948214eb49e4fbec788bb1951.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 23:23:23,784 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/c216895948214eb49e4fbec788bb1951.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 23:23:23,784 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/c216895948214eb49e4fbec788bb1951.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x110b61940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x111069550>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/c216895948214eb49e4fbec788bb1951.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 23:23:23,786 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:23:24,514 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:23:34,784 | INFO | app.controllers.audio | Transcripción recibida session=60fbd589-4bbe-40b2-8149-98599b9f045d: pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía Paso de Ochoomogo 7000 pies dos almas a bordo, Capitán Salas. tres horas y media de autonomía.
2025-10-28 23:23:34,784 | INFO | app.logs.transcript | student | session=60fbd589-4bbe-40b2-8149-98599b9f045d | frequency=121.7 | text=pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía Paso de Ochoomogo 7000 pies dos almas a bordo, Capitán Salas. tres horas y media de autonomía.
2025-10-28 23:23:34,829 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:23:34,830 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:23:34,830 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:23:34,833 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:23:34,867 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:23:34,867 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:23:34,867 | INFO | sqlalchemy.engine.Engine | [cached since 0.03724s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:23:34,871 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-10-28 23:23:34,871 | INFO | sqlalchemy.engine.Engine | [generated in 0.00019s] ('{"meteo": {"qnh": "1001", "vis": ">10km", "wind": "040/4", "condition": "VMC", "windSpeed": "4", "windDirection": "040"}, "route": "MRPV-MRPV", "obje ... (5758 characters truncated) ... ">10km", "wind": "040/4", "condition": "VMC", "windSpeed": "4", "windDirection": "040"}, "route": "MRPV-MRPV", "timestamp": "2025-10-29T05:23:34Z"}]}', datetime.datetime(2025, 10, 29, 5, 23, 34, 871178), UUID('e213ada5-435f-438c-9527-70b5d3fee928'))
2025-10-28 23:23:34,874 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:23:34,885 | INFO | app.controllers.audio | Fase activa session=60fbd589-4bbe-40b2-8149-98599b9f045d phase_id=ground_departure_request intent=ground_taxi_clearance freq=ground
2025-10-28 23:23:34,885 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona Eco vía Paso de Ochoomogo 7000 pies dos almas a bordo, Capitán Salas. tres horas y media de autonomía.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superficie / frecuen...
2025-10-28 23:23:36,253 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados a 4 nudos, QNH 1001, squawque 0522, rodaje Alfa 2, Alfa. Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 100,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-10-28 23:23:36,254 | INFO | app.controllers.audio | Transición automática de fase session=60fbd589-4bbe-40b2-8149-98599b9f045d de=ground_departure_request a=ground_readback
2025-10-28 23:23:36,294 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:23:36,294 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:23:36,294 | INFO | sqlalchemy.engine.Engine | [cached since 1.465s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:23:36,299 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-10-28 23:23:36,299 | INFO | sqlalchemy.engine.Engine | [cached since 1.428s ago] ('{"meteo": {"qnh": "1001", "vis": ">10km", "wind": "040/4", "condition": "VMC", "windSpeed": "4", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (6534 characters truncated) ... ]}, "objectives": [], "frequencies": {"ground": "121.7", "tower": "118.3"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "ground"}', datetime.datetime(2025, 10, 29, 5, 23, 36, 299145), UUID('e213ada5-435f-438c-9527-70b5d3fee928'))
2025-10-28 23:23:36,301 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:23:36,309 | INFO | app.logs.transcript | controller | session=60fbd589-4bbe-40b2-8149-98599b9f045d | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Pista uno cero, viento 40 grados a 4 nudos, QNH 1001, squawque 0522, rodaje Alfa 2, Alfa. Avise listo.
2025-10-28 23:23:38,392 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:24:19,417 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:24:19,417 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 23:24:19,417 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 23:24:19,417 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:24:19,417 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:35473]
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:24:19,418 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 23:24:19,442 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:24:19,442 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:24:19,442 | INFO | sqlalchemy.engine.Engine | [cached since 125.4s ago] ()
2025-10-28 23:24:19,445 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:24:19,445 | INFO | sqlalchemy.engine.Engine | [cached since 88.42s ago] (1,)
2025-10-28 23:24:19,458 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:24:19,458 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106ed50>}) about to wait for the following futures []
2025-10-28 23:24:19,458 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106ed50>}) done waiting for dependent futures
2025-10-28 23:24:19,458 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106ed50>}) with kwargs {'client': <botocore.client.S3 object at 0x110b61940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110f91590>, 'osutil': <s3transfer.utils.OSUtils object at 0x11106e5d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x111058510>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106ed50>}
2025-10-28 23:24:19,458 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/9eb47c192f924342b6630b0619c76f02.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x111058510> for transfer request: 0.
2025-10-28 23:24:19,458 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:24:19,458 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/9eb47c192f924342b6630b0619c76f02.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 23:24:19,458 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/9eb47c192f924342b6630b0619c76f02.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 23:24:19,458 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:24:19,458 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/9eb47c192f924342b6630b0619c76f02.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x110b61940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11106f610>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/9eb47c192f924342b6630b0619c76f02.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 23:24:20,215 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:24:30,194 | INFO | app.controllers.audio | Transcripción recibida session=60fbd589-4bbe-40b2-8149-98599b9f045d: QN 1001 Transponder 0522 Redo Vía Alpha dos Alpha al.de espera pista 10. Alfa Noviembre India.
2025-10-28 23:24:30,194 | INFO | app.logs.transcript | student | session=60fbd589-4bbe-40b2-8149-98599b9f045d | frequency=121.7 | text=QN 1001 Transponder 0522 Redo Vía Alpha dos Alpha al.de espera pista 10. Alfa Noviembre India.
2025-10-28 23:24:30,239 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:24:30,240 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:24:30,240 | INFO | sqlalchemy.engine.Engine | [cached since 55.41s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:24:30,243 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:24:30,278 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:24:30,278 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:24:30,278 | INFO | sqlalchemy.engine.Engine | [cached since 55.45s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:24:30,281 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-10-28 23:24:30,282 | INFO | sqlalchemy.engine.Engine | [cached since 55.41s ago] ('{"meteo": {"qnh": "1001", "vis": ">10km", "wind": "040/4", "condition": "VMC", "windSpeed": "4", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (6869 characters truncated) ... "}, "objectives": [], "frequencies": {"tower": "118.3", "ground": "121.7"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "ground"}', datetime.datetime(2025, 10, 29, 5, 24, 30, 281902), UUID('e213ada5-435f-438c-9527-70b5d3fee928'))
2025-10-28 23:24:30,285 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:24:30,293 | INFO | app.controllers.audio | Fase activa session=60fbd589-4bbe-40b2-8149-98599b9f045d phase_id=ground_readback intent=ground_taxi_readback freq=ground
2025-10-28 23:24:30,293 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_readback freq_group=ground
SYSTEM> Sigues siendo Pavas Superficie en 121.7. Evalúas el readback del alumno tras la autorización de taxi. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Readback de autorización de taxi
Intent esperado: ground_taxi_readback
Transcripción textual del alumno:
QN 1001 Transponder 0522 Redo Vía Alpha dos Alpha al.de espera pista 10. Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Repite QNH asignado.
- Repite transponder asignado.
- Confirma ruta de rodaje y pista.
- Cierra con identificador correcto.

Checklist controlador:
- Comparar la cola...
2025-10-28 23:24:30,969 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_readback: {
  "intent": "ground_taxi_readback",
  "allowResponse": false,
  "controllerText": null,
  "feedback": "Falta repetir la ruta de rodaje completa y la pista asignada.",
  "confidence": null,
  "metadata": {
    "missingItems": ["Ruta de rodaje completa", "Pista asignada"]
  }
}
2025-10-28 23:24:31,022 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:24:31,023 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:24:31,023 | INFO | sqlalchemy.engine.Engine | [cached since 56.19s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:24:31,027 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-10-28 23:24:31,027 | INFO | sqlalchemy.engine.Engine | [cached since 56.16s ago] ('{"meteo": {"qnh": "1001", "vis": ">10km", "wind": "040/4", "condition": "VMC", "windSpeed": "4", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (7504 characters truncated) ... "}, "objectives": [], "frequencies": {"tower": "118.3", "ground": "121.7"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "ground"}', datetime.datetime(2025, 10, 29, 5, 24, 31, 26999), UUID('e213ada5-435f-438c-9527-70b5d3fee928'))
2025-10-28 23:24:31,029 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:24:31,037 | INFO | app.logs.transcript | controller | session=60fbd589-4bbe-40b2-8149-98599b9f045d | frequency=121.7 | intent=ground_taxi_readback | phase=ground_readback | allow_response=False | text=
2025-10-28 23:24:31,037 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:25:28,141 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-10-28 23:25:28,142 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-10-28 23:25:28,143 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:40333]
2025-10-28 23:25:28,143 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-10-28 23:25:28,143 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-10-28 23:25:28,168 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:25:28,168 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-10-28 23:25:28,168 | INFO | sqlalchemy.engine.Engine | [cached since 194.1s ago] ()
2025-10-28 23:25:28,170 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-10-28 23:25:28,170 | INFO | sqlalchemy.engine.Engine | [cached since 157.1s ago] (1,)
2025-10-28 23:25:28,185 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:25:28,185 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106f250>}) about to wait for the following futures []
2025-10-28 23:25:28,185 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106f250>}) done waiting for dependent futures
2025-10-28 23:25:28,185 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106f250>}) with kwargs {'client': <botocore.client.S3 object at 0x110b61940>, 'config': <boto3.s3.transfer.TransferConfig object at 0x110f93750>, 'osutil': <s3transfer.utils.OSUtils object at 0x110f90f50>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x1110f0050>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x11106f250>}
2025-10-28 23:25:28,185 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/2463a8aa2997439ab34f27ce529f1e92.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x1110f0050> for transfer request: 0.
2025-10-28 23:25:28,185 | DEBUG | s3transfer.utils | Acquiring 0
2025-10-28 23:25:28,185 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/2463a8aa2997439ab34f27ce529f1e92.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-10-28 23:25:28,185 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/2463a8aa2997439ab34f27ce529f1e92.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-10-28 23:25:28,186 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/2463a8aa2997439ab34f27ce529f1e92.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x110b61940>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11106f750>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/60fbd589-4bbe-40b2-8149-98599b9f045d/2463a8aa2997439ab34f27ce529f1e92.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-10-28 23:25:28,186 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:25:28,933 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-10-28 23:25:38,995 | INFO | app.controllers.audio | Transcripción recibida session=60fbd589-4bbe-40b2-8149-98599b9f045d: Q N 1001 Transponder 0522 Redo vía Alpha dos Alpha al.de espera de la pista 10 Alfa Noviembre India.
2025-10-28 23:25:38,995 | INFO | app.logs.transcript | student | session=60fbd589-4bbe-40b2-8149-98599b9f045d | frequency=121.7 | text=Q N 1001 Transponder 0522 Redo vía Alpha dos Alpha al.de espera de la pista 10 Alfa Noviembre India.
2025-10-28 23:25:39,037 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:25:39,038 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:25:39,038 | INFO | sqlalchemy.engine.Engine | [cached since 124.2s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:25:39,041 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-10-28 23:25:39,076 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:25:39,076 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:25:39,076 | INFO | sqlalchemy.engine.Engine | [cached since 124.2s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:25:39,080 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-10-28 23:25:39,080 | INFO | sqlalchemy.engine.Engine | [cached since 124.2s ago] ('{"meteo": {"qnh": "1001", "vis": ">10km", "wind": "040/4", "condition": "VMC", "windSpeed": "4", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (7845 characters truncated) ... "}, "objectives": [], "frequencies": {"tower": "118.3", "ground": "121.7"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "ground"}', datetime.datetime(2025, 10, 29, 5, 25, 39, 79974), UUID('e213ada5-435f-438c-9527-70b5d3fee928'))
2025-10-28 23:25:39,082 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:25:39,090 | INFO | app.controllers.audio | Fase activa session=60fbd589-4bbe-40b2-8149-98599b9f045d phase_id=ground_readback intent=ground_taxi_readback freq=ground
2025-10-28 23:25:39,090 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_readback freq_group=ground
SYSTEM> Sigues siendo Pavas Superficie en 121.7. Evalúas el readback del alumno tras la autorización de taxi. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Readback de autorización de taxi
Intent esperado: ground_taxi_readback
Transcripción textual del alumno:
Q N 1001 Transponder 0522 Redo vía Alpha dos Alpha al.de espera de la pista 10 Alfa Noviembre India.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Repite QNH asignado.
- Repite transponder asignado.
- Confirma ruta de rodaje y pista.
- Cierra con identificador correcto.

Checklist controlador:
- Comparar l...
2025-10-28 23:25:39,673 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_readback: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, colación correcta.",
  "feedback": "Colación correcta.",
  "confidence": 100,
  "metadata": {}
}
2025-10-28 23:25:39,674 | INFO | app.controllers.audio | Transición automática de fase session=60fbd589-4bbe-40b2-8149-98599b9f045d de=ground_readback a=tower_ready
2025-10-28 23:25:39,728 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-10-28 23:25:39,728 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-10-28 23:25:39,729 | INFO | sqlalchemy.engine.Engine | [cached since 124.9s ago] (UUID('60fbd589-4bbe-40b2-8149-98599b9f045d'),)
2025-10-28 23:25:39,733 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-10-28 23:25:39,733 | INFO | sqlalchemy.engine.Engine | [cached since 124.9s ago] ('{"meteo": {"qnh": "1001", "vis": ">10km", "wind": "040/4", "condition": "VMC", "windSpeed": "4", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (8345 characters truncated) ... t"}, "objectives": [], "frequencies": {"tower": "118.3", "ground": "121.7"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "tower"}', datetime.datetime(2025, 10, 29, 5, 25, 39, 733300), UUID('e213ada5-435f-438c-9527-70b5d3fee928'))
2025-10-28 23:25:39,736 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-10-28 23:25:39,746 | INFO | app.logs.transcript | controller | session=60fbd589-4bbe-40b2-8149-98599b9f045d | frequency=121.7 | intent=ground_taxi_readback | phase=tower_ready | allow_response=True | text=Alfa Noviembre India, colación correcta.
2025-10-28 23:25:40,835 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:25:22,027 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:25:22,027 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:25:22,032 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:25:22,032 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:25:22,051 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:25:22,051 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:25:22,056 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:25:22,056 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:25:22,056 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 19:25:22,062 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:25:22,063 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-11-04 19:25:22,066 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:25:22,066 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:25:22,075 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:25:22,075 | INFO | sqlalchemy.engine.Engine | [cached since 0.009267s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:25:22,077 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:25:22,077 | INFO | sqlalchemy.engine.Engine | [cached since 0.01085s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:25:22,078 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:25:22,078 | INFO | sqlalchemy.engine.Engine | [cached since 0.01196s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:25:22,079 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:25:22,079 | INFO | sqlalchemy.engine.Engine | [cached since 0.01274s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:25:22,080 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:25:22,081 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 19:25:22,087 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:25:22,087 | INFO | sqlalchemy.engine.Engine | [cached since 0.006188s ago] ('account_type', 'pg_catalog')
2025-11-04 19:25:22,088 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:25:22,088 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 19:25:22,092 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:25:22,092 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 19:25:22,095 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:25:22,095 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-11-04 19:25:22,120 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:25:22,133 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:30:23,615 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:30:23,615 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:30:23,618 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:30:23,618 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:30:23,620 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:30:23,620 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:30:23,622 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:30:23,622 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:30:23,622 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 19:30:23,623 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:30:23,623 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:30:23,626 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:30:23,626 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:30:23,631 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:30:23,631 | INFO | sqlalchemy.engine.Engine | [cached since 0.005768s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:30:23,632 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:30:23,632 | INFO | sqlalchemy.engine.Engine | [cached since 0.006683s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:30:23,633 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:30:23,633 | INFO | sqlalchemy.engine.Engine | [cached since 0.007533s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:30:23,634 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:30:23,634 | INFO | sqlalchemy.engine.Engine | [cached since 0.008346s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:30:23,636 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:30:23,636 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 19:30:23,638 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:30:23,638 | INFO | sqlalchemy.engine.Engine | [cached since 0.00285s ago] ('account_type', 'pg_catalog')
2025-11-04 19:30:23,640 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:30:23,640 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 19:30:23,642 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:30:23,642 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:30:23,645 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:30:23,645 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-11-04 19:30:23,665 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:30:23,678 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:35:39,606 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:35:39,606 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:35:39,609 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:35:39,609 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:35:39,611 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:35:39,611 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:35:39,613 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:35:39,613 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:35:39,613 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:35:39,615 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:35:39,615 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 19:35:39,617 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:35:39,617 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:35:39,622 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:35:39,622 | INFO | sqlalchemy.engine.Engine | [cached since 0.005031s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:35:39,623 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:35:39,623 | INFO | sqlalchemy.engine.Engine | [cached since 0.006114s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:35:39,624 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:35:39,624 | INFO | sqlalchemy.engine.Engine | [cached since 0.006892s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:35:39,625 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:35:39,625 | INFO | sqlalchemy.engine.Engine | [cached since 0.007814s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:35:39,627 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:35:39,627 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-11-04 19:35:39,629 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:35:39,629 | INFO | sqlalchemy.engine.Engine | [cached since 0.002796s ago] ('account_type', 'pg_catalog')
2025-11-04 19:35:39,631 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:35:39,631 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:35:39,634 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:35:39,634 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 19:35:39,636 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:35:39,636 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 19:35:39,651 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:35:39,682 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:41:05,925 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:41:05,925 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:41:05,928 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:41:05,928 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:41:05,930 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:41:05,930 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:41:05,931 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:41:05,931 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:41:05,931 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 19:41:05,933 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:41:05,933 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 19:41:05,936 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:41:05,936 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:41:05,940 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:41:05,940 | INFO | sqlalchemy.engine.Engine | [cached since 0.004204s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:41:05,940 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:41:05,940 | INFO | sqlalchemy.engine.Engine | [cached since 0.004932s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:41:05,941 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:41:05,942 | INFO | sqlalchemy.engine.Engine | [cached since 0.006077s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:41:05,942 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:41:05,942 | INFO | sqlalchemy.engine.Engine | [cached since 0.006895s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:41:05,944 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:41:05,944 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 19:41:05,946 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:41:05,946 | INFO | sqlalchemy.engine.Engine | [cached since 0.002091s ago] ('account_type', 'pg_catalog')
2025-11-04 19:41:05,947 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:41:05,947 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:41:05,949 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:41:05,949 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 19:41:05,951 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:41:05,951 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-11-04 19:41:05,967 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:41:05,976 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:44:32,641 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:44:32,642 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:44:32,642 | INFO | sqlalchemy.engine.Engine | [cached since 206.7s ago] ()
2025-11-04 19:44:32,660 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-11-04 19:44:32,660 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] ('hola@email.com',)
2025-11-04 19:44:32,688 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:44:38,630 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:44:38,630 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:44:38,630 | INFO | sqlalchemy.engine.Engine | [cached since 212.7s ago] ()
2025-11-04 19:44:38,633 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-11-04 19:44:38,633 | INFO | sqlalchemy.engine.Engine | [cached since 5.973s ago] ('hola@mail.com',)
2025-11-04 19:44:38,677 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:44:51,261 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:44:51,261 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:44:51,261 | INFO | sqlalchemy.engine.Engine | [cached since 225.3s ago] ()
2025-11-04 19:44:51,265 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 19:44:51,265 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] (1,)
2025-11-04 19:44:51,280 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-11-04 19:44:51,281 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] (UUID('3e91669c-7134-4cb3-ab5f-4d20a7024832'), UUID('385f84ea-1ae1-4a79-9ec6-50a295df69da'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1013", "windDirection": "040", "windSpeed": "6", "wind": "040/6"}, "objectives": []}')
2025-11-04 19:44:51,284 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:44:51,321 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:44:51,322 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-11-04 19:44:51,322 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] (UUID('3e91669c-7134-4cb3-ab5f-4d20a7024832'),)
2025-11-04 19:44:51,325 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:45:37,500 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:45:37,501 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 19:45:37,501 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 19:45:37,501 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:45:37,501 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:45:37,501 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:46273]
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:45:37,502 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 19:45:37,538 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:45:37,538 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:45:37,538 | INFO | sqlalchemy.engine.Engine | [cached since 271.6s ago] ()
2025-11-04 19:45:37,542 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 19:45:37,542 | INFO | sqlalchemy.engine.Engine | [cached since 46.28s ago] (1,)
2025-11-04 19:45:37,567 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 19:45:37,567 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d85010>}) about to wait for the following futures []
2025-11-04 19:45:37,567 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d85010>}) done waiting for dependent futures
2025-11-04 19:45:37,567 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d85010>}) with kwargs {'client': <botocore.client.S3 object at 0x10e715a90>, 'config': <boto3.s3.transfer.TransferConfig object at 0x112b4e270>, 'osutil': <s3transfer.utils.OSUtils object at 0x112d841a0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x112d84830>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d85010>}
2025-11-04 19:45:37,568 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/41431722b9444c9a8e92881044bf530f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x112d84830> for transfer request: 0.
2025-11-04 19:45:37,568 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 19:45:37,568 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/41431722b9444c9a8e92881044bf530f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 19:45:37,568 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/41431722b9444c9a8e92881044bf530f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 19:45:37,568 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/41431722b9444c9a8e92881044bf530f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10e715a90>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x112d85940>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/41431722b9444c9a8e92881044bf530f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 19:45:37,571 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 19:45:38,337 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 19:47:39,851 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:48:05,743 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:46273]
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:48:05,744 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 19:48:05,777 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:48:05,777 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:48:05,777 | INFO | sqlalchemy.engine.Engine | [cached since 419.8s ago] ()
2025-11-04 19:48:05,781 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 19:48:05,781 | INFO | sqlalchemy.engine.Engine | [cached since 194.5s ago] (1,)
2025-11-04 19:48:05,803 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 19:48:05,803 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d8a490>}) about to wait for the following futures []
2025-11-04 19:48:05,803 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d8a490>}) done waiting for dependent futures
2025-11-04 19:48:05,803 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d8a490>}) with kwargs {'client': <botocore.client.S3 object at 0x10e715a90>, 'config': <boto3.s3.transfer.TransferConfig object at 0x112b911d0>, 'osutil': <s3transfer.utils.OSUtils object at 0x112d89e50>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x112d368b0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d8a490>}
2025-11-04 19:48:05,804 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/bbc29b78e94349cb88a50af091a5767d.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x112d368b0> for transfer request: 0.
2025-11-04 19:48:05,804 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 19:48:05,804 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/bbc29b78e94349cb88a50af091a5767d.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 19:48:05,804 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/bbc29b78e94349cb88a50af091a5767d.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 19:48:05,804 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/bbc29b78e94349cb88a50af091a5767d.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10e715a90>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x112d8ad50>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/bbc29b78e94349cb88a50af091a5767d.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 19:48:05,804 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 19:48:06,199 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 19:49:46,299 | INFO | app.controllers.audio | Transcripción recibida session=385f84ea-1ae1-4a79-9ec6-50a295df69da: pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona de entrenamiento Eco Vía Paso de Oomogo 7000 pies. dos almas a bordo. Capitán Salas Autonomía tres horas y media.
2025-11-04 19:49:46,300 | INFO | app.logs.transcript | student | session=385f84ea-1ae1-4a79-9ec6-50a295df69da | frequency=118.0 | text=pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona de entrenamiento Eco Vía Paso de Oomogo 7000 pies. dos almas a bordo. Capitán Salas Autonomía tres horas y media.
2025-11-04 19:49:46,329 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:49:46,330 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 19:49:46,330 | INFO | sqlalchemy.engine.Engine | [generated in 0.00019s] (UUID('385f84ea-1ae1-4a79-9ec6-50a295df69da'),)
2025-11-04 19:49:46,332 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:49:46,358 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:49:46,358 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 19:49:46,358 | INFO | sqlalchemy.engine.Engine | [cached since 0.02857s ago] (UUID('385f84ea-1ae1-4a79-9ec6-50a295df69da'),)
2025-11-04 19:49:46,365 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 19:49:46,366 | INFO | sqlalchemy.engine.Engine | [generated in 0.00023s] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/6", "condition": "VMC", "windSpeed": "6", "windDirection": "040"}, "route": "MRPV-MRPV", "obje ... (5769 characters truncated) ... ">10km", "wind": "040/6", "condition": "VMC", "windSpeed": "6", "windDirection": "040"}, "route": "MRPV-MRPV", "timestamp": "2025-11-05T01:49:46Z"}]}', datetime.datetime(2025, 11, 5, 1, 49, 46, 365846), UUID('3e91669c-7134-4cb3-ab5f-4d20a7024832'))
2025-11-04 19:49:46,368 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:49:46,380 | INFO | app.controllers.audio | Fase activa session=385f84ea-1ae1-4a79-9ec6-50a295df69da phase_id=ground_departure_request intent=ground_taxi_clearance freq=ground
2025-11-04 19:49:46,380 | INFO | app.controllers.audio | Frecuencia fuera de rango intent=ground_taxi_clearance freq=118.000 esperado=121.700
2025-11-04 19:49:46,403 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:49:46,403 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 19:49:46,403 | INFO | sqlalchemy.engine.Engine | [cached since 0.0736s ago] (UUID('385f84ea-1ae1-4a79-9ec6-50a295df69da'),)
2025-11-04 19:49:46,406 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 19:49:46,406 | INFO | sqlalchemy.engine.Engine | [cached since 0.04053s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/6", "condition": "VMC", "windSpeed": "6", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (6102 characters truncated) ... ]}, "objectives": [], "frequencies": {"ground": "121.7", "tower": "118.3"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 1, 49, 46, 406204), UUID('3e91669c-7134-4cb3-ab5f-4d20a7024832'))
2025-11-04 19:49:46,408 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:49:46,417 | INFO | app.logs.transcript | controller | session=385f84ea-1ae1-4a79-9ec6-50a295df69da | frequency=118.0 | intent=ground_taxi_clearance | phase=ground_departure_request | allow_response=False | text=La frecuencia esperada para esta solicitud es 121.700.
2025-11-04 19:49:46,417 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:50:11,397 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:50:11,397 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:46273]
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 19:50:11,398 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 19:50:11,426 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:50:11,426 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:50:11,427 | INFO | sqlalchemy.engine.Engine | [cached since 545.5s ago] ()
2025-11-04 19:50:11,429 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 19:50:11,429 | INFO | sqlalchemy.engine.Engine | [cached since 320.2s ago] (1,)
2025-11-04 19:50:11,442 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 19:50:11,442 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d88910>}) about to wait for the following futures []
2025-11-04 19:50:11,442 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d88910>}) done waiting for dependent futures
2025-11-04 19:50:11,442 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d88910>}) with kwargs {'client': <botocore.client.S3 object at 0x10e715a90>, 'config': <boto3.s3.transfer.TransferConfig object at 0x112b27110>, 'osutil': <s3transfer.utils.OSUtils object at 0x112b911d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x112b53790>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x112d88910>}
2025-11-04 19:50:11,442 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/745c835f21644cf197e691fce8daafb3.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x112b53790> for transfer request: 0.
2025-11-04 19:50:11,442 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 19:50:11,442 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/745c835f21644cf197e691fce8daafb3.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 19:50:11,442 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/745c835f21644cf197e691fce8daafb3.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 19:50:11,442 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 19:50:11,442 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/745c835f21644cf197e691fce8daafb3.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10e715a90>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x112d89450>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/385f84ea-1ae1-4a79-9ec6-50a295df69da/745c835f21644cf197e691fce8daafb3.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 19:50:11,843 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 19:51:31,649 | INFO | app.controllers.audio | Transcripción recibida session=385f84ea-1ae1-4a79-9ec6-50a295df69da: pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona de entrenamiento Eco Vía Paso de Oomogo 7000 pies. dos almas a bordo. Capitán Salas Autonomía tres horas y media.
2025-11-04 19:51:31,650 | INFO | app.logs.transcript | student | session=385f84ea-1ae1-4a79-9ec6-50a295df69da | frequency=121.7 | text=pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona de entrenamiento Eco Vía Paso de Oomogo 7000 pies. dos almas a bordo. Capitán Salas Autonomía tres horas y media.
2025-11-04 19:51:31,705 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:51:31,706 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 19:51:31,706 | INFO | sqlalchemy.engine.Engine | [cached since 105.4s ago] (UUID('385f84ea-1ae1-4a79-9ec6-50a295df69da'),)
2025-11-04 19:51:31,712 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:51:31,750 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:51:31,751 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 19:51:31,751 | INFO | sqlalchemy.engine.Engine | [cached since 105.4s ago] (UUID('385f84ea-1ae1-4a79-9ec6-50a295df69da'),)
2025-11-04 19:51:31,753 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 19:51:31,753 | INFO | sqlalchemy.engine.Engine | [cached since 105.4s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/6", "condition": "VMC", "windSpeed": "6", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (6561 characters truncated) ... "}, "objectives": [], "frequencies": {"tower": "118.3", "ground": "121.7"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 1, 51, 31, 753610), UUID('3e91669c-7134-4cb3-ab5f-4d20a7024832'))
2025-11-04 19:51:31,756 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:51:31,765 | INFO | app.controllers.audio | Fase activa session=385f84ea-1ae1-4a79-9ec6-50a295df69da phase_id=ground_departure_request intent=ground_taxi_clearance freq=ground
2025-11-04 19:51:31,765 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres un controlador de superficie en Costa Rica (Pavas Superficie 121.7). Evalúas la llamada inicial de apertura de plan VFR y decides si emites la autorización. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto ad...
USER> Fase actual: Solicitud de apertura de plan de vuelo
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
pa superficie Alfa Noviembre India frente a hangar 37 solicitando abrir plan de vuelo a zona de entrenamiento Eco Vía Paso de Oomogo 7000 pies. dos almas a bordo. Capitán Salas Autonomía tres horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Destinatario correcto (Pavas Superfici...
2025-11-04 19:51:33,150 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Rodaje Alfa 2, Alfa. Pista 10, viento 40 grados, 6 nudos, QNH 1013. Transponder 0522. Avise listo.",
  "feedback": "Llamada correcta.",
  "confidence": 1,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-11-04 19:51:33,151 | INFO | app.controllers.audio | Transición automática de fase session=385f84ea-1ae1-4a79-9ec6-50a295df69da de=ground_departure_request a=ground_readback
2025-11-04 19:51:33,211 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:51:33,211 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 19:51:33,211 | INFO | sqlalchemy.engine.Engine | [cached since 106.9s ago] (UUID('385f84ea-1ae1-4a79-9ec6-50a295df69da'),)
2025-11-04 19:51:33,216 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 19:51:33,216 | INFO | sqlalchemy.engine.Engine | [cached since 106.8s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/6", "condition": "VMC", "windSpeed": "6", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (7327 characters truncated) ... "}, "objectives": [], "frequencies": {"tower": "118.3", "ground": "121.7"}, "scenario_id": "mrpv_vfr_departure", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 1, 51, 33, 216423), UUID('3e91669c-7134-4cb3-ab5f-4d20a7024832'))
2025-11-04 19:51:33,224 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:51:33,236 | INFO | app.logs.transcript | controller | session=385f84ea-1ae1-4a79-9ec6-50a295df69da | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Rodaje Alfa 2, Alfa. Pista 10, viento 40 grados, 6 nudos, QNH 1013. Transponder 0522. Avise listo.
2025-11-04 19:51:35,912 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 19:52:28,471 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:52:28,472 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:28,473 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:52:28,473 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:28,475 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:52:28,475 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:28,477 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:52:28,477 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:52:28,477 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 19:52:28,479 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:52:28,479 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 19:52:28,481 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:28,481 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:28,483 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:28,483 | INFO | sqlalchemy.engine.Engine | [cached since 0.002355s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:28,483 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:28,483 | INFO | sqlalchemy.engine.Engine | [cached since 0.002916s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:28,484 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:28,484 | INFO | sqlalchemy.engine.Engine | [cached since 0.003397s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:28,484 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:28,484 | INFO | sqlalchemy.engine.Engine | [cached since 0.003831s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:28,485 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:28,485 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 19:52:28,486 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:28,486 | INFO | sqlalchemy.engine.Engine | [cached since 0.001099s ago] ('account_type', 'pg_catalog')
2025-11-04 19:52:28,487 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:52:28,487 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:52:28,489 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:52:28,489 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] ()
2025-11-04 19:52:28,491 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:52:28,492 | INFO | sqlalchemy.engine.Engine | [generated in 0.00029s] ()
2025-11-04 19:52:28,507 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:52:28,515 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:52:29,531 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:52:29,532 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:29,534 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:52:29,534 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:29,536 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:52:29,536 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:29,537 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:52:29,537 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:52:29,537 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:52:29,539 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:52:29,539 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:52:29,542 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:29,542 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:29,545 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:29,545 | INFO | sqlalchemy.engine.Engine | [cached since 0.003131s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:29,545 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:29,546 | INFO | sqlalchemy.engine.Engine | [cached since 0.004027s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:29,546 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:29,546 | INFO | sqlalchemy.engine.Engine | [cached since 0.00482s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:29,547 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:29,547 | INFO | sqlalchemy.engine.Engine | [cached since 0.005826s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:29,549 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:29,549 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 19:52:29,551 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:29,551 | INFO | sqlalchemy.engine.Engine | [cached since 0.002142s ago] ('account_type', 'pg_catalog')
2025-11-04 19:52:29,552 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:52:29,552 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:52:29,553 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:52:29,553 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:52:29,556 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:52:29,556 | INFO | sqlalchemy.engine.Engine | [generated in 0.00019s] ()
2025-11-04 19:52:29,570 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:52:29,575 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:52:32,912 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:52:32,912 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:32,914 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:52:32,914 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:32,916 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:52:32,916 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:32,917 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:52:32,917 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:52:32,917 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 19:52:32,919 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:52:32,919 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:52:32,921 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:32,921 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:32,924 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:32,924 | INFO | sqlalchemy.engine.Engine | [cached since 0.00333s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:32,925 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:32,925 | INFO | sqlalchemy.engine.Engine | [cached since 0.003867s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:32,925 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:32,925 | INFO | sqlalchemy.engine.Engine | [cached since 0.004336s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:32,926 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:32,926 | INFO | sqlalchemy.engine.Engine | [cached since 0.004842s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:32,928 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:32,928 | INFO | sqlalchemy.engine.Engine | [generated in 0.00021s] ('user_status', 'pg_catalog')
2025-11-04 19:52:32,956 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:32,956 | INFO | sqlalchemy.engine.Engine | [cached since 0.02845s ago] ('account_type', 'pg_catalog')
2025-11-04 19:52:32,957 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:52:32,957 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] ()
2025-11-04 19:52:32,958 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:52:32,958 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 19:52:32,959 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:52:32,960 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] ()
2025-11-04 19:52:32,981 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:52:32,993 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:52:37,029 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:52:37,029 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:37,032 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:52:37,032 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:37,034 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:52:37,034 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:52:37,035 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:52:37,035 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:52:37,035 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:52:37,037 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:52:37,037 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:52:37,039 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:37,039 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:37,042 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:37,043 | INFO | sqlalchemy.engine.Engine | [cached since 0.003546s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:37,043 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:37,043 | INFO | sqlalchemy.engine.Engine | [cached since 0.004174s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:37,044 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:37,044 | INFO | sqlalchemy.engine.Engine | [cached since 0.004964s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:37,044 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:52:37,045 | INFO | sqlalchemy.engine.Engine | [cached since 0.005576s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:52:37,046 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:37,046 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('user_status', 'pg_catalog')
2025-11-04 19:52:37,047 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:52:37,047 | INFO | sqlalchemy.engine.Engine | [cached since 0.001458s ago] ('account_type', 'pg_catalog')
2025-11-04 19:52:37,048 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:52:37,048 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:52:37,049 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:52:37,049 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:52:37,050 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:52:37,050 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 19:52:37,063 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:52:37,071 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:59:00,733 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:59:00,734 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:00,736 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:59:00,736 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:00,738 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:59:00,738 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:00,739 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:59:00,739 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:59:00,739 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 19:59:00,740 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:59:00,740 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:00,742 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:00,742 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:00,746 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:00,746 | INFO | sqlalchemy.engine.Engine | [cached since 0.003385s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:00,746 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:00,746 | INFO | sqlalchemy.engine.Engine | [cached since 0.004114s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:00,747 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:00,747 | INFO | sqlalchemy.engine.Engine | [cached since 0.00466s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:00,747 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:00,747 | INFO | sqlalchemy.engine.Engine | [cached since 0.005175s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:00,748 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:00,749 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 19:59:00,750 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:00,750 | INFO | sqlalchemy.engine.Engine | [cached since 0.00122s ago] ('account_type', 'pg_catalog')
2025-11-04 19:59:00,750 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:59:00,750 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:00,751 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:59:00,751 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:00,752 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:59:00,753 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-11-04 19:59:00,772 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:59:00,780 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:59:07,049 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:59:07,049 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:07,051 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:59:07,051 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:07,054 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:59:07,054 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:07,056 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:59:07,056 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:59:07,056 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:07,059 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:59:07,059 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:07,063 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:07,063 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:07,065 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:07,065 | INFO | sqlalchemy.engine.Engine | [cached since 0.001765s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:07,065 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:07,065 | INFO | sqlalchemy.engine.Engine | [cached since 0.002251s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:07,066 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:07,066 | INFO | sqlalchemy.engine.Engine | [cached since 0.002727s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:07,066 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:07,066 | INFO | sqlalchemy.engine.Engine | [cached since 0.003216s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:07,067 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:07,067 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('user_status', 'pg_catalog')
2025-11-04 19:59:07,068 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:07,069 | INFO | sqlalchemy.engine.Engine | [cached since 0.001236s ago] ('account_type', 'pg_catalog')
2025-11-04 19:59:07,069 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:59:07,069 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:07,070 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:59:07,070 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:07,071 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:59:07,071 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 19:59:07,082 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:59:07,091 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:59:30,871 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:59:30,871 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:30,873 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:59:30,873 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:30,875 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:59:30,875 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:30,876 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:59:30,876 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:59:30,876 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 19:59:30,878 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:59:30,878 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:59:30,880 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:30,880 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:30,883 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:30,883 | INFO | sqlalchemy.engine.Engine | [cached since 0.00373s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:30,884 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:30,884 | INFO | sqlalchemy.engine.Engine | [cached since 0.004637s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:30,885 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:30,885 | INFO | sqlalchemy.engine.Engine | [cached since 0.005344s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:30,886 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:30,886 | INFO | sqlalchemy.engine.Engine | [cached since 0.006151s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:30,887 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:30,887 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 19:59:30,889 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:30,889 | INFO | sqlalchemy.engine.Engine | [cached since 0.001838s ago] ('account_type', 'pg_catalog')
2025-11-04 19:59:30,890 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:59:30,890 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:30,891 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:59:30,891 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:30,893 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:59:30,893 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 19:59:30,908 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:59:30,919 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:59:38,789 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:59:38,789 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:38,791 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:59:38,791 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:38,793 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:59:38,793 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:38,795 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:59:38,795 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:59:38,795 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:59:38,796 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:59:38,796 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:38,798 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:38,798 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:38,802 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:38,802 | INFO | sqlalchemy.engine.Engine | [cached since 0.003996s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:38,803 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:38,803 | INFO | sqlalchemy.engine.Engine | [cached since 0.004941s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:38,804 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:38,804 | INFO | sqlalchemy.engine.Engine | [cached since 0.005758s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:38,805 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:38,805 | INFO | sqlalchemy.engine.Engine | [cached since 0.006423s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:38,806 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:38,806 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 19:59:38,808 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:38,808 | INFO | sqlalchemy.engine.Engine | [cached since 0.001763s ago] ('account_type', 'pg_catalog')
2025-11-04 19:59:38,808 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:59:38,808 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:38,810 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:59:38,810 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:38,811 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:59:38,811 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 19:59:38,824 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:59:38,836 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:59:44,200 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:59:44,200 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:44,202 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:59:44,202 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:44,204 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:59:44,204 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:44,205 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:59:44,206 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:59:44,206 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 19:59:44,207 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:59:44,207 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:44,209 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:44,209 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:44,212 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:44,212 | INFO | sqlalchemy.engine.Engine | [cached since 0.003201s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:44,213 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:44,213 | INFO | sqlalchemy.engine.Engine | [cached since 0.004185s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:44,214 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:44,214 | INFO | sqlalchemy.engine.Engine | [cached since 0.004974s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:44,215 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:44,215 | INFO | sqlalchemy.engine.Engine | [cached since 0.00579s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:44,216 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:44,216 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 19:59:44,218 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:44,218 | INFO | sqlalchemy.engine.Engine | [cached since 0.001931s ago] ('account_type', 'pg_catalog')
2025-11-04 19:59:44,219 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:59:44,219 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:44,221 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:59:44,221 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:44,222 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:59:44,222 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 19:59:44,238 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:59:44,243 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 19:59:49,761 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 19:59:49,761 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:49,764 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 19:59:49,764 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:49,766 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 19:59:49,766 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 19:59:49,767 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 19:59:49,767 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 19:59:49,767 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:49,769 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 19:59:49,769 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 19:59:49,771 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:49,771 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:49,774 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:49,774 | INFO | sqlalchemy.engine.Engine | [cached since 0.003197s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:49,775 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:49,775 | INFO | sqlalchemy.engine.Engine | [cached since 0.004109s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:49,776 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:49,776 | INFO | sqlalchemy.engine.Engine | [cached since 0.00503s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:49,777 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 19:59:49,777 | INFO | sqlalchemy.engine.Engine | [cached since 0.005847s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 19:59:49,778 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:49,778 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 19:59:49,780 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 19:59:49,780 | INFO | sqlalchemy.engine.Engine | [cached since 0.00198s ago] ('account_type', 'pg_catalog')
2025-11-04 19:59:49,781 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 19:59:49,781 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 19:59:49,783 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 19:59:49,783 | INFO | sqlalchemy.engine.Engine | [generated in 0.00004s] ()
2025-11-04 19:59:49,784 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 19:59:49,785 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 19:59:49,800 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 19:59:49,808 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:00:06,195 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:00:06,195 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:06,197 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:00:06,197 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:06,198 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:00:06,198 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:06,199 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:00:06,200 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:00:06,200 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:06,201 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:00:06,201 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:06,203 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:06,203 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:06,204 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:06,204 | INFO | sqlalchemy.engine.Engine | [cached since 0.001559s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:06,205 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:06,205 | INFO | sqlalchemy.engine.Engine | [cached since 0.002096s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:06,205 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:06,205 | INFO | sqlalchemy.engine.Engine | [cached since 0.002587s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:06,206 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:06,206 | INFO | sqlalchemy.engine.Engine | [cached since 0.003099s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:06,207 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:06,207 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 20:00:06,208 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:06,208 | INFO | sqlalchemy.engine.Engine | [cached since 0.001221s ago] ('account_type', 'pg_catalog')
2025-11-04 20:00:06,209 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:00:06,209 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:00:06,209 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:00:06,210 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:00:06,210 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:00:06,211 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 20:00:06,221 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:00:06,227 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:00:10,975 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:00:10,975 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:10,977 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:00:10,977 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:10,979 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:00:10,979 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:10,980 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:00:10,980 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:00:10,980 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:00:10,982 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:00:10,982 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 20:00:10,984 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:10,984 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:10,987 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:10,987 | INFO | sqlalchemy.engine.Engine | [cached since 0.003181s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:10,989 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:10,989 | INFO | sqlalchemy.engine.Engine | [cached since 0.004781s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:10,990 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:10,990 | INFO | sqlalchemy.engine.Engine | [cached since 0.005764s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:10,991 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:10,991 | INFO | sqlalchemy.engine.Engine | [cached since 0.00657s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:10,992 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:10,992 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:00:10,994 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:10,994 | INFO | sqlalchemy.engine.Engine | [cached since 0.001757s ago] ('account_type', 'pg_catalog')
2025-11-04 20:00:10,995 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:00:10,995 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:10,996 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:00:10,996 | INFO | sqlalchemy.engine.Engine | [generated in 0.00004s] ()
2025-11-04 20:00:10,998 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:00:10,998 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 20:00:11,013 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:00:11,026 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:00:23,662 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:00:23,662 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:23,664 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:00:23,664 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:23,665 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:00:23,665 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:23,666 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:00:23,667 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:00:23,667 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 20:00:23,668 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:00:23,668 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:00:23,670 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:23,670 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:23,672 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:23,672 | INFO | sqlalchemy.engine.Engine | [cached since 0.002055s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:23,673 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:23,673 | INFO | sqlalchemy.engine.Engine | [cached since 0.002614s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:23,673 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:23,673 | INFO | sqlalchemy.engine.Engine | [cached since 0.003142s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:23,674 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:23,674 | INFO | sqlalchemy.engine.Engine | [cached since 0.003692s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:23,675 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:23,675 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 20:00:23,676 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:23,676 | INFO | sqlalchemy.engine.Engine | [cached since 0.001209s ago] ('account_type', 'pg_catalog')
2025-11-04 20:00:23,677 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:00:23,677 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:23,678 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:00:23,678 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:23,679 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:00:23,679 | INFO | sqlalchemy.engine.Engine | [generated in 0.00036s] ()
2025-11-04 20:00:23,691 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:00:23,704 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:00:28,797 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:00:28,797 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:28,799 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:00:28,799 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:28,800 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:00:28,800 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:28,801 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:00:28,802 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:00:28,802 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:28,803 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:00:28,803 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:28,805 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:28,805 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:28,806 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:28,806 | INFO | sqlalchemy.engine.Engine | [cached since 0.001497s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:28,806 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:28,806 | INFO | sqlalchemy.engine.Engine | [cached since 0.002012s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:28,807 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:28,807 | INFO | sqlalchemy.engine.Engine | [cached since 0.002555s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:28,807 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:28,807 | INFO | sqlalchemy.engine.Engine | [cached since 0.003027s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:28,809 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:28,809 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 20:00:28,810 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:28,810 | INFO | sqlalchemy.engine.Engine | [cached since 0.001201s ago] ('account_type', 'pg_catalog')
2025-11-04 20:00:28,810 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:00:28,810 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:28,811 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:00:28,811 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:28,812 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:00:28,812 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] ()
2025-11-04 20:00:28,822 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:00:28,828 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:00:34,660 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:00:34,660 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:34,663 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:00:34,663 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:34,665 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:00:34,665 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:34,666 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:00:34,666 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:00:34,666 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:00:34,668 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:00:34,668 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:34,671 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:34,671 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:34,674 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:34,674 | INFO | sqlalchemy.engine.Engine | [cached since 0.003771s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:34,675 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:34,675 | INFO | sqlalchemy.engine.Engine | [cached since 0.0048s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:34,676 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:34,676 | INFO | sqlalchemy.engine.Engine | [cached since 0.00562s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:34,677 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:34,677 | INFO | sqlalchemy.engine.Engine | [cached since 0.006338s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:34,678 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:34,678 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:00:34,680 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:34,680 | INFO | sqlalchemy.engine.Engine | [cached since 0.001824s ago] ('account_type', 'pg_catalog')
2025-11-04 20:00:34,681 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:00:34,681 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:34,682 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:00:34,683 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:00:34,684 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:00:34,685 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] ()
2025-11-04 20:00:34,703 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:00:34,714 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:00:41,347 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:00:41,347 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:41,349 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:00:41,349 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:41,351 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:00:41,351 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:41,352 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:00:41,353 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:00:41,353 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 20:00:41,354 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:00:41,354 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:41,356 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:41,356 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:41,359 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:41,359 | INFO | sqlalchemy.engine.Engine | [cached since 0.003211s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:41,360 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:41,360 | INFO | sqlalchemy.engine.Engine | [cached since 0.004109s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:41,361 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:41,361 | INFO | sqlalchemy.engine.Engine | [cached since 0.004946s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:41,362 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:41,362 | INFO | sqlalchemy.engine.Engine | [cached since 0.005829s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:41,363 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:41,364 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:00:41,365 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:41,365 | INFO | sqlalchemy.engine.Engine | [cached since 0.001801s ago] ('account_type', 'pg_catalog')
2025-11-04 20:00:41,366 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:00:41,366 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:41,368 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:00:41,368 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:41,370 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:00:41,370 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 20:00:41,384 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:00:41,395 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:00:45,827 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:00:45,827 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:45,830 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:00:45,830 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:45,832 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:00:45,832 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:00:45,833 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:00:45,834 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:00:45,834 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:00:45,835 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:00:45,835 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:45,837 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:45,837 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:45,840 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:45,841 | INFO | sqlalchemy.engine.Engine | [cached since 0.003134s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:45,841 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:45,841 | INFO | sqlalchemy.engine.Engine | [cached since 0.003975s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:45,842 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:45,842 | INFO | sqlalchemy.engine.Engine | [cached since 0.00485s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:45,843 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:00:45,843 | INFO | sqlalchemy.engine.Engine | [cached since 0.005584s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:00:45,844 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:45,844 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 20:00:45,846 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:00:45,847 | INFO | sqlalchemy.engine.Engine | [cached since 0.002559s ago] ('account_type', 'pg_catalog')
2025-11-04 20:00:45,849 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:00:45,849 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:00:45,850 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:00:45,850 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 20:00:45,851 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:00:45,851 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 20:00:45,862 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:00:45,868 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:01:12,174 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:01:12,174 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:12,177 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:01:12,177 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:12,179 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:01:12,179 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:12,180 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:01:12,180 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:01:12,180 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:12,182 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:01:12,182 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:12,184 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:12,184 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:12,187 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:12,187 | INFO | sqlalchemy.engine.Engine | [cached since 0.003214s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:12,188 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:12,188 | INFO | sqlalchemy.engine.Engine | [cached since 0.004327s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:12,190 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:12,190 | INFO | sqlalchemy.engine.Engine | [cached since 0.006434s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:12,192 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:12,193 | INFO | sqlalchemy.engine.Engine | [cached since 0.008985s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:12,194 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:12,194 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-11-04 20:01:12,196 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:12,196 | INFO | sqlalchemy.engine.Engine | [cached since 0.001425s ago] ('account_type', 'pg_catalog')
2025-11-04 20:01:12,196 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:01:12,196 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:12,199 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:01:12,200 | INFO | sqlalchemy.engine.Engine | [generated in 0.00139s] ()
2025-11-04 20:01:12,224 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:01:12,224 | INFO | sqlalchemy.engine.Engine | [generated in 0.00110s] ()
2025-11-04 20:01:12,279 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:01:12,293 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:01:22,671 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:01:22,671 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:22,674 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:01:22,674 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:22,676 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:01:22,676 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:22,677 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:01:22,677 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:01:22,677 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:22,679 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:01:22,679 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:22,681 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:22,681 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:22,684 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:22,684 | INFO | sqlalchemy.engine.Engine | [cached since 0.003501s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:22,685 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:22,685 | INFO | sqlalchemy.engine.Engine | [cached since 0.004154s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:22,685 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:22,686 | INFO | sqlalchemy.engine.Engine | [cached since 0.004753s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:22,686 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:22,686 | INFO | sqlalchemy.engine.Engine | [cached since 0.005509s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:22,687 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:22,688 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:01:22,689 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:22,689 | INFO | sqlalchemy.engine.Engine | [cached since 0.001879s ago] ('account_type', 'pg_catalog')
2025-11-04 20:01:22,690 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:01:22,690 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:01:22,692 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:01:22,692 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:01:22,693 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:01:22,693 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 20:01:22,711 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:01:22,723 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:01:46,185 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:01:46,185 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:46,187 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:01:46,187 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:46,189 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:01:46,190 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:46,191 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:01:46,191 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:01:46,191 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:46,193 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:01:46,193 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:01:46,195 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:46,195 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:46,199 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:46,199 | INFO | sqlalchemy.engine.Engine | [cached since 0.003941s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:46,200 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:46,200 | INFO | sqlalchemy.engine.Engine | [cached since 0.00475s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:46,201 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:46,201 | INFO | sqlalchemy.engine.Engine | [cached since 0.005525s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:46,202 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:46,202 | INFO | sqlalchemy.engine.Engine | [cached since 0.006197s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:46,203 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:46,203 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:01:46,204 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:46,204 | INFO | sqlalchemy.engine.Engine | [cached since 0.001651s ago] ('account_type', 'pg_catalog')
2025-11-04 20:01:46,205 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:01:46,205 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:01:46,206 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:01:46,206 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:01:46,208 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:01:46,208 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 20:01:46,222 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:01:46,229 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:01:52,891 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:01:52,891 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:52,894 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:01:52,894 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:52,896 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:01:52,896 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:01:52,897 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:01:52,898 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:01:52,898 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:52,899 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:01:52,899 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:01:52,901 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:52,901 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:52,904 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:52,904 | INFO | sqlalchemy.engine.Engine | [cached since 0.003079s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:52,905 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:52,905 | INFO | sqlalchemy.engine.Engine | [cached since 0.0039s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:52,906 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:52,906 | INFO | sqlalchemy.engine.Engine | [cached since 0.004726s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:52,907 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:01:52,907 | INFO | sqlalchemy.engine.Engine | [cached since 0.005934s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:01:52,909 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:52,909 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:01:52,910 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:01:52,911 | INFO | sqlalchemy.engine.Engine | [cached since 0.002006s ago] ('account_type', 'pg_catalog')
2025-11-04 20:01:52,911 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:01:52,911 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:01:52,912 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:01:52,913 | INFO | sqlalchemy.engine.Engine | [generated in 0.00004s] ()
2025-11-04 20:01:52,914 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:01:52,914 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 20:01:52,928 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:01:52,937 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:02:17,819 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:02:17,819 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:02:17,822 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:02:17,822 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:02:17,823 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:02:17,824 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:02:17,825 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:02:17,825 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:02:17,825 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:02:17,826 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:02:17,826 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:02:17,828 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:02:17,828 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:02:17,831 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:02:17,831 | INFO | sqlalchemy.engine.Engine | [cached since 0.003348s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:02:17,832 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:02:17,832 | INFO | sqlalchemy.engine.Engine | [cached since 0.003881s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:02:17,832 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:02:17,832 | INFO | sqlalchemy.engine.Engine | [cached since 0.00434s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:02:17,833 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:02:17,833 | INFO | sqlalchemy.engine.Engine | [cached since 0.00477s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:02:17,834 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:02:17,834 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:02:17,835 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:02:17,835 | INFO | sqlalchemy.engine.Engine | [cached since 0.001109s ago] ('account_type', 'pg_catalog')
2025-11-04 20:02:17,835 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:02:17,835 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:02:17,837 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:02:17,837 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:02:17,839 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:02:17,839 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 20:02:17,861 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:02:17,869 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:06:52,217 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:06:52,217 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:06:52,219 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:06:52,219 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:06:52,220 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:06:52,220 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:06:52,221 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:06:52,222 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:06:52,222 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 20:06:52,222 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:06:52,223 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:06:52,225 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:06:52,225 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:06:52,227 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:06:52,227 | INFO | sqlalchemy.engine.Engine | [cached since 0.00227s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:06:52,227 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:06:52,227 | INFO | sqlalchemy.engine.Engine | [cached since 0.002901s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:06:52,228 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:06:52,228 | INFO | sqlalchemy.engine.Engine | [cached since 0.003411s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:06:52,228 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:06:52,228 | INFO | sqlalchemy.engine.Engine | [cached since 0.00399s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:06:52,230 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:06:52,230 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 20:06:52,231 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:06:52,231 | INFO | sqlalchemy.engine.Engine | [cached since 0.001756s ago] ('account_type', 'pg_catalog')
2025-11-04 20:06:52,233 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:06:52,233 | INFO | sqlalchemy.engine.Engine | [generated in 0.00065s] ()
2025-11-04 20:06:52,235 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:06:52,235 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:06:52,238 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:06:52,238 | INFO | sqlalchemy.engine.Engine | [generated in 0.00028s] ()
2025-11-04 20:06:52,250 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:06:52,262 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:07:18,963 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:07:18,963 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:07:18,965 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:07:18,965 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:07:18,968 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:07:18,968 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:07:18,970 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:07:18,970 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:07:18,970 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:07:18,971 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:07:18,972 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:07:18,974 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:07:18,974 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:07:18,977 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:07:18,977 | INFO | sqlalchemy.engine.Engine | [cached since 0.003661s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:07:18,978 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:07:18,978 | INFO | sqlalchemy.engine.Engine | [cached since 0.004416s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:07:18,979 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:07:18,979 | INFO | sqlalchemy.engine.Engine | [cached since 0.005203s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:07:18,980 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:07:18,980 | INFO | sqlalchemy.engine.Engine | [cached since 0.005854s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:07:18,981 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:07:18,981 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:07:18,982 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:07:18,982 | INFO | sqlalchemy.engine.Engine | [cached since 0.001464s ago] ('account_type', 'pg_catalog')
2025-11-04 20:07:18,983 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:07:18,983 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:07:18,984 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:07:18,984 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:07:18,985 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:07:18,985 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] ()
2025-11-04 20:07:19,000 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:07:19,007 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:46:46,198 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:46:46,198 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:46:46,200 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:46:46,200 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:46:46,202 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:46:46,202 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:46:46,204 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:46:46,204 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:46:46,204 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:46:46,206 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:46:46,206 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:46:46,208 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:46,208 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:46,210 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:46,210 | INFO | sqlalchemy.engine.Engine | [cached since 0.002429s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:46,211 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:46,211 | INFO | sqlalchemy.engine.Engine | [cached since 0.003235s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:46,212 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:46,212 | INFO | sqlalchemy.engine.Engine | [cached since 0.004214s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:46,213 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:46,213 | INFO | sqlalchemy.engine.Engine | [cached since 0.004724s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:46,214 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:46:46,214 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 20:46:46,215 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:46:46,215 | INFO | sqlalchemy.engine.Engine | [cached since 0.001267s ago] ('account_type', 'pg_catalog')
2025-11-04 20:46:46,216 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:46:46,216 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:46:46,217 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:46:46,217 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:46:46,219 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:46:46,219 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 20:46:46,237 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:46:46,244 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:46:52,997 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:46:52,997 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:46:52,999 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:46:52,999 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:46:53,001 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:46:53,001 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:46:53,004 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:46:53,004 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:46:53,004 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 20:46:53,006 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:46:53,006 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:46:53,008 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:53,008 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:53,013 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:53,013 | INFO | sqlalchemy.engine.Engine | [cached since 0.005075s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:53,015 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:53,015 | INFO | sqlalchemy.engine.Engine | [cached since 0.006768s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:53,016 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:53,016 | INFO | sqlalchemy.engine.Engine | [cached since 0.007813s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:53,017 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:46:53,017 | INFO | sqlalchemy.engine.Engine | [cached since 0.008675s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:46:53,018 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:46:53,018 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 20:46:53,021 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:46:53,021 | INFO | sqlalchemy.engine.Engine | [cached since 0.002617s ago] ('account_type', 'pg_catalog')
2025-11-04 20:46:53,022 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:46:53,022 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:46:53,023 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:46:53,023 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:46:53,025 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:46:53,025 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 20:46:53,038 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:46:53,044 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:47:00,466 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:47:00,467 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:00,468 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:47:00,468 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:00,470 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:47:00,470 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:00,471 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:47:00,471 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:47:00,471 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:47:00,472 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:47:00,472 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:00,474 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:00,474 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:00,476 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:00,476 | INFO | sqlalchemy.engine.Engine | [cached since 0.001531s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:00,476 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:00,476 | INFO | sqlalchemy.engine.Engine | [cached since 0.002022s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:00,477 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:00,477 | INFO | sqlalchemy.engine.Engine | [cached since 0.002464s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:00,477 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:00,477 | INFO | sqlalchemy.engine.Engine | [cached since 0.003023s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:00,479 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:00,479 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 20:47:00,481 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:00,481 | INFO | sqlalchemy.engine.Engine | [cached since 0.00216s ago] ('account_type', 'pg_catalog')
2025-11-04 20:47:00,481 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:47:00,481 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:00,482 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:47:00,482 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:00,483 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:47:00,483 | INFO | sqlalchemy.engine.Engine | [generated in 0.00033s] ()
2025-11-04 20:47:00,493 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:47:00,500 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:47:13,002 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:47:13,002 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:13,006 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:47:13,006 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:13,008 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:47:13,008 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:13,009 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:47:13,009 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:47:13,009 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:13,012 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:47:13,012 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:13,016 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:13,016 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:13,018 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:13,018 | INFO | sqlalchemy.engine.Engine | [cached since 0.002215s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:13,018 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:13,018 | INFO | sqlalchemy.engine.Engine | [cached since 0.002817s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:13,019 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:13,019 | INFO | sqlalchemy.engine.Engine | [cached since 0.003355s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:13,019 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:13,019 | INFO | sqlalchemy.engine.Engine | [cached since 0.003876s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:13,022 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:13,022 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ('user_status', 'pg_catalog')
2025-11-04 20:47:13,023 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:13,023 | INFO | sqlalchemy.engine.Engine | [cached since 0.001515s ago] ('account_type', 'pg_catalog')
2025-11-04 20:47:13,024 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:47:13,024 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:47:13,025 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:47:13,025 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:47:13,026 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:47:13,026 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 20:47:13,034 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:47:13,041 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:47:25,738 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:47:25,738 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:25,741 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:47:25,741 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:25,743 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:47:25,743 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:25,744 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:47:25,745 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:47:25,745 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:25,747 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:47:25,747 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:47:25,750 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:25,750 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:25,753 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:25,753 | INFO | sqlalchemy.engine.Engine | [cached since 0.003315s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:25,754 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:25,754 | INFO | sqlalchemy.engine.Engine | [cached since 0.004079s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:25,755 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:25,755 | INFO | sqlalchemy.engine.Engine | [cached since 0.005326s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:25,755 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:25,755 | INFO | sqlalchemy.engine.Engine | [cached since 0.00596s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:25,757 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:25,757 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 20:47:25,758 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:25,758 | INFO | sqlalchemy.engine.Engine | [cached since 0.001341s ago] ('account_type', 'pg_catalog')
2025-11-04 20:47:25,758 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:47:25,759 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:25,759 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:47:25,759 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:47:25,760 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:47:25,761 | INFO | sqlalchemy.engine.Engine | [generated in 0.00022s] ()
2025-11-04 20:47:25,769 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:47:25,776 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:47:34,532 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:47:34,532 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:34,535 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:47:34,535 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:34,537 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:47:34,537 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:34,538 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:47:34,538 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:47:34,538 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:47:34,539 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:47:34,540 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:47:34,541 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:34,542 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:34,544 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:34,544 | INFO | sqlalchemy.engine.Engine | [cached since 0.00236s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:34,544 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:34,544 | INFO | sqlalchemy.engine.Engine | [cached since 0.002905s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:34,545 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:34,545 | INFO | sqlalchemy.engine.Engine | [cached since 0.003766s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:34,546 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:34,546 | INFO | sqlalchemy.engine.Engine | [cached since 0.004866s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:34,547 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:34,548 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 20:47:34,550 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:34,550 | INFO | sqlalchemy.engine.Engine | [cached since 0.002182s ago] ('account_type', 'pg_catalog')
2025-11-04 20:47:34,550 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:47:34,550 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:47:34,552 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:47:34,552 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:47:34,555 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:47:34,555 | INFO | sqlalchemy.engine.Engine | [generated in 0.00055s] ()
2025-11-04 20:47:34,568 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:47:34,575 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:47:44,882 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:47:44,882 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:44,884 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:47:44,884 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:44,887 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:47:44,887 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:44,889 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:47:44,889 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:47:44,889 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 20:47:44,891 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:47:44,891 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:44,893 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:44,893 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:44,898 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:44,898 | INFO | sqlalchemy.engine.Engine | [cached since 0.004882s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:44,899 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:44,899 | INFO | sqlalchemy.engine.Engine | [cached since 0.006181s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:44,900 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:44,900 | INFO | sqlalchemy.engine.Engine | [cached since 0.006978s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:44,900 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:44,901 | INFO | sqlalchemy.engine.Engine | [cached since 0.007626s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:44,902 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:44,902 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-11-04 20:47:44,904 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:44,905 | INFO | sqlalchemy.engine.Engine | [cached since 0.002494s ago] ('account_type', 'pg_catalog')
2025-11-04 20:47:44,906 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:47:44,906 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:47:44,907 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:47:44,907 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 20:47:44,909 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:47:44,909 | INFO | sqlalchemy.engine.Engine | [generated in 0.00021s] ()
2025-11-04 20:47:44,920 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:47:44,929 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:47:53,528 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:47:53,528 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:53,530 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:47:53,530 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:53,531 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:47:53,532 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:47:53,532 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:47:53,533 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:47:53,533 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:47:53,534 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:47:53,534 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:53,536 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:53,536 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:53,538 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:53,538 | INFO | sqlalchemy.engine.Engine | [cached since 0.002046s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:53,538 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:53,538 | INFO | sqlalchemy.engine.Engine | [cached since 0.002588s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:53,539 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:53,539 | INFO | sqlalchemy.engine.Engine | [cached since 0.003078s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:53,539 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:47:53,539 | INFO | sqlalchemy.engine.Engine | [cached since 0.00354s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:47:53,541 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:53,541 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 20:47:53,542 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:47:53,542 | INFO | sqlalchemy.engine.Engine | [cached since 0.001183s ago] ('account_type', 'pg_catalog')
2025-11-04 20:47:53,542 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:47:53,542 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:47:53,546 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:47:53,546 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 20:47:53,547 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:47:53,547 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-11-04 20:47:53,558 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:47:53,564 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:48:22,168 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:48:22,168 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:22,171 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:48:22,172 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:22,174 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:48:22,174 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:22,175 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:48:22,175 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:48:22,175 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:48:22,177 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:48:22,177 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:48:22,179 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:22,179 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:22,183 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:22,183 | INFO | sqlalchemy.engine.Engine | [cached since 0.004067s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:22,184 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:22,184 | INFO | sqlalchemy.engine.Engine | [cached since 0.005016s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:22,185 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:22,185 | INFO | sqlalchemy.engine.Engine | [cached since 0.005693s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:22,185 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:22,185 | INFO | sqlalchemy.engine.Engine | [cached since 0.006347s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:22,187 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:48:22,187 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 20:48:22,189 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:48:22,189 | INFO | sqlalchemy.engine.Engine | [cached since 0.002706s ago] ('account_type', 'pg_catalog')
2025-11-04 20:48:22,190 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:48:22,190 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:48:22,191 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:48:22,191 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:48:22,192 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:48:22,193 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 20:48:22,202 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:48:22,213 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:48:42,627 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:48:42,628 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:42,632 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:48:42,632 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:42,634 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:48:42,634 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:42,635 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:48:42,635 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:48:42,635 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:48:42,637 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:48:42,637 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:48:42,640 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:42,640 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:42,644 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:42,644 | INFO | sqlalchemy.engine.Engine | [cached since 0.004431s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:42,645 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:42,645 | INFO | sqlalchemy.engine.Engine | [cached since 0.005324s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:42,650 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:42,650 | INFO | sqlalchemy.engine.Engine | [cached since 0.01013s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:42,651 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:42,651 | INFO | sqlalchemy.engine.Engine | [cached since 0.01081s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:42,652 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:48:42,652 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ('user_status', 'pg_catalog')
2025-11-04 20:48:42,654 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:48:42,654 | INFO | sqlalchemy.engine.Engine | [cached since 0.001666s ago] ('account_type', 'pg_catalog')
2025-11-04 20:48:42,654 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:48:42,654 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:48:42,656 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:48:42,656 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 20:48:42,657 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:48:42,657 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 20:48:42,670 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:48:42,683 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:48:57,971 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:48:57,972 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:57,975 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:48:57,975 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:57,977 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:48:57,977 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:48:57,979 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:48:57,979 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:48:57,979 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:48:57,982 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:48:57,982 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 20:48:57,984 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:57,984 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:57,989 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:57,989 | INFO | sqlalchemy.engine.Engine | [cached since 0.004766s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:57,990 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:57,990 | INFO | sqlalchemy.engine.Engine | [cached since 0.006086s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:57,991 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:57,991 | INFO | sqlalchemy.engine.Engine | [cached since 0.006882s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:57,992 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:48:57,992 | INFO | sqlalchemy.engine.Engine | [cached since 0.007623s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:48:57,993 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:48:57,993 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:48:57,995 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:48:57,995 | INFO | sqlalchemy.engine.Engine | [cached since 0.002304s ago] ('account_type', 'pg_catalog')
2025-11-04 20:48:57,996 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:48:57,996 | INFO | sqlalchemy.engine.Engine | [generated in 0.00024s] ()
2025-11-04 20:48:57,997 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:48:57,997 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 20:48:57,999 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:48:57,999 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-11-04 20:48:58,011 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:48:58,020 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 20:50:37,762 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 20:50:37,763 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:50:37,766 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 20:50:37,766 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:50:37,767 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 20:50:37,767 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 20:50:37,769 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 20:50:37,769 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 20:50:37,769 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:50:37,770 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 20:50:37,770 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 20:50:37,772 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:50:37,772 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:50:37,775 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:50:37,775 | INFO | sqlalchemy.engine.Engine | [cached since 0.00341s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:50:37,776 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:50:37,776 | INFO | sqlalchemy.engine.Engine | [cached since 0.004073s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:50:37,776 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:50:37,776 | INFO | sqlalchemy.engine.Engine | [cached since 0.004616s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:50:37,777 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 20:50:37,777 | INFO | sqlalchemy.engine.Engine | [cached since 0.005133s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 20:50:37,778 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:50:37,778 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 20:50:37,779 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 20:50:37,779 | INFO | sqlalchemy.engine.Engine | [cached since 0.001222s ago] ('account_type', 'pg_catalog')
2025-11-04 20:50:37,780 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 20:50:37,780 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 20:50:37,782 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 20:50:37,782 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 20:50:37,783 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 20:50:37,783 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-11-04 20:50:37,796 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 20:50:37,806 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:07:49,535 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:07:49,535 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:07:49,539 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:07:49,539 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:07:49,540 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:07:49,541 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:07:49,542 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:07:49,542 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:07:49,542 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:07:49,544 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:07:49,544 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:07:49,546 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:07:49,546 | INFO | sqlalchemy.engine.Engine | [generated in 0.00030s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:07:49,551 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:07:49,551 | INFO | sqlalchemy.engine.Engine | [cached since 0.004584s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:07:49,552 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:07:49,552 | INFO | sqlalchemy.engine.Engine | [cached since 0.005608s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:07:49,552 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:07:49,553 | INFO | sqlalchemy.engine.Engine | [cached since 0.006359s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:07:49,553 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:07:49,553 | INFO | sqlalchemy.engine.Engine | [cached since 0.007013s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:07:49,555 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:07:49,555 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('user_status', 'pg_catalog')
2025-11-04 21:07:49,557 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:07:49,557 | INFO | sqlalchemy.engine.Engine | [cached since 0.002252s ago] ('account_type', 'pg_catalog')
2025-11-04 21:07:49,558 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:07:49,558 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:07:49,559 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:07:49,559 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:07:49,562 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:07:49,562 | INFO | sqlalchemy.engine.Engine | [generated in 0.00025s] ()
2025-11-04 21:07:49,582 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:07:49,592 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:08:17,006 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:08:17,006 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:08:17,008 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:08:17,008 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:08:17,010 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:08:17,010 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:08:17,012 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:08:17,013 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:08:17,013 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 21:08:17,015 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:08:17,015 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:08:17,017 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:17,017 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:17,023 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:17,023 | INFO | sqlalchemy.engine.Engine | [cached since 0.005587s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:17,024 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:17,024 | INFO | sqlalchemy.engine.Engine | [cached since 0.006771s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:17,025 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:17,025 | INFO | sqlalchemy.engine.Engine | [cached since 0.007676s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:17,026 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:17,026 | INFO | sqlalchemy.engine.Engine | [cached since 0.008355s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:17,027 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:08:17,027 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 21:08:17,030 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:08:17,030 | INFO | sqlalchemy.engine.Engine | [cached since 0.002709s ago] ('account_type', 'pg_catalog')
2025-11-04 21:08:17,031 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:08:17,031 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:08:17,033 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:08:17,033 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:08:17,034 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:08:17,035 | INFO | sqlalchemy.engine.Engine | [generated in 0.00021s] ()
2025-11-04 21:08:17,045 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:08:17,053 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:08:36,905 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:08:36,905 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:08:36,908 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:08:36,908 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:08:36,910 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:08:36,910 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:08:36,911 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:08:36,912 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:08:36,912 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 21:08:36,914 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:08:36,914 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 21:08:36,917 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:36,917 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:36,921 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:36,921 | INFO | sqlalchemy.engine.Engine | [cached since 0.004142s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:36,922 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:36,922 | INFO | sqlalchemy.engine.Engine | [cached since 0.005164s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:36,923 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:36,923 | INFO | sqlalchemy.engine.Engine | [cached since 0.006142s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:36,923 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:08:36,923 | INFO | sqlalchemy.engine.Engine | [cached since 0.006779s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:08:36,925 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:08:36,925 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 21:08:36,927 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:08:36,927 | INFO | sqlalchemy.engine.Engine | [cached since 0.002036s ago] ('account_type', 'pg_catalog')
2025-11-04 21:08:36,927 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:08:36,928 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:08:36,929 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:08:36,929 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:08:36,931 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:08:36,931 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] ()
2025-11-04 21:08:36,944 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:08:36,954 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:09:04,998 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:09:04,998 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:09:05,000 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:09:05,000 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:09:05,003 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:09:05,003 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:09:05,004 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:09:05,004 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:09:05,004 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 21:09:05,007 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:09:05,007 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:09:05,009 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:05,009 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:05,013 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:05,013 | INFO | sqlalchemy.engine.Engine | [cached since 0.004397s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:05,015 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:05,015 | INFO | sqlalchemy.engine.Engine | [cached since 0.005614s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:05,015 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:05,015 | INFO | sqlalchemy.engine.Engine | [cached since 0.0063s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:05,016 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:05,016 | INFO | sqlalchemy.engine.Engine | [cached since 0.007116s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:05,018 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:09:05,018 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 21:09:05,020 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:09:05,020 | INFO | sqlalchemy.engine.Engine | [cached since 0.002331s ago] ('account_type', 'pg_catalog')
2025-11-04 21:09:05,021 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:09:05,021 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ()
2025-11-04 21:09:05,023 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:09:05,023 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:09:05,024 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:09:05,024 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 21:09:05,038 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:09:05,049 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:09:18,820 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:09:18,821 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:09:18,823 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:09:18,823 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:09:18,825 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:09:18,825 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:09:18,826 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:09:18,827 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:09:18,827 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:09:18,828 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:09:18,828 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:09:18,831 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:18,831 | INFO | sqlalchemy.engine.Engine | [generated in 0.00022s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:18,835 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:18,835 | INFO | sqlalchemy.engine.Engine | [cached since 0.003656s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:18,836 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:18,836 | INFO | sqlalchemy.engine.Engine | [cached since 0.004667s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:18,837 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:18,837 | INFO | sqlalchemy.engine.Engine | [cached since 0.005729s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:18,838 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:09:18,838 | INFO | sqlalchemy.engine.Engine | [cached since 0.006637s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:09:18,840 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:09:18,840 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('user_status', 'pg_catalog')
2025-11-04 21:09:18,842 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:09:18,842 | INFO | sqlalchemy.engine.Engine | [cached since 0.002715s ago] ('account_type', 'pg_catalog')
2025-11-04 21:09:18,843 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:09:18,843 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:09:18,845 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:09:18,845 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:09:18,847 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:09:18,847 | INFO | sqlalchemy.engine.Engine | [generated in 0.00028s] ()
2025-11-04 21:09:18,860 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:09:18,868 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:10:05,183 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:10:05,183 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:05,186 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:10:05,186 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:05,188 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:10:05,188 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:05,190 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:10:05,190 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:10:05,190 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:10:05,192 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:10:05,192 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:10:05,194 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:05,194 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:05,198 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:05,198 | INFO | sqlalchemy.engine.Engine | [cached since 0.004082s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:05,199 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:05,199 | INFO | sqlalchemy.engine.Engine | [cached since 0.004816s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:05,200 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:05,200 | INFO | sqlalchemy.engine.Engine | [cached since 0.005491s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:05,200 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:05,200 | INFO | sqlalchemy.engine.Engine | [cached since 0.006304s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:05,202 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:10:05,202 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 21:10:05,204 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:10:05,204 | INFO | sqlalchemy.engine.Engine | [cached since 0.002055s ago] ('account_type', 'pg_catalog')
2025-11-04 21:10:05,205 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:10:05,205 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:10:05,207 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:10:05,207 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:10:05,208 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:10:05,208 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 21:10:05,222 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:10:05,235 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:10:40,292 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:10:40,292 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:40,295 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:10:40,295 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:40,297 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:10:40,297 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:40,299 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:10:40,300 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:10:40,300 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:10:40,301 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:10:40,301 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:10:40,304 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:40,304 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:40,308 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:40,308 | INFO | sqlalchemy.engine.Engine | [cached since 0.004001s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:40,309 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:40,309 | INFO | sqlalchemy.engine.Engine | [cached since 0.005045s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:40,310 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:40,310 | INFO | sqlalchemy.engine.Engine | [cached since 0.005892s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:40,313 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:40,313 | INFO | sqlalchemy.engine.Engine | [cached since 0.009271s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:40,316 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:10:40,316 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('user_status', 'pg_catalog')
2025-11-04 21:10:40,319 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:10:40,319 | INFO | sqlalchemy.engine.Engine | [cached since 0.003075s ago] ('account_type', 'pg_catalog')
2025-11-04 21:10:40,320 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:10:40,320 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:10:40,322 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:10:40,322 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:10:40,325 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:10:40,325 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 21:10:40,338 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:10:40,345 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:10:49,346 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:10:49,346 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:49,348 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:10:49,349 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:49,350 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:10:49,350 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:10:49,352 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:10:49,352 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:10:49,352 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:10:49,354 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:10:49,354 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:10:49,357 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:49,357 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:49,360 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:49,360 | INFO | sqlalchemy.engine.Engine | [cached since 0.003659s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:49,361 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:49,361 | INFO | sqlalchemy.engine.Engine | [cached since 0.004595s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:49,362 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:49,362 | INFO | sqlalchemy.engine.Engine | [cached since 0.005457s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:49,363 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:10:49,363 | INFO | sqlalchemy.engine.Engine | [cached since 0.006258s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:10:49,365 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:10:49,365 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('user_status', 'pg_catalog')
2025-11-04 21:10:49,367 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:10:49,367 | INFO | sqlalchemy.engine.Engine | [cached since 0.002146s ago] ('account_type', 'pg_catalog')
2025-11-04 21:10:49,368 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:10:49,368 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:10:49,370 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:10:49,370 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:10:49,372 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:10:49,372 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 21:10:49,383 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:10:49,394 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:11:07,527 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:11:07,527 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:11:07,530 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:11:07,530 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:11:07,532 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:11:07,532 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:11:07,533 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:11:07,533 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:11:07,533 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:11:07,534 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:11:07,535 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:11:07,537 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:11:07,537 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:11:07,541 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:11:07,541 | INFO | sqlalchemy.engine.Engine | [cached since 0.004087s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:11:07,542 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:11:07,542 | INFO | sqlalchemy.engine.Engine | [cached since 0.005214s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:11:07,543 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:11:07,543 | INFO | sqlalchemy.engine.Engine | [cached since 0.006204s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:11:07,544 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:11:07,544 | INFO | sqlalchemy.engine.Engine | [cached since 0.007129s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:11:07,545 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:11:07,545 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 21:11:07,548 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:11:07,548 | INFO | sqlalchemy.engine.Engine | [cached since 0.002317s ago] ('account_type', 'pg_catalog')
2025-11-04 21:11:07,548 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:11:07,549 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:11:07,550 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:11:07,550 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:11:07,551 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:11:07,552 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 21:11:07,566 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:11:07,579 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:12:02,688 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:12:02,689 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:12:02,693 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:12:02,693 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:12:02,695 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:12:02,695 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:12:02,696 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:12:02,696 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:12:02,696 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:12:02,697 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:12:02,698 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 21:12:02,700 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:12:02,700 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:12:02,701 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:12:02,701 | INFO | sqlalchemy.engine.Engine | [cached since 0.001888s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:12:02,702 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:12:02,702 | INFO | sqlalchemy.engine.Engine | [cached since 0.002387s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:12:02,702 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:12:02,702 | INFO | sqlalchemy.engine.Engine | [cached since 0.002913s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:12:02,703 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:12:02,703 | INFO | sqlalchemy.engine.Engine | [cached since 0.003413s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:12:02,704 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:12:02,704 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 21:12:02,705 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:12:02,705 | INFO | sqlalchemy.engine.Engine | [cached since 0.001139s ago] ('account_type', 'pg_catalog')
2025-11-04 21:12:02,706 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:12:02,706 | INFO | sqlalchemy.engine.Engine | [generated in 0.00045s] ()
2025-11-04 21:12:02,708 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:12:02,708 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:12:02,709 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:12:02,709 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 21:12:02,719 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:12:02,727 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:13:03,269 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:13:03,269 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:13:03,271 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:13:03,271 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:13:03,274 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:13:03,274 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:13:03,275 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:13:03,276 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:13:03,276 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:13:03,277 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:13:03,277 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:13:03,280 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:13:03,280 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:13:03,285 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:13:03,285 | INFO | sqlalchemy.engine.Engine | [cached since 0.005457s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:13:03,286 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:13:03,286 | INFO | sqlalchemy.engine.Engine | [cached since 0.006695s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:13:03,287 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:13:03,287 | INFO | sqlalchemy.engine.Engine | [cached since 0.00775s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:13:03,288 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:13:03,289 | INFO | sqlalchemy.engine.Engine | [cached since 0.008958s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:13:03,290 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:13:03,290 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 21:13:03,294 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:13:03,294 | INFO | sqlalchemy.engine.Engine | [cached since 0.004025s ago] ('account_type', 'pg_catalog')
2025-11-04 21:13:03,295 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:13:03,295 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:13:03,297 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:13:03,297 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:13:03,300 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:13:03,300 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ()
2025-11-04 21:13:03,313 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:13:03,322 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:47:13,942 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:47:13,943 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:47:13,945 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:47:13,945 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:47:13,947 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:47:13,947 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:47:13,949 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:47:13,949 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:47:13,949 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:47:13,950 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:47:13,951 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:47:13,954 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:13,954 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:13,958 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:13,958 | INFO | sqlalchemy.engine.Engine | [cached since 0.00419s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:13,959 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:13,959 | INFO | sqlalchemy.engine.Engine | [cached since 0.005165s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:13,960 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:13,960 | INFO | sqlalchemy.engine.Engine | [cached since 0.005924s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:13,961 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:13,961 | INFO | sqlalchemy.engine.Engine | [cached since 0.006926s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:13,962 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:47:13,962 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('user_status', 'pg_catalog')
2025-11-04 21:47:13,964 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:47:13,964 | INFO | sqlalchemy.engine.Engine | [cached since 0.001788s ago] ('account_type', 'pg_catalog')
2025-11-04 21:47:13,964 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:47:13,965 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:47:13,967 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:47:13,967 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:47:13,969 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:47:13,969 | INFO | sqlalchemy.engine.Engine | [generated in 0.00023s] ()
2025-11-04 21:47:13,986 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:47:13,993 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:47:20,740 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:47:20,740 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:47:20,742 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:47:20,743 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:47:20,745 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:47:20,745 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:47:20,746 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:47:20,746 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:47:20,746 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:47:20,748 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:47:20,748 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:47:20,750 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:20,750 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:20,754 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:20,754 | INFO | sqlalchemy.engine.Engine | [cached since 0.004083s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:20,755 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:20,755 | INFO | sqlalchemy.engine.Engine | [cached since 0.005208s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:20,756 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:20,756 | INFO | sqlalchemy.engine.Engine | [cached since 0.006s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:20,757 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:47:20,757 | INFO | sqlalchemy.engine.Engine | [cached since 0.006589s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:47:20,758 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:47:20,758 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 21:47:20,761 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:47:20,761 | INFO | sqlalchemy.engine.Engine | [cached since 0.002954s ago] ('account_type', 'pg_catalog')
2025-11-04 21:47:20,762 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:47:20,762 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 21:47:20,764 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:47:20,764 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:47:20,765 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:47:20,765 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 21:47:20,782 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:47:20,789 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:48:16,056 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:48:16,056 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:16,059 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:48:16,059 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:16,060 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:48:16,061 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:16,062 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:48:16,062 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:48:16,062 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:48:16,063 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:48:16,063 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:48:16,065 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:16,065 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:16,070 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:16,070 | INFO | sqlalchemy.engine.Engine | [cached since 0.004988s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:16,071 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:16,071 | INFO | sqlalchemy.engine.Engine | [cached since 0.006016s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:16,072 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:16,072 | INFO | sqlalchemy.engine.Engine | [cached since 0.00688s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:16,073 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:16,073 | INFO | sqlalchemy.engine.Engine | [cached since 0.007743s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:16,075 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:48:16,075 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 21:48:16,077 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:48:16,078 | INFO | sqlalchemy.engine.Engine | [cached since 0.003029s ago] ('account_type', 'pg_catalog')
2025-11-04 21:48:16,079 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:48:16,079 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:48:16,080 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:48:16,080 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ()
2025-11-04 21:48:16,081 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:48:16,082 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-11-04 21:48:16,095 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:48:16,104 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:48:24,974 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:48:24,974 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:24,980 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:48:24,980 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:24,985 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:48:24,985 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:24,987 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:48:24,987 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:48:24,987 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 21:48:24,989 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:48:24,989 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 21:48:24,991 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:24,991 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:24,995 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:24,995 | INFO | sqlalchemy.engine.Engine | [cached since 0.004044s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:24,996 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:24,996 | INFO | sqlalchemy.engine.Engine | [cached since 0.004733s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:24,997 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:24,997 | INFO | sqlalchemy.engine.Engine | [cached since 0.00529s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:24,997 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:24,997 | INFO | sqlalchemy.engine.Engine | [cached since 0.005971s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:24,998 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:48:24,999 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 21:48:25,000 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:48:25,000 | INFO | sqlalchemy.engine.Engine | [cached since 0.001243s ago] ('account_type', 'pg_catalog')
2025-11-04 21:48:25,000 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:48:25,001 | INFO | sqlalchemy.engine.Engine | [generated in 0.00026s] ()
2025-11-04 21:48:25,001 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:48:25,002 | INFO | sqlalchemy.engine.Engine | [generated in 0.00034s] ()
2025-11-04 21:48:25,003 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:48:25,003 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] ()
2025-11-04 21:48:25,013 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:48:25,020 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:48:33,825 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:48:33,825 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:33,828 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:48:33,828 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:33,830 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:48:33,830 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:48:33,831 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:48:33,832 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:48:33,832 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ()
2025-11-04 21:48:33,833 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:48:33,833 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:48:33,838 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:33,838 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:33,842 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:33,842 | INFO | sqlalchemy.engine.Engine | [cached since 0.004088s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:33,844 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:33,844 | INFO | sqlalchemy.engine.Engine | [cached since 0.006012s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:33,845 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:33,846 | INFO | sqlalchemy.engine.Engine | [cached since 0.007361s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:33,846 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:48:33,846 | INFO | sqlalchemy.engine.Engine | [cached since 0.008068s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:48:33,848 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:48:33,848 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 21:48:33,849 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:48:33,849 | INFO | sqlalchemy.engine.Engine | [cached since 0.00195s ago] ('account_type', 'pg_catalog')
2025-11-04 21:48:33,850 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:48:33,850 | INFO | sqlalchemy.engine.Engine | [generated in 0.00005s] ()
2025-11-04 21:48:33,852 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:48:33,852 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 21:48:33,854 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:48:33,854 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 21:48:33,865 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:48:33,872 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:50:54,653 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:50:54,653 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:50:54,654 | INFO | sqlalchemy.engine.Engine | [cached since 140.8s ago] ()
2025-11-04 21:50:54,667 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.email = $1::VARCHAR
2025-11-04 21:50:54,667 | INFO | sqlalchemy.engine.Engine | [generated in 0.00019s] ('hola@mail.com',)
2025-11-04 21:50:54,710 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:50:59,168 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:50:59,168 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:50:59,168 | INFO | sqlalchemy.engine.Engine | [cached since 145.3s ago] ()
2025-11-04 21:50:59,172 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 21:50:59,172 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] (1,)
2025-11-04 21:50:59,187 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-11-04 21:50:59,188 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] (UUID('26e037b1-bc89-451d-862e-cd0cad81130e'), UUID('5ec43225-5331-49c9-a9cf-33657bc1fca8'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1013", "windDirection": "040", "windSpeed": "2", "wind": "040/2"}, "objectives": [], "scenario_id": "mrpv_full_flight", "default_frequency_group": "ground"}')
2025-11-04 21:50:59,190 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:50:59,222 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:50:59,223 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-11-04 21:50:59,223 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] (UUID('26e037b1-bc89-451d-862e-cd0cad81130e'),)
2025-11-04 21:50:59,225 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 21:51:53,184 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:33745]
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:51:53,185 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 21:51:53,212 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:51:53,213 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:51:53,213 | INFO | sqlalchemy.engine.Engine | [cached since 199.4s ago] ()
2025-11-04 21:51:53,216 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 21:51:53,216 | INFO | sqlalchemy.engine.Engine | [cached since 54.04s ago] (1,)
2025-11-04 21:51:53,230 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:51:53,230 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184492b0>}) about to wait for the following futures []
2025-11-04 21:51:53,231 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184492b0>}) done waiting for dependent futures
2025-11-04 21:51:53,231 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184492b0>}) with kwargs {'client': <botocore.client.S3 object at 0x10fb6dbe0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x11808e900>, 'osutil': <s3transfer.utils.OSUtils object at 0x11808e7b0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x118448ad0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184492b0>}
2025-11-04 21:51:53,231 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/38381c8c202a40309c8dc080c8d8dd5f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x118448ad0> for transfer request: 0.
2025-11-04 21:51:53,231 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:51:53,231 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/38381c8c202a40309c8dc080c8d8dd5f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 21:51:53,232 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/38381c8c202a40309c8dc080c8d8dd5f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 21:51:53,232 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/38381c8c202a40309c8dc080c8d8dd5f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10fb6dbe0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x118449be0>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/38381c8c202a40309c8dc080c8d8dd5f.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 21:51:53,232 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:51:54,047 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:52:04,352 | INFO | app.controllers.audio | Transcripción recibida session=5ec43225-5331-49c9-a9cf-33657bc1fca8: Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:52:04,353 | INFO | app.logs.transcript | student | session=5ec43225-5331-49c9-a9cf-33657bc1fca8 | frequency=121.7 | text=Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:52:04,422 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:52:04,423 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:52:04,423 | INFO | sqlalchemy.engine.Engine | [generated in 0.00015s] (UUID('5ec43225-5331-49c9-a9cf-33657bc1fca8'),)
2025-11-04 21:52:04,428 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:52:05,209 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:52:05,210 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:52:05,210 | INFO | sqlalchemy.engine.Engine | [cached since 0.787s ago] (UUID('5ec43225-5331-49c9-a9cf-33657bc1fca8'),)
2025-11-04 21:52:05,217 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 21:52:05,217 | INFO | sqlalchemy.engine.Engine | [generated in 0.00037s] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "obje ... (18637 characters truncated) ... ": "MRPV-MRPV", "intent": "ground_departure_briefing", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-11-05T03:52:05Z"}]}', datetime.datetime(2025, 11, 5, 3, 52, 5, 217587), UUID('26e037b1-bc89-451d-862e-cd0cad81130e'))
2025-11-04 21:52:05,245 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:52:05,283 | INFO | app.controllers.audio | Fase activa session=5ec43225-5331-49c9-a9cf-33657bc1fca8 phase_id=ground_departure_request intent=ground_departure_briefing freq=ground
2025-11-04 21:52:05,284 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_departure_briefing freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial para abrir plan de vuelo y autorizar rodaje. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_departure_briefing
Transcripción textual del alumno:
Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicación (...
2025-11-04 21:52:05,284 | ERROR | app.controllers.audio | Fallo en pipeline LLM
Traceback (most recent call last):
  File "/Users/abraham_salas/EcoWhiskey-ATC-BackEnd/app/controllers/audio.py", line 174, in analyze_audio
    request = await build_llm_request(
              ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
TypeError: object LlmRequest can't be used in 'await' expression
2025-11-04 21:52:05,286 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:52:12,163 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 21:52:12,164 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:33745]
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:52:12,165 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 21:52:12,196 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:52:12,196 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:52:12,196 | INFO | sqlalchemy.engine.Engine | [cached since 218.4s ago] ()
2025-11-04 21:52:12,205 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 21:52:12,205 | INFO | sqlalchemy.engine.Engine | [cached since 73.03s ago] (1,)
2025-11-04 21:52:12,220 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:52:12,221 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184ba850>}) about to wait for the following futures []
2025-11-04 21:52:12,221 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184ba850>}) done waiting for dependent futures
2025-11-04 21:52:12,221 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184ba850>}) with kwargs {'client': <botocore.client.S3 object at 0x10fb6dbe0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x1180c0550>, 'osutil': <s3transfer.utils.OSUtils object at 0x1180c1450>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x1184903e0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x1184ba850>}
2025-11-04 21:52:12,221 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/dd390516d7154423a71cb21684b13833.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x1184903e0> for transfer request: 0.
2025-11-04 21:52:12,221 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:52:12,221 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/dd390516d7154423a71cb21684b13833.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 21:52:12,221 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/dd390516d7154423a71cb21684b13833.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 21:52:12,221 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/dd390516d7154423a71cb21684b13833.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10fb6dbe0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x1184bb110>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/5ec43225-5331-49c9-a9cf-33657bc1fca8/dd390516d7154423a71cb21684b13833.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 21:52:12,222 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:52:12,605 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:52:22,401 | INFO | app.controllers.audio | Transcripción recibida session=5ec43225-5331-49c9-a9cf-33657bc1fca8: Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:52:22,403 | INFO | app.logs.transcript | student | session=5ec43225-5331-49c9-a9cf-33657bc1fca8 | frequency=121.7 | text=Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:52:22,459 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:52:22,459 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:52:22,459 | INFO | sqlalchemy.engine.Engine | [cached since 18.04s ago] (UUID('5ec43225-5331-49c9-a9cf-33657bc1fca8'),)
2025-11-04 21:52:22,464 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:52:22,950 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:52:22,950 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:52:22,950 | INFO | sqlalchemy.engine.Engine | [cached since 18.53s ago] (UUID('5ec43225-5331-49c9-a9cf-33657bc1fca8'),)
2025-11-04 21:52:22,954 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 21:52:22,954 | INFO | sqlalchemy.engine.Engine | [cached since 17.74s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (19156 characters truncated) ... nd": "121.7", "unicom": "122.0", "approach": "120.5"}, "scenario_id": "mrpv_full_flight", "transponder": "0518", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 3, 52, 22, 954111), UUID('26e037b1-bc89-451d-862e-cd0cad81130e'))
2025-11-04 21:52:22,959 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:52:22,974 | INFO | app.controllers.audio | Fase activa session=5ec43225-5331-49c9-a9cf-33657bc1fca8 phase_id=ground_departure_request intent=ground_taxi_clearance freq=ground
2025-11-04 21:52:22,974 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial para abrir plan de vuelo y autorizar rodaje. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicación (hang...
2025-11-04 21:52:22,976 | ERROR | app.controllers.audio | Fallo en pipeline LLM
Traceback (most recent call last):
  File "/Users/abraham_salas/EcoWhiskey-ATC-BackEnd/app/controllers/audio.py", line 174, in analyze_audio
    request = await build_llm_request(
              ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
TypeError: object LlmRequest can't be used in 'await' expression
2025-11-04 21:52:22,976 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:54:03,069 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 21:54:03,069 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:54:03,072 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 21:54:03,072 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:54:03,074 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 21:54:03,074 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 21:54:03,075 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:54:03,076 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 21:54:03,076 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 21:54:03,078 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:54:03,078 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:54:03,081 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:54:03,081 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:54:03,085 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:54:03,085 | INFO | sqlalchemy.engine.Engine | [cached since 0.004145s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:54:03,086 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:54:03,086 | INFO | sqlalchemy.engine.Engine | [cached since 0.005133s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:54:03,088 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:54:03,088 | INFO | sqlalchemy.engine.Engine | [cached since 0.00708s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:54:03,089 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 21:54:03,089 | INFO | sqlalchemy.engine.Engine | [cached since 0.007941s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 21:54:03,090 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:54:03,090 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ('user_status', 'pg_catalog')
2025-11-04 21:54:03,092 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 21:54:03,092 | INFO | sqlalchemy.engine.Engine | [cached since 0.002109s ago] ('account_type', 'pg_catalog')
2025-11-04 21:54:03,094 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 21:54:03,094 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 21:54:03,096 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 21:54:03,096 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 21:54:03,098 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 21:54:03,098 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] ()
2025-11-04 21:54:03,114 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:54:03,122 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 21:54:53,285 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:54:53,285 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:54:53,285 | INFO | sqlalchemy.engine.Engine | [cached since 50.21s ago] ()
2025-11-04 21:54:53,293 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 21:54:53,293 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] (1,)
2025-11-04 21:54:53,312 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-11-04 21:54:53,312 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] (UUID('ca4894ab-09c5-4f9a-af7e-770ecbdf75fe'), UUID('86ea369e-06bc-401e-a354-909c2fbb33b3'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1013", "windDirection": "040", "windSpeed": "2", "wind": "040/2"}, "objectives": [], "scenario_id": "mrpv_full_flight", "default_frequency_group": "ground"}')
2025-11-04 21:54:53,313 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:54:53,345 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:54:53,346 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-11-04 21:54:53,346 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] (UUID('ca4894ab-09c5-4f9a-af7e-770ecbdf75fe'),)
2025-11-04 21:54:53,349 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:55:14,748 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:33745]
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:55:14,749 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 21:55:14,776 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:55:14,777 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:55:14,777 | INFO | sqlalchemy.engine.Engine | [cached since 71.7s ago] ()
2025-11-04 21:55:14,779 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 21:55:14,779 | INFO | sqlalchemy.engine.Engine | [cached since 21.49s ago] (1,)
2025-11-04 21:55:14,795 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:55:14,795 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11628d160>}) about to wait for the following futures []
2025-11-04 21:55:14,795 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11628d160>}) done waiting for dependent futures
2025-11-04 21:55:14,795 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11628d160>}) with kwargs {'client': <botocore.client.S3 object at 0x115b71be0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x11618d2b0>, 'osutil': <s3transfer.utils.OSUtils object at 0x11618c830>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x11628c980>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x11628d160>}
2025-11-04 21:55:14,795 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/86ea369e-06bc-401e-a354-909c2fbb33b3/0889f705e0c74337aa0ec788fec171b4.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x11628c980> for transfer request: 0.
2025-11-04 21:55:14,796 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:55:14,796 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/86ea369e-06bc-401e-a354-909c2fbb33b3/0889f705e0c74337aa0ec788fec171b4.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 21:55:14,796 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/86ea369e-06bc-401e-a354-909c2fbb33b3/0889f705e0c74337aa0ec788fec171b4.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 21:55:14,796 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:55:14,796 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/86ea369e-06bc-401e-a354-909c2fbb33b3/0889f705e0c74337aa0ec788fec171b4.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x115b71be0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11628da90>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/86ea369e-06bc-401e-a354-909c2fbb33b3/0889f705e0c74337aa0ec788fec171b4.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 21:55:15,966 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:55:26,117 | INFO | app.controllers.audio | Transcripción recibida session=86ea369e-06bc-401e-a354-909c2fbb33b3: Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:55:26,118 | INFO | app.logs.transcript | student | session=86ea369e-06bc-401e-a354-909c2fbb33b3 | frequency=121.7 | text=Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:55:26,177 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:55:26,178 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:55:26,178 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] (UUID('86ea369e-06bc-401e-a354-909c2fbb33b3'),)
2025-11-04 21:55:26,181 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:55:26,965 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:55:26,966 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:55:26,966 | INFO | sqlalchemy.engine.Engine | [cached since 0.7885s ago] (UUID('86ea369e-06bc-401e-a354-909c2fbb33b3'),)
2025-11-04 21:55:26,977 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 21:55:26,977 | INFO | sqlalchemy.engine.Engine | [generated in 0.00041s] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "obje ... (18594 characters truncated) ... ute": "MRPV-MRPV", "intent": "ground_departure_brief", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-11-05T03:55:26Z"}]}', datetime.datetime(2025, 11, 5, 3, 55, 26, 976790), UUID('ca4894ab-09c5-4f9a-af7e-770ecbdf75fe'))
2025-11-04 21:55:26,982 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:55:26,998 | INFO | app.controllers.audio | Fase activa session=86ea369e-06bc-401e-a354-909c2fbb33b3 phase_id=ground_departure_request intent=ground_departure_brief freq=ground
2025-11-04 21:55:26,999 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_departure_brief freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial para abrir plan de vuelo y autorizar rodaje. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_departure_brief
Transcripción textual del alumno:
Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicación (han...
2025-11-04 21:55:29,072 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_departure_brief: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Rodaje Alfa, Bravo al punto de espera. Pista uno cero en uso, viento 40 grados a 2 nudos, QNH 1013. Contacte Torre 118.3 cuando listo.",
  "feedback": "Colación completa. Bien hecho.",
  "confidence": 0.95,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-11-04 21:55:29,072 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_clearance) difiere del esperado (ground_departure_brief)
2025-11-04 21:55:29,073 | INFO | app.controllers.audio | Transición automática de fase session=86ea369e-06bc-401e-a354-909c2fbb33b3 de=ground_departure_request a=ground_readback
2025-11-04 21:55:29,119 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:55:29,120 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:55:29,120 | INFO | sqlalchemy.engine.Engine | [cached since 2.942s ago] (UUID('86ea369e-06bc-401e-a354-909c2fbb33b3'),)
2025-11-04 21:55:29,124 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 21:55:29,124 | INFO | sqlalchemy.engine.Engine | [cached since 2.148s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (19628 characters truncated) ... roach": "120.5", "radio": "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_full_flight", "transponder": "0505", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 3, 55, 29, 124527), UUID('ca4894ab-09c5-4f9a-af7e-770ecbdf75fe'))
2025-11-04 21:55:29,130 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:55:29,139 | INFO | app.logs.transcript | controller | session=86ea369e-06bc-401e-a354-909c2fbb33b3 | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Rodaje Alfa, Bravo al punto de espera. Pista uno cero en uso, viento 40 grados a 2 nudos, QNH 1013. Contacte Torre 118.3 cuando listo.
2025-11-04 21:55:31,841 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:59:17,547 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:59:17,549 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:59:17,549 | INFO | sqlalchemy.engine.Engine | [cached since 314.5s ago] ()
2025-11-04 21:59:17,552 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 21:59:17,552 | INFO | sqlalchemy.engine.Engine | [cached since 264.3s ago] (1,)
2025-11-04 21:59:17,575 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-11-04 21:59:17,575 | INFO | sqlalchemy.engine.Engine | [cached since 264.3s ago] (UUID('924af777-552b-4b3c-aa97-050180a12ffc'), UUID('f777415e-05ab-489d-9f07-5c060f6cdf0a'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1013", "windDirection": "040", "windSpeed": "2", "wind": "040/2"}, "objectives": [], "scenario_id": "mrpv_full_flight", "default_frequency_group": "ground"}')
2025-11-04 21:59:17,577 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:59:17,608 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:59:17,608 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-11-04 21:59:17,608 | INFO | sqlalchemy.engine.Engine | [cached since 264.3s ago] (UUID('924af777-552b-4b3c-aa97-050180a12ffc'),)
2025-11-04 21:59:17,610 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:59:22,097 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:59:22,097 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 21:59:22,097 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 21:59:22,097 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:59:22,097 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:33745]
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 21:59:22,098 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 21:59:22,128 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:59:22,128 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 21:59:22,128 | INFO | sqlalchemy.engine.Engine | [cached since 319.1s ago] ()
2025-11-04 21:59:22,130 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 21:59:22,130 | INFO | sqlalchemy.engine.Engine | [cached since 268.8s ago] (1,)
2025-11-04 21:59:22,144 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:59:22,145 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629e850>}) about to wait for the following futures []
2025-11-04 21:59:22,145 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629e850>}) done waiting for dependent futures
2025-11-04 21:59:22,145 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629e850>}) with kwargs {'client': <botocore.client.S3 object at 0x115b71be0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x1161bdf90>, 'osutil': <s3transfer.utils.OSUtils object at 0x1161bda90>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x116230d60>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629e850>}
2025-11-04 21:59:22,145 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f777415e-05ab-489d-9f07-5c060f6cdf0a/19d52af00d864f63b366fa2f23164be2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x116230d60> for transfer request: 0.
2025-11-04 21:59:22,145 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 21:59:22,145 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f777415e-05ab-489d-9f07-5c060f6cdf0a/19d52af00d864f63b366fa2f23164be2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 21:59:22,145 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f777415e-05ab-489d-9f07-5c060f6cdf0a/19d52af00d864f63b366fa2f23164be2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 21:59:22,145 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:59:22,145 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f777415e-05ab-489d-9f07-5c060f6cdf0a/19d52af00d864f63b366fa2f23164be2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x115b71be0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11629ee90>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/f777415e-05ab-489d-9f07-5c060f6cdf0a/19d52af00d864f63b366fa2f23164be2.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 21:59:22,911 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 21:59:33,147 | INFO | app.controllers.audio | Transcripción recibida session=f777415e-05ab-489d-9f07-5c060f6cdf0a: Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:59:33,148 | INFO | app.logs.transcript | student | session=f777415e-05ab-489d-9f07-5c060f6cdf0a | frequency=121.7 | text=Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 21:59:33,187 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:59:33,188 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:59:33,188 | INFO | sqlalchemy.engine.Engine | [cached since 247s ago] (UUID('f777415e-05ab-489d-9f07-5c060f6cdf0a'),)
2025-11-04 21:59:33,193 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 21:59:33,657 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:59:33,658 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:59:33,658 | INFO | sqlalchemy.engine.Engine | [cached since 247.5s ago] (UUID('f777415e-05ab-489d-9f07-5c060f6cdf0a'),)
2025-11-04 21:59:33,662 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 21:59:33,662 | INFO | sqlalchemy.engine.Engine | [cached since 246.7s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "obje ... (18597 characters truncated) ... ": "MRPV-MRPV", "intent": "ground_departure_briefing", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-11-05T03:59:33Z"}]}', datetime.datetime(2025, 11, 5, 3, 59, 33, 662038), UUID('924af777-552b-4b3c-aa97-050180a12ffc'))
2025-11-04 21:59:33,668 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:59:33,685 | INFO | app.controllers.audio | Fase activa session=f777415e-05ab-489d-9f07-5c060f6cdf0a phase_id=ground_departure_request intent=ground_departure_briefing freq=ground
2025-11-04 21:59:33,686 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_departure_briefing freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial para abrir plan de vuelo y autorizar rodaje. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_departure_briefing
Transcripción textual del alumno:
Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicación (...
2025-11-04 21:59:35,444 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_departure_briefing: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Rodaje Alfa, Bravo, pista uno cero en uso, viento 40 grados a 2 nudos, QNH 1013. Contacte Torre 118.3 cuando listo.",
  "feedback": "Colación completa. Bien hecho.",
  "confidence": 0.95,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-11-04 21:59:35,445 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_clearance) difiere del esperado (ground_departure_briefing)
2025-11-04 21:59:35,445 | INFO | app.controllers.audio | Transición automática de fase session=f777415e-05ab-489d-9f07-5c060f6cdf0a de=ground_departure_request a=ground_readback
2025-11-04 21:59:35,491 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 21:59:35,491 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 21:59:35,491 | INFO | sqlalchemy.engine.Engine | [cached since 249.3s ago] (UUID('f777415e-05ab-489d-9f07-5c060f6cdf0a'),)
2025-11-04 21:59:35,495 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 21:59:35,495 | INFO | sqlalchemy.engine.Engine | [cached since 248.5s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (19596 characters truncated) ... roach": "120.5", "radio": "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_full_flight", "transponder": "0545", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 3, 59, 35, 495429), UUID('924af777-552b-4b3c-aa97-050180a12ffc'))
2025-11-04 21:59:35,500 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 21:59:35,506 | INFO | app.logs.transcript | controller | session=f777415e-05ab-489d-9f07-5c060f6cdf0a | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Rodaje Alfa, Bravo, pista uno cero en uso, viento 40 grados a 2 nudos, QNH 1013. Contacte Torre 118.3 cuando listo.
2025-11-04 21:59:37,728 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:01:19,841 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:01:19,842 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:01:19,842 | INFO | sqlalchemy.engine.Engine | [cached since 436.8s ago] ()
2025-11-04 22:01:19,845 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 22:01:19,845 | INFO | sqlalchemy.engine.Engine | [cached since 386.6s ago] (1,)
2025-11-04 22:01:19,864 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-11-04 22:01:19,864 | INFO | sqlalchemy.engine.Engine | [cached since 386.6s ago] (UUID('1a0620d3-5709-4d2e-91f0-b95b7f8b91c5'), UUID('664071c8-fa4f-47dd-a033-48dd491365d5'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1013", "windDirection": "040", "windSpeed": "2", "wind": "040/2"}, "objectives": [], "scenario_id": "mrpv_full_flight", "default_frequency_group": "ground"}')
2025-11-04 22:01:19,866 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:01:19,903 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:01:19,903 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-11-04 22:01:19,903 | INFO | sqlalchemy.engine.Engine | [cached since 386.6s ago] (UUID('1a0620d3-5709-4d2e-91f0-b95b7f8b91c5'),)
2025-11-04 22:01:19,905 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:33745]
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:01:27,392 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 22:01:27,422 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:01:27,422 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:01:27,422 | INFO | sqlalchemy.engine.Engine | [cached since 444.3s ago] ()
2025-11-04 22:01:27,425 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 22:01:27,425 | INFO | sqlalchemy.engine.Engine | [cached since 394.1s ago] (1,)
2025-11-04 22:01:27,441 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 22:01:27,442 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629c190>}) about to wait for the following futures []
2025-11-04 22:01:27,442 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629c190>}) done waiting for dependent futures
2025-11-04 22:01:27,442 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629c190>}) with kwargs {'client': <botocore.client.S3 object at 0x115b71be0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x1161be850>, 'osutil': <s3transfer.utils.OSUtils object at 0x1161bda90>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x1162a27a0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x11629c190>}
2025-11-04 22:01:27,442 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/664071c8-fa4f-47dd-a033-48dd491365d5/61f760d8447f41bfb47a15a3254fba26.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x1162a27a0> for transfer request: 0.
2025-11-04 22:01:27,442 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 22:01:27,442 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/664071c8-fa4f-47dd-a033-48dd491365d5/61f760d8447f41bfb47a15a3254fba26.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 22:01:27,442 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/664071c8-fa4f-47dd-a033-48dd491365d5/61f760d8447f41bfb47a15a3254fba26.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 22:01:27,442 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/664071c8-fa4f-47dd-a033-48dd491365d5/61f760d8447f41bfb47a15a3254fba26.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x115b71be0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11629d450>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/664071c8-fa4f-47dd-a033-48dd491365d5/61f760d8447f41bfb47a15a3254fba26.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 22:01:27,443 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 22:01:28,185 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 22:01:38,333 | INFO | app.controllers.audio | Transcripción recibida session=664071c8-fa4f-47dd-a033-48dd491365d5: Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 22:01:38,333 | INFO | app.logs.transcript | student | session=664071c8-fa4f-47dd-a033-48dd491365d5 | frequency=121.7 | text=Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 22:01:38,377 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:01:38,377 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:01:38,377 | INFO | sqlalchemy.engine.Engine | [cached since 372.2s ago] (UUID('664071c8-fa4f-47dd-a033-48dd491365d5'),)
2025-11-04 22:01:38,380 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:01:38,811 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:01:38,812 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:01:38,812 | INFO | sqlalchemy.engine.Engine | [cached since 372.6s ago] (UUID('664071c8-fa4f-47dd-a033-48dd491365d5'),)
2025-11-04 22:01:38,817 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 22:01:38,818 | INFO | sqlalchemy.engine.Engine | [cached since 371.8s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "obje ... (18617 characters truncated) ... ": "MRPV-MRPV", "intent": "ground_departure_briefing", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-11-05T04:01:38Z"}]}', datetime.datetime(2025, 11, 5, 4, 1, 38, 817530), UUID('1a0620d3-5709-4d2e-91f0-b95b7f8b91c5'))
2025-11-04 22:01:38,823 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:01:38,834 | INFO | app.controllers.audio | Fase activa session=664071c8-fa4f-47dd-a033-48dd491365d5 phase_id=ground_departure_request intent=ground_departure_briefing freq=ground
2025-11-04 22:01:38,835 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_departure_briefing freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial para abrir plan de vuelo y autorizar rodaje. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_departure_briefing
Transcripción textual del alumno:
Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicación (...
2025-11-04 22:01:40,506 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_departure_briefing: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Rodaje Alfa 3, Alfa, pista uno cero en uso, viento 40 grados a 2 knots, QNH 1013. Contacte Torre 118.3 cuando listo.",
  "feedback": "Colación completa. Bien hecho.",
  "confidence": 0.95,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-11-04 22:01:40,507 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_clearance) difiere del esperado (ground_departure_briefing)
2025-11-04 22:01:40,507 | INFO | app.controllers.audio | Transición automática de fase session=664071c8-fa4f-47dd-a033-48dd491365d5 de=ground_departure_request a=ground_readback
2025-11-04 22:01:40,554 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:01:40,554 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:01:40,554 | INFO | sqlalchemy.engine.Engine | [cached since 374.4s ago] (UUID('664071c8-fa4f-47dd-a033-48dd491365d5'),)
2025-11-04 22:01:40,559 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 22:01:40,559 | INFO | sqlalchemy.engine.Engine | [cached since 373.6s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (19618 characters truncated) ... roach": "120.5", "radio": "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_full_flight", "transponder": "0513", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 4, 1, 40, 559564), UUID('1a0620d3-5709-4d2e-91f0-b95b7f8b91c5'))
2025-11-04 22:01:40,564 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:01:40,578 | INFO | app.logs.transcript | controller | session=664071c8-fa4f-47dd-a033-48dd491365d5 | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Rodaje Alfa 3, Alfa, pista uno cero en uso, viento 40 grados a 2 knots, QNH 1013. Contacte Torre 118.3 cuando listo.
2025-11-04 22:01:42,777 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:02:14,260 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 22:02:14,260 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:02:14,263 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 22:02:14,263 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:02:14,265 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 22:02:14,265 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:02:14,266 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:02:14,266 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 22:02:14,266 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 22:02:14,267 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:02:14,267 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 22:02:14,269 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:02:14,269 | INFO | sqlalchemy.engine.Engine | [generated in 0.00011s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:02:14,271 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:02:14,271 | INFO | sqlalchemy.engine.Engine | [cached since 0.001832s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:02:14,272 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:02:14,272 | INFO | sqlalchemy.engine.Engine | [cached since 0.002368s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:02:14,272 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:02:14,272 | INFO | sqlalchemy.engine.Engine | [cached since 0.002906s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:02:14,273 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:02:14,273 | INFO | sqlalchemy.engine.Engine | [cached since 0.003392s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:02:14,274 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 22:02:14,274 | INFO | sqlalchemy.engine.Engine | [generated in 0.00035s] ('user_status', 'pg_catalog')
2025-11-04 22:02:14,275 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 22:02:14,275 | INFO | sqlalchemy.engine.Engine | [cached since 0.001559s ago] ('account_type', 'pg_catalog')
2025-11-04 22:02:14,276 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 22:02:14,276 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 22:02:14,277 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 22:02:14,277 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 22:02:14,278 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 22:02:14,278 | INFO | sqlalchemy.engine.Engine | [generated in 0.00013s] ()
2025-11-04 22:02:14,287 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:02:14,293 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 22:02:17,915 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:02:17,915 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:02:17,915 | INFO | sqlalchemy.engine.Engine | [cached since 3.648s ago] ()
2025-11-04 22:02:17,923 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 22:02:17,923 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] (1,)
2025-11-04 22:02:17,939 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-11-04 22:02:17,939 | INFO | sqlalchemy.engine.Engine | [generated in 0.00020s] (UUID('5f0ccfbd-dede-41bf-8f00-d5dec71bb51c'), UUID('1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1013", "windDirection": "040", "windSpeed": "2", "wind": "040/2"}, "objectives": [], "scenario_id": "mrpv_full_flight", "default_frequency_group": "ground"}')
2025-11-04 22:02:17,941 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:02:17,970 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:02:17,971 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-11-04 22:02:17,971 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] (UUID('5f0ccfbd-dede-41bf-8f00-d5dec71bb51c'),)
2025-11-04 22:02:17,975 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 22:02:30,289 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 22:02:30,290 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:02:30,290 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:02:30,290 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:33745]
2025-11-04 22:02:30,290 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:02:30,290 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 22:02:30,324 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:02:30,324 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:02:30,324 | INFO | sqlalchemy.engine.Engine | [cached since 16.06s ago] ()
2025-11-04 22:02:30,327 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 22:02:30,327 | INFO | sqlalchemy.engine.Engine | [cached since 12.4s ago] (1,)
2025-11-04 22:02:30,341 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 22:02:30,341 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11238d160>}) about to wait for the following futures []
2025-11-04 22:02:30,341 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11238d160>}) done waiting for dependent futures
2025-11-04 22:02:30,341 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11238d160>}) with kwargs {'client': <botocore.client.S3 object at 0x10ddf5be0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x11228d2b0>, 'osutil': <s3transfer.utils.OSUtils object at 0x11228c830>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x11238c980>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x11238d160>}
2025-11-04 22:02:30,341 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/714ba623bca946468ae94457ebb79a14.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x11238c980> for transfer request: 0.
2025-11-04 22:02:30,341 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 22:02:30,342 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/714ba623bca946468ae94457ebb79a14.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 22:02:30,342 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/714ba623bca946468ae94457ebb79a14.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 22:02:30,342 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/714ba623bca946468ae94457ebb79a14.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10ddf5be0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x11238da90>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/714ba623bca946468ae94457ebb79a14.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 22:02:30,342 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 22:02:31,076 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 22:02:41,171 | INFO | app.controllers.audio | Transcripción recibida session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1: Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 22:02:41,171 | INFO | app.logs.transcript | student | session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1 | frequency=121.7 | text=Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.
2025-11-04 22:02:41,219 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:02:41,219 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:02:41,220 | INFO | sqlalchemy.engine.Engine | [generated in 0.00014s] (UUID('1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1'),)
2025-11-04 22:02:41,222 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:02:42,068 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:02:42,069 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:02:42,069 | INFO | sqlalchemy.engine.Engine | [cached since 0.8495s ago] (UUID('1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1'),)
2025-11-04 22:02:42,075 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 22:02:42,075 | INFO | sqlalchemy.engine.Engine | [generated in 0.00044s] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "obje ... (18700 characters truncated) ... ": "MRPV-MRPV", "intent": "ground_departure_briefing", "frequency_group": "ground", "intent_confidence": 0.95, "timestamp": "2025-11-05T04:02:42Z"}]}', datetime.datetime(2025, 11, 5, 4, 2, 42, 74871), UUID('5f0ccfbd-dede-41bf-8f00-d5dec71bb51c'))
2025-11-04 22:02:42,080 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:02:42,094 | INFO | app.controllers.audio | Fase activa session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1 phase_id=ground_departure_request intent=ground_departure_briefing freq=ground
2025-11-04 22:02:42,094 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_departure_briefing freq_group=ground
SYSTEM> Eres Pavas Superficie (121.7). Recibes la llamada inicial para abrir plan de vuelo y autorizar rodaje. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Solicitud de apertura y autorización de rodaje
Intent esperado: ground_departure_briefing
Transcripción textual del alumno:
Alfa Noviembre India en hangar 37 solicitando abrir plan de vuelo hacia zona Eco Vía Paso de Chomogos 7000 pies dos almas a bordo. Capitán Salas Autonomía cinco horas y media.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_departure_request

Checklist alumno:
- Saludo correcto a Pavas Superficie.
- Indicar ubicación (...
2025-11-04 22:02:44,035 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_departure_briefing: {
  "intent": "ground_taxi_clearance",
  "allowResponse": true,
  "controllerText": "Alfa Noviembre India, Pavas Superficie. Rodaje Alfa, Bravo al punto de espera. Pista uno cero en uso, viento 40 grados a 2 knots, QNH 1013. Contacte Torre 118.3 cuando listo.",
  "feedback": "Solicitud completa.",
  "confidence": 0.95,
  "metadata": {
    "nextPhase": "ground_readback"
  }
}
2025-11-04 22:02:44,036 | INFO | app.services.audio_pipeline | Intent devuelto por el LLM (ground_taxi_clearance) difiere del esperado (ground_departure_briefing)
2025-11-04 22:02:44,036 | INFO | app.controllers.audio | Transición automática de fase session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1 de=ground_departure_request a=ground_readback
2025-11-04 22:02:44,082 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:02:44,083 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:02:44,083 | INFO | sqlalchemy.engine.Engine | [cached since 2.863s ago] (UUID('1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1'),)
2025-11-04 22:02:44,087 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 22:02:44,087 | INFO | sqlalchemy.engine.Engine | [cached since 2.013s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (19703 characters truncated) ... roach": "120.5", "radio": "126.8", "unicom": "122.0"}, "scenario_id": "mrpv_full_flight", "transponder": "0578", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 4, 2, 44, 87051), UUID('5f0ccfbd-dede-41bf-8f00-d5dec71bb51c'))
2025-11-04 22:02:44,091 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:02:44,099 | INFO | app.logs.transcript | controller | session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1 | frequency=121.7 | intent=ground_taxi_clearance | phase=ground_readback | allow_response=True | text=Alfa Noviembre India, Pavas Superficie. Rodaje Alfa, Bravo al punto de espera. Pista uno cero en uso, viento 40 grados a 2 knots, QNH 1013. Contacte Torre 118.3 cuando listo.
2025-11-04 22:02:47,078 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:39361]
2025-11-04 22:03:42,751 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:03:42,752 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 22:03:42,790 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:03:42,791 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:03:42,791 | INFO | sqlalchemy.engine.Engine | [cached since 88.53s ago] ()
2025-11-04 22:03:42,793 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 22:03:42,793 | INFO | sqlalchemy.engine.Engine | [cached since 84.87s ago] (1,)
2025-11-04 22:03:42,804 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 22:03:42,804 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11239f890>}) about to wait for the following futures []
2025-11-04 22:03:42,805 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11239f890>}) done waiting for dependent futures
2025-11-04 22:03:42,805 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x11239f890>}) with kwargs {'client': <botocore.client.S3 object at 0x10ddf5be0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x1122c1f90>, 'osutil': <s3transfer.utils.OSUtils object at 0x11239f110>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x112331220>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x11239f890>}
2025-11-04 22:03:42,805 | DEBUG | s3transfer.futures | Submitting task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/e38aa5f571ee4d769ee74a6a69d560d8.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) to executor <s3transfer.futures.BoundedExecutor object at 0x112331220> for transfer request: 0.
2025-11-04 22:03:42,805 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 22:03:42,805 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/e38aa5f571ee4d769ee74a6a69d560d8.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) about to wait for the following futures []
2025-11-04 22:03:42,805 | DEBUG | s3transfer.tasks | PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/e38aa5f571ee4d769ee74a6a69d560d8.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) done waiting for dependent futures
2025-11-04 22:03:42,805 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 22:03:42,805 | DEBUG | s3transfer.tasks | Executing task PutObjectTask(transfer_id=0, {'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/e38aa5f571ee4d769ee74a6a69d560d8.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}) with kwargs {'client': <botocore.client.S3 object at 0x10ddf5be0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x112570190>, 'bucket': 'ecowhiskey-atc-audio', 'key': 'sessions/1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1/e38aa5f571ee4d769ee74a6a69d560d8.mp3', 'extra_args': {'ContentType': 'audio/mpeg', 'ChecksumAlgorithm': 'CRC32'}}
2025-11-04 22:03:43,857 | DEBUG | s3transfer.utils | Releasing acquire 0/None
2025-11-04 22:03:53,860 | INFO | app.controllers.audio | Transcripción recibida session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1: ruedo vía Alfa Bravo Al.de espera Pista 10 Viento 40 grados dos nudos QN 1013 y contacto 1813 cuando listo.
2025-11-04 22:03:53,860 | INFO | app.logs.transcript | student | session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1 | frequency=121.7 | text=ruedo vía Alfa Bravo Al.de espera Pista 10 Viento 40 grados dos nudos QN 1013 y contacto 1813 cuando listo.
2025-11-04 22:03:53,900 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:03:53,901 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:03:53,901 | INFO | sqlalchemy.engine.Engine | [cached since 72.68s ago] (UUID('1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1'),)
2025-11-04 22:03:53,906 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:03:54,291 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:03:54,292 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.training_session_id = $1::UUID
2025-11-04 22:03:54,292 | INFO | sqlalchemy.engine.Engine | [cached since 73.07s ago] (UUID('1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1'),)
2025-11-04 22:03:54,296 | INFO | sqlalchemy.engine.Engine | UPDATE ecowhiskey.training_contexts SET context=$1::JSONB, updated_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE ecowhiskey.training_contexts.id = $3::UUID
2025-11-04 22:03:54,296 | INFO | sqlalchemy.engine.Engine | [cached since 72.22s ago] ('{"meteo": {"qnh": "1013", "vis": ">10km", "wind": "040/2", "condition": "VMC", "windSpeed": "2", "windDirection": "040"}, "route": "MRPV-MRPV", "turn ... (20141 characters truncated) ... nd": "121.7", "unicom": "122.0", "approach": "120.5"}, "scenario_id": "mrpv_full_flight", "transponder": "0578", "default_frequency_group": "ground"}', datetime.datetime(2025, 11, 5, 4, 3, 54, 296063), UUID('5f0ccfbd-dede-41bf-8f00-d5dec71bb51c'))
2025-11-04 22:03:54,299 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:03:54,311 | INFO | app.controllers.audio | Fase activa session=1d93ffaf-e4f1-4ae4-8552-2d491c45f3b1 phase_id=ground_readback intent=ground_taxi_clearance freq=ground
2025-11-04 22:03:54,312 | INFO | app.services.audio_pipeline | Prompts generados intent=ground_taxi_clearance freq_group=ground
SYSTEM> Sigues como Pavas Superficie. Evalúas la colación y decides si pasa a Torre. Responde únicamente en formato JSON válido con la estructura exacta: {
  "intent": string,
  "allowResponse": boolean,
  "controllerText": string | null,
  "feedback": string,
  "confidence": number | null,
  "metadata": object
 }.
Si necesitas proponer un cambio de fase, incluye en metadata la clave "nextPhase". No escribas texto adicional antes o después del JSON.
USER> Fase actual: Readback de autorización de rodaje
Intent esperado: ground_taxi_clearance
Transcripción textual del alumno:
ruedo vía Alfa Bravo Al.de espera Pista 10 Viento 40 grados dos nudos QN 1013 y contacto 1813 cuando listo.

Contexto operativo:
- Aeropuerto: MRPV
- Grupo de frecuencia: ground
- Fase ID: ground_readback

Checklist alumno:
- Repetir pista, viento, QNH y ruta de rodaje.
- Mantener indicativo correcto y mención de contactar Torre.

Checklist controlador:
- Confirmar colación...
2025-11-04 22:03:55,452 | INFO | app.services.audio_pipeline | Respuesta LLM cruda intent=ground_taxi_clearance: {
  "intent": "ground_taxi_readback",
  "allowResponse": true,
  "controllerText": "Colación correcta.",
  "feedback": null,
  "confidence": 0.9,
  "metadata": {
    "nextPhase": "tower_hold_short"
  }
}
2025-11-04 22:03:55,456 | ERROR | app.controllers.audio | Fallo en pipeline LLM
Traceback (most recent call last):
  File "/Users/abraham_salas/EcoWhiskey-ATC-BackEnd/app/controllers/audio.py", line 182, in analyze_audio
    llm_outcome = await call_conversation_llm(request)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/abraham_salas/EcoWhiskey-ATC-BackEnd/app/pipelines/audio/llm.py", line 39, in call_conversation_llm
    structured = StructuredLlmResponse.from_json(raw_response)
  File "/Users/abraham_salas/EcoWhiskey-ATC-BackEnd/app/services/response_contract.py", line 40, in from_json
    return cls.model_validate(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/abraham_salas/EcoWhiskey-ATC-BackEnd/.venv/lib/python3.13/site-packages/pydantic/main.py", line 705, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for StructuredLlmResponse
feedback
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-11-04 22:03:55,465 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:04:37,748 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 22:04:37,748 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:04:37,751 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 22:04:37,751 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:04:37,753 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 22:04:37,753 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:04:37,754 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:04:37,755 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 22:04:37,755 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 22:04:37,760 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:04:37,760 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] ()
2025-11-04 22:04:37,762 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:04:37,763 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:04:37,764 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:04:37,764 | INFO | sqlalchemy.engine.Engine | [cached since 0.001912s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:04:37,765 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:04:37,765 | INFO | sqlalchemy.engine.Engine | [cached since 0.002431s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:04:37,765 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:04:37,765 | INFO | sqlalchemy.engine.Engine | [cached since 0.002953s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:04:37,766 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:04:37,766 | INFO | sqlalchemy.engine.Engine | [cached since 0.003445s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:04:37,767 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 22:04:37,767 | INFO | sqlalchemy.engine.Engine | [generated in 0.00008s] ('user_status', 'pg_catalog')
2025-11-04 22:04:37,768 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 22:04:37,768 | INFO | sqlalchemy.engine.Engine | [cached since 0.00114s ago] ('account_type', 'pg_catalog')
2025-11-04 22:04:37,769 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 22:04:37,769 | INFO | sqlalchemy.engine.Engine | [generated in 0.00024s] ()
2025-11-04 22:04:37,770 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 22:04:37,770 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 22:04:37,772 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 22:04:37,772 | INFO | sqlalchemy.engine.Engine | [generated in 0.00018s] ()
2025-11-04 22:04:37,782 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:04:37,790 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 22:07:20,371 | INFO | sqlalchemy.engine.Engine | select pg_catalog.version()
2025-11-04 22:07:20,371 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:07:20,373 | INFO | sqlalchemy.engine.Engine | select current_schema()
2025-11-04 22:07:20,373 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:07:20,374 | INFO | sqlalchemy.engine.Engine | show standard_conforming_strings
2025-11-04 22:07:20,374 | INFO | sqlalchemy.engine.Engine | [raw sql] ()
2025-11-04 22:07:20,375 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:07:20,375 | INFO | sqlalchemy.engine.Engine | CREATE SCHEMA IF NOT EXISTS "ecowhiskey"
2025-11-04 22:07:20,376 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 22:07:20,377 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:07:20,377 | INFO | sqlalchemy.engine.Engine | [generated in 0.00006s] ()
2025-11-04 22:07:20,379 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:07:20,379 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ('hello_messages', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:07:20,381 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:07:20,381 | INFO | sqlalchemy.engine.Engine | [cached since 0.002248s ago] ('request_logs', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:07:20,381 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:07:20,382 | INFO | sqlalchemy.engine.Engine | [cached since 0.002795s ago] ('schools', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:07:20,382 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:07:20,382 | INFO | sqlalchemy.engine.Engine | [cached since 0.003469s ago] ('training_contexts', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:07:20,383 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_namespace.nspname = $7::VARCHAR
2025-11-04 22:07:20,383 | INFO | sqlalchemy.engine.Engine | [cached since 0.004415s ago] ('users', 'r', 'p', 'f', 'v', 'm', 'ecowhiskey')
2025-11-04 22:07:20,385 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 22:07:20,385 | INFO | sqlalchemy.engine.Engine | [generated in 0.00010s] ('user_status', 'pg_catalog')
2025-11-04 22:07:20,386 | INFO | sqlalchemy.engine.Engine | SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2025-11-04 22:07:20,386 | INFO | sqlalchemy.engine.Engine | [cached since 0.001542s ago] ('account_type', 'pg_catalog')
2025-11-04 22:07:20,387 | INFO | sqlalchemy.engine.Engine | ALTER TABLE IF EXISTS schools ADD COLUMN IF NOT EXISTS value VARCHAR(20)
2025-11-04 22:07:20,387 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 22:07:20,388 | INFO | sqlalchemy.engine.Engine | UPDATE schools SET value = CONCAT('school_', id) WHERE value IS NULL OR btrim(value) = ''
2025-11-04 22:07:20,388 | INFO | sqlalchemy.engine.Engine | [generated in 0.00007s] ()
2025-11-04 22:07:20,389 | INFO | sqlalchemy.engine.Engine | 
            DO $$
            BEGIN
                IF EXISTS (
                    SELECT 1
                    FROM information_schema.columns
                    WHERE table_schema = current_schema()
                      AND table_name = 'schools'
                      AND column_name = 'value'
                ) THEN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints tc
                        JOIN information_schema.constraint_column_usage ccu
                          ON tc.constraint_name = ccu.constraint_name
                         AND tc.table_schema = ccu.table_schema
                        WHERE tc.table_schema = current_schema()
                          AND tc.table_name = 'schools'
                          AND tc.constraint_type = 'UNIQUE'
                          AND ccu.column_name = 'value'
                    ) THEN
                        ALTER TABLE schools
                        ADD CONSTRAINT uq_schools_value UNIQUE (value);
                    END IF;

                    ALTER TABLE schools
                    ALTER COLUMN value SET NOT NULL;
                END IF;
            END
            $$;
            
2025-11-04 22:07:20,389 | INFO | sqlalchemy.engine.Engine | [generated in 0.00012s] ()
2025-11-04 22:07:20,401 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:07:20,407 | INFO | app.database | Ensured database tables in schema 'ecowhiskey'.
2025-11-04 22:07:24,822 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:07:24,822 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:07:24,823 | INFO | sqlalchemy.engine.Engine | [cached since 4.446s ago] ()
2025-11-04 22:07:24,829 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 22:07:24,829 | INFO | sqlalchemy.engine.Engine | [generated in 0.00017s] (1,)
2025-11-04 22:07:24,846 | INFO | sqlalchemy.engine.Engine | INSERT INTO ecowhiskey.training_contexts (id, training_session_id, user_id, context) VALUES ($1::UUID, $2::UUID, $3::INTEGER, $4::JSONB) RETURNING ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at
2025-11-04 22:07:24,847 | INFO | sqlalchemy.engine.Engine | [generated in 0.00016s] (UUID('4fd88f2c-eddd-4479-804a-6afaeac7e999'), UUID('05d23be5-2345-44ea-a0c1-7304503ac10e'), 1, '{"route": "MRPV-MRPV", "meteo": {"condition": "VMC", "vis": ">10km", "qnh": "1013", "windDirection": "040", "windSpeed": "2", "wind": "040/2"}, "objectives": [], "scenario_id": "mrpv_full_flight", "default_frequency_group": "ground"}')
2025-11-04 22:07:24,848 | INFO | sqlalchemy.engine.Engine | COMMIT
2025-11-04 22:07:24,881 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:07:24,882 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.training_contexts.id, ecowhiskey.training_contexts.training_session_id, ecowhiskey.training_contexts.user_id, ecowhiskey.training_contexts.context, ecowhiskey.training_contexts.created_at, ecowhiskey.training_contexts.updated_at 
FROM ecowhiskey.training_contexts 
WHERE ecowhiskey.training_contexts.id = $1::UUID
2025-11-04 22:07:24,882 | INFO | sqlalchemy.engine.Engine | [generated in 0.00009s] (UUID('4fd88f2c-eddd-4479-804a-6afaeac7e999'),)
2025-11-04 22:07:24,884 | INFO | sqlalchemy.engine.Engine | ROLLBACK
2025-11-04 22:08:03,108 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_header_field with data[36:55]
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_header_value with data[57:85]
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_part_data with data[89:125]
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_header_field with data[163:182]
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_header_value with data[184:211]
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:08:03,109 | DEBUG | python_multipart.multipart | Calling on_part_data with data[215:220]
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_part_begin with no data
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_header_field with data[258:277]
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_header_value with data[279:335]
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_header_field with data[337:349]
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_header_value with data[351:361]
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_header_end with no data
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_headers_finished with no data
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_part_data with data[365:42601]
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_part_end with no data
2025-11-04 22:08:03,110 | DEBUG | python_multipart.multipart | Calling on_end with no data
2025-11-04 22:08:03,152 | INFO | sqlalchemy.engine.Engine | BEGIN (implicit)
2025-11-04 22:08:03,152 | INFO | sqlalchemy.engine.Engine | SET search_path TO "ecowhiskey", public
2025-11-04 22:08:03,152 | INFO | sqlalchemy.engine.Engine | [cached since 42.78s ago] ()
2025-11-04 22:08:03,154 | INFO | sqlalchemy.engine.Engine | SELECT ecowhiskey.users.id, ecowhiskey.users.email, ecowhiskey.users.first_name, ecowhiskey.users.last_name, ecowhiskey.users.password_hash, ecowhiskey.users.status, ecowhiskey.users.account_type, ecowhiskey.users.school_id, ecowhiskey.users.photo, ecowhiskey.users.created_at, ecowhiskey.users.updated_at, schools_1.id AS id_1, schools_1.name, schools_1.value, schools_1.location, schools_1.created_at AS created_at_1 
FROM ecowhiskey.users LEFT OUTER JOIN ecowhiskey.schools AS schools_1 ON schools_1.id = ecowhiskey.users.school_id 
WHERE ecowhiskey.users.id = $1::INTEGER
2025-11-04 22:08:03,154 | INFO | sqlalchemy.engine.Engine | [cached since 38.33s ago] (1,)
2025-11-04 22:08:03,170 | DEBUG | s3transfer.utils | Acquiring 0
2025-11-04 22:08:03,170 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10e799010>}) about to wait for the following futures []
2025-11-04 22:08:03,170 | DEBUG | s3transfer.tasks | UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10e799010>}) done waiting for dependent futures
2025-11-04 22:08:03,171 | DEBUG | s3transfer.tasks | Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x10e799010>}) with kwargs {'client': <botocore.client.S3 object at 0x10e26dbe0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x10e68d160>, 'osutil': <s3transfer.utils.OSUtils object at 0x10e68c6e0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x10e798830>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x10e799010>}
